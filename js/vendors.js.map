{"version":3,"sources":["vendors.js"],"names":["global","factory","module","exports","document","w","Error","window","this","noGlobal","isArraylike","obj","length","type","jQuery","isWindow","nodeType","winnow","elements","qualifier","not","isFunction","grep","elem","i","call","risSimple","test","filter","inArray","sibling","cur","dir","createOptions","options","object","optionsCache","each","match","rnotwhite","_","flag","detach","addEventListener","removeEventListener","completed","detachEvent","event","readyState","ready","dataAttr","key","data","undefined","name","replace","rmultiDash","toLowerCase","getAttribute","rbrace","parseJSON","e","isEmptyDataObject","isEmptyObject","internalData","pvt","acceptData","ret","thisCache","internalKey","expando","isNode","cache","id","deletedIds","pop","guid","toJSON","noop","extend","camelCase","internalRemoveData","isArray","concat","map","split","cleanData","support","deleteExpando","returnTrue","returnFalse","safeActiveElement","activeElement","err","createSafeFragment","list","nodeNames","safeFrag","createDocumentFragment","createElement","getAll","context","tag","elems","found","getElementsByTagName","strundefined","querySelectorAll","childNodes","nodeName","push","merge","fixDefaultChecked","rcheckableType","defaultChecked","checked","manipulationTarget","content","firstChild","appendChild","ownerDocument","disableScript","find","attr","restoreScript","rscriptTypeMasked","exec","removeAttribute","setGlobalEval","refElements","_data","cloneCopyEvent","src","dest","hasData","l","oldData","curData","events","handle","add","fixCloneNodeIssues","noCloneEvent","removeEvent","text","parentNode","outerHTML","html5Clone","innerHTML","trim","value","defaultSelected","selected","defaultValue","actualDisplay","doc","style","appendTo","body","display","getDefaultComputedStyle","css","defaultDisplay","elemdisplay","iframe","documentElement","contentWindow","contentDocument","write","close","addGetHookIf","conditionFn","hookFn","get","condition","apply","arguments","vendorPropName","capName","charAt","toUpperCase","slice","origName","cssPrefixes","showHide","show","hidden","values","index","isHidden","setPositiveNumber","subtract","matches","rnumsplit","Math","max","augmentWidthOrHeight","extra","isBorderBox","styles","val","cssExpand","getWidthOrHeight","valueIsBorderBox","offsetWidth","offsetHeight","getStyles","boxSizing","curCSS","rnumnonpx","boxSizingReliable","parseFloat","Tween","prop","end","easing","prototype","init","createFxNow","setTimeout","fxNow","now","genFx","includeWidth","which","attrs","height","opacity","width","createTween","animation","tween","collection","tweeners","defaultPrefilter","props","opts","toggle","hooks","oldfire","checkDisplay","anim","orig","dataShow","queue","_queueHooks","unqueued","empty","fire","always","overflow","overflowX","overflowY","inlineBlockNeedsLayout","zoom","shrinkWrapBlocks","rfxtypes","done","hide","_removeData","start","propFilter","specialEasing","cssHooks","expand","Animation","properties","result","stopped","animationPrefilters","deferred","Deferred","tick","currentTime","remaining","startTime","duration","temp","percent","tweens","run","notifyWith","resolveWith","promise","originalProperties","originalOptions","stop","gotoEnd","rejectWith","fx","timer","progress","complete","fail","addToPrefiltersOrTransports","structure","dataTypeExpression","func","dataType","dataTypes","unshift","inspectPrefiltersOrTransports","jqXHR","inspect","inspected","prefilterOrFactory","dataTypeOrTransport","seekingTransport","transports","ajaxExtend","target","deep","flatOptions","ajaxSettings","ajaxHandleResponses","s","responses","firstDataType","ct","finalDataType","contents","shift","mimeType","getResponseHeader","converters","ajaxConvert","response","isSuccess","conv2","current","conv","tmp","prev","responseFields","dataFilter","state","error","buildParams","prefix","traditional","v","rbracket","createStandardXHR","XMLHttpRequest","createActiveXHR","ActiveXObject","getWindow","defaultView","parentWindow","indexOf","class2type","toString","hasOwn","hasOwnProperty","version","selector","fn","rtrim","rmsPrefix","rdashAlpha","fcamelCase","all","letter","jquery","constructor","toArray","num","pushStack","prevObject","callback","args","first","eq","last","len","j","sort","splice","copyIsArray","copy","clone","isPlainObject","random","isReady","msg","Array","isNumeric","ownLast","globalEval","execScript","string","makeArray","arr","results","Object","second","invert","callbackInverse","callbackExpect","arg","proxy","Date","Sizzle","seed","m","groups","old","nid","newContext","newSelector","preferredDoc","setDocument","documentIsHTML","rquickExpr","getElementById","contains","getElementsByClassName","qsa","rbuggyQSA","tokenize","rescape","setAttribute","toSelector","rsibling","testContext","join","qsaError","select","createCache","keys","Expr","cacheLength","markFunction","assert","div","removeChild","addHandle","handler","attrHandle","siblingCheck","a","b","diff","sourceIndex","MAX_NEGATIVE","nextSibling","createInputPseudo","createButtonPseudo","createPositionalPseudo","argument","matchIndexes","setFilters","tokens","addCombinator","matcher","combinator","base","checkNonElements","doneName","xml","oldCache","outerCache","newCache","dirruns","elementMatcher","matchers","multipleContexts","contexts","condense","unmatched","newUnmatched","mapped","setMatcher","preFilter","postFilter","postFinder","postSelector","preMap","postMap","preexisting","matcherIn","matcherOut","matcherFromTokens","checkContext","leadingRelative","relative","implicitRelative","matchContext","matchAnyContext","outermostContext","matcherFromGroupMatchers","elementMatchers","setMatchers","bySet","byElement","superMatcher","outermost","matchedCount","setMatched","contextBackup","dirrunsUnique","uniqueSort","getText","isXML","compile","sortInput","hasDuplicate","docElem","rbuggyMatches","classCache","tokenCache","compilerCache","sortOrder","push_native","booleans","whitespace","characterEncoding","identifier","attributes","pseudos","rwhitespace","RegExp","rcomma","rcombinators","rattributeQuotes","rpseudo","ridentifier","matchExpr","ID","CLASS","TAG","ATTR","PSEUDO","CHILD","bool","needsContext","rinputs","rheader","rnative","runescape","funescape","escaped","escapedWhitespace","high","String","fromCharCode","unloadHandler","els","node","hasCompare","parent","top","attachEvent","className","createComment","getById","getElementsByName","attrId","getAttributeNode","input","matchesSelector","webkitMatchesSelector","mozMatchesSelector","oMatchesSelector","msMatchesSelector","disconnectedMatch","compareDocumentPosition","adown","bup","compare","sortDetached","aup","ap","bp","expr","specified","duplicates","detectDuplicates","sortStable","textContent","nodeValue","selectors","createPseudo",">"," ","+","~","excess","unquoted","nodeNameSelector","pattern","operator","check","what","simple","forward","ofType","nodeIndex","useCache","lastChild","pseudo","idx","matched","has","innerText","lang","elemLang","hash","location","root","focus","hasFocus","href","tabIndex","enabled","disabled","selectedIndex","header","button","even","odd","lt","gt","radio","checkbox","file","password","image","submit","reset","filters","parseOnly","soFar","preFilters","cached","token","compiled","div1","unique","isXMLDoc","rneedsContext","rsingleTag","self","is","rootjQuery","parseHTML","rparentsprev","guaranteedUnique","children","next","until","n","r","targets","closest","pos","prevAll","addBack","parents","parentsUntil","nextAll","nextUntil","prevUntil","siblings","reverse","Callbacks","firing","memory","fired","firingLength","firingIndex","firingStart","stack","once","stopOnFalse","disable","remove","lock","locked","fireWith","tuples","then","fns","newDefer","tuple","returned","resolve","reject","notify","pipe","stateString","when","subordinate","progressValues","progressContexts","resolveContexts","resolveValues","updateFunc","readyList","readyWait","holdReady","hold","wait","triggerHandler","off","frameElement","doScroll","doScrollCheck","container","cssText","noData","applet ","embed ","object ","removeData","dequeue","startLength","setter","clearQueue","count","defer","pnum","source","el","access","chainable","emptyGet","raw","bulk","fragment","leadingWhitespace","tbody","htmlSerialize","cloneNode","appendChecked","noCloneChecked","checkClone","click","eventName","change","focusin","rformElems","rkeyEvent","rmouseEvent","rfocusMorph","rtypenamespace","types","t","handleObjIn","special","eventHandle","handleObj","handlers","namespaces","origType","elemData","triggered","dispatch","delegateType","bindType","namespace","delegateCount","setup","mappedTypes","origCount","teardown","trigger","onlyHandlers","ontype","bubbleType","eventPath","Event","isTrigger","namespace_re","noBubble","isPropagationStopped","preventDefault","isDefaultPrevented","_default","fix","handlerQueue","delegateTarget","preDispatch","currentTarget","isImmediatePropagationStopped","stopPropagation","postDispatch","sel","originalEvent","fixHook","fixHooks","mouseHooks","keyHooks","srcElement","metaKey","original","charCode","keyCode","eventDoc","fromElement","pageX","clientX","scrollLeft","clientLeft","pageY","clientY","scrollTop","clientTop","relatedTarget","toElement","load","blur","beforeunload","returnValue","simulate","bubble","isSimulated","defaultPrevented","timeStamp","cancelBubble","stopImmediatePropagation","mouseenter","mouseleave","pointerenter","pointerleave","related","submitBubbles","form","_submit_bubble","changeBubbles","propertyName","_just_changed","focusinBubbles","attaches","on","one","origFn","rinlinejQuery","rnoshimcache","rleadingWhitespace","rxhtmlTag","rtagName","rtbody","rhtml","rnoInnerhtml","rchecked","rscriptType","rcleanScript","wrapMap","option","legend","area","param","thead","tr","col","td","safeFragment","fragmentDiv","optgroup","tfoot","colgroup","caption","th","dataAndEvents","deepDataAndEvents","destElements","srcElements","inPage","buildFragment","scripts","selection","wrap","safe","nodes","createTextNode","append","domManip","prepend","insertBefore","before","after","keepData","html","replaceWith","replaceChild","hasScripts","set","iNoClone","_evalUrl","prependTo","insertAfter","replaceAll","insert","shrinkWrapBlocksVal","rmargin","rposition","getComputedStyle","opener","computed","minWidth","maxWidth","getPropertyValue","currentStyle","left","rs","rsLeft","runtimeStyle","pixelLeft","computeStyleTests","pixelPositionVal","boxSizingReliableVal","reliableMarginRightVal","marginRight","reliableHiddenOffsetsVal","cssFloat","backgroundClip","clearCloneStyle","MozBoxSizing","WebkitBoxSizing","reliableHiddenOffsets","pixelPosition","reliableMarginRight","swap","ralpha","ropacity","rdisplayswap","rrelNum","cssShow","position","visibility","cssNormalTransform","letterSpacing","fontWeight","cssNumber","columnCount","fillOpacity","flexGrow","flexShrink","lineHeight","order","orphans","widows","zIndex","cssProps","float","$1","margin","padding","border","suffix","expanded","parts","unit","propHooks","eased","step","linear","p","swing","cos","PI","timerId","rfxnum","rrun","*","scale","maxIterations","tweener","prefilter","speed","opt","speeds","fadeTo","to","animate","optall","doAnimation","finish","stopQueue","timers","cssFn","slideDown","slideUp","slideToggle","fadeIn","fadeOut","fadeToggle","interval","setInterval","clearInterval","slow","fast","delay","time","timeout","clearTimeout","getSetAttribute","hrefNormalized","checkOn","optSelected","enctype","optDisabled","radioValue","rreturn","valHooks","optionSet","scrollHeight","nodeHook","boolHook","ruseDefault","getSetInput","removeAttr","nType","attrHooks","propName","attrNames","propFix","getter","setAttributeNode","createAttribute","coords","contenteditable","rfocusable","rclickable","removeProp","for","class","notxml","tabindex","parseInt","rclass","addClass","classes","clazz","finalValue","proceed","removeClass","toggleClass","stateVal","classNames","hasClass","hover","fnOver","fnOut","bind","unbind","delegate","undelegate","nonce","rquery","rvalidtokens","JSON","parse","requireNonComma","depth","str","comma","open","Function","parseXML","DOMParser","parseFromString","async","loadXML","ajaxLocParts","ajaxLocation","rhash","rts","rheaders","rlocalProtocol","rnoContent","rprotocol","rurl","prefilters","allTypes","active","lastModified","etag","url","isLocal","processData","contentType","accepts","json","* text","text html","text json","text xml","ajaxSetup","settings","ajaxPrefilter","ajaxTransport","ajax","status","nativeStatusText","headers","success","modified","statusText","timeoutTimer","transport","responseHeadersString","ifModified","cacheURL","callbackContext","statusCode","fireGlobals","globalEventContext","completeDeferred","responseHeaders","requestHeaders","requestHeadersNames","strAbort","getAllResponseHeaders","setRequestHeader","lname","overrideMimeType","code","abort","finalText","method","crossDomain","hasContent","beforeSend","send","getJSON","getScript","throws","wrapAll","wrapInner","unwrap","visible","r20","rCRLF","rsubmitterTypes","rsubmittable","encodeURIComponent","serialize","serializeArray","xhr","xhrId","xhrCallbacks","xhrSupported","cors","username","xhrFields","isAbort","onreadystatechange","responseText","script","text script","head","scriptCharset","charset","onload","oldCallbacks","rjsonp","jsonp","jsonpCallback","originalSettings","callbackName","overwritten","responseContainer","jsonProp","keepScripts","parsed","_load","params","animated","offset","setOffset","curPosition","curLeft","curCSSTop","curTop","curOffset","curCSSLeft","calculatePosition","curElem","using","win","box","getBoundingClientRect","pageYOffset","pageXOffset","offsetParent","parentOffset","scrollTo","Height","Width","","defaultExtra","funcName","size","andSelf","define","amd","_jQuery","_$","$","noConflict","console","con","dummy","methods","matchMedia","refNode","firstElementChild","fakeBody","background","q","media","callMedia","applyMedia","respond","update","requestQueue","xmlHttp","xmlhttpmethod","req","regex","keyframes","urls","findStyles","only","minw","maxw","mediaQueriesSupported","lastCall","resizeDefer","eminpx","mediastyles","rules","appendedEls","parsedSheets","resizeThrottle","links","getEmValue","originalHTMLFontSize","fontSize","originalBodyFontSize","fakeUsed","fromResize","docElemProp","currWidth","compatMode","styleBlocks","lastLink","getTime","thisstyle","min","minnull","maxnull","em","hasquery","k","ss","styleSheet","translate","qs","ql","substring","lastIndexOf","repUrls","useMedia","fullq","thisq","eachq","eql","$2","makeRequests","thisRequest","ripCSS","sheet","isCSS","rel","rawCssText","host","protocol","Reveal","initialize","checkCapabilities","features","transforms2d","transforms3d","dom","wrapper","querySelector","slides","layout","query","getQueryHash","config","hideAddressBar","images","iframes","lazyLoadable","element","requestAnimationFrameMethod","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","canvas","getContext","touch","overviewTransitions","navigator","userAgent","isMobileDevice","scriptsAsync","js","loadScript","scriptsToPreload","dependencies","setupDOM","setupPostMessage","setupIframeScrollPrevention","resetVerticalSlides","configure","readURL","updateBackground","classList","loaded","dispatchEvent","indexh","indexv","currentSlide","isPrintingPDF","removeEventListeners","setupPDF","createSingletonNode","progressbar","slideNumber","controls","theme","controlsLeft","controlsRight","controlsUp","controlsDown","controlsPrev","controlsNext","statusDiv","createStatusDiv","clip","slideSize","getComputedSlideSize","innerWidth","innerHeight","pageWidth","floor","pageHeight","slideWidth","slideHeight","injectStyleSheet","SLIDES_SELECTOR","forEach","slide","contentHeight","getAbsoluteHeight","numberOfPages","ceil","center","tagname","classname","testNode","createBackgrounds","printMode","HORIZONTAL_SLIDES_SELECTOR","slideh","backgroundStack","createBackground","slidev","parallaxBackgroundImage","backgroundImage","backgroundSize","parallaxBackgroundSize","backgroundVideo","backgroundIframe","backgroundColor","backgroundRepeat","backgroundPosition","backgroundTransition","computedBackgroundColor","rgb","colorToRgb","colorBrightness","postMessage","numberOfSlides","transition","transitionSpeed","rtl","pause","resume","mouseWheel","onDocumentMouseScroll","rollingLinks","enableRollingLinks","disableRollingLinks","previewLinks","enablePreviewLinks","disablePreviewLinks","autoSlidePlayer","destroy","autoSlide","autoSlideStoppable","Playback","autoSlideStartTime","onAutoSlidePlayerClick","autoSlidePaused","fragments","sync","addEventListeners","eventsAreBound","onWindowHashChange","onWindowResize","onTouchStart","onTouchMove","onTouchEnd","pointerEnabled","onPointerDown","onPointerMove","onPointerUp","msPointerEnabled","keyboard","onDocumentKeyDown","onDocumentKeyPress","onProgressClicked","focusBodyOnPageVisibilityChange","visibilityChange","onPageVisibilityChange","pointerEvents","onNavigateLeftClicked","onNavigateRightClicked","onNavigateUpClicked","onNavigateDownClicked","onNavigatePrevClicked","onNavigateNextClicked","o","deserialize","distanceBetween","dx","x","dy","y","sqrt","transformElement","transform","WebkitTransform","MozTransform","msTransform","transformSlides","transforms","slidesTransform","overview","color","hex3","g","hex6","substr","rgba","absoluteChildren","child","offsetTop","getRemainingHeight","newHeight","oldHeight","search","removeAddressBar","createEvent","initEvent","postMessageEvents","stringify","getState","anchors","anchor","span","onPreviewLinkClicked","showPreview","closeOverlay","overlay","showHelp","help","keyboardShortcuts","slidePadding","layoutSlideContents","presentationWidth","presentationHeight","minScale","maxScale","bottom","right","updateProgress","updateParallax","remainingHeight","nw","naturalWidth","videoWidth","nh","naturalHeight","videoHeight","es","setPreviousVerticalIndex","getPreviousVerticalIndex","attributeName","hasAttribute","activateOverview","isOverview","cancelAutoSlide","onOverviewSlideClicked","updateSlidesVisibility","layoutOverview","updateOverview","hslide","h","vslide","hbackground","vbackground","deactivateOverview","cueAutoSlide","toggleOverview","override","isVerticalSlide","enterFullscreen","requestMethod","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen","wasPaused","togglePause","isPaused","toggleAutoSlide","resumeAutoSlide","pauseAutoSlide","isAutoSliding","f","previousSlide","horizontalSlides","stateBefore","indexhBefore","indexvBefore","updateSlides","VERTICAL_SLIDES_SELECTOR","stateLoop","currentHorizontalSlide","currentVerticalSlides","navigateFragment","slideChanged","origin","HOME_SLIDE_SELECTOR","stopEmbeddedContent","startEmbeddedContent","updateControls","updateSlideNumber","writeURL","sortAllFragments","formatEmbeddedContent","horizontalSlide","verticalSlides","verticalSlide","sortFragments","slidesLength","loop","pastFragments","pastFragment","futureFragments","futureFragment","slideState","distanceX","distanceY","horizontalSlidesLength","viewDistance","Number","MAX_VALUE","verticalSlidesLength","abs","showSlide","hideSlide","oy","getProgress","format","getSlidePastCount","getTotalSlides","routes","availableRoutes","availableFragments","up","down","includeAll","currentBackground","horizontalPast","horizontalFuture","backgroundh","backgroundv","previousBackground","previousVideo","currentVideo","play","backgroundImageURL","previousBackgroundHash","currentBackgroundHash","classToBubble","backgroundWidth","backgroundHeight","horizontalOffsetMultiplier","horizontalOffset","horizontalSlideCount","parallaxBackgroundHorizontal","verticalOffsetMultiplier","verticalOffset","verticalSlideCount","parallaxBackgroundVertical","sources","indices","getIndices","getSlideBackground","backgroundVideoLoop","isSpeakerNotes","video","maxHeight","hiddenFragments","_appendParamToIframeSource","sourceAttribute","sourceURL","startEmbeddedIframe","pastCount","mainLoop","totalCount","allFragments","visibleFragments","fragmentWeight","bits","isNaN","history","writeURLTimeout","isVertical","hasFragments","currentFragment","getSlide","horizontalBackground","verticalBackgrounds","indexf","paused","setState","pausedFlag","overviewFlag","ordered","unordered","sorted","group","lastVisibleFragment","fragmentsShown","fragmentsHidden","nextFragment","previousFragment","fragmentAutoSlide","parentAutoSlide","slideAutoSlide","isLastSlide","autoSlideTimeout","navigateNext","setPlaying","navigateLeft","navigateRight","navigateUp","navigateDown","navigatePrev","onUserInput","shiftKey","keyboardCondition","autoSlideWasPaused","activeElementIsCE","contentEditable","activeElementIsInput","tagName","altKey","ctrlKey","startX","touches","startY","startCount","startSpan","captured","currentX","currentY","currentSpan","threshold","deltaX","deltaY","embedded","pointerType","MSPOINTER_TYPE_TOUCH","lastMouseWheelStep","delta","detail","wheelDelta","slidesTotal","slideIndex","webkitHidden","msHidden","progressCheck","diameter","thickness","playing","progressOffset","render","N  ,  SPACE","P","&#8592;  ,  H","&#8594;  ,  L","&#8593;  ,  K","&#8595;  ,  J","Home","End","B  ,  .","F","ESC, O","wasPlaying","progressBefore","radius","iconSize","endAngle","startAngle","save","clearRect","beginPath","arc","fillStyle","fill","lineWidth","strokeStyle","stroke","fillRect","moveTo","lineTo","restore","listener","prevFragment","navigateTo","getPreviousSlide","getCurrentSlide","getScale","getConfig","unescape","isFirstSlide","nextElementSibling","useCapture","triggerKey","HTMLElement","Element","c","DOMException","message","d","_updateClassName","item","defineProperty","enumerable","configurable","number","__defineGetter__","isEnabled","modifier","zoomKey","zoomPadding","revealScale","bounds","pan","magnify","rect","scrollOffset","getScrollOffset","supportsTransforms","OTransform","transformOrigin","OTransformOrigin","msTransformOrigin","MozTransformOrigin","WebkitTransformOrigin","level","range","rangeX","rangeY","mouseY","scroll","mouseX","scrollX","scrollY","panEngageTimeout","panUpdateInterval","OTransition","msTransition","MozTransition","WebkitTransition","out","zoomLevel","scrollbarwidth","$window","zindexvalues","lastclicked","onevisible","oneormorevisible","focushandler","blurhandler","escapehandler","bodymarginright","opensuffix","closesuffix","focusedelementbeforepopup","_init","$el","_initonce","autoopen","$wrapper","$body","scrolllock","setzindex","autozindex","outline","popupbackground","$background","textAlign","verticalAlign","openelement","ord","closeelement","ordinal","beforeopen","keepfocus","escape","reposition","focuselement","focusdelay","dialog","maxzindex","elementzindex","pagecontainer","opentransitionend","onopen","margin-right","notransitiondetach","closetransitionend","onclose","$elementclicked","linkOffset","horizontal","outerWidth","offsetleft","vertical","outerHeight","offsettop","elementclicked","popup","customoptions","defaults","require","encode","decode","decodeURIComponent","stringifyCookieValue","parseCookieValue","pluses","read","converter","cookie","expires","days","setTime","toUTCString","path","domain","secure","cookies","removeCookie","pluginName","bindSufix","onChange","elm","keySearchTimeout","arrowButtonMarkup","disableOnMobile","openOnHover","hoverIntentTimeout","expandToItemText","responsive","preventWindowScroll","inheritOriginalWidth","allowWrap","customClass","optionsItemBuilder","labelBuilder","hookName","_utils","replaceDiacritics","nextEnabledItem","selectItems","previousEnabledItem","toDash","triggerCallback","scope","$doc","$win","Selectric","_this","isMobile","_destroy","postfixes","originalWidth","$original","currClass","$input","readonly","$items","items","$itemsScroll","$label","$outerWrapper","eventTriggers","_open","_close","refresh","_refresh","hideselect","_populate","$options","_$li","$justOptions","currIndex","currValue","optionsLength","buildOption","$elm","optionText","selectDisabled","itemBuilder","slug","groupDisabled","$children","grouplabel","closeTimer","isOpen","_handleSystemKeys","resetStr","_select","$li","mousedown","_calculateOptionsDimensions","hiddenChildren","tempshow","itemsWidth","wrapperWidth","finalWidth","itemsHeight","itemsInnerHeight","_isInViewport","orgEvent","wheelDeltaY","_detectItemVisibility","winHeight","uiPosX","uiHeight","fitsDown","fitsAbove","renderAbove","above","liHeight","liTop","itemsScrollTop","scrollT","preserveData","operate","direct","_indeterminate","_disabled","_checked","_update","indeterminate","_determinate","_callback","_type","_radio","keep","_unchecked","regular","capitalize","specific","inputs","_iCheck","callbacks","_cursor","_iCheckHelper","_add","_remove","tidy","_label","_checkbox","_click","_touch","_mobile","walker","checkedClass","disabledClass","indeterminateClass","labelHover","hoverClass","focusClass","activeClass","labelHoverClass","increaseArea","helper","layer","checkboxClass","radioClass","label","aria","ariaID","inheritClass","inheritID","Zepto","debounce","invokeAsap","ctx","throttle","needInvoke","callee","vendorify","getTouchPageX","changedTouches","getTouchPageY","property","titleCased","vendorPrefixes","eventProperties","toArr","nodeList","generic","instance","enable","create","START_EVENT","END_EVENT","MOVE_EVENT","nextId","Dragging","eventHandler","lastEntered","lastX","lastY","lastDirection","originalCss","windows","placeholder","move","dropEvent","revert","adjustPlacement","view","offsetLeft","over","isOldIE","msElementsFromPoint","elementFromPoint","direction","dragging","setCurrent","bottomReached","scrollBy","topReached","MutationObserver","WebKitMutationObserver","MozMutationObserver","onAdded","addedNodes","removedNodes","onRemoved","observe","disconnect","appName","SelectorObserver","childsOnly","initialized","NodeList","observer","mutations","mutation","childList","subtree","Draggable","cancel","isHandle","cloneClass","Droppable","accept","enter","leave","drop","activate","connectWith","receiveHandler","evtObj","Sortable","placeholderTag","diverted","isEmpty","forcePlaceholderSize","isContainer","newIndex","updateHandler","updatePosition","attribute","draggable","cursor","droppable","sortable","fabric","jsdom","createWindow","isTouchSupported","isLikelyNode","Buffer","SHARED_ATTRIBUTES","DPI","reNum","_removeEventListener","__eventListeners","util","removeFromArray","stopObserving","listenersForEvent","Observable","Collection","_objects","_onObjectAdded","renderOnAddRemove","renderAll","insertAt","nonSplicing","objects","getObjects","_onObjectRemoved","forEachObject","complexity","reduce","memo","atan2","PiBy180","array","getRandomInt","degreesToRadians","degrees","radiansToDegrees","radians","rotatePoint","point","sin","subtractEquals","rx","ry","Point","addEquals","transformPoint","ignoreOffset","invertTransform","toFixed","fractionDigits","parseUnit","Text","DEFAULT_SVG_FONT_SIZE","falseFunction","getKlass","camelize","resolveNamespace","loadImage","crossOrigin","img","createImage","onerror","log","enlivenObjects","reviver","onLoaded","numLoadedObjects","numTotalObjects","enlivenedObjects","klass","fromObject","groupSVGElements","PathGroup","setSourcePath","populateWithProperties","destination","drawDashedLine","x2","y2","da","rot","dc","di","draw","rotate","createCanvasElement","canvasEl","G_vmlCanvasManager","initElement","createAccessors","proto","stateProperties","capitalizedPropName","setterName","getterName","clipContext","receiver","clipTo","multiplyTransformMatrices","getFunctionBody","isTransparent","tolerance","_isTransparent","imageData","getImageData","arcToSegments","toX","toY","large","sweep","rotateX","argsString","_join","arcToSegmentsCache","sinTh","cosTh","fromX","fromY","px","py","rx2","ry2","py2","px2","pl","cx","cy","cx1","cy1","mTheta","calcVectorAngle","dtheta","segments","mDelta","mT","th3","segmentToBezier","th2","argsString2","segmentToBezierCache","costh2","sinth2","costh3","sinth3","cp1X","cp1Y","cp2X","cp2Y","ux","uy","vx","vy","ta","tb","getBoundsOfCurve","x0","y0","x1","y1","x3","y3","boundsOfCurveCache","t1","t2","b2ac","sqrtb2ac","tvalues","mt","jlen","drawArc","fy","tx","ty","segs","segsNorm","bezierCurveTo","getBoundsOfArc","bound","boundCopy","invoke","byProperty","value1","value2","searchElement","TypeError","POSITIVE_INFINITY","NEGATIVE_INFINITY","every","some","rv","character","firstLetterOnly","escapeXml","Dummy","thisArg","Subclass","callSuper","methodName","superclass","createClass","subclasses","addMethods","emptyFunction","IS_DONTENUM_BUGGY","valueOf","areHostMethods","methodNames","createListener","uid","wrappedHandler","createWrappedHandler","getElement","createDispatcher","handlersForEvent","getPointer","upperCanvasEl","unknown","getScrollLeftTop","pointerX","pointerY","_getPointer","pageProp","clientProp","touchProp","setElement","getUniqueId","__uniqueID","addListener","removeListener","shouldUseAddListenerRemoveListener","shouldUseAttachEventDetachEvent","listeners","existingHandler","setStyle","elementStyle","setOpacity","normalizedProperty","styleFloat","parseEl","supportsOpacity","supportsFilters","reOpacity","hasLayout","makeElement","htmlFor","wrapElement","firstFixedAncestor","origElement","docElement","getElementStyle","getElementOffset","scrollLeftTop","offsetAttributes","borderLeftWidth","borderTopWidth","paddingLeft","paddingTop","sliceCanConvertNodelists","_slice","arrayLike","makeElementUnselectable","onselectstart","selectProp","unselectable","makeElementSelectable","headEl","scriptEl","loading","addParamToUrl","emptyFn","request","onComplete","makeXHR","parameters","factories","warn","requestAnimFrame","timestamp","startValue","endValue","byValue","onStart","ticktime","_requestAnimFrame","oRequestAnimationFrame","msRequestAnimationFrame","normalize","asin","elastic","pow","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeInElastic","easeOutElastic","easeInOutElastic","easeInBack","easeOutBack","easeInOutBack","easeInBounce","easeOutBounce","easeInOutBounce","ease","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","normalizeAttr","attributesMap","normalizeValue","parentAttributes","transformMatrix","parseTransformAttribute","_setStrokeFillOpacity","colorAttributes","Color","setAlpha","getAlpha","toRgba","parseStyleString","oStyle","chunk","pair","parseStyleObject","getGlobalStylesForElement","svgUid","rule","cssRules","elementMatchesRule","firstMatching","parentMatching","selectorMatches","doesSomeParentMatch","parseUseDirectives","nodelist","xlink","el2","currentTrans","addVBTransform","widthAttr","heightAttr","viewBoxWidth","viewBoxHeight","matrix","viewBoxAttr","scaleX","scaleY","minX","minY","reViewBoxAttrValue","_enlivenCachedObject","cachedObject","_createSVGPattern","markup","toSVG","fill-opacity","fill-rule","font-family","font-size","font-style","font-weight","stroke-dasharray","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","text-decoration","text-anchor","gradientDefs","rotateMatrix","angle","scaleMatrix","multiplierX","multiplierY","skewXMatrix","tan","skewYMatrix","translateMatrix","iMatrix","commaWsp","skewX","skewY","transformList","reTransformList","reTransform","attributeValue","matrices","operation","combinedMatrix","parseSVGDocument","hasAncestorWithNodeName","reAllowedSVGTagNames","reViewBoxTagNames","__uid","toBeParsed","descendants","selectNodes","getGradientDefs","getCSSRules","parseElements","instances","documentParsingTime","svgCache","reFontDeclaration","parseFontDeclaration","fontStyle","fontFamily","linearGradientEls","radialGradientEls","elList","idsToXlinkMap","parseAttributes","ownAttributes","parseStyleAttribute","font","ElementsParser","parsePointsAttribute","points","parsedPoints","allRules","styleContents","ruleObj","declaration","propertyValuePairs","_rule","loadSVGFromURL","responseXML","hasUrl","enlivedRecord","loadSVGFromString","parser","createSVGFontFacesMarkup","createSVGRefElementsMarkup","numElements","createObjects","createObject","_createObject","checkIfDone","createCallback","resolveGradient","instanceFillValue","gradientId","Gradient","that","scalarAdd","scalar","scalarAddEquals","scalarSubtract","scalarSubtractEquals","multiply","multiplyEquals","divide","divideEquals","lte","gte","lerp","distanceFrom","midPointFrom","setXY","setFromPoint","Intersection","appendPoint","appendPoints","intersectLineLine","a1","a2","b1","b2","uaT","ubT","uB","ua","ub","intersectLinePolygon","inter","intersectPolygonPolygon","points1","points2","intersectPolygonRectangle","r1","r2","topRight","bottomLeft","inter1","inter2","inter3","inter4","_tryParsingColor","setSource","hue2rgb","colorNameMap","sourceFromHex","sourceFromRgb","sourceFromHsl","_rgbToHsl","round","getSource","_source","toRgb","toHsl","hsl","toHsla","toHex","alpha","toGrayscale","average","currentAlpha","toBlackWhite","overlayWith","otherColor","otherAlpha","otherSource","reRGBa","reHSLa","reHex","aqua","black","blue","fuchsia","gray","green","lime","maroon","navy","olive","orange","purple","red","silver","teal","white","yellow","fromRgb","fromSource","fromRgba","fromHsl","fromHsla","fromHex","isShortNotation","oColor","getColorStop","colorAlpha","keyValuePairs","getLinearCoords","getRadialCoords","_convertPercentUnitsToValues","gradientUnits","propValue","addFactor","multFactor","ellipseMatrix","scaleFactor","offsetX","offsetY","colorStops","gradientTransform","addColorStop","colorStop","toObject","commonAttributes","toLive","gradient","createLinearGradient","createRadialGradient","colorStopEls","forObject","Pattern","repeat","patternSource","patternWidth","getWidth","patternHeight","getHeight","patternOffsetX","patternOffsetY","patternImgSrc","toDataURL","createPattern","Shadow","affectStroke","includeDefaultValues","_parseShadow","shadow","shadowStr","offsetsAndBlur","reOffsetsAndBlur","mode","fBoxX","fBoxY","StaticCanvas","CANVAS_INIT_ERROR","_initStatic","activeInstance","overlayColor","overlayImage","stateful","controlsAboveOverlay","allowTouchScrolling","imageSmoothingEnabled","preserveObjectStacking","viewportTransform","onBeforeScaleRotate","_createLowerCanvas","_initOptions","_setImageSmoothing","setOverlayImage","setBackgroundImage","setBackgroundColor","setOverlayColor","calcOffset","_offset","lowerCanvasEl","__setBgOverlayImage","__setBgOverlayColor","webkitImageSmoothingEnabled","mozImageSmoothingEnabled","msImageSmoothingEnabled","oImageSmoothingEnabled","Image","setOptions","_createCanvasElement","_initCanvasElement","interactive","_applyCanvasStyle","contextContainer","setWidth","setDimensions","setHeight","dimensions","cssValue","cssOnly","_setBackstoreDimension","backstoreOnly","_setCssDimension","cacheCanvasEl","wrapperEl","getZoom","setViewportTransform","vpt","activeGroup","getActiveGroup","setCoords","zoomToPoint","setZoom","absolutePan","relativePan","getActiveObject","_draw","_shouldRenderObject","_renderControls","setupState","_discardActiveObject","clearContext","clear","discardActiveGroup","discardActiveObject","contextTop","allOnTop","canvasToDrawOn","_groupSelector","_renderBackground","_renderObjects","_renderActiveGroup","_renderOverlay","drawControls","sortedObjects","_set","renderTop","_drawSelection","getCenter","centerObjectH","_centerObject","getCenterPoint","centerObjectV","centerObject","setPositionByOrigin","toDatalessJSON","propertiesToInclude","toDatalessObject","_toObjectMethod","_toObjects","__serializeBgOverlay","_toObject","originalValue","_realizeGroupTransformOnObject","_unwindGroupTransformOnObject","layoutProps","originalValues","realizeTransform","svgViewportTransformation","_setSVGPreamble","_setSVGHeader","_setSVGBgOverlayColor","_setSVGBgOverlayImage","_setSVGObjects","suppressPreamble","encoding","viewBox","sendToBack","bringToFront","sendBackwards","intersecting","newIdx","_findNewLowerIndex","isIntersecting","intersectsWithObject","isContainedWithinObject","bringForward","_findNewUpperIndex","dispose","removeListeners","DataURLExporter","EMPTY_JSON","supports","setLineDash","BaseBrush","strokeLineCap","strokeLineJoin","strokeDashArray","setShadow","_setBrushStyles","lineCap","lineJoin","_setShadow","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","_resetShadow","PencilBrush","_points","onMouseDown","pointer","_prepareForDrawing","_captureDrawingPath","_render","onMouseMove","onMouseUp","_finalizeAndAddPath","_reset","_addPoint","pointerPoint","p1","p2","midPoint","quadraticCurveTo","convertPointsToSVGPath","createPath","pathData","Path","strokeWidth","originX","originY","closePath","CircleBrush","drawDot","addPoint","originalRenderOnAddRemove","circles","circle","Circle","Group","circleRadius","circleColor","SprayBrush","density","dotWidth","dotWidthVariance","randomOpacity","optimizeOverlapping","sprayChunks","addSprayChunk","rects","ilen","sprayChunk","Rect","_getOptimizedRects","uniqueRects","uniqueRectsArray","sprayChunkPoints","globalAlpha","PatternBrush","getPatternSrc","dotDistance","patternCanvas","patternCtx","getPatternSrcFunction","getPattern","STROKE_OFFSET","Canvas","_initInteractive","_createCacheCanvas","uniScaleTransform","centeredScaling","centeredRotation","selectionColor","selectionDashArray","selectionBorderColor","selectionLineWidth","hoverCursor","moveCursor","defaultCursor","freeDrawingCursor","rotationCursor","containerClass","perPixelTargetFind","targetFindTolerance","skipTargetFind","_currentTransform","_initWrapperElement","_createUpperCanvas","_initEventListeners","freeDrawingBrush","_resetCurrentTransform","_shouldCenterTransform","action","_setOriginToCenter","mouseXSign","mouseYSign","containsPoint","xy","_normalizePointer","_findTargetCorner","isObjectInGroup","isTargetTransparent","hasBorders","transparentCorners","contextCache","_shouldClearSelection","activeObject","evented","selectable","centerTransform","_getOriginFromCorner","corner","_getActionFromCorner","_setupCurrentTransform","ex","ey","theta","_translateObject","_scaleObject","by","lockScalingX","lockScalingY","lockScalingFlip","constraintPosition","translateToOriginPoint","localMouse","toLocalPoint","_setLocalMouse","_setObjectScale","forbidScalingX","forbidScalingY","newScaleX","newScaleY","_scaleObjectEqually","_flipObject","dist","lastDist","_rotateObject","lastAngle","curAngle","setCursor","_resetObjectTransform","setAngle","groupSelector","aleft","atop","strokeRect","_isLastRenderedObject","lastRenderedObjectWithControlsAboveOverlay","findTarget","skipGroup","_searchPossibleTargets","_fireOverOutEvents","_hoveredTarget","_checkTarget","isEditing","ignoreZoom","cssScale","boundsWidth","boundsHeight","lowerCanvasClass","_copyCanvasStyle","fromEl","toEl","getSelectionContext","getSelectionElement","_setActiveObject","_activeObject","setActiveObject","_setActiveGroup","_activeGroup","setActiveGroup","_discardActiveGroup","deactivateAll","allObjects","deactivateAllWithDispatch","_drawGroupControls","_drawObjectsControls","_setCursorFromEvent","cursorOffset","mr","br","mb","bl","ml","tl","cursorMap","_bindEvents","_onResize","_onMouseDown","_onMouseMove","_onMouseWheel","eventjs","_onGesture","_onDrag","_onOrientationChange","_onShake","_onLongPress","_onMouseUp","__onTransformGesture","__onDrag","__onMouseWheel","__onOrientationChange","__onShake","__onLongPress","__onMouseDown","__onMouseUp","__onMouseMove","_shouldRender","isMoving","_previousPointer","isDrawingMode","_isCurrentlyDrawing","_onMouseUpInDrawingMode","_finalizeCurrentTransform","shouldRender","_maybeGroupObjects","_handleCursorAndEvent","_scaling","hasStateChanged","_restoreOriginXY","_previousOriginX","_previousOriginY","originPoint","_onMouseDownInDrawingMode","ivt","_onMouseMoveInDrawingMode","isLeftClick","shouldGroup","_shouldGroup","_clearSelection","_handleGrouping","_beforeTransform","saveState","_setCenterToOrigin","_transformObject","_beforeScaleTransform","_performTransformAction","_fire","_onScale","currentAction","_setCornerCursor","_getRotatedCornerCursor","hasRotatingPoint","getAngle","isType","_updateActiveGroup","_createActiveGroup","saveCoords","removeWithUpdate","addWithUpdate","_createGroup","isActiveLower","groupObjects","_groupSelectedObjects","_collectObjects","currentObject","selectionX1Y1","selectionX2Y2","isClick","intersectsWithRect","isContainedWithinRect","setObjectsCoords","quality","multiplier","cropping","__toDataURLWithMultiplier","__toDataURL","croppedCanvasEl","__getCroppedCanvas","croppedCtx","shouldCrop","drawImage","origWidth","origHeight","scaledWidth","scaledHeight","_tempRemoveBordersControlsFromGroup","_restoreBordersControlsOnGroup","toDataURLWithMultiplier","origHasControls","hasControls","origBorderColor","borderColor","hideControls","origHideControls","loadFromDatalessJSON","loadFromJSON","serialized","_enlivenObjects","_setBgOverlay","cbIfLoaded","__setBgOverlay","_toDataURL","_toDataURLWithMultiplier","cloneWithoutData","backgroundImageOpacity","backgroundImageStretch","supportsLineDash","flipX","flipY","cornerSize","cornerColor","fillRule","globalCompositeOperation","strokeMiterLimit","borderOpacityWhenMoving","borderScaleFactor","minScaleLimit","rotatingPointOffset","lockMovementX","lockMovementY","lockRotation","lockUniScaling","_initGradient","_initPattern","_initClipping","functionBody","fromLeft","_getLeftTopCoords","NUM_FRACTION_DIGITS","_removeDefaultValues","_setObject","shouldConstrainValue","_constrainScale","sourcePath","getViewportTransform","noTransform","_setupCompositeOperation","_setStrokeStyles","_setFillStyles","_setOpacity","_removeShadow","_restoreCompositeOperation","miterLimit","drawBorders","multX","multY","_renderFill","_renderStroke","_stroke","_renderDashedStroke","cloneAsImage","dataUrl","boundingRect","getBoundingRect","origParams","getLeft","getTop","originalCanvas","setGradient","setPatternFill","setColor","shouldCenterOrigin","_resetOrigin","centerH","centerV","getLocalPointer","objectLeftTop","_prevGlobalCompositeOperation","translateToCenterPoint","leftTop","getPointByOrigin","adjustPosition","hypotHalf","xHalf","yHalf","hypotFull","xFull","yFull","_originalOriginX","_originalOriginY","oCoords","pointTL","pointBR","intersection","other","getCoords","thisCoords","otherCoords","point1","point2","lines","_getImageLines","xPoints","_findCrossPoints","topline","rightline","bottomline","leftline","xi","yi","iLine","xcount","lineKey","getBoundingRectWidth","getBoundingRectHeight","xCoords","maxX","yCoords","maxY","scaleToWidth","boundingRectFactor","scaleToHeight","_calculateCurrentDimensions","currentWidth","currentHeight","_hypotenuse","_angle","atan","isFinite","wh","_tl","_tr","mtr","_setCornerCoords","getSvgStyles","getSvgTransform","translatePart","anglePart","scalePart","addTranslateX","flipXPart","addTranslateY","flipYPart","getSvgTransformMatrix","_createBaseSVGMarkup","originalState","isVML","_controlsVisibility","isControlVisible","__corner","newTheta","cornerHypotenuse","cosHalfOffset","sinHalfOffset","shouldTransform","capped","vLine","hLine","sLine","strokeW","strokeH","rotateHeight","scaleOffset","_drawControl","control","controlName","_getControlsVisibility","setControlVisible","setControlsVisibility","FX_DURATION","fxCenterObjectH","fxCenterObjectV","fxRemove","skipCallbacks","propsToAnimate","_animate","propPair","currentValue","from","makeEdgeToOriginGetter","propertyNames","originValues","axis1","axis2","dimension","nearest","farthest","coordProps","Line","_setWidthHeight","_getLeftToOriginX","_getTopToOriginY","cp","calcLinePoints","origStrokeStyle","xMult","yMult","ATTRIBUTE_NAMES","parsedAttributes","isValidRadius","pi","setRadius","endX","endY","largeFlag","getRadiusX","getRadiusY","Triangle","widthBy2","heightBy2","piBy2","Ellipse","getRx","getRy","ellipse","_initRxRy","isRounded","Polyline","Polygon","_calcDimensions","_applyPointOffset","commonRender","_toString","commandLengths","repeatedCommands","M","fromArray","_parsePath","_setPositionDimensions","calcDim","_parseDimensions","pathOffset","tempX","tempY","previous","subpathStartX","subpathStartY","controlX","controlY","chunks","addTransform","currentPath","coordsStr","coordsParsed","re","command","commandLength","repeatedCommand","klen","aX","aY","pathUrl","parentToObject","paths","parseDimensionsFromPaths","xC","yC","isSameColor","firstPathFill","total","pathGroup","_lockProperties","_calcBounds","_updateObjectsCoords","_updateObjectCoords","objectLeft","objectTop","originalLeft","originalTop","__origHasControls","_restoreObjectsState","_setObjectActive","_moveFlippedObject","delegatedProperties","textDecoration","_renderObject","originalHasRotatingPoint","_restoreObjectState","_setObjectPosition","oldOriginX","oldOriginY","_toggleFlipping","newOrigin","rotated","_getRotatedLeftTop","groupAngle","_originalLeft","_originalTop","hasMoved","onlyWidthHeight","_getBounds","minXY","maxXY","alignX","alignY","meetOrSlice","_lastScaleX","_lastScaleY","resizeFilters","_initElement","_initConfig","applyFilters","_element","_originalElement","setCrossOrigin","getOriginalSize","_src","filterObj","preserveAspectRatio","getSvgSrc","origFill","getSrc","setSrc","imgElement","forResizing","imgEl","replacement","applyTo","toBuffer","pngCompression","_filteredEl","elementToDraw","imageMargins","_findMargins","_needsResize","marginX","marginY","scales","_resetWidthHeight","CSS_CANVAS","_initFilters","fromURL","imgOptions","aspectRatioAttrs","align","_getAngleValueForStraighten","straighten","fxStraighten","straightenObject","fxStraightenObject","BaseFilter","Brightness","brightness","putImageData","Convolute","opaque","tmpCtx","_createImageData","createImageData","weights","pixels","side","halfSide","sw","sh","output","dst","alphaFac","sy","sx","dstOff","scy","scx","srcOff","wt","GradientTransparency","Grayscale","Invert","iLen","Mask","mask","channel","maskEl","maskCanvasEl","maskImageData","maskData","Noise","noise","rand","Pixelate","blocksize","jLen","_i","_ilen","_j","_jlen","RemoveWhite","distance","limit","Sepia","avg","Sepia2","Tint","tintR","tintG","tintB","alpha1","Multiply","Blend","tg","_r","_g","_b","isImage","_el","tmpCanvas","context2","Resize","resizeType","lanczosLobes","rcpScaleX","rcpScaleY","oW","oH","dW","dH","sliceByTwo","hermiteFastResize","bilinearFiltering","lanczosResize","newWidth","multW","multH","signW","signH","doneW","doneH","stepW","stepH","lanczosCreate","lobes","xx","process","u","weight","fX","fY","ratioX","icenter","ratioY","range2X","cacheLanc","range2Y","lanczos","rcpRatioX","rcpRatioY","srcData","destData","destImg","srcImg","w2","h2","xDiff","yDiff","chnl","origPix","w4","destImage","destPixels","ratioW","ratioH","ratioWHalf","ratioHHalf","img2","data2","weightsAlpha","gxR","gxG","gxB","gxA","centerY","yy","centerX","w0","scaley","_dimensionAffectingProps","_reNewline","textBackgroundColor","_fontSizeFraction","_fontSizeMult","__skipDimension","_initDimensions","_setTextStyles","_textLines","_clearCache","currentTextAlign","_getTextWidth","_getTextHeight","_renderTextBackground","_renderText","_renderTextDecoration","_translateForTextAlign","_renderTextFill","_renderTextStroke","textBaseline","skipTextAlign","_getFontDeclaration","_getHeightOfLine","_getLineWidth","currentLineWidth","_renderChars","chars","_renderTextLine","line","lineIndex","totalWidth","words","wordsWidth","_getWidthOfWords","widthDiff","numSpaces","spaceWidth","leftOffset","measureText","_getLeftOffset","_getTopOffset","_skipFillStrokeCheck","lineHeights","heightOfLine","_renderTextBoxBackground","_renderTextLinesBackground","lineTopOffset","lineLeftOffset","_getLineLeftOffset","__lineWidths","__lineHeights","__lineOffsets","_shouldClearCache","shouldClear","renderLinesAtOffset","offsets","oLen","halfOfVerticalBox","_getSVGLeftTopOffsets","textAndBg","_getSVGTextAndBg","textTop","textLeft","_wrapSVGTextAndBg","lineTop","textBgRects","textSpans","textTopOffset","textLeftOffset","_setSVGBg","_setSVGTextLineBg","_setSVGTextLineText","yPos","_getFillAttributes","fillColor","offX","IText","selectionStart","selectionEnd","editable","editingBorderColor","cursorWidth","cursorColor","cursorDelay","cursorDuration","caching","_reSpace","_currentCursorOpacity","_selectionDirection","_abortCursorAnimation","_charWidthsCache","initBehavior","__maxFontHeights","__widthOfSpace","isEmptyStyles","p3","setSelectionStart","_updateTextarea","setSelectionEnd","getSelectionStyles","startIndex","endIndex","loc","get2DCursorLocation","charIndex","setSelectionStyles","_extendStyles","renderCursorOrSelection","boundaries","_getCursorBoundaries","renderCursor","renderSelection","textBeforeCursor","linesBeforeCursor","getCurrentCharStyle","getCurrentCharFontSize","getCurrentCharColor","typeOfBoundaries","_getCursorBoundariesOffsets","lineLeft","topOffset","_getWidthOfChar","_getCachedLineOffset","widthOfLine","cursorLocation","charHeight","__isMousedown","startLine","endLine","lineOffset","boxWidth","j2","j2len","_renderCharsFast","prevStyle","charsToRender","thisStyle","_hasStyleChanged","_renderChar","skipFillStrokeCheck","_char","decl","charWidth","shouldStroke","shouldFill","_applyCharStylesGetWidth","_getHeightOfChar","fillText","strokeText","_renderCharDecoration","styleDeclaration","_getWidthOfCharsAt","_getCacheProp","_applyFontStyles","cacheProp","_getStyleDeclaration","_getWidthOfSpace","_getHeightOfCharAt","currentCharHeight","initAddedHandler","initRemovedHandler","initCursorSelectionHandlers","initDoubleClickSimulation","initSelectedHandler","_hasITextHandlers","_initCanvasHandlers","_iTextInstances","exitEditingOnOthers","_tick","_currentTickState","_animateCursor","targetOpacity","completeMethod","tickState","isAborted","_onTickComplete","_cursorTimeout1","_currentTickCompleteState","initDelayedCursor","restart","_cursorTimeout2","abortCursorAnimation","selectAll","getSelectedText","findWordBoundaryLeft","startFrom","findWordBoundaryRight","findLineBoundaryLeft","findLineBoundaryRight","getNumNewLinesInSelectedText","selectedText","numNewLines","searchWordBoundary","reNonWord","selectWord","newSelectionStart","newSelectionEnd","selectLine","enterEditing","initHiddenTextarea","hiddenTextarea","_saveEditingProps","_setEditingProps","initMouseMoveHandler","exitEditing","getSelectionStartFromPointer","__selectionStartOnMouseDown","_savedProps","_restoreEditingProps","overCursor","_removeExtraneousStyles","_removeCharsFromTo","prevIndex","isNewline","removeStyleObject","insertChars","_chars","useCopiedStyle","isEndOfLine","insertStyleObjects","insertNewlineStyleObject","shiftLineStyles","currentCharStyle","newLineStyles","insertCharStyleObject","currentLineStyles","currentLineStylesCloned","numericIndex","_insertStyles","copiedStyles","clonedStyles","numericLine","isBeginningOfLine","textOnPreviousLine","newCharIndexOnPrevLine","insertNewline","__lastClickTime","__lastLastClickTime","__lastPointer","__newClickTime","newPointer","isTripleClick","_stopEvent","isDoubleClick","__lastIsEditing","__lastSelected","initMousedownHandler","initMouseupHandler","initClicks","__mousedownX","__mousedownY","setCursorByClick","_isObjectMoved","_getLocalRotatedPointer","pClicked","pLeftTop","mouseOffset","prevWidth","_getNewSelectionStartFromOffset","distanceBtwLastCharAndCursor","distanceBtwNextCharAndCursor","onKeyDown","onKeyPress","paste","_clickHandlerInitialized","onClick","_keysMap","8","9","27","13","33","34","35","36","37","38","39","40","46","_ctrlKeysMap","65","88","forwardDelete","moveCursorRight","removeChars","clipboardData","_getClipboardData","setData","copiedText","getData","cut","getDownCursorOffset","isRight","selectionProp","textAfterCursor","textOnSameLineBeforeCursor","textOnSameLineAfterCursor","textOnNextLine","widthOfSameLineBeforeCursor","widthOfCharsOnSameLineBeforeCursor","indexOnNextLine","_getIndexOnNextLine","foundMatch","widthOfNextLine","widthOfCharsOnNextLine","widthOfChar","leftEdge","rightEdge","offsetFromLeftEdge","offsetFromRightEdge","moveCursorDown","moveCursorDownWithShift","moveCursorDownWithoutShift","swapSelectionPoints","swapSel","getUpCursorOffset","indexOnPrevLine","_getIndexOnPrevLine","widthOfPreviousLine","widthOfCharsOnPreviousLine","moveCursorUp","moveCursorUpWithShift","moveCursorUpWithoutShift","moveCursorLeft","moveCursorLeftWithShift","moveCursorLeftWithoutShift","_move","propMethod","_moveLeft","_moveRight","moveCursorRightWithShift","moveCursorRightWithoutShift","_removeCharsNearCursor","leftLineBoundary","leftWordBoundary","_setSVGTextLineChars","charOffset","_getSVGLineLeftOffset","_getSVGLineTopOffset","styleDecl","_createTextCharSpan","_createTextCharBg","lastHeight","fillStyles","oURL","URL","port","reqHandler","HTTPS","HTTP","hostname","setEncoding","errno","ECONNREFUSED","requestFs","fs","readFile","createImageAndCallBack","eval","oImg","createCanvasForNode","nodeCanvasOptions","nodeCanvas","FabricCanvas","fabricCanvas","Font","createPNGStream","createJPEGStream","origSetWidth","origSetHeight","DateFormat","daysInWeek","shortDaysInWeek","shortMonthsInYear","longMonthsInYear","shortMonthsToNumber","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","YYYYMMDD_MATCHER","numberToLongDay","numberToShortDay","numberToShortMonth","monthArrayIndex","numberToLongMonth","shortMonthToNumber","parseTime","hour","minute","delimited","timeArray","millis","paddingCount","parseDate","parsedDate","date","year","month","dayOfMonth","dayOfWeek","getFullYear","getMonth","getDate","toTimeString","subValues","getDay","retValue","unparsedRest","inQuote","currentPattern","nextRight","prettyDate","day_diff","toBrowserTimeZone","saveAs","nativeIeSaveAs","blob","msSaveOrOpenBlob","autoBom","FileSaver","saveUsingLinkElement","objectUrl","getURL","createObjectURL","saveLinkElement","download","setImmediate","triggerClickOnSaveLink","dispatchAll","filesaver","revoke","DONE","fixChromeSaveableType","chrome","forceSaveableType","webkitSlice","blobChanged","fixWebKitDownload","webkitReqFs","targetView","saveUsingObjectURLs","execSave","newTab","INIT","canUseSaveLink","reqFs","saveUsingFyleSystem","fileSaverAbort","eventTypes","throwOutside","getFyleSystem","getDirectory","createIfNotFound","abortable","getTempDirectory","getExistentFileForRemove","existentFileNotFound","getFile","getFileForWrite","createWriter","writer","onWriterEnd","toURL","onError","ABORT_ERR","bindEventsToWriter","onAbort","onwriteend","WRITING","fsMinSize","exclusive","TEMPORARY","Blob","webkitURL","revoker","revokeObjectURL","arbitraryRevokeTimeout","MouseEvent","createElementNS","webkitRequestFileSystem","requestFileSystem","mozRequestFileSystem","FSProto","onwritestart","onprogress","onwrite","onabort","base64_ranks","Uint8Array","HTMLCanvasElement","canvas_proto","is_base64_regex","to_data_url","decode_base64","base64","rank","undef","buffer","outptr","charCodeAt","toBlob","mozGetAsFile","msToBlob","dataURI","header_end","is_base64","fake","toDataURLHD","toBlobHD"],"mappings":"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","file":"vendors.js","sourcesContent":["/*!\n * jQuery JavaScript Library v1.11.3\n * http://jquery.com/\n *\n * Includes Sizzle.js\n * http://sizzlejs.com/\n *\n * Copyright 2005, 2014 jQuery Foundation, Inc. and other contributors\n * Released under the MIT license\n * http://jquery.org/license\n *\n * Date: 2015-04-28T16:19Z\n */\n\n(function( global, factory ) {\n\n\tif ( typeof module === \"object\" && typeof module.exports === \"object\" ) {\n\t\t// For CommonJS and CommonJS-like environments where a proper window is present,\n\t\t// execute the factory and get jQuery\n\t\t// For environments that do not inherently posses a window with a document\n\t\t// (such as Node.js), expose a jQuery-making factory as module.exports\n\t\t// This accentuates the need for the creation of a real window\n\t\t// e.g. var jQuery = require(\"jquery\")(window);\n\t\t// See ticket #14549 for more info\n\t\tmodule.exports = global.document ?\n\t\t\tfactory( global, true ) :\n\t\t\tfunction( w ) {\n\t\t\t\tif ( !w.document ) {\n\t\t\t\t\tthrow new Error( \"jQuery requires a window with a document\" );\n\t\t\t\t}\n\t\t\t\treturn factory( w );\n\t\t\t};\n\t} else {\n\t\tfactory( global );\n\t}\n\n// Pass this if window is not defined yet\n}(typeof window !== \"undefined\" ? window : this, function( window, noGlobal ) {\n\n// Can't do this because several apps including ASP.NET trace\n// the stack via arguments.caller.callee and Firefox dies if\n// you try to trace through \"use strict\" call chains. (#13335)\n// Support: Firefox 18+\n//\n\nvar deletedIds = [];\n\nvar slice = deletedIds.slice;\n\nvar concat = deletedIds.concat;\n\nvar push = deletedIds.push;\n\nvar indexOf = deletedIds.indexOf;\n\nvar class2type = {};\n\nvar toString = class2type.toString;\n\nvar hasOwn = class2type.hasOwnProperty;\n\nvar support = {};\n\n\n\nvar\n\tversion = \"1.11.3\",\n\n\t// Define a local copy of jQuery\n\tjQuery = function( selector, context ) {\n\t\t// The jQuery object is actually just the init constructor 'enhanced'\n\t\t// Need init if jQuery is called (just allow error to be thrown if not included)\n\t\treturn new jQuery.fn.init( selector, context );\n\t},\n\n\t// Support: Android<4.1, IE<9\n\t// Make sure we trim BOM and NBSP\n\trtrim = /^[\\s\\uFEFF\\xA0]+|[\\s\\uFEFF\\xA0]+$/g,\n\n\t// Matches dashed string for camelizing\n\trmsPrefix = /^-ms-/,\n\trdashAlpha = /-([\\da-z])/gi,\n\n\t// Used by jQuery.camelCase as callback to replace()\n\tfcamelCase = function( all, letter ) {\n\t\treturn letter.toUpperCase();\n\t};\n\njQuery.fn = jQuery.prototype = {\n\t// The current version of jQuery being used\n\tjquery: version,\n\n\tconstructor: jQuery,\n\n\t// Start with an empty selector\n\tselector: \"\",\n\n\t// The default length of a jQuery object is 0\n\tlength: 0,\n\n\ttoArray: function() {\n\t\treturn slice.call( this );\n\t},\n\n\t// Get the Nth element in the matched element set OR\n\t// Get the whole matched element set as a clean array\n\tget: function( num ) {\n\t\treturn num != null ?\n\n\t\t\t// Return just the one element from the set\n\t\t\t( num < 0 ? this[ num + this.length ] : this[ num ] ) :\n\n\t\t\t// Return all the elements in a clean array\n\t\t\tslice.call( this );\n\t},\n\n\t// Take an array of elements and push it onto the stack\n\t// (returning the new matched element set)\n\tpushStack: function( elems ) {\n\n\t\t// Build a new jQuery matched element set\n\t\tvar ret = jQuery.merge( this.constructor(), elems );\n\n\t\t// Add the old object onto the stack (as a reference)\n\t\tret.prevObject = this;\n\t\tret.context = this.context;\n\n\t\t// Return the newly-formed element set\n\t\treturn ret;\n\t},\n\n\t// Execute a callback for every element in the matched set.\n\t// (You can seed the arguments with an array of args, but this is\n\t// only used internally.)\n\teach: function( callback, args ) {\n\t\treturn jQuery.each( this, callback, args );\n\t},\n\n\tmap: function( callback ) {\n\t\treturn this.pushStack( jQuery.map(this, function( elem, i ) {\n\t\t\treturn callback.call( elem, i, elem );\n\t\t}));\n\t},\n\n\tslice: function() {\n\t\treturn this.pushStack( slice.apply( this, arguments ) );\n\t},\n\n\tfirst: function() {\n\t\treturn this.eq( 0 );\n\t},\n\n\tlast: function() {\n\t\treturn this.eq( -1 );\n\t},\n\n\teq: function( i ) {\n\t\tvar len = this.length,\n\t\t\tj = +i + ( i < 0 ? len : 0 );\n\t\treturn this.pushStack( j >= 0 && j < len ? [ this[j] ] : [] );\n\t},\n\n\tend: function() {\n\t\treturn this.prevObject || this.constructor(null);\n\t},\n\n\t// For internal use only.\n\t// Behaves like an Array's method, not like a jQuery method.\n\tpush: push,\n\tsort: deletedIds.sort,\n\tsplice: deletedIds.splice\n};\n\njQuery.extend = jQuery.fn.extend = function() {\n\tvar src, copyIsArray, copy, name, options, clone,\n\t\ttarget = arguments[0] || {},\n\t\ti = 1,\n\t\tlength = arguments.length,\n\t\tdeep = false;\n\n\t// Handle a deep copy situation\n\tif ( typeof target === \"boolean\" ) {\n\t\tdeep = target;\n\n\t\t// skip the boolean and the target\n\t\ttarget = arguments[ i ] || {};\n\t\ti++;\n\t}\n\n\t// Handle case when target is a string or something (possible in deep copy)\n\tif ( typeof target !== \"object\" && !jQuery.isFunction(target) ) {\n\t\ttarget = {};\n\t}\n\n\t// extend jQuery itself if only one argument is passed\n\tif ( i === length ) {\n\t\ttarget = this;\n\t\ti--;\n\t}\n\n\tfor ( ; i < length; i++ ) {\n\t\t// Only deal with non-null/undefined values\n\t\tif ( (options = arguments[ i ]) != null ) {\n\t\t\t// Extend the base object\n\t\t\tfor ( name in options ) {\n\t\t\t\tsrc = target[ name ];\n\t\t\t\tcopy = options[ name ];\n\n\t\t\t\t// Prevent never-ending loop\n\t\t\t\tif ( target === copy ) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\t// Recurse if we're merging plain objects or arrays\n\t\t\t\tif ( deep && copy && ( jQuery.isPlainObject(copy) || (copyIsArray = jQuery.isArray(copy)) ) ) {\n\t\t\t\t\tif ( copyIsArray ) {\n\t\t\t\t\t\tcopyIsArray = false;\n\t\t\t\t\t\tclone = src && jQuery.isArray(src) ? src : [];\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tclone = src && jQuery.isPlainObject(src) ? src : {};\n\t\t\t\t\t}\n\n\t\t\t\t\t// Never move original objects, clone them\n\t\t\t\t\ttarget[ name ] = jQuery.extend( deep, clone, copy );\n\n\t\t\t\t// Don't bring in undefined values\n\t\t\t\t} else if ( copy !== undefined ) {\n\t\t\t\t\ttarget[ name ] = copy;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Return the modified object\n\treturn target;\n};\n\njQuery.extend({\n\t// Unique for each copy of jQuery on the page\n\texpando: \"jQuery\" + ( version + Math.random() ).replace( /\\D/g, \"\" ),\n\n\t// Assume jQuery is ready without the ready module\n\tisReady: true,\n\n\terror: function( msg ) {\n\t\tthrow new Error( msg );\n\t},\n\n\tnoop: function() {},\n\n\t// See test/unit/core.js for details concerning isFunction.\n\t// Since version 1.3, DOM methods and functions like alert\n\t// aren't supported. They return false on IE (#2968).\n\tisFunction: function( obj ) {\n\t\treturn jQuery.type(obj) === \"function\";\n\t},\n\n\tisArray: Array.isArray || function( obj ) {\n\t\treturn jQuery.type(obj) === \"array\";\n\t},\n\n\tisWindow: function( obj ) {\n\t\t/* jshint eqeqeq: false */\n\t\treturn obj != null && obj == obj.window;\n\t},\n\n\tisNumeric: function( obj ) {\n\t\t// parseFloat NaNs numeric-cast false positives (null|true|false|\"\")\n\t\t// ...but misinterprets leading-number strings, particularly hex literals (\"0x...\")\n\t\t// subtraction forces infinities to NaN\n\t\t// adding 1 corrects loss of precision from parseFloat (#15100)\n\t\treturn !jQuery.isArray( obj ) && (obj - parseFloat( obj ) + 1) >= 0;\n\t},\n\n\tisEmptyObject: function( obj ) {\n\t\tvar name;\n\t\tfor ( name in obj ) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t},\n\n\tisPlainObject: function( obj ) {\n\t\tvar key;\n\n\t\t// Must be an Object.\n\t\t// Because of IE, we also have to check the presence of the constructor property.\n\t\t// Make sure that DOM nodes and window objects don't pass through, as well\n\t\tif ( !obj || jQuery.type(obj) !== \"object\" || obj.nodeType || jQuery.isWindow( obj ) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\ttry {\n\t\t\t// Not own constructor property must be Object\n\t\t\tif ( obj.constructor &&\n\t\t\t\t!hasOwn.call(obj, \"constructor\") &&\n\t\t\t\t!hasOwn.call(obj.constructor.prototype, \"isPrototypeOf\") ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t} catch ( e ) {\n\t\t\t// IE8,9 Will throw exceptions on certain host objects #9897\n\t\t\treturn false;\n\t\t}\n\n\t\t// Support: IE<9\n\t\t// Handle iteration over inherited properties before own properties.\n\t\tif ( support.ownLast ) {\n\t\t\tfor ( key in obj ) {\n\t\t\t\treturn hasOwn.call( obj, key );\n\t\t\t}\n\t\t}\n\n\t\t// Own properties are enumerated firstly, so to speed up,\n\t\t// if last one is own, then all properties are own.\n\t\tfor ( key in obj ) {}\n\n\t\treturn key === undefined || hasOwn.call( obj, key );\n\t},\n\n\ttype: function( obj ) {\n\t\tif ( obj == null ) {\n\t\t\treturn obj + \"\";\n\t\t}\n\t\treturn typeof obj === \"object\" || typeof obj === \"function\" ?\n\t\t\tclass2type[ toString.call(obj) ] || \"object\" :\n\t\t\ttypeof obj;\n\t},\n\n\t// Evaluates a script in a global context\n\t// Workarounds based on findings by Jim Driscoll\n\t// http://weblogs.java.net/blog/driscoll/archive/2009/09/08/eval-javascript-global-context\n\tglobalEval: function( data ) {\n\t\tif ( data && jQuery.trim( data ) ) {\n\t\t\t// We use execScript on Internet Explorer\n\t\t\t// We use an anonymous function so that context is window\n\t\t\t// rather than jQuery in Firefox\n\t\t\t( window.execScript || function( data ) {\n\t\t\t\twindow[ \"eval\" ].call( window, data );\n\t\t\t} )( data );\n\t\t}\n\t},\n\n\t// Convert dashed to camelCase; used by the css and data modules\n\t// Microsoft forgot to hump their vendor prefix (#9572)\n\tcamelCase: function( string ) {\n\t\treturn string.replace( rmsPrefix, \"ms-\" ).replace( rdashAlpha, fcamelCase );\n\t},\n\n\tnodeName: function( elem, name ) {\n\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === name.toLowerCase();\n\t},\n\n\t// args is for internal usage only\n\teach: function( obj, callback, args ) {\n\t\tvar value,\n\t\t\ti = 0,\n\t\t\tlength = obj.length,\n\t\t\tisArray = isArraylike( obj );\n\n\t\tif ( args ) {\n\t\t\tif ( isArray ) {\n\t\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\t\tvalue = callback.apply( obj[ i ], args );\n\n\t\t\t\t\tif ( value === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( i in obj ) {\n\t\t\t\t\tvalue = callback.apply( obj[ i ], args );\n\n\t\t\t\t\tif ( value === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t// A special, fast, case for the most common use of each\n\t\t} else {\n\t\t\tif ( isArray ) {\n\t\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\t\tvalue = callback.call( obj[ i ], i, obj[ i ] );\n\n\t\t\t\t\tif ( value === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( i in obj ) {\n\t\t\t\t\tvalue = callback.call( obj[ i ], i, obj[ i ] );\n\n\t\t\t\t\tif ( value === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn obj;\n\t},\n\n\t// Support: Android<4.1, IE<9\n\ttrim: function( text ) {\n\t\treturn text == null ?\n\t\t\t\"\" :\n\t\t\t( text + \"\" ).replace( rtrim, \"\" );\n\t},\n\n\t// results is for internal usage only\n\tmakeArray: function( arr, results ) {\n\t\tvar ret = results || [];\n\n\t\tif ( arr != null ) {\n\t\t\tif ( isArraylike( Object(arr) ) ) {\n\t\t\t\tjQuery.merge( ret,\n\t\t\t\t\ttypeof arr === \"string\" ?\n\t\t\t\t\t[ arr ] : arr\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tpush.call( ret, arr );\n\t\t\t}\n\t\t}\n\n\t\treturn ret;\n\t},\n\n\tinArray: function( elem, arr, i ) {\n\t\tvar len;\n\n\t\tif ( arr ) {\n\t\t\tif ( indexOf ) {\n\t\t\t\treturn indexOf.call( arr, elem, i );\n\t\t\t}\n\n\t\t\tlen = arr.length;\n\t\t\ti = i ? i < 0 ? Math.max( 0, len + i ) : i : 0;\n\n\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\t// Skip accessing in sparse arrays\n\t\t\t\tif ( i in arr && arr[ i ] === elem ) {\n\t\t\t\t\treturn i;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t},\n\n\tmerge: function( first, second ) {\n\t\tvar len = +second.length,\n\t\t\tj = 0,\n\t\t\ti = first.length;\n\n\t\twhile ( j < len ) {\n\t\t\tfirst[ i++ ] = second[ j++ ];\n\t\t}\n\n\t\t// Support: IE<9\n\t\t// Workaround casting of .length to NaN on otherwise arraylike objects (e.g., NodeLists)\n\t\tif ( len !== len ) {\n\t\t\twhile ( second[j] !== undefined ) {\n\t\t\t\tfirst[ i++ ] = second[ j++ ];\n\t\t\t}\n\t\t}\n\n\t\tfirst.length = i;\n\n\t\treturn first;\n\t},\n\n\tgrep: function( elems, callback, invert ) {\n\t\tvar callbackInverse,\n\t\t\tmatches = [],\n\t\t\ti = 0,\n\t\t\tlength = elems.length,\n\t\t\tcallbackExpect = !invert;\n\n\t\t// Go through the array, only saving the items\n\t\t// that pass the validator function\n\t\tfor ( ; i < length; i++ ) {\n\t\t\tcallbackInverse = !callback( elems[ i ], i );\n\t\t\tif ( callbackInverse !== callbackExpect ) {\n\t\t\t\tmatches.push( elems[ i ] );\n\t\t\t}\n\t\t}\n\n\t\treturn matches;\n\t},\n\n\t// arg is for internal usage only\n\tmap: function( elems, callback, arg ) {\n\t\tvar value,\n\t\t\ti = 0,\n\t\t\tlength = elems.length,\n\t\t\tisArray = isArraylike( elems ),\n\t\t\tret = [];\n\n\t\t// Go through the array, translating each of the items to their new values\n\t\tif ( isArray ) {\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\n\n\t\t\t\tif ( value != null ) {\n\t\t\t\t\tret.push( value );\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Go through every key on the object,\n\t\t} else {\n\t\t\tfor ( i in elems ) {\n\t\t\t\tvalue = callback( elems[ i ], i, arg );\n\n\t\t\t\tif ( value != null ) {\n\t\t\t\t\tret.push( value );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Flatten any nested arrays\n\t\treturn concat.apply( [], ret );\n\t},\n\n\t// A global GUID counter for objects\n\tguid: 1,\n\n\t// Bind a function to a context, optionally partially applying any\n\t// arguments.\n\tproxy: function( fn, context ) {\n\t\tvar args, proxy, tmp;\n\n\t\tif ( typeof context === \"string\" ) {\n\t\t\ttmp = fn[ context ];\n\t\t\tcontext = fn;\n\t\t\tfn = tmp;\n\t\t}\n\n\t\t// Quick check to determine if target is callable, in the spec\n\t\t// this throws a TypeError, but we will just return undefined.\n\t\tif ( !jQuery.isFunction( fn ) ) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\t// Simulated bind\n\t\targs = slice.call( arguments, 2 );\n\t\tproxy = function() {\n\t\t\treturn fn.apply( context || this, args.concat( slice.call( arguments ) ) );\n\t\t};\n\n\t\t// Set the guid of unique handler to the same of original handler, so it can be removed\n\t\tproxy.guid = fn.guid = fn.guid || jQuery.guid++;\n\n\t\treturn proxy;\n\t},\n\n\tnow: function() {\n\t\treturn +( new Date() );\n\t},\n\n\t// jQuery.support is not used in Core but other projects attach their\n\t// properties to it so it needs to exist.\n\tsupport: support\n});\n\n// Populate the class2type map\njQuery.each(\"Boolean Number String Function Array Date RegExp Object Error\".split(\" \"), function(i, name) {\n\tclass2type[ \"[object \" + name + \"]\" ] = name.toLowerCase();\n});\n\nfunction isArraylike( obj ) {\n\n\t// Support: iOS 8.2 (not reproducible in simulator)\n\t// `in` check used to prevent JIT error (gh-2145)\n\t// hasOwn isn't used here due to false negatives\n\t// regarding Nodelist length in IE\n\tvar length = \"length\" in obj && obj.length,\n\t\ttype = jQuery.type( obj );\n\n\tif ( type === \"function\" || jQuery.isWindow( obj ) ) {\n\t\treturn false;\n\t}\n\n\tif ( obj.nodeType === 1 && length ) {\n\t\treturn true;\n\t}\n\n\treturn type === \"array\" || length === 0 ||\n\t\ttypeof length === \"number\" && length > 0 && ( length - 1 ) in obj;\n}\nvar Sizzle =\n/*!\n * Sizzle CSS Selector Engine v2.2.0-pre\n * http://sizzlejs.com/\n *\n * Copyright 2008, 2014 jQuery Foundation, Inc. and other contributors\n * Released under the MIT license\n * http://jquery.org/license\n *\n * Date: 2014-12-16\n */\n(function( window ) {\n\nvar i,\n\tsupport,\n\tExpr,\n\tgetText,\n\tisXML,\n\ttokenize,\n\tcompile,\n\tselect,\n\toutermostContext,\n\tsortInput,\n\thasDuplicate,\n\n\t// Local document vars\n\tsetDocument,\n\tdocument,\n\tdocElem,\n\tdocumentIsHTML,\n\trbuggyQSA,\n\trbuggyMatches,\n\tmatches,\n\tcontains,\n\n\t// Instance-specific data\n\texpando = \"sizzle\" + 1 * new Date(),\n\tpreferredDoc = window.document,\n\tdirruns = 0,\n\tdone = 0,\n\tclassCache = createCache(),\n\ttokenCache = createCache(),\n\tcompilerCache = createCache(),\n\tsortOrder = function( a, b ) {\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t}\n\t\treturn 0;\n\t},\n\n\t// General-purpose constants\n\tMAX_NEGATIVE = 1 << 31,\n\n\t// Instance methods\n\thasOwn = ({}).hasOwnProperty,\n\tarr = [],\n\tpop = arr.pop,\n\tpush_native = arr.push,\n\tpush = arr.push,\n\tslice = arr.slice,\n\t// Use a stripped-down indexOf as it's faster than native\n\t// http://jsperf.com/thor-indexof-vs-for/5\n\tindexOf = function( list, elem ) {\n\t\tvar i = 0,\n\t\t\tlen = list.length;\n\t\tfor ( ; i < len; i++ ) {\n\t\t\tif ( list[i] === elem ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\n\tbooleans = \"checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped\",\n\n\t// Regular expressions\n\n\t// Whitespace characters http://www.w3.org/TR/css3-selectors/#whitespace\n\twhitespace = \"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",\n\t// http://www.w3.org/TR/css3-syntax/#characters\n\tcharacterEncoding = \"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",\n\n\t// Loosely modeled on CSS identifier characters\n\t// An unquoted value should be a CSS identifier http://www.w3.org/TR/css3-selectors/#attribute-selectors\n\t// Proper syntax: http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier\n\tidentifier = characterEncoding.replace( \"w\", \"w#\" ),\n\n\t// Attribute selectors: http://www.w3.org/TR/selectors/#attribute-selectors\n\tattributes = \"\\\\[\" + whitespace + \"*(\" + characterEncoding + \")(?:\" + whitespace +\n\t\t// Operator (capture 2)\n\t\t\"*([*^$|!~]?=)\" + whitespace +\n\t\t// \"Attribute values must be CSS identifiers [capture 5] or strings [capture 3 or capture 4]\"\n\t\t\"*(?:'((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\"|(\" + identifier + \"))|)\" + whitespace +\n\t\t\"*\\\\]\",\n\n\tpseudos = \":(\" + characterEncoding + \")(?:\\\\((\" +\n\t\t// To reduce the number of selectors needing tokenize in the preFilter, prefer arguments:\n\t\t// 1. quoted (capture 3; capture 4 or capture 5)\n\t\t\"('((?:\\\\\\\\.|[^\\\\\\\\'])*)'|\\\"((?:\\\\\\\\.|[^\\\\\\\\\\\"])*)\\\")|\" +\n\t\t// 2. simple (capture 6)\n\t\t\"((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\" + attributes + \")*)|\" +\n\t\t// 3. anything else (capture 2)\n\t\t\".*\" +\n\t\t\")\\\\)|)\",\n\n\t// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter\n\trwhitespace = new RegExp( whitespace + \"+\", \"g\" ),\n\trtrim = new RegExp( \"^\" + whitespace + \"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\" + whitespace + \"+$\", \"g\" ),\n\n\trcomma = new RegExp( \"^\" + whitespace + \"*,\" + whitespace + \"*\" ),\n\trcombinators = new RegExp( \"^\" + whitespace + \"*([>+~]|\" + whitespace + \")\" + whitespace + \"*\" ),\n\n\trattributeQuotes = new RegExp( \"=\" + whitespace + \"*([^\\\\]'\\\"]*?)\" + whitespace + \"*\\\\]\", \"g\" ),\n\n\trpseudo = new RegExp( pseudos ),\n\tridentifier = new RegExp( \"^\" + identifier + \"$\" ),\n\n\tmatchExpr = {\n\t\t\"ID\": new RegExp( \"^#(\" + characterEncoding + \")\" ),\n\t\t\"CLASS\": new RegExp( \"^\\\\.(\" + characterEncoding + \")\" ),\n\t\t\"TAG\": new RegExp( \"^(\" + characterEncoding.replace( \"w\", \"w*\" ) + \")\" ),\n\t\t\"ATTR\": new RegExp( \"^\" + attributes ),\n\t\t\"PSEUDO\": new RegExp( \"^\" + pseudos ),\n\t\t\"CHILD\": new RegExp( \"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\" + whitespace +\n\t\t\t\"*(even|odd|(([+-]|)(\\\\d*)n|)\" + whitespace + \"*(?:([+-]|)\" + whitespace +\n\t\t\t\"*(\\\\d+)|))\" + whitespace + \"*\\\\)|)\", \"i\" ),\n\t\t\"bool\": new RegExp( \"^(?:\" + booleans + \")$\", \"i\" ),\n\t\t// For use in libraries implementing .is()\n\t\t// We use this for POS matching in `select`\n\t\t\"needsContext\": new RegExp( \"^\" + whitespace + \"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\" +\n\t\t\twhitespace + \"*((?:-\\\\d)?\\\\d*)\" + whitespace + \"*\\\\)|)(?=[^-]|$)\", \"i\" )\n\t},\n\n\trinputs = /^(?:input|select|textarea|button)$/i,\n\trheader = /^h\\d$/i,\n\n\trnative = /^[^{]+\\{\\s*\\[native \\w/,\n\n\t// Easily-parseable/retrievable ID or TAG or CLASS selectors\n\trquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n\n\trsibling = /[+~]/,\n\trescape = /'|\\\\/g,\n\n\t// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters\n\trunescape = new RegExp( \"\\\\\\\\([\\\\da-f]{1,6}\" + whitespace + \"?|(\" + whitespace + \")|.)\", \"ig\" ),\n\tfunescape = function( _, escaped, escapedWhitespace ) {\n\t\tvar high = \"0x\" + escaped - 0x10000;\n\t\t// NaN means non-codepoint\n\t\t// Support: Firefox<24\n\t\t// Workaround erroneous numeric interpretation of +\"0x\"\n\t\treturn high !== high || escapedWhitespace ?\n\t\t\tescaped :\n\t\t\thigh < 0 ?\n\t\t\t\t// BMP codepoint\n\t\t\t\tString.fromCharCode( high + 0x10000 ) :\n\t\t\t\t// Supplemental Plane codepoint (surrogate pair)\n\t\t\t\tString.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );\n\t},\n\n\t// Used for iframes\n\t// See setDocument()\n\t// Removing the function wrapper causes a \"Permission Denied\"\n\t// error in IE\n\tunloadHandler = function() {\n\t\tsetDocument();\n\t};\n\n// Optimize for push.apply( _, NodeList )\ntry {\n\tpush.apply(\n\t\t(arr = slice.call( preferredDoc.childNodes )),\n\t\tpreferredDoc.childNodes\n\t);\n\t// Support: Android<4.0\n\t// Detect silently failing push.apply\n\tarr[ preferredDoc.childNodes.length ].nodeType;\n} catch ( e ) {\n\tpush = { apply: arr.length ?\n\n\t\t// Leverage slice if possible\n\t\tfunction( target, els ) {\n\t\t\tpush_native.apply( target, slice.call(els) );\n\t\t} :\n\n\t\t// Support: IE<9\n\t\t// Otherwise append directly\n\t\tfunction( target, els ) {\n\t\t\tvar j = target.length,\n\t\t\t\ti = 0;\n\t\t\t// Can't trust NodeList.length\n\t\t\twhile ( (target[j++] = els[i++]) ) {}\n\t\t\ttarget.length = j - 1;\n\t\t}\n\t};\n}\n\nfunction Sizzle( selector, context, results, seed ) {\n\tvar match, elem, m, nodeType,\n\t\t// QSA vars\n\t\ti, groups, old, nid, newContext, newSelector;\n\n\tif ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {\n\t\tsetDocument( context );\n\t}\n\n\tcontext = context || document;\n\tresults = results || [];\n\tnodeType = context.nodeType;\n\n\tif ( typeof selector !== \"string\" || !selector ||\n\t\tnodeType !== 1 && nodeType !== 9 && nodeType !== 11 ) {\n\n\t\treturn results;\n\t}\n\n\tif ( !seed && documentIsHTML ) {\n\n\t\t// Try to shortcut find operations when possible (e.g., not under DocumentFragment)\n\t\tif ( nodeType !== 11 && (match = rquickExpr.exec( selector )) ) {\n\t\t\t// Speed-up: Sizzle(\"#ID\")\n\t\t\tif ( (m = match[1]) ) {\n\t\t\t\tif ( nodeType === 9 ) {\n\t\t\t\t\telem = context.getElementById( m );\n\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t\t// nodes that are no longer in the document (jQuery #6963)\n\t\t\t\t\tif ( elem && elem.parentNode ) {\n\t\t\t\t\t\t// Handle the case where IE, Opera, and Webkit return items\n\t\t\t\t\t\t// by name instead of ID\n\t\t\t\t\t\tif ( elem.id === m ) {\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Context is not a document\n\t\t\t\t\tif ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&\n\t\t\t\t\t\tcontains( context, elem ) && elem.id === m ) {\n\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Speed-up: Sizzle(\"TAG\")\n\t\t\t} else if ( match[2] ) {\n\t\t\t\tpush.apply( results, context.getElementsByTagName( selector ) );\n\t\t\t\treturn results;\n\n\t\t\t// Speed-up: Sizzle(\".CLASS\")\n\t\t\t} else if ( (m = match[3]) && support.getElementsByClassName ) {\n\t\t\t\tpush.apply( results, context.getElementsByClassName( m ) );\n\t\t\t\treturn results;\n\t\t\t}\n\t\t}\n\n\t\t// QSA path\n\t\tif ( support.qsa && (!rbuggyQSA || !rbuggyQSA.test( selector )) ) {\n\t\t\tnid = old = expando;\n\t\t\tnewContext = context;\n\t\t\tnewSelector = nodeType !== 1 && selector;\n\n\t\t\t// qSA works strangely on Element-rooted queries\n\t\t\t// We can work around this by specifying an extra ID on the root\n\t\t\t// and working up from there (Thanks to Andrew Dupont for the technique)\n\t\t\t// IE 8 doesn't work on object elements\n\t\t\tif ( nodeType === 1 && context.nodeName.toLowerCase() !== \"object\" ) {\n\t\t\t\tgroups = tokenize( selector );\n\n\t\t\t\tif ( (old = context.getAttribute(\"id\")) ) {\n\t\t\t\t\tnid = old.replace( rescape, \"\\\\$&\" );\n\t\t\t\t} else {\n\t\t\t\t\tcontext.setAttribute( \"id\", nid );\n\t\t\t\t}\n\t\t\t\tnid = \"[id='\" + nid + \"'] \";\n\n\t\t\t\ti = groups.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tgroups[i] = nid + toSelector( groups[i] );\n\t\t\t\t}\n\t\t\t\tnewContext = rsibling.test( selector ) && testContext( context.parentNode ) || context;\n\t\t\t\tnewSelector = groups.join(\",\");\n\t\t\t}\n\n\t\t\tif ( newSelector ) {\n\t\t\t\ttry {\n\t\t\t\t\tpush.apply( results,\n\t\t\t\t\t\tnewContext.querySelectorAll( newSelector )\n\t\t\t\t\t);\n\t\t\t\t\treturn results;\n\t\t\t\t} catch(qsaError) {\n\t\t\t\t} finally {\n\t\t\t\t\tif ( !old ) {\n\t\t\t\t\t\tcontext.removeAttribute(\"id\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// All others\n\treturn select( selector.replace( rtrim, \"$1\" ), context, results, seed );\n}\n\n/**\n * Create key-value caches of limited size\n * @returns {Function(string, Object)} Returns the Object data after storing it on itself with\n *\tproperty name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)\n *\tdeleting the oldest entry\n */\nfunction createCache() {\n\tvar keys = [];\n\n\tfunction cache( key, value ) {\n\t\t// Use (key + \" \") to avoid collision with native prototype properties (see Issue #157)\n\t\tif ( keys.push( key + \" \" ) > Expr.cacheLength ) {\n\t\t\t// Only keep the most recent entries\n\t\t\tdelete cache[ keys.shift() ];\n\t\t}\n\t\treturn (cache[ key + \" \" ] = value);\n\t}\n\treturn cache;\n}\n\n/**\n * Mark a function for special use by Sizzle\n * @param {Function} fn The function to mark\n */\nfunction markFunction( fn ) {\n\tfn[ expando ] = true;\n\treturn fn;\n}\n\n/**\n * Support testing using an element\n * @param {Function} fn Passed the created div and expects a boolean result\n */\nfunction assert( fn ) {\n\tvar div = document.createElement(\"div\");\n\n\ttry {\n\t\treturn !!fn( div );\n\t} catch (e) {\n\t\treturn false;\n\t} finally {\n\t\t// Remove from its parent by default\n\t\tif ( div.parentNode ) {\n\t\t\tdiv.parentNode.removeChild( div );\n\t\t}\n\t\t// release memory in IE\n\t\tdiv = null;\n\t}\n}\n\n/**\n * Adds the same handler for all of the specified attrs\n * @param {String} attrs Pipe-separated list of attributes\n * @param {Function} handler The method that will be applied\n */\nfunction addHandle( attrs, handler ) {\n\tvar arr = attrs.split(\"|\"),\n\t\ti = attrs.length;\n\n\twhile ( i-- ) {\n\t\tExpr.attrHandle[ arr[i] ] = handler;\n\t}\n}\n\n/**\n * Checks document order of two siblings\n * @param {Element} a\n * @param {Element} b\n * @returns {Number} Returns less than 0 if a precedes b, greater than 0 if a follows b\n */\nfunction siblingCheck( a, b ) {\n\tvar cur = b && a,\n\t\tdiff = cur && a.nodeType === 1 && b.nodeType === 1 &&\n\t\t\t( ~b.sourceIndex || MAX_NEGATIVE ) -\n\t\t\t( ~a.sourceIndex || MAX_NEGATIVE );\n\n\t// Use IE sourceIndex if available on both nodes\n\tif ( diff ) {\n\t\treturn diff;\n\t}\n\n\t// Check if b follows a\n\tif ( cur ) {\n\t\twhile ( (cur = cur.nextSibling) ) {\n\t\t\tif ( cur === b ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn a ? 1 : -1;\n}\n\n/**\n * Returns a function to use in pseudos for input types\n * @param {String} type\n */\nfunction createInputPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn name === \"input\" && elem.type === type;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for buttons\n * @param {String} type\n */\nfunction createButtonPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn (name === \"input\" || name === \"button\") && elem.type === type;\n\t};\n}\n\n/**\n * Returns a function to use in pseudos for positionals\n * @param {Function} fn\n */\nfunction createPositionalPseudo( fn ) {\n\treturn markFunction(function( argument ) {\n\t\targument = +argument;\n\t\treturn markFunction(function( seed, matches ) {\n\t\t\tvar j,\n\t\t\t\tmatchIndexes = fn( [], seed.length, argument ),\n\t\t\t\ti = matchIndexes.length;\n\n\t\t\t// Match elements found at the specified indexes\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( seed[ (j = matchIndexes[i]) ] ) {\n\t\t\t\t\tseed[j] = !(matches[j] = seed[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\n/**\n * Checks a node for validity as a Sizzle context\n * @param {Element|Object=} context\n * @returns {Element|Object|Boolean} The input node if acceptable, otherwise a falsy value\n */\nfunction testContext( context ) {\n\treturn context && typeof context.getElementsByTagName !== \"undefined\" && context;\n}\n\n// Expose support vars for convenience\nsupport = Sizzle.support = {};\n\n/**\n * Detects XML nodes\n * @param {Element|Object} elem An element or a document\n * @returns {Boolean} True iff elem is a non-HTML XML node\n */\nisXML = Sizzle.isXML = function( elem ) {\n\t// documentElement is verified for cases where it doesn't yet exist\n\t// (such as loading iframes in IE - #4833)\n\tvar documentElement = elem && (elem.ownerDocument || elem).documentElement;\n\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n};\n\n/**\n * Sets document-related variables once based on the current document\n * @param {Element|Object} [doc] An element or document object to use to set the document\n * @returns {Object} Returns the current document\n */\nsetDocument = Sizzle.setDocument = function( node ) {\n\tvar hasCompare, parent,\n\t\tdoc = node ? node.ownerDocument || node : preferredDoc;\n\n\t// If no document and documentElement is available, return\n\tif ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {\n\t\treturn document;\n\t}\n\n\t// Set our document\n\tdocument = doc;\n\tdocElem = doc.documentElement;\n\tparent = doc.defaultView;\n\n\t// Support: IE>8\n\t// If iframe document is assigned to \"document\" variable and if iframe has been reloaded,\n\t// IE will throw \"permission denied\" error when accessing \"document\" variable, see jQuery #13936\n\t// IE6-8 do not support the defaultView property so parent will be undefined\n\tif ( parent && parent !== parent.top ) {\n\t\t// IE11 does not have attachEvent, so all must suffer\n\t\tif ( parent.addEventListener ) {\n\t\t\tparent.addEventListener( \"unload\", unloadHandler, false );\n\t\t} else if ( parent.attachEvent ) {\n\t\t\tparent.attachEvent( \"onunload\", unloadHandler );\n\t\t}\n\t}\n\n\t/* Support tests\n\t---------------------------------------------------------------------- */\n\tdocumentIsHTML = !isXML( doc );\n\n\t/* Attributes\n\t---------------------------------------------------------------------- */\n\n\t// Support: IE<8\n\t// Verify that getAttribute really returns attributes and not properties\n\t// (excepting IE8 booleans)\n\tsupport.attributes = assert(function( div ) {\n\t\tdiv.className = \"i\";\n\t\treturn !div.getAttribute(\"className\");\n\t});\n\n\t/* getElement(s)By*\n\t---------------------------------------------------------------------- */\n\n\t// Check if getElementsByTagName(\"*\") returns only elements\n\tsupport.getElementsByTagName = assert(function( div ) {\n\t\tdiv.appendChild( doc.createComment(\"\") );\n\t\treturn !div.getElementsByTagName(\"*\").length;\n\t});\n\n\t// Support: IE<9\n\tsupport.getElementsByClassName = rnative.test( doc.getElementsByClassName );\n\n\t// Support: IE<10\n\t// Check if getElementById returns elements by name\n\t// The broken getElementById methods don't pick up programatically-set names,\n\t// so use a roundabout getElementsByName test\n\tsupport.getById = assert(function( div ) {\n\t\tdocElem.appendChild( div ).id = expando;\n\t\treturn !doc.getElementsByName || !doc.getElementsByName( expando ).length;\n\t});\n\n\t// ID find and filter\n\tif ( support.getById ) {\n\t\tExpr.find[\"ID\"] = function( id, context ) {\n\t\t\tif ( typeof context.getElementById !== \"undefined\" && documentIsHTML ) {\n\t\t\t\tvar m = context.getElementById( id );\n\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t// nodes that are no longer in the document #6963\n\t\t\t\treturn m && m.parentNode ? [ m ] : [];\n\t\t\t}\n\t\t};\n\t\tExpr.filter[\"ID\"] = function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn elem.getAttribute(\"id\") === attrId;\n\t\t\t};\n\t\t};\n\t} else {\n\t\t// Support: IE6/7\n\t\t// getElementById is not reliable as a find shortcut\n\t\tdelete Expr.find[\"ID\"];\n\n\t\tExpr.filter[\"ID\"] =  function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\tvar node = typeof elem.getAttributeNode !== \"undefined\" && elem.getAttributeNode(\"id\");\n\t\t\t\treturn node && node.value === attrId;\n\t\t\t};\n\t\t};\n\t}\n\n\t// Tag\n\tExpr.find[\"TAG\"] = support.getElementsByTagName ?\n\t\tfunction( tag, context ) {\n\t\t\tif ( typeof context.getElementsByTagName !== \"undefined\" ) {\n\t\t\t\treturn context.getElementsByTagName( tag );\n\n\t\t\t// DocumentFragment nodes don't have gEBTN\n\t\t\t} else if ( support.qsa ) {\n\t\t\t\treturn context.querySelectorAll( tag );\n\t\t\t}\n\t\t} :\n\n\t\tfunction( tag, context ) {\n\t\t\tvar elem,\n\t\t\t\ttmp = [],\n\t\t\t\ti = 0,\n\t\t\t\t// By happy coincidence, a (broken) gEBTN appears on DocumentFragment nodes too\n\t\t\t\tresults = context.getElementsByTagName( tag );\n\n\t\t\t// Filter out possible comments\n\t\t\tif ( tag === \"*\" ) {\n\t\t\t\twhile ( (elem = results[i++]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\ttmp.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\t\t\treturn results;\n\t\t};\n\n\t// Class\n\tExpr.find[\"CLASS\"] = support.getElementsByClassName && function( className, context ) {\n\t\tif ( documentIsHTML ) {\n\t\t\treturn context.getElementsByClassName( className );\n\t\t}\n\t};\n\n\t/* QSA/matchesSelector\n\t---------------------------------------------------------------------- */\n\n\t// QSA and matchesSelector support\n\n\t// matchesSelector(:active) reports false when true (IE9/Opera 11.5)\n\trbuggyMatches = [];\n\n\t// qSa(:focus) reports false when true (Chrome 21)\n\t// We allow this because of a bug in IE8/9 that throws an error\n\t// whenever `document.activeElement` is accessed on an iframe\n\t// So, we allow :focus to pass through QSA all the time to avoid the IE error\n\t// See http://bugs.jquery.com/ticket/13378\n\trbuggyQSA = [];\n\n\tif ( (support.qsa = rnative.test( doc.querySelectorAll )) ) {\n\t\t// Build QSA regex\n\t\t// Regex strategy adopted from Diego Perini\n\t\tassert(function( div ) {\n\t\t\t// Select is set to empty string on purpose\n\t\t\t// This is to test IE's treatment of not explicitly\n\t\t\t// setting a boolean content attribute,\n\t\t\t// since its presence should be enough\n\t\t\t// http://bugs.jquery.com/ticket/12359\n\t\t\tdocElem.appendChild( div ).innerHTML = \"<a id='\" + expando + \"'></a>\" +\n\t\t\t\t\"<select id='\" + expando + \"-\\f]' msallowcapture=''>\" +\n\t\t\t\t\"<option selected=''></option></select>\";\n\n\t\t\t// Support: IE8, Opera 11-12.16\n\t\t\t// Nothing should be selected when empty strings follow ^= or $= or *=\n\t\t\t// The test attribute must be unknown in Opera but \"safe\" for WinRT\n\t\t\t// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx#attribute_section\n\t\t\tif ( div.querySelectorAll(\"[msallowcapture^='']\").length ) {\n\t\t\t\trbuggyQSA.push( \"[*^$]=\" + whitespace + \"*(?:''|\\\"\\\")\" );\n\t\t\t}\n\n\t\t\t// Support: IE8\n\t\t\t// Boolean attributes and \"value\" are not treated correctly\n\t\t\tif ( !div.querySelectorAll(\"[selected]\").length ) {\n\t\t\t\trbuggyQSA.push( \"\\\\[\" + whitespace + \"*(?:value|\" + booleans + \")\" );\n\t\t\t}\n\n\t\t\t// Support: Chrome<29, Android<4.2+, Safari<7.0+, iOS<7.0+, PhantomJS<1.9.7+\n\t\t\tif ( !div.querySelectorAll( \"[id~=\" + expando + \"-]\" ).length ) {\n\t\t\t\trbuggyQSA.push(\"~=\");\n\t\t\t}\n\n\t\t\t// Webkit/Opera - :checked should return selected option elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !div.querySelectorAll(\":checked\").length ) {\n\t\t\t\trbuggyQSA.push(\":checked\");\n\t\t\t}\n\n\t\t\t// Support: Safari 8+, iOS 8+\n\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=136851\n\t\t\t// In-page `selector#id sibing-combinator selector` fails\n\t\t\tif ( !div.querySelectorAll( \"a#\" + expando + \"+*\" ).length ) {\n\t\t\t\trbuggyQSA.push(\".#.+[+~]\");\n\t\t\t}\n\t\t});\n\n\t\tassert(function( div ) {\n\t\t\t// Support: Windows 8 Native Apps\n\t\t\t// The type and name attributes are restricted during .innerHTML assignment\n\t\t\tvar input = doc.createElement(\"input\");\n\t\t\tinput.setAttribute( \"type\", \"hidden\" );\n\t\t\tdiv.appendChild( input ).setAttribute( \"name\", \"D\" );\n\n\t\t\t// Support: IE8\n\t\t\t// Enforce case-sensitivity of name attribute\n\t\t\tif ( div.querySelectorAll(\"[name=d]\").length ) {\n\t\t\t\trbuggyQSA.push( \"name\" + whitespace + \"*[*^$|!~]?=\" );\n\t\t\t}\n\n\t\t\t// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !div.querySelectorAll(\":enabled\").length ) {\n\t\t\t\trbuggyQSA.push( \":enabled\", \":disabled\" );\n\t\t\t}\n\n\t\t\t// Opera 10-11 does not throw on post-comma invalid pseudos\n\t\t\tdiv.querySelectorAll(\"*,:x\");\n\t\t\trbuggyQSA.push(\",.*:\");\n\t\t});\n\t}\n\n\tif ( (support.matchesSelector = rnative.test( (matches = docElem.matches ||\n\t\tdocElem.webkitMatchesSelector ||\n\t\tdocElem.mozMatchesSelector ||\n\t\tdocElem.oMatchesSelector ||\n\t\tdocElem.msMatchesSelector) )) ) {\n\n\t\tassert(function( div ) {\n\t\t\t// Check to see if it's possible to do matchesSelector\n\t\t\t// on a disconnected node (IE 9)\n\t\t\tsupport.disconnectedMatch = matches.call( div, \"div\" );\n\n\t\t\t// This should fail with an exception\n\t\t\t// Gecko does not error, returns false instead\n\t\t\tmatches.call( div, \"[s!='']:x\" );\n\t\t\trbuggyMatches.push( \"!=\", pseudos );\n\t\t});\n\t}\n\n\trbuggyQSA = rbuggyQSA.length && new RegExp( rbuggyQSA.join(\"|\") );\n\trbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join(\"|\") );\n\n\t/* Contains\n\t---------------------------------------------------------------------- */\n\thasCompare = rnative.test( docElem.compareDocumentPosition );\n\n\t// Element contains another\n\t// Purposefully does not implement inclusive descendent\n\t// As in, an element does not contain itself\n\tcontains = hasCompare || rnative.test( docElem.contains ) ?\n\t\tfunction( a, b ) {\n\t\t\tvar adown = a.nodeType === 9 ? a.documentElement : a,\n\t\t\t\tbup = b && b.parentNode;\n\t\t\treturn a === bup || !!( bup && bup.nodeType === 1 && (\n\t\t\t\tadown.contains ?\n\t\t\t\t\tadown.contains( bup ) :\n\t\t\t\t\ta.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16\n\t\t\t));\n\t\t} :\n\t\tfunction( a, b ) {\n\t\t\tif ( b ) {\n\t\t\t\twhile ( (b = b.parentNode) ) {\n\t\t\t\t\tif ( b === a ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t/* Sorting\n\t---------------------------------------------------------------------- */\n\n\t// Document order sorting\n\tsortOrder = hasCompare ?\n\tfunction( a, b ) {\n\n\t\t// Flag for duplicate removal\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\t// Sort on method existence if only one input has compareDocumentPosition\n\t\tvar compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n\t\tif ( compare ) {\n\t\t\treturn compare;\n\t\t}\n\n\t\t// Calculate position if both inputs belong to the same document\n\t\tcompare = ( a.ownerDocument || a ) === ( b.ownerDocument || b ) ?\n\t\t\ta.compareDocumentPosition( b ) :\n\n\t\t\t// Otherwise we know they are disconnected\n\t\t\t1;\n\n\t\t// Disconnected nodes\n\t\tif ( compare & 1 ||\n\t\t\t(!support.sortDetached && b.compareDocumentPosition( a ) === compare) ) {\n\n\t\t\t// Choose the first element that is related to our preferred document\n\t\t\tif ( a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a) ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t\tif ( b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b) ) {\n\t\t\t\treturn 1;\n\t\t\t}\n\n\t\t\t// Maintain original order\n\t\t\treturn sortInput ?\n\t\t\t\t( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n\t\t\t\t0;\n\t\t}\n\n\t\treturn compare & 4 ? -1 : 1;\n\t} :\n\tfunction( a, b ) {\n\t\t// Exit early if the nodes are identical\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\tvar cur,\n\t\t\ti = 0,\n\t\t\taup = a.parentNode,\n\t\t\tbup = b.parentNode,\n\t\t\tap = [ a ],\n\t\t\tbp = [ b ];\n\n\t\t// Parentless nodes are either documents or disconnected\n\t\tif ( !aup || !bup ) {\n\t\t\treturn a === doc ? -1 :\n\t\t\t\tb === doc ? 1 :\n\t\t\t\taup ? -1 :\n\t\t\t\tbup ? 1 :\n\t\t\t\tsortInput ?\n\t\t\t\t( indexOf( sortInput, a ) - indexOf( sortInput, b ) ) :\n\t\t\t\t0;\n\n\t\t// If the nodes are siblings, we can do a quick check\n\t\t} else if ( aup === bup ) {\n\t\t\treturn siblingCheck( a, b );\n\t\t}\n\n\t\t// Otherwise we need full lists of their ancestors for comparison\n\t\tcur = a;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tap.unshift( cur );\n\t\t}\n\t\tcur = b;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tbp.unshift( cur );\n\t\t}\n\n\t\t// Walk down the tree looking for a discrepancy\n\t\twhile ( ap[i] === bp[i] ) {\n\t\t\ti++;\n\t\t}\n\n\t\treturn i ?\n\t\t\t// Do a sibling check if the nodes have a common ancestor\n\t\t\tsiblingCheck( ap[i], bp[i] ) :\n\n\t\t\t// Otherwise nodes in our document sort first\n\t\t\tap[i] === preferredDoc ? -1 :\n\t\t\tbp[i] === preferredDoc ? 1 :\n\t\t\t0;\n\t};\n\n\treturn doc;\n};\n\nSizzle.matches = function( expr, elements ) {\n\treturn Sizzle( expr, null, null, elements );\n};\n\nSizzle.matchesSelector = function( elem, expr ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\t// Make sure that attribute selectors are quoted\n\texpr = expr.replace( rattributeQuotes, \"='$1']\" );\n\n\tif ( support.matchesSelector && documentIsHTML &&\n\t\t( !rbuggyMatches || !rbuggyMatches.test( expr ) ) &&\n\t\t( !rbuggyQSA     || !rbuggyQSA.test( expr ) ) ) {\n\n\t\ttry {\n\t\t\tvar ret = matches.call( elem, expr );\n\n\t\t\t// IE 9's matchesSelector returns false on disconnected nodes\n\t\t\tif ( ret || support.disconnectedMatch ||\n\t\t\t\t\t// As well, disconnected nodes are said to be in a document\n\t\t\t\t\t// fragment in IE 9\n\t\t\t\t\telem.document && elem.document.nodeType !== 11 ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t} catch (e) {}\n\t}\n\n\treturn Sizzle( expr, document, null, [ elem ] ).length > 0;\n};\n\nSizzle.contains = function( context, elem ) {\n\t// Set document vars if needed\n\tif ( ( context.ownerDocument || context ) !== document ) {\n\t\tsetDocument( context );\n\t}\n\treturn contains( context, elem );\n};\n\nSizzle.attr = function( elem, name ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\tvar fn = Expr.attrHandle[ name.toLowerCase() ],\n\t\t// Don't get fooled by Object.prototype properties (jQuery #13807)\n\t\tval = fn && hasOwn.call( Expr.attrHandle, name.toLowerCase() ) ?\n\t\t\tfn( elem, name, !documentIsHTML ) :\n\t\t\tundefined;\n\n\treturn val !== undefined ?\n\t\tval :\n\t\tsupport.attributes || !documentIsHTML ?\n\t\t\telem.getAttribute( name ) :\n\t\t\t(val = elem.getAttributeNode(name)) && val.specified ?\n\t\t\t\tval.value :\n\t\t\t\tnull;\n};\n\nSizzle.error = function( msg ) {\n\tthrow new Error( \"Syntax error, unrecognized expression: \" + msg );\n};\n\n/**\n * Document sorting and removing duplicates\n * @param {ArrayLike} results\n */\nSizzle.uniqueSort = function( results ) {\n\tvar elem,\n\t\tduplicates = [],\n\t\tj = 0,\n\t\ti = 0;\n\n\t// Unless we *know* we can detect duplicates, assume their presence\n\thasDuplicate = !support.detectDuplicates;\n\tsortInput = !support.sortStable && results.slice( 0 );\n\tresults.sort( sortOrder );\n\n\tif ( hasDuplicate ) {\n\t\twhile ( (elem = results[i++]) ) {\n\t\t\tif ( elem === results[ i ] ) {\n\t\t\t\tj = duplicates.push( i );\n\t\t\t}\n\t\t}\n\t\twhile ( j-- ) {\n\t\t\tresults.splice( duplicates[ j ], 1 );\n\t\t}\n\t}\n\n\t// Clear input after sorting to release objects\n\t// See https://github.com/jquery/sizzle/pull/225\n\tsortInput = null;\n\n\treturn results;\n};\n\n/**\n * Utility function for retrieving the text value of an array of DOM nodes\n * @param {Array|Element} elem\n */\ngetText = Sizzle.getText = function( elem ) {\n\tvar node,\n\t\tret = \"\",\n\t\ti = 0,\n\t\tnodeType = elem.nodeType;\n\n\tif ( !nodeType ) {\n\t\t// If no nodeType, this is expected to be an array\n\t\twhile ( (node = elem[i++]) ) {\n\t\t\t// Do not traverse comment nodes\n\t\t\tret += getText( node );\n\t\t}\n\t} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n\t\t// Use textContent for elements\n\t\t// innerText usage removed for consistency of new lines (jQuery #11153)\n\t\tif ( typeof elem.textContent === \"string\" ) {\n\t\t\treturn elem.textContent;\n\t\t} else {\n\t\t\t// Traverse its children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tret += getText( elem );\n\t\t\t}\n\t\t}\n\t} else if ( nodeType === 3 || nodeType === 4 ) {\n\t\treturn elem.nodeValue;\n\t}\n\t// Do not include comment or processing instruction nodes\n\n\treturn ret;\n};\n\nExpr = Sizzle.selectors = {\n\n\t// Can be adjusted by the user\n\tcacheLength: 50,\n\n\tcreatePseudo: markFunction,\n\n\tmatch: matchExpr,\n\n\tattrHandle: {},\n\n\tfind: {},\n\n\trelative: {\n\t\t\">\": { dir: \"parentNode\", first: true },\n\t\t\" \": { dir: \"parentNode\" },\n\t\t\"+\": { dir: \"previousSibling\", first: true },\n\t\t\"~\": { dir: \"previousSibling\" }\n\t},\n\n\tpreFilter: {\n\t\t\"ATTR\": function( match ) {\n\t\t\tmatch[1] = match[1].replace( runescape, funescape );\n\n\t\t\t// Move the given value to match[3] whether quoted or unquoted\n\t\t\tmatch[3] = ( match[3] || match[4] || match[5] || \"\" ).replace( runescape, funescape );\n\n\t\t\tif ( match[2] === \"~=\" ) {\n\t\t\t\tmatch[3] = \" \" + match[3] + \" \";\n\t\t\t}\n\n\t\t\treturn match.slice( 0, 4 );\n\t\t},\n\n\t\t\"CHILD\": function( match ) {\n\t\t\t/* matches from matchExpr[\"CHILD\"]\n\t\t\t\t1 type (only|nth|...)\n\t\t\t\t2 what (child|of-type)\n\t\t\t\t3 argument (even|odd|\\d*|\\d*n([+-]\\d+)?|...)\n\t\t\t\t4 xn-component of xn+y argument ([+-]?\\d*n|)\n\t\t\t\t5 sign of xn-component\n\t\t\t\t6 x of xn-component\n\t\t\t\t7 sign of y-component\n\t\t\t\t8 y of y-component\n\t\t\t*/\n\t\t\tmatch[1] = match[1].toLowerCase();\n\n\t\t\tif ( match[1].slice( 0, 3 ) === \"nth\" ) {\n\t\t\t\t// nth-* requires argument\n\t\t\t\tif ( !match[3] ) {\n\t\t\t\t\tSizzle.error( match[0] );\n\t\t\t\t}\n\n\t\t\t\t// numeric x and y parameters for Expr.filter.CHILD\n\t\t\t\t// remember that false/true cast respectively to 0/1\n\t\t\t\tmatch[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === \"even\" || match[3] === \"odd\" ) );\n\t\t\t\tmatch[5] = +( ( match[7] + match[8] ) || match[3] === \"odd\" );\n\n\t\t\t// other types prohibit arguments\n\t\t\t} else if ( match[3] ) {\n\t\t\t\tSizzle.error( match[0] );\n\t\t\t}\n\n\t\t\treturn match;\n\t\t},\n\n\t\t\"PSEUDO\": function( match ) {\n\t\t\tvar excess,\n\t\t\t\tunquoted = !match[6] && match[2];\n\n\t\t\tif ( matchExpr[\"CHILD\"].test( match[0] ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Accept quoted arguments as-is\n\t\t\tif ( match[3] ) {\n\t\t\t\tmatch[2] = match[4] || match[5] || \"\";\n\n\t\t\t// Strip excess characters from unquoted arguments\n\t\t\t} else if ( unquoted && rpseudo.test( unquoted ) &&\n\t\t\t\t// Get excess from tokenize (recursively)\n\t\t\t\t(excess = tokenize( unquoted, true )) &&\n\t\t\t\t// advance to the next closing parenthesis\n\t\t\t\t(excess = unquoted.indexOf( \")\", unquoted.length - excess ) - unquoted.length) ) {\n\n\t\t\t\t// excess is a negative index\n\t\t\t\tmatch[0] = match[0].slice( 0, excess );\n\t\t\t\tmatch[2] = unquoted.slice( 0, excess );\n\t\t\t}\n\n\t\t\t// Return only captures needed by the pseudo filter method (type and argument)\n\t\t\treturn match.slice( 0, 3 );\n\t\t}\n\t},\n\n\tfilter: {\n\n\t\t\"TAG\": function( nodeNameSelector ) {\n\t\t\tvar nodeName = nodeNameSelector.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn nodeNameSelector === \"*\" ?\n\t\t\t\tfunction() { return true; } :\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n\t\t\t\t};\n\t\t},\n\n\t\t\"CLASS\": function( className ) {\n\t\t\tvar pattern = classCache[ className + \" \" ];\n\n\t\t\treturn pattern ||\n\t\t\t\t(pattern = new RegExp( \"(^|\" + whitespace + \")\" + className + \"(\" + whitespace + \"|$)\" )) &&\n\t\t\t\tclassCache( className, function( elem ) {\n\t\t\t\t\treturn pattern.test( typeof elem.className === \"string\" && elem.className || typeof elem.getAttribute !== \"undefined\" && elem.getAttribute(\"class\") || \"\" );\n\t\t\t\t});\n\t\t},\n\n\t\t\"ATTR\": function( name, operator, check ) {\n\t\t\treturn function( elem ) {\n\t\t\t\tvar result = Sizzle.attr( elem, name );\n\n\t\t\t\tif ( result == null ) {\n\t\t\t\t\treturn operator === \"!=\";\n\t\t\t\t}\n\t\t\t\tif ( !operator ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tresult += \"\";\n\n\t\t\t\treturn operator === \"=\" ? result === check :\n\t\t\t\t\toperator === \"!=\" ? result !== check :\n\t\t\t\t\toperator === \"^=\" ? check && result.indexOf( check ) === 0 :\n\t\t\t\t\toperator === \"*=\" ? check && result.indexOf( check ) > -1 :\n\t\t\t\t\toperator === \"$=\" ? check && result.slice( -check.length ) === check :\n\t\t\t\t\toperator === \"~=\" ? ( \" \" + result.replace( rwhitespace, \" \" ) + \" \" ).indexOf( check ) > -1 :\n\t\t\t\t\toperator === \"|=\" ? result === check || result.slice( 0, check.length + 1 ) === check + \"-\" :\n\t\t\t\t\tfalse;\n\t\t\t};\n\t\t},\n\n\t\t\"CHILD\": function( type, what, argument, first, last ) {\n\t\t\tvar simple = type.slice( 0, 3 ) !== \"nth\",\n\t\t\t\tforward = type.slice( -4 ) !== \"last\",\n\t\t\t\tofType = what === \"of-type\";\n\n\t\t\treturn first === 1 && last === 0 ?\n\n\t\t\t\t// Shortcut for :nth-*(n)\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn !!elem.parentNode;\n\t\t\t\t} :\n\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tvar cache, outerCache, node, diff, nodeIndex, start,\n\t\t\t\t\t\tdir = simple !== forward ? \"nextSibling\" : \"previousSibling\",\n\t\t\t\t\t\tparent = elem.parentNode,\n\t\t\t\t\t\tname = ofType && elem.nodeName.toLowerCase(),\n\t\t\t\t\t\tuseCache = !xml && !ofType;\n\n\t\t\t\t\tif ( parent ) {\n\n\t\t\t\t\t\t// :(first|last|only)-(child|of-type)\n\t\t\t\t\t\tif ( simple ) {\n\t\t\t\t\t\t\twhile ( dir ) {\n\t\t\t\t\t\t\t\tnode = elem;\n\t\t\t\t\t\t\t\twhile ( (node = node[ dir ]) ) {\n\t\t\t\t\t\t\t\t\tif ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Reverse direction for :only-* (if we haven't yet done so)\n\t\t\t\t\t\t\t\tstart = dir = type === \"only\" && !start && \"nextSibling\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstart = [ forward ? parent.firstChild : parent.lastChild ];\n\n\t\t\t\t\t\t// non-xml :nth-child(...) stores cache data on `parent`\n\t\t\t\t\t\tif ( forward && useCache ) {\n\t\t\t\t\t\t\t// Seek `elem` from a previously-cached index\n\t\t\t\t\t\t\touterCache = parent[ expando ] || (parent[ expando ] = {});\n\t\t\t\t\t\t\tcache = outerCache[ type ] || [];\n\t\t\t\t\t\t\tnodeIndex = cache[0] === dirruns && cache[1];\n\t\t\t\t\t\t\tdiff = cache[0] === dirruns && cache[2];\n\t\t\t\t\t\t\tnode = nodeIndex && parent.childNodes[ nodeIndex ];\n\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\n\t\t\t\t\t\t\t\t// Fallback to seeking `elem` from the start\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\t// When found, cache indexes on `parent` and break\n\t\t\t\t\t\t\t\tif ( node.nodeType === 1 && ++diff && node === elem ) {\n\t\t\t\t\t\t\t\t\touterCache[ type ] = [ dirruns, nodeIndex, diff ];\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Use previously-cached element index if available\n\t\t\t\t\t\t} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {\n\t\t\t\t\t\t\tdiff = cache[1];\n\n\t\t\t\t\t\t// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Use the same loop as above to seek `elem` from the start\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\tif ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {\n\t\t\t\t\t\t\t\t\t// Cache the index of each encountered element\n\t\t\t\t\t\t\t\t\tif ( useCache ) {\n\t\t\t\t\t\t\t\t\t\t(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif ( node === elem ) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Incorporate the offset, then check against cycle size\n\t\t\t\t\t\tdiff -= last;\n\t\t\t\t\t\treturn diff === first || ( diff % first === 0 && diff / first >= 0 );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t},\n\n\t\t\"PSEUDO\": function( pseudo, argument ) {\n\t\t\t// pseudo-class names are case-insensitive\n\t\t\t// http://www.w3.org/TR/selectors/#pseudo-classes\n\t\t\t// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters\n\t\t\t// Remember that setFilters inherits from pseudos\n\t\t\tvar args,\n\t\t\t\tfn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||\n\t\t\t\t\tSizzle.error( \"unsupported pseudo: \" + pseudo );\n\n\t\t\t// The user may use createPseudo to indicate that\n\t\t\t// arguments are needed to create the filter function\n\t\t\t// just as Sizzle does\n\t\t\tif ( fn[ expando ] ) {\n\t\t\t\treturn fn( argument );\n\t\t\t}\n\n\t\t\t// But maintain support for old signatures\n\t\t\tif ( fn.length > 1 ) {\n\t\t\t\targs = [ pseudo, pseudo, \"\", argument ];\n\t\t\t\treturn Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?\n\t\t\t\t\tmarkFunction(function( seed, matches ) {\n\t\t\t\t\t\tvar idx,\n\t\t\t\t\t\t\tmatched = fn( seed, argument ),\n\t\t\t\t\t\t\ti = matched.length;\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tidx = indexOf( seed, matched[i] );\n\t\t\t\t\t\t\tseed[ idx ] = !( matches[ idx ] = matched[i] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}) :\n\t\t\t\t\tfunction( elem ) {\n\t\t\t\t\t\treturn fn( elem, 0, args );\n\t\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn fn;\n\t\t}\n\t},\n\n\tpseudos: {\n\t\t// Potentially complex pseudos\n\t\t\"not\": markFunction(function( selector ) {\n\t\t\t// Trim the selector passed to compile\n\t\t\t// to avoid treating leading and trailing\n\t\t\t// spaces as combinators\n\t\t\tvar input = [],\n\t\t\t\tresults = [],\n\t\t\t\tmatcher = compile( selector.replace( rtrim, \"$1\" ) );\n\n\t\t\treturn matcher[ expando ] ?\n\t\t\t\tmarkFunction(function( seed, matches, context, xml ) {\n\t\t\t\t\tvar elem,\n\t\t\t\t\t\tunmatched = matcher( seed, null, xml, [] ),\n\t\t\t\t\t\ti = seed.length;\n\n\t\t\t\t\t// Match elements unmatched by `matcher`\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = unmatched[i]) ) {\n\t\t\t\t\t\t\tseed[i] = !(matches[i] = elem);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}) :\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tinput[0] = elem;\n\t\t\t\t\tmatcher( input, null, xml, results );\n\t\t\t\t\t// Don't keep the element (issue #299)\n\t\t\t\t\tinput[0] = null;\n\t\t\t\t\treturn !results.pop();\n\t\t\t\t};\n\t\t}),\n\n\t\t\"has\": markFunction(function( selector ) {\n\t\t\treturn function( elem ) {\n\t\t\t\treturn Sizzle( selector, elem ).length > 0;\n\t\t\t};\n\t\t}),\n\n\t\t\"contains\": markFunction(function( text ) {\n\t\t\ttext = text.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;\n\t\t\t};\n\t\t}),\n\n\t\t// \"Whether an element is represented by a :lang() selector\n\t\t// is based solely on the element's language value\n\t\t// being equal to the identifier C,\n\t\t// or beginning with the identifier C immediately followed by \"-\".\n\t\t// The matching of C against the element's language value is performed case-insensitively.\n\t\t// The identifier C does not have to be a valid language name.\"\n\t\t// http://www.w3.org/TR/selectors/#lang-pseudo\n\t\t\"lang\": markFunction( function( lang ) {\n\t\t\t// lang value must be a valid identifier\n\t\t\tif ( !ridentifier.test(lang || \"\") ) {\n\t\t\t\tSizzle.error( \"unsupported lang: \" + lang );\n\t\t\t}\n\t\t\tlang = lang.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn function( elem ) {\n\t\t\t\tvar elemLang;\n\t\t\t\tdo {\n\t\t\t\t\tif ( (elemLang = documentIsHTML ?\n\t\t\t\t\t\telem.lang :\n\t\t\t\t\t\telem.getAttribute(\"xml:lang\") || elem.getAttribute(\"lang\")) ) {\n\n\t\t\t\t\t\telemLang = elemLang.toLowerCase();\n\t\t\t\t\t\treturn elemLang === lang || elemLang.indexOf( lang + \"-\" ) === 0;\n\t\t\t\t\t}\n\t\t\t\t} while ( (elem = elem.parentNode) && elem.nodeType === 1 );\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}),\n\n\t\t// Miscellaneous\n\t\t\"target\": function( elem ) {\n\t\t\tvar hash = window.location && window.location.hash;\n\t\t\treturn hash && hash.slice( 1 ) === elem.id;\n\t\t},\n\n\t\t\"root\": function( elem ) {\n\t\t\treturn elem === docElem;\n\t\t},\n\n\t\t\"focus\": function( elem ) {\n\t\t\treturn elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n\t\t},\n\n\t\t// Boolean properties\n\t\t\"enabled\": function( elem ) {\n\t\t\treturn elem.disabled === false;\n\t\t},\n\n\t\t\"disabled\": function( elem ) {\n\t\t\treturn elem.disabled === true;\n\t\t},\n\n\t\t\"checked\": function( elem ) {\n\t\t\t// In CSS3, :checked should return both checked and selected elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\tvar nodeName = elem.nodeName.toLowerCase();\n\t\t\treturn (nodeName === \"input\" && !!elem.checked) || (nodeName === \"option\" && !!elem.selected);\n\t\t},\n\n\t\t\"selected\": function( elem ) {\n\t\t\t// Accessing this property makes selected-by-default\n\t\t\t// options in Safari work properly\n\t\t\tif ( elem.parentNode ) {\n\t\t\t\telem.parentNode.selectedIndex;\n\t\t\t}\n\n\t\t\treturn elem.selected === true;\n\t\t},\n\n\t\t// Contents\n\t\t\"empty\": function( elem ) {\n\t\t\t// http://www.w3.org/TR/selectors/#empty-pseudo\n\t\t\t// :empty is negated by element (1) or content nodes (text: 3; cdata: 4; entity ref: 5),\n\t\t\t//   but not by others (comment: 8; processing instruction: 7; etc.)\n\t\t\t// nodeType < 6 works because attributes (2) do not appear as children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tif ( elem.nodeType < 6 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t\"parent\": function( elem ) {\n\t\t\treturn !Expr.pseudos[\"empty\"]( elem );\n\t\t},\n\n\t\t// Element/input types\n\t\t\"header\": function( elem ) {\n\t\t\treturn rheader.test( elem.nodeName );\n\t\t},\n\n\t\t\"input\": function( elem ) {\n\t\t\treturn rinputs.test( elem.nodeName );\n\t\t},\n\n\t\t\"button\": function( elem ) {\n\t\t\tvar name = elem.nodeName.toLowerCase();\n\t\t\treturn name === \"input\" && elem.type === \"button\" || name === \"button\";\n\t\t},\n\n\t\t\"text\": function( elem ) {\n\t\t\tvar attr;\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" &&\n\t\t\t\telem.type === \"text\" &&\n\n\t\t\t\t// Support: IE<8\n\t\t\t\t// New HTML5 attribute values (e.g., \"search\") appear with elem.type === \"text\"\n\t\t\t\t( (attr = elem.getAttribute(\"type\")) == null || attr.toLowerCase() === \"text\" );\n\t\t},\n\n\t\t// Position-in-collection\n\t\t\"first\": createPositionalPseudo(function() {\n\t\t\treturn [ 0 ];\n\t\t}),\n\n\t\t\"last\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\treturn [ length - 1 ];\n\t\t}),\n\n\t\t\"eq\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\treturn [ argument < 0 ? argument + length : argument ];\n\t\t}),\n\n\t\t\"even\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 0;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"odd\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 1;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"lt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; --i >= 0; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"gt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; ++i < length; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t})\n\t}\n};\n\nExpr.pseudos[\"nth\"] = Expr.pseudos[\"eq\"];\n\n// Add button/input type pseudos\nfor ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {\n\tExpr.pseudos[ i ] = createInputPseudo( i );\n}\nfor ( i in { submit: true, reset: true } ) {\n\tExpr.pseudos[ i ] = createButtonPseudo( i );\n}\n\n// Easy API for creating new setFilters\nfunction setFilters() {}\nsetFilters.prototype = Expr.filters = Expr.pseudos;\nExpr.setFilters = new setFilters();\n\ntokenize = Sizzle.tokenize = function( selector, parseOnly ) {\n\tvar matched, match, tokens, type,\n\t\tsoFar, groups, preFilters,\n\t\tcached = tokenCache[ selector + \" \" ];\n\n\tif ( cached ) {\n\t\treturn parseOnly ? 0 : cached.slice( 0 );\n\t}\n\n\tsoFar = selector;\n\tgroups = [];\n\tpreFilters = Expr.preFilter;\n\n\twhile ( soFar ) {\n\n\t\t// Comma and first run\n\t\tif ( !matched || (match = rcomma.exec( soFar )) ) {\n\t\t\tif ( match ) {\n\t\t\t\t// Don't consume trailing commas as valid\n\t\t\t\tsoFar = soFar.slice( match[0].length ) || soFar;\n\t\t\t}\n\t\t\tgroups.push( (tokens = []) );\n\t\t}\n\n\t\tmatched = false;\n\n\t\t// Combinators\n\t\tif ( (match = rcombinators.exec( soFar )) ) {\n\t\t\tmatched = match.shift();\n\t\t\ttokens.push({\n\t\t\t\tvalue: matched,\n\t\t\t\t// Cast descendant combinators to space\n\t\t\t\ttype: match[0].replace( rtrim, \" \" )\n\t\t\t});\n\t\t\tsoFar = soFar.slice( matched.length );\n\t\t}\n\n\t\t// Filters\n\t\tfor ( type in Expr.filter ) {\n\t\t\tif ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||\n\t\t\t\t(match = preFilters[ type ]( match ))) ) {\n\t\t\t\tmatched = match.shift();\n\t\t\t\ttokens.push({\n\t\t\t\t\tvalue: matched,\n\t\t\t\t\ttype: type,\n\t\t\t\t\tmatches: match\n\t\t\t\t});\n\t\t\t\tsoFar = soFar.slice( matched.length );\n\t\t\t}\n\t\t}\n\n\t\tif ( !matched ) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Return the length of the invalid excess\n\t// if we're just parsing\n\t// Otherwise, throw an error or return tokens\n\treturn parseOnly ?\n\t\tsoFar.length :\n\t\tsoFar ?\n\t\t\tSizzle.error( selector ) :\n\t\t\t// Cache the tokens\n\t\t\ttokenCache( selector, groups ).slice( 0 );\n};\n\nfunction toSelector( tokens ) {\n\tvar i = 0,\n\t\tlen = tokens.length,\n\t\tselector = \"\";\n\tfor ( ; i < len; i++ ) {\n\t\tselector += tokens[i].value;\n\t}\n\treturn selector;\n}\n\nfunction addCombinator( matcher, combinator, base ) {\n\tvar dir = combinator.dir,\n\t\tcheckNonElements = base && dir === \"parentNode\",\n\t\tdoneName = done++;\n\n\treturn combinator.first ?\n\t\t// Check against closest ancestor/preceding element\n\t\tfunction( elem, context, xml ) {\n\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\treturn matcher( elem, context, xml );\n\t\t\t\t}\n\t\t\t}\n\t\t} :\n\n\t\t// Check against all ancestor/preceding elements\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar oldCache, outerCache,\n\t\t\t\tnewCache = [ dirruns, doneName ];\n\n\t\t\t// We can't set arbitrary data on XML nodes, so they don't benefit from dir caching\n\t\t\tif ( xml ) {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\touterCache = elem[ expando ] || (elem[ expando ] = {});\n\t\t\t\t\t\tif ( (oldCache = outerCache[ dir ]) &&\n\t\t\t\t\t\t\toldCache[ 0 ] === dirruns && oldCache[ 1 ] === doneName ) {\n\n\t\t\t\t\t\t\t// Assign to newCache so results back-propagate to previous elements\n\t\t\t\t\t\t\treturn (newCache[ 2 ] = oldCache[ 2 ]);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Reuse newcache so results back-propagate to previous elements\n\t\t\t\t\t\t\touterCache[ dir ] = newCache;\n\n\t\t\t\t\t\t\t// A match means we're done; a fail means we have to keep checking\n\t\t\t\t\t\t\tif ( (newCache[ 2 ] = matcher( elem, context, xml )) ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n}\n\nfunction elementMatcher( matchers ) {\n\treturn matchers.length > 1 ?\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar i = matchers.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( !matchers[i]( elem, context, xml ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t} :\n\t\tmatchers[0];\n}\n\nfunction multipleContexts( selector, contexts, results ) {\n\tvar i = 0,\n\t\tlen = contexts.length;\n\tfor ( ; i < len; i++ ) {\n\t\tSizzle( selector, contexts[i], results );\n\t}\n\treturn results;\n}\n\nfunction condense( unmatched, map, filter, context, xml ) {\n\tvar elem,\n\t\tnewUnmatched = [],\n\t\ti = 0,\n\t\tlen = unmatched.length,\n\t\tmapped = map != null;\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (elem = unmatched[i]) ) {\n\t\t\tif ( !filter || filter( elem, context, xml ) ) {\n\t\t\t\tnewUnmatched.push( elem );\n\t\t\t\tif ( mapped ) {\n\t\t\t\t\tmap.push( i );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn newUnmatched;\n}\n\nfunction setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {\n\tif ( postFilter && !postFilter[ expando ] ) {\n\t\tpostFilter = setMatcher( postFilter );\n\t}\n\tif ( postFinder && !postFinder[ expando ] ) {\n\t\tpostFinder = setMatcher( postFinder, postSelector );\n\t}\n\treturn markFunction(function( seed, results, context, xml ) {\n\t\tvar temp, i, elem,\n\t\t\tpreMap = [],\n\t\t\tpostMap = [],\n\t\t\tpreexisting = results.length,\n\n\t\t\t// Get initial elements from seed or context\n\t\t\telems = seed || multipleContexts( selector || \"*\", context.nodeType ? [ context ] : context, [] ),\n\n\t\t\t// Prefilter to get matcher input, preserving a map for seed-results synchronization\n\t\t\tmatcherIn = preFilter && ( seed || !selector ) ?\n\t\t\t\tcondense( elems, preMap, preFilter, context, xml ) :\n\t\t\t\telems,\n\n\t\t\tmatcherOut = matcher ?\n\t\t\t\t// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,\n\t\t\t\tpostFinder || ( seed ? preFilter : preexisting || postFilter ) ?\n\n\t\t\t\t\t// ...intermediate processing is necessary\n\t\t\t\t\t[] :\n\n\t\t\t\t\t// ...otherwise use results directly\n\t\t\t\t\tresults :\n\t\t\t\tmatcherIn;\n\n\t\t// Find primary matches\n\t\tif ( matcher ) {\n\t\t\tmatcher( matcherIn, matcherOut, context, xml );\n\t\t}\n\n\t\t// Apply postFilter\n\t\tif ( postFilter ) {\n\t\t\ttemp = condense( matcherOut, postMap );\n\t\t\tpostFilter( temp, [], context, xml );\n\n\t\t\t// Un-match failing elements by moving them back to matcherIn\n\t\t\ti = temp.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( (elem = temp[i]) ) {\n\t\t\t\t\tmatcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( seed ) {\n\t\t\tif ( postFinder || preFilter ) {\n\t\t\t\tif ( postFinder ) {\n\t\t\t\t\t// Get the final matcherOut by condensing this intermediate into postFinder contexts\n\t\t\t\t\ttemp = [];\n\t\t\t\t\ti = matcherOut.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = matcherOut[i]) ) {\n\t\t\t\t\t\t\t// Restore matcherIn since elem is not yet a final match\n\t\t\t\t\t\t\ttemp.push( (matcherIn[i] = elem) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tpostFinder( null, (matcherOut = []), temp, xml );\n\t\t\t\t}\n\n\t\t\t\t// Move matched elements from seed to results to keep them synchronized\n\t\t\t\ti = matcherOut.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( (elem = matcherOut[i]) &&\n\t\t\t\t\t\t(temp = postFinder ? indexOf( seed, elem ) : preMap[i]) > -1 ) {\n\n\t\t\t\t\t\tseed[temp] = !(results[temp] = elem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Add elements to results, through postFinder if defined\n\t\t} else {\n\t\t\tmatcherOut = condense(\n\t\t\t\tmatcherOut === results ?\n\t\t\t\t\tmatcherOut.splice( preexisting, matcherOut.length ) :\n\t\t\t\t\tmatcherOut\n\t\t\t);\n\t\t\tif ( postFinder ) {\n\t\t\t\tpostFinder( null, results, matcherOut, xml );\n\t\t\t} else {\n\t\t\t\tpush.apply( results, matcherOut );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction matcherFromTokens( tokens ) {\n\tvar checkContext, matcher, j,\n\t\tlen = tokens.length,\n\t\tleadingRelative = Expr.relative[ tokens[0].type ],\n\t\timplicitRelative = leadingRelative || Expr.relative[\" \"],\n\t\ti = leadingRelative ? 1 : 0,\n\n\t\t// The foundational matcher ensures that elements are reachable from top-level context(s)\n\t\tmatchContext = addCombinator( function( elem ) {\n\t\t\treturn elem === checkContext;\n\t\t}, implicitRelative, true ),\n\t\tmatchAnyContext = addCombinator( function( elem ) {\n\t\t\treturn indexOf( checkContext, elem ) > -1;\n\t\t}, implicitRelative, true ),\n\t\tmatchers = [ function( elem, context, xml ) {\n\t\t\tvar ret = ( !leadingRelative && ( xml || context !== outermostContext ) ) || (\n\t\t\t\t(checkContext = context).nodeType ?\n\t\t\t\t\tmatchContext( elem, context, xml ) :\n\t\t\t\t\tmatchAnyContext( elem, context, xml ) );\n\t\t\t// Avoid hanging onto element (issue #299)\n\t\t\tcheckContext = null;\n\t\t\treturn ret;\n\t\t} ];\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (matcher = Expr.relative[ tokens[i].type ]) ) {\n\t\t\tmatchers = [ addCombinator(elementMatcher( matchers ), matcher) ];\n\t\t} else {\n\t\t\tmatcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );\n\n\t\t\t// Return special upon seeing a positional matcher\n\t\t\tif ( matcher[ expando ] ) {\n\t\t\t\t// Find the next relative operator (if any) for proper handling\n\t\t\t\tj = ++i;\n\t\t\t\tfor ( ; j < len; j++ ) {\n\t\t\t\t\tif ( Expr.relative[ tokens[j].type ] ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn setMatcher(\n\t\t\t\t\ti > 1 && elementMatcher( matchers ),\n\t\t\t\t\ti > 1 && toSelector(\n\t\t\t\t\t\t// If the preceding token was a descendant combinator, insert an implicit any-element `*`\n\t\t\t\t\t\ttokens.slice( 0, i - 1 ).concat({ value: tokens[ i - 2 ].type === \" \" ? \"*\" : \"\" })\n\t\t\t\t\t).replace( rtrim, \"$1\" ),\n\t\t\t\t\tmatcher,\n\t\t\t\t\ti < j && matcherFromTokens( tokens.slice( i, j ) ),\n\t\t\t\t\tj < len && matcherFromTokens( (tokens = tokens.slice( j )) ),\n\t\t\t\t\tj < len && toSelector( tokens )\n\t\t\t\t);\n\t\t\t}\n\t\t\tmatchers.push( matcher );\n\t\t}\n\t}\n\n\treturn elementMatcher( matchers );\n}\n\nfunction matcherFromGroupMatchers( elementMatchers, setMatchers ) {\n\tvar bySet = setMatchers.length > 0,\n\t\tbyElement = elementMatchers.length > 0,\n\t\tsuperMatcher = function( seed, context, xml, results, outermost ) {\n\t\t\tvar elem, j, matcher,\n\t\t\t\tmatchedCount = 0,\n\t\t\t\ti = \"0\",\n\t\t\t\tunmatched = seed && [],\n\t\t\t\tsetMatched = [],\n\t\t\t\tcontextBackup = outermostContext,\n\t\t\t\t// We must always have either seed elements or outermost context\n\t\t\t\telems = seed || byElement && Expr.find[\"TAG\"]( \"*\", outermost ),\n\t\t\t\t// Use integer dirruns iff this is the outermost matcher\n\t\t\t\tdirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1),\n\t\t\t\tlen = elems.length;\n\n\t\t\tif ( outermost ) {\n\t\t\t\toutermostContext = context !== document && context;\n\t\t\t}\n\n\t\t\t// Add elements passing elementMatchers directly to results\n\t\t\t// Keep `i` a string if there are no elements so `matchedCount` will be \"00\" below\n\t\t\t// Support: IE<9, Safari\n\t\t\t// Tolerate NodeList properties (IE: \"length\"; Safari: <number>) matching elements by id\n\t\t\tfor ( ; i !== len && (elem = elems[i]) != null; i++ ) {\n\t\t\t\tif ( byElement && elem ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( (matcher = elementMatchers[j++]) ) {\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( outermost ) {\n\t\t\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Track unmatched elements for set filters\n\t\t\t\tif ( bySet ) {\n\t\t\t\t\t// They will have gone through all possible matchers\n\t\t\t\t\tif ( (elem = !matcher && elem) ) {\n\t\t\t\t\t\tmatchedCount--;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Lengthen the array for every element, matched or not\n\t\t\t\t\tif ( seed ) {\n\t\t\t\t\t\tunmatched.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Apply set filters to unmatched elements\n\t\t\tmatchedCount += i;\n\t\t\tif ( bySet && i !== matchedCount ) {\n\t\t\t\tj = 0;\n\t\t\t\twhile ( (matcher = setMatchers[j++]) ) {\n\t\t\t\t\tmatcher( unmatched, setMatched, context, xml );\n\t\t\t\t}\n\n\t\t\t\tif ( seed ) {\n\t\t\t\t\t// Reintegrate element matches to eliminate the need for sorting\n\t\t\t\t\tif ( matchedCount > 0 ) {\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tif ( !(unmatched[i] || setMatched[i]) ) {\n\t\t\t\t\t\t\t\tsetMatched[i] = pop.call( results );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Discard index placeholder values to get only actual matches\n\t\t\t\t\tsetMatched = condense( setMatched );\n\t\t\t\t}\n\n\t\t\t\t// Add matches to results\n\t\t\t\tpush.apply( results, setMatched );\n\n\t\t\t\t// Seedless set matches succeeding multiple successful matchers stipulate sorting\n\t\t\t\tif ( outermost && !seed && setMatched.length > 0 &&\n\t\t\t\t\t( matchedCount + setMatchers.length ) > 1 ) {\n\n\t\t\t\t\tSizzle.uniqueSort( results );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Override manipulation of globals by nested matchers\n\t\t\tif ( outermost ) {\n\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\toutermostContext = contextBackup;\n\t\t\t}\n\n\t\t\treturn unmatched;\n\t\t};\n\n\treturn bySet ?\n\t\tmarkFunction( superMatcher ) :\n\t\tsuperMatcher;\n}\n\ncompile = Sizzle.compile = function( selector, match /* Internal Use Only */ ) {\n\tvar i,\n\t\tsetMatchers = [],\n\t\telementMatchers = [],\n\t\tcached = compilerCache[ selector + \" \" ];\n\n\tif ( !cached ) {\n\t\t// Generate a function of recursive functions that can be used to check each element\n\t\tif ( !match ) {\n\t\t\tmatch = tokenize( selector );\n\t\t}\n\t\ti = match.length;\n\t\twhile ( i-- ) {\n\t\t\tcached = matcherFromTokens( match[i] );\n\t\t\tif ( cached[ expando ] ) {\n\t\t\t\tsetMatchers.push( cached );\n\t\t\t} else {\n\t\t\t\telementMatchers.push( cached );\n\t\t\t}\n\t\t}\n\n\t\t// Cache the compiled function\n\t\tcached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );\n\n\t\t// Save selector and tokenization\n\t\tcached.selector = selector;\n\t}\n\treturn cached;\n};\n\n/**\n * A low-level selection function that works with Sizzle's compiled\n *  selector functions\n * @param {String|Function} selector A selector or a pre-compiled\n *  selector function built with Sizzle.compile\n * @param {Element} context\n * @param {Array} [results]\n * @param {Array} [seed] A set of elements to match against\n */\nselect = Sizzle.select = function( selector, context, results, seed ) {\n\tvar i, tokens, token, type, find,\n\t\tcompiled = typeof selector === \"function\" && selector,\n\t\tmatch = !seed && tokenize( (selector = compiled.selector || selector) );\n\n\tresults = results || [];\n\n\t// Try to minimize operations if there is no seed and only one group\n\tif ( match.length === 1 ) {\n\n\t\t// Take a shortcut and set the context if the root selector is an ID\n\t\ttokens = match[0] = match[0].slice( 0 );\n\t\tif ( tokens.length > 2 && (token = tokens[0]).type === \"ID\" &&\n\t\t\t\tsupport.getById && context.nodeType === 9 && documentIsHTML &&\n\t\t\t\tExpr.relative[ tokens[1].type ] ) {\n\n\t\t\tcontext = ( Expr.find[\"ID\"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];\n\t\t\tif ( !context ) {\n\t\t\t\treturn results;\n\n\t\t\t// Precompiled matchers will still verify ancestry, so step up a level\n\t\t\t} else if ( compiled ) {\n\t\t\t\tcontext = context.parentNode;\n\t\t\t}\n\n\t\t\tselector = selector.slice( tokens.shift().value.length );\n\t\t}\n\n\t\t// Fetch a seed set for right-to-left matching\n\t\ti = matchExpr[\"needsContext\"].test( selector ) ? 0 : tokens.length;\n\t\twhile ( i-- ) {\n\t\t\ttoken = tokens[i];\n\n\t\t\t// Abort if we hit a combinator\n\t\t\tif ( Expr.relative[ (type = token.type) ] ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( (find = Expr.find[ type ]) ) {\n\t\t\t\t// Search, expanding context for leading sibling combinators\n\t\t\t\tif ( (seed = find(\n\t\t\t\t\ttoken.matches[0].replace( runescape, funescape ),\n\t\t\t\t\trsibling.test( tokens[0].type ) && testContext( context.parentNode ) || context\n\t\t\t\t)) ) {\n\n\t\t\t\t\t// If seed is empty or no tokens remain, we can return early\n\t\t\t\t\ttokens.splice( i, 1 );\n\t\t\t\t\tselector = seed.length && toSelector( tokens );\n\t\t\t\t\tif ( !selector ) {\n\t\t\t\t\t\tpush.apply( results, seed );\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Compile and execute a filtering function if one is not provided\n\t// Provide `match` to avoid retokenization if we modified the selector above\n\t( compiled || compile( selector, match ) )(\n\t\tseed,\n\t\tcontext,\n\t\t!documentIsHTML,\n\t\tresults,\n\t\trsibling.test( selector ) && testContext( context.parentNode ) || context\n\t);\n\treturn results;\n};\n\n// One-time assignments\n\n// Sort stability\nsupport.sortStable = expando.split(\"\").sort( sortOrder ).join(\"\") === expando;\n\n// Support: Chrome 14-35+\n// Always assume duplicates if they aren't passed to the comparison function\nsupport.detectDuplicates = !!hasDuplicate;\n\n// Initialize against the default document\nsetDocument();\n\n// Support: Webkit<537.32 - Safari 6.0.3/Chrome 25 (fixed in Chrome 27)\n// Detached nodes confoundingly follow *each other*\nsupport.sortDetached = assert(function( div1 ) {\n\t// Should return 1, but returns 4 (following)\n\treturn div1.compareDocumentPosition( document.createElement(\"div\") ) & 1;\n});\n\n// Support: IE<8\n// Prevent attribute/property \"interpolation\"\n// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\nif ( !assert(function( div ) {\n\tdiv.innerHTML = \"<a href='#'></a>\";\n\treturn div.firstChild.getAttribute(\"href\") === \"#\" ;\n}) ) {\n\taddHandle( \"type|href|height|width\", function( elem, name, isXML ) {\n\t\tif ( !isXML ) {\n\t\t\treturn elem.getAttribute( name, name.toLowerCase() === \"type\" ? 1 : 2 );\n\t\t}\n\t});\n}\n\n// Support: IE<9\n// Use defaultValue in place of getAttribute(\"value\")\nif ( !support.attributes || !assert(function( div ) {\n\tdiv.innerHTML = \"<input/>\";\n\tdiv.firstChild.setAttribute( \"value\", \"\" );\n\treturn div.firstChild.getAttribute( \"value\" ) === \"\";\n}) ) {\n\taddHandle( \"value\", function( elem, name, isXML ) {\n\t\tif ( !isXML && elem.nodeName.toLowerCase() === \"input\" ) {\n\t\t\treturn elem.defaultValue;\n\t\t}\n\t});\n}\n\n// Support: IE<9\n// Use getAttributeNode to fetch booleans when getAttribute lies\nif ( !assert(function( div ) {\n\treturn div.getAttribute(\"disabled\") == null;\n}) ) {\n\taddHandle( booleans, function( elem, name, isXML ) {\n\t\tvar val;\n\t\tif ( !isXML ) {\n\t\t\treturn elem[ name ] === true ? name.toLowerCase() :\n\t\t\t\t\t(val = elem.getAttributeNode( name )) && val.specified ?\n\t\t\t\t\tval.value :\n\t\t\t\tnull;\n\t\t}\n\t});\n}\n\nreturn Sizzle;\n\n})( window );\n\n\n\njQuery.find = Sizzle;\njQuery.expr = Sizzle.selectors;\njQuery.expr[\":\"] = jQuery.expr.pseudos;\njQuery.unique = Sizzle.uniqueSort;\njQuery.text = Sizzle.getText;\njQuery.isXMLDoc = Sizzle.isXML;\njQuery.contains = Sizzle.contains;\n\n\n\nvar rneedsContext = jQuery.expr.match.needsContext;\n\nvar rsingleTag = (/^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/);\n\n\n\nvar risSimple = /^.[^:#\\[\\.,]*$/;\n\n// Implement the identical functionality for filter and not\nfunction winnow( elements, qualifier, not ) {\n\tif ( jQuery.isFunction( qualifier ) ) {\n\t\treturn jQuery.grep( elements, function( elem, i ) {\n\t\t\t/* jshint -W018 */\n\t\t\treturn !!qualifier.call( elem, i, elem ) !== not;\n\t\t});\n\n\t}\n\n\tif ( qualifier.nodeType ) {\n\t\treturn jQuery.grep( elements, function( elem ) {\n\t\t\treturn ( elem === qualifier ) !== not;\n\t\t});\n\n\t}\n\n\tif ( typeof qualifier === \"string\" ) {\n\t\tif ( risSimple.test( qualifier ) ) {\n\t\t\treturn jQuery.filter( qualifier, elements, not );\n\t\t}\n\n\t\tqualifier = jQuery.filter( qualifier, elements );\n\t}\n\n\treturn jQuery.grep( elements, function( elem ) {\n\t\treturn ( jQuery.inArray( elem, qualifier ) >= 0 ) !== not;\n\t});\n}\n\njQuery.filter = function( expr, elems, not ) {\n\tvar elem = elems[ 0 ];\n\n\tif ( not ) {\n\t\texpr = \":not(\" + expr + \")\";\n\t}\n\n\treturn elems.length === 1 && elem.nodeType === 1 ?\n\t\tjQuery.find.matchesSelector( elem, expr ) ? [ elem ] : [] :\n\t\tjQuery.find.matches( expr, jQuery.grep( elems, function( elem ) {\n\t\t\treturn elem.nodeType === 1;\n\t\t}));\n};\n\njQuery.fn.extend({\n\tfind: function( selector ) {\n\t\tvar i,\n\t\t\tret = [],\n\t\t\tself = this,\n\t\t\tlen = self.length;\n\n\t\tif ( typeof selector !== \"string\" ) {\n\t\t\treturn this.pushStack( jQuery( selector ).filter(function() {\n\t\t\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\t\t\tif ( jQuery.contains( self[ i ], this ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}) );\n\t\t}\n\n\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\tjQuery.find( selector, self[ i ], ret );\n\t\t}\n\n\t\t// Needed because $( selector, context ) becomes $( context ).find( selector )\n\t\tret = this.pushStack( len > 1 ? jQuery.unique( ret ) : ret );\n\t\tret.selector = this.selector ? this.selector + \" \" + selector : selector;\n\t\treturn ret;\n\t},\n\tfilter: function( selector ) {\n\t\treturn this.pushStack( winnow(this, selector || [], false) );\n\t},\n\tnot: function( selector ) {\n\t\treturn this.pushStack( winnow(this, selector || [], true) );\n\t},\n\tis: function( selector ) {\n\t\treturn !!winnow(\n\t\t\tthis,\n\n\t\t\t// If this is a positional/relative selector, check membership in the returned set\n\t\t\t// so $(\"p:first\").is(\"p:last\") won't return true for a doc with two \"p\".\n\t\t\ttypeof selector === \"string\" && rneedsContext.test( selector ) ?\n\t\t\t\tjQuery( selector ) :\n\t\t\t\tselector || [],\n\t\t\tfalse\n\t\t).length;\n\t}\n});\n\n\n// Initialize a jQuery object\n\n\n// A central reference to the root jQuery(document)\nvar rootjQuery,\n\n\t// Use the correct document accordingly with window argument (sandbox)\n\tdocument = window.document,\n\n\t// A simple way to check for HTML strings\n\t// Prioritize #id over <tag> to avoid XSS via location.hash (#9521)\n\t// Strict HTML recognition (#11290: must start with <)\n\trquickExpr = /^(?:\\s*(<[\\w\\W]+>)[^>]*|#([\\w-]*))$/,\n\n\tinit = jQuery.fn.init = function( selector, context ) {\n\t\tvar match, elem;\n\n\t\t// HANDLE: $(\"\"), $(null), $(undefined), $(false)\n\t\tif ( !selector ) {\n\t\t\treturn this;\n\t\t}\n\n\t\t// Handle HTML strings\n\t\tif ( typeof selector === \"string\" ) {\n\t\t\tif ( selector.charAt(0) === \"<\" && selector.charAt( selector.length - 1 ) === \">\" && selector.length >= 3 ) {\n\t\t\t\t// Assume that strings that start and end with <> are HTML and skip the regex check\n\t\t\t\tmatch = [ null, selector, null ];\n\n\t\t\t} else {\n\t\t\t\tmatch = rquickExpr.exec( selector );\n\t\t\t}\n\n\t\t\t// Match html or make sure no context is specified for #id\n\t\t\tif ( match && (match[1] || !context) ) {\n\n\t\t\t\t// HANDLE: $(html) -> $(array)\n\t\t\t\tif ( match[1] ) {\n\t\t\t\t\tcontext = context instanceof jQuery ? context[0] : context;\n\n\t\t\t\t\t// scripts is true for back-compat\n\t\t\t\t\t// Intentionally let the error be thrown if parseHTML is not present\n\t\t\t\t\tjQuery.merge( this, jQuery.parseHTML(\n\t\t\t\t\t\tmatch[1],\n\t\t\t\t\t\tcontext && context.nodeType ? context.ownerDocument || context : document,\n\t\t\t\t\t\ttrue\n\t\t\t\t\t) );\n\n\t\t\t\t\t// HANDLE: $(html, props)\n\t\t\t\t\tif ( rsingleTag.test( match[1] ) && jQuery.isPlainObject( context ) ) {\n\t\t\t\t\t\tfor ( match in context ) {\n\t\t\t\t\t\t\t// Properties of context are called as methods if possible\n\t\t\t\t\t\t\tif ( jQuery.isFunction( this[ match ] ) ) {\n\t\t\t\t\t\t\t\tthis[ match ]( context[ match ] );\n\n\t\t\t\t\t\t\t// ...and otherwise set as attributes\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.attr( match, context[ match ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this;\n\n\t\t\t\t// HANDLE: $(#id)\n\t\t\t\t} else {\n\t\t\t\t\telem = document.getElementById( match[2] );\n\n\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t\t// nodes that are no longer in the document #6963\n\t\t\t\t\tif ( elem && elem.parentNode ) {\n\t\t\t\t\t\t// Handle the case where IE and Opera return items\n\t\t\t\t\t\t// by name instead of ID\n\t\t\t\t\t\tif ( elem.id !== match[2] ) {\n\t\t\t\t\t\t\treturn rootjQuery.find( selector );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Otherwise, we inject the element directly into the jQuery object\n\t\t\t\t\t\tthis.length = 1;\n\t\t\t\t\t\tthis[0] = elem;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.context = document;\n\t\t\t\t\tthis.selector = selector;\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\n\t\t\t// HANDLE: $(expr, $(...))\n\t\t\t} else if ( !context || context.jquery ) {\n\t\t\t\treturn ( context || rootjQuery ).find( selector );\n\n\t\t\t// HANDLE: $(expr, context)\n\t\t\t// (which is just equivalent to: $(context).find(expr)\n\t\t\t} else {\n\t\t\t\treturn this.constructor( context ).find( selector );\n\t\t\t}\n\n\t\t// HANDLE: $(DOMElement)\n\t\t} else if ( selector.nodeType ) {\n\t\t\tthis.context = this[0] = selector;\n\t\t\tthis.length = 1;\n\t\t\treturn this;\n\n\t\t// HANDLE: $(function)\n\t\t// Shortcut for document ready\n\t\t} else if ( jQuery.isFunction( selector ) ) {\n\t\t\treturn typeof rootjQuery.ready !== \"undefined\" ?\n\t\t\t\trootjQuery.ready( selector ) :\n\t\t\t\t// Execute immediately if ready is not present\n\t\t\t\tselector( jQuery );\n\t\t}\n\n\t\tif ( selector.selector !== undefined ) {\n\t\t\tthis.selector = selector.selector;\n\t\t\tthis.context = selector.context;\n\t\t}\n\n\t\treturn jQuery.makeArray( selector, this );\n\t};\n\n// Give the init function the jQuery prototype for later instantiation\ninit.prototype = jQuery.fn;\n\n// Initialize central reference\nrootjQuery = jQuery( document );\n\n\nvar rparentsprev = /^(?:parents|prev(?:Until|All))/,\n\t// methods guaranteed to produce a unique set when starting from a unique set\n\tguaranteedUnique = {\n\t\tchildren: true,\n\t\tcontents: true,\n\t\tnext: true,\n\t\tprev: true\n\t};\n\njQuery.extend({\n\tdir: function( elem, dir, until ) {\n\t\tvar matched = [],\n\t\t\tcur = elem[ dir ];\n\n\t\twhile ( cur && cur.nodeType !== 9 && (until === undefined || cur.nodeType !== 1 || !jQuery( cur ).is( until )) ) {\n\t\t\tif ( cur.nodeType === 1 ) {\n\t\t\t\tmatched.push( cur );\n\t\t\t}\n\t\t\tcur = cur[dir];\n\t\t}\n\t\treturn matched;\n\t},\n\n\tsibling: function( n, elem ) {\n\t\tvar r = [];\n\n\t\tfor ( ; n; n = n.nextSibling ) {\n\t\t\tif ( n.nodeType === 1 && n !== elem ) {\n\t\t\t\tr.push( n );\n\t\t\t}\n\t\t}\n\n\t\treturn r;\n\t}\n});\n\njQuery.fn.extend({\n\thas: function( target ) {\n\t\tvar i,\n\t\t\ttargets = jQuery( target, this ),\n\t\t\tlen = targets.length;\n\n\t\treturn this.filter(function() {\n\t\t\tfor ( i = 0; i < len; i++ ) {\n\t\t\t\tif ( jQuery.contains( this, targets[i] ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\n\tclosest: function( selectors, context ) {\n\t\tvar cur,\n\t\t\ti = 0,\n\t\t\tl = this.length,\n\t\t\tmatched = [],\n\t\t\tpos = rneedsContext.test( selectors ) || typeof selectors !== \"string\" ?\n\t\t\t\tjQuery( selectors, context || this.context ) :\n\t\t\t\t0;\n\n\t\tfor ( ; i < l; i++ ) {\n\t\t\tfor ( cur = this[i]; cur && cur !== context; cur = cur.parentNode ) {\n\t\t\t\t// Always skip document fragments\n\t\t\t\tif ( cur.nodeType < 11 && (pos ?\n\t\t\t\t\tpos.index(cur) > -1 :\n\n\t\t\t\t\t// Don't pass non-elements to Sizzle\n\t\t\t\t\tcur.nodeType === 1 &&\n\t\t\t\t\t\tjQuery.find.matchesSelector(cur, selectors)) ) {\n\n\t\t\t\t\tmatched.push( cur );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.pushStack( matched.length > 1 ? jQuery.unique( matched ) : matched );\n\t},\n\n\t// Determine the position of an element within\n\t// the matched set of elements\n\tindex: function( elem ) {\n\n\t\t// No argument, return index in parent\n\t\tif ( !elem ) {\n\t\t\treturn ( this[0] && this[0].parentNode ) ? this.first().prevAll().length : -1;\n\t\t}\n\n\t\t// index in selector\n\t\tif ( typeof elem === \"string\" ) {\n\t\t\treturn jQuery.inArray( this[0], jQuery( elem ) );\n\t\t}\n\n\t\t// Locate the position of the desired element\n\t\treturn jQuery.inArray(\n\t\t\t// If it receives a jQuery object, the first element is used\n\t\t\telem.jquery ? elem[0] : elem, this );\n\t},\n\n\tadd: function( selector, context ) {\n\t\treturn this.pushStack(\n\t\t\tjQuery.unique(\n\t\t\t\tjQuery.merge( this.get(), jQuery( selector, context ) )\n\t\t\t)\n\t\t);\n\t},\n\n\taddBack: function( selector ) {\n\t\treturn this.add( selector == null ?\n\t\t\tthis.prevObject : this.prevObject.filter(selector)\n\t\t);\n\t}\n});\n\nfunction sibling( cur, dir ) {\n\tdo {\n\t\tcur = cur[ dir ];\n\t} while ( cur && cur.nodeType !== 1 );\n\n\treturn cur;\n}\n\njQuery.each({\n\tparent: function( elem ) {\n\t\tvar parent = elem.parentNode;\n\t\treturn parent && parent.nodeType !== 11 ? parent : null;\n\t},\n\tparents: function( elem ) {\n\t\treturn jQuery.dir( elem, \"parentNode\" );\n\t},\n\tparentsUntil: function( elem, i, until ) {\n\t\treturn jQuery.dir( elem, \"parentNode\", until );\n\t},\n\tnext: function( elem ) {\n\t\treturn sibling( elem, \"nextSibling\" );\n\t},\n\tprev: function( elem ) {\n\t\treturn sibling( elem, \"previousSibling\" );\n\t},\n\tnextAll: function( elem ) {\n\t\treturn jQuery.dir( elem, \"nextSibling\" );\n\t},\n\tprevAll: function( elem ) {\n\t\treturn jQuery.dir( elem, \"previousSibling\" );\n\t},\n\tnextUntil: function( elem, i, until ) {\n\t\treturn jQuery.dir( elem, \"nextSibling\", until );\n\t},\n\tprevUntil: function( elem, i, until ) {\n\t\treturn jQuery.dir( elem, \"previousSibling\", until );\n\t},\n\tsiblings: function( elem ) {\n\t\treturn jQuery.sibling( ( elem.parentNode || {} ).firstChild, elem );\n\t},\n\tchildren: function( elem ) {\n\t\treturn jQuery.sibling( elem.firstChild );\n\t},\n\tcontents: function( elem ) {\n\t\treturn jQuery.nodeName( elem, \"iframe\" ) ?\n\t\t\telem.contentDocument || elem.contentWindow.document :\n\t\t\tjQuery.merge( [], elem.childNodes );\n\t}\n}, function( name, fn ) {\n\tjQuery.fn[ name ] = function( until, selector ) {\n\t\tvar ret = jQuery.map( this, fn, until );\n\n\t\tif ( name.slice( -5 ) !== \"Until\" ) {\n\t\t\tselector = until;\n\t\t}\n\n\t\tif ( selector && typeof selector === \"string\" ) {\n\t\t\tret = jQuery.filter( selector, ret );\n\t\t}\n\n\t\tif ( this.length > 1 ) {\n\t\t\t// Remove duplicates\n\t\t\tif ( !guaranteedUnique[ name ] ) {\n\t\t\t\tret = jQuery.unique( ret );\n\t\t\t}\n\n\t\t\t// Reverse order for parents* and prev-derivatives\n\t\t\tif ( rparentsprev.test( name ) ) {\n\t\t\t\tret = ret.reverse();\n\t\t\t}\n\t\t}\n\n\t\treturn this.pushStack( ret );\n\t};\n});\nvar rnotwhite = (/\\S+/g);\n\n\n\n// String to Object options format cache\nvar optionsCache = {};\n\n// Convert String-formatted options into Object-formatted ones and store in cache\nfunction createOptions( options ) {\n\tvar object = optionsCache[ options ] = {};\n\tjQuery.each( options.match( rnotwhite ) || [], function( _, flag ) {\n\t\tobject[ flag ] = true;\n\t});\n\treturn object;\n}\n\n/*\n * Create a callback list using the following parameters:\n *\n *\toptions: an optional list of space-separated options that will change how\n *\t\t\tthe callback list behaves or a more traditional option object\n *\n * By default a callback list will act like an event callback list and can be\n * \"fired\" multiple times.\n *\n * Possible options:\n *\n *\tonce:\t\t\twill ensure the callback list can only be fired once (like a Deferred)\n *\n *\tmemory:\t\t\twill keep track of previous values and will call any callback added\n *\t\t\t\t\tafter the list has been fired right away with the latest \"memorized\"\n *\t\t\t\t\tvalues (like a Deferred)\n *\n *\tunique:\t\t\twill ensure a callback can only be added once (no duplicate in the list)\n *\n *\tstopOnFalse:\tinterrupt callings when a callback returns false\n *\n */\njQuery.Callbacks = function( options ) {\n\n\t// Convert options from String-formatted to Object-formatted if needed\n\t// (we check in cache first)\n\toptions = typeof options === \"string\" ?\n\t\t( optionsCache[ options ] || createOptions( options ) ) :\n\t\tjQuery.extend( {}, options );\n\n\tvar // Flag to know if list is currently firing\n\t\tfiring,\n\t\t// Last fire value (for non-forgettable lists)\n\t\tmemory,\n\t\t// Flag to know if list was already fired\n\t\tfired,\n\t\t// End of the loop when firing\n\t\tfiringLength,\n\t\t// Index of currently firing callback (modified by remove if needed)\n\t\tfiringIndex,\n\t\t// First callback to fire (used internally by add and fireWith)\n\t\tfiringStart,\n\t\t// Actual callback list\n\t\tlist = [],\n\t\t// Stack of fire calls for repeatable lists\n\t\tstack = !options.once && [],\n\t\t// Fire callbacks\n\t\tfire = function( data ) {\n\t\t\tmemory = options.memory && data;\n\t\t\tfired = true;\n\t\t\tfiringIndex = firingStart || 0;\n\t\t\tfiringStart = 0;\n\t\t\tfiringLength = list.length;\n\t\t\tfiring = true;\n\t\t\tfor ( ; list && firingIndex < firingLength; firingIndex++ ) {\n\t\t\t\tif ( list[ firingIndex ].apply( data[ 0 ], data[ 1 ] ) === false && options.stopOnFalse ) {\n\t\t\t\t\tmemory = false; // To prevent further calls using add\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tfiring = false;\n\t\t\tif ( list ) {\n\t\t\t\tif ( stack ) {\n\t\t\t\t\tif ( stack.length ) {\n\t\t\t\t\t\tfire( stack.shift() );\n\t\t\t\t\t}\n\t\t\t\t} else if ( memory ) {\n\t\t\t\t\tlist = [];\n\t\t\t\t} else {\n\t\t\t\t\tself.disable();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t// Actual Callbacks object\n\t\tself = {\n\t\t\t// Add a callback or a collection of callbacks to the list\n\t\t\tadd: function() {\n\t\t\t\tif ( list ) {\n\t\t\t\t\t// First, we save the current length\n\t\t\t\t\tvar start = list.length;\n\t\t\t\t\t(function add( args ) {\n\t\t\t\t\t\tjQuery.each( args, function( _, arg ) {\n\t\t\t\t\t\t\tvar type = jQuery.type( arg );\n\t\t\t\t\t\t\tif ( type === \"function\" ) {\n\t\t\t\t\t\t\t\tif ( !options.unique || !self.has( arg ) ) {\n\t\t\t\t\t\t\t\t\tlist.push( arg );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if ( arg && arg.length && type !== \"string\" ) {\n\t\t\t\t\t\t\t\t// Inspect recursively\n\t\t\t\t\t\t\t\tadd( arg );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t})( arguments );\n\t\t\t\t\t// Do we need to add the callbacks to the\n\t\t\t\t\t// current firing batch?\n\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\tfiringLength = list.length;\n\t\t\t\t\t// With memory, if we're not firing then\n\t\t\t\t\t// we should call right away\n\t\t\t\t\t} else if ( memory ) {\n\t\t\t\t\t\tfiringStart = start;\n\t\t\t\t\t\tfire( memory );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Remove a callback from the list\n\t\t\tremove: function() {\n\t\t\t\tif ( list ) {\n\t\t\t\t\tjQuery.each( arguments, function( _, arg ) {\n\t\t\t\t\t\tvar index;\n\t\t\t\t\t\twhile ( ( index = jQuery.inArray( arg, list, index ) ) > -1 ) {\n\t\t\t\t\t\t\tlist.splice( index, 1 );\n\t\t\t\t\t\t\t// Handle firing indexes\n\t\t\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\t\t\tif ( index <= firingLength ) {\n\t\t\t\t\t\t\t\t\tfiringLength--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif ( index <= firingIndex ) {\n\t\t\t\t\t\t\t\t\tfiringIndex--;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Check if a given callback is in the list.\n\t\t\t// If no argument is given, return whether or not list has callbacks attached.\n\t\t\thas: function( fn ) {\n\t\t\t\treturn fn ? jQuery.inArray( fn, list ) > -1 : !!( list && list.length );\n\t\t\t},\n\t\t\t// Remove all callbacks from the list\n\t\t\tempty: function() {\n\t\t\t\tlist = [];\n\t\t\t\tfiringLength = 0;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Have the list do nothing anymore\n\t\t\tdisable: function() {\n\t\t\t\tlist = stack = memory = undefined;\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Is it disabled?\n\t\t\tdisabled: function() {\n\t\t\t\treturn !list;\n\t\t\t},\n\t\t\t// Lock the list in its current state\n\t\t\tlock: function() {\n\t\t\t\tstack = undefined;\n\t\t\t\tif ( !memory ) {\n\t\t\t\t\tself.disable();\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Is it locked?\n\t\t\tlocked: function() {\n\t\t\t\treturn !stack;\n\t\t\t},\n\t\t\t// Call all callbacks with the given context and arguments\n\t\t\tfireWith: function( context, args ) {\n\t\t\t\tif ( list && ( !fired || stack ) ) {\n\t\t\t\t\targs = args || [];\n\t\t\t\t\targs = [ context, args.slice ? args.slice() : args ];\n\t\t\t\t\tif ( firing ) {\n\t\t\t\t\t\tstack.push( args );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfire( args );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// Call all the callbacks with the given arguments\n\t\t\tfire: function() {\n\t\t\t\tself.fireWith( this, arguments );\n\t\t\t\treturn this;\n\t\t\t},\n\t\t\t// To know if the callbacks have already been called at least once\n\t\t\tfired: function() {\n\t\t\t\treturn !!fired;\n\t\t\t}\n\t\t};\n\n\treturn self;\n};\n\n\njQuery.extend({\n\n\tDeferred: function( func ) {\n\t\tvar tuples = [\n\t\t\t\t// action, add listener, listener list, final state\n\t\t\t\t[ \"resolve\", \"done\", jQuery.Callbacks(\"once memory\"), \"resolved\" ],\n\t\t\t\t[ \"reject\", \"fail\", jQuery.Callbacks(\"once memory\"), \"rejected\" ],\n\t\t\t\t[ \"notify\", \"progress\", jQuery.Callbacks(\"memory\") ]\n\t\t\t],\n\t\t\tstate = \"pending\",\n\t\t\tpromise = {\n\t\t\t\tstate: function() {\n\t\t\t\t\treturn state;\n\t\t\t\t},\n\t\t\t\talways: function() {\n\t\t\t\t\tdeferred.done( arguments ).fail( arguments );\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\t\t\t\tthen: function( /* fnDone, fnFail, fnProgress */ ) {\n\t\t\t\t\tvar fns = arguments;\n\t\t\t\t\treturn jQuery.Deferred(function( newDefer ) {\n\t\t\t\t\t\tjQuery.each( tuples, function( i, tuple ) {\n\t\t\t\t\t\t\tvar fn = jQuery.isFunction( fns[ i ] ) && fns[ i ];\n\t\t\t\t\t\t\t// deferred[ done | fail | progress ] for forwarding actions to newDefer\n\t\t\t\t\t\t\tdeferred[ tuple[1] ](function() {\n\t\t\t\t\t\t\t\tvar returned = fn && fn.apply( this, arguments );\n\t\t\t\t\t\t\t\tif ( returned && jQuery.isFunction( returned.promise ) ) {\n\t\t\t\t\t\t\t\t\treturned.promise()\n\t\t\t\t\t\t\t\t\t\t.done( newDefer.resolve )\n\t\t\t\t\t\t\t\t\t\t.fail( newDefer.reject )\n\t\t\t\t\t\t\t\t\t\t.progress( newDefer.notify );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tnewDefer[ tuple[ 0 ] + \"With\" ]( this === promise ? newDefer.promise() : this, fn ? [ returned ] : arguments );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfns = null;\n\t\t\t\t\t}).promise();\n\t\t\t\t},\n\t\t\t\t// Get a promise for this deferred\n\t\t\t\t// If obj is provided, the promise aspect is added to the object\n\t\t\t\tpromise: function( obj ) {\n\t\t\t\t\treturn obj != null ? jQuery.extend( obj, promise ) : promise;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdeferred = {};\n\n\t\t// Keep pipe for back-compat\n\t\tpromise.pipe = promise.then;\n\n\t\t// Add list-specific methods\n\t\tjQuery.each( tuples, function( i, tuple ) {\n\t\t\tvar list = tuple[ 2 ],\n\t\t\t\tstateString = tuple[ 3 ];\n\n\t\t\t// promise[ done | fail | progress ] = list.add\n\t\t\tpromise[ tuple[1] ] = list.add;\n\n\t\t\t// Handle state\n\t\t\tif ( stateString ) {\n\t\t\t\tlist.add(function() {\n\t\t\t\t\t// state = [ resolved | rejected ]\n\t\t\t\t\tstate = stateString;\n\n\t\t\t\t// [ reject_list | resolve_list ].disable; progress_list.lock\n\t\t\t\t}, tuples[ i ^ 1 ][ 2 ].disable, tuples[ 2 ][ 2 ].lock );\n\t\t\t}\n\n\t\t\t// deferred[ resolve | reject | notify ]\n\t\t\tdeferred[ tuple[0] ] = function() {\n\t\t\t\tdeferred[ tuple[0] + \"With\" ]( this === deferred ? promise : this, arguments );\n\t\t\t\treturn this;\n\t\t\t};\n\t\t\tdeferred[ tuple[0] + \"With\" ] = list.fireWith;\n\t\t});\n\n\t\t// Make the deferred a promise\n\t\tpromise.promise( deferred );\n\n\t\t// Call given func if any\n\t\tif ( func ) {\n\t\t\tfunc.call( deferred, deferred );\n\t\t}\n\n\t\t// All done!\n\t\treturn deferred;\n\t},\n\n\t// Deferred helper\n\twhen: function( subordinate /* , ..., subordinateN */ ) {\n\t\tvar i = 0,\n\t\t\tresolveValues = slice.call( arguments ),\n\t\t\tlength = resolveValues.length,\n\n\t\t\t// the count of uncompleted subordinates\n\t\t\tremaining = length !== 1 || ( subordinate && jQuery.isFunction( subordinate.promise ) ) ? length : 0,\n\n\t\t\t// the master Deferred. If resolveValues consist of only a single Deferred, just use that.\n\t\t\tdeferred = remaining === 1 ? subordinate : jQuery.Deferred(),\n\n\t\t\t// Update function for both resolve and progress values\n\t\t\tupdateFunc = function( i, contexts, values ) {\n\t\t\t\treturn function( value ) {\n\t\t\t\t\tcontexts[ i ] = this;\n\t\t\t\t\tvalues[ i ] = arguments.length > 1 ? slice.call( arguments ) : value;\n\t\t\t\t\tif ( values === progressValues ) {\n\t\t\t\t\t\tdeferred.notifyWith( contexts, values );\n\n\t\t\t\t\t} else if ( !(--remaining) ) {\n\t\t\t\t\t\tdeferred.resolveWith( contexts, values );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tprogressValues, progressContexts, resolveContexts;\n\n\t\t// add listeners to Deferred subordinates; treat others as resolved\n\t\tif ( length > 1 ) {\n\t\t\tprogressValues = new Array( length );\n\t\t\tprogressContexts = new Array( length );\n\t\t\tresolveContexts = new Array( length );\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tif ( resolveValues[ i ] && jQuery.isFunction( resolveValues[ i ].promise ) ) {\n\t\t\t\t\tresolveValues[ i ].promise()\n\t\t\t\t\t\t.done( updateFunc( i, resolveContexts, resolveValues ) )\n\t\t\t\t\t\t.fail( deferred.reject )\n\t\t\t\t\t\t.progress( updateFunc( i, progressContexts, progressValues ) );\n\t\t\t\t} else {\n\t\t\t\t\t--remaining;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// if we're not waiting on anything, resolve the master\n\t\tif ( !remaining ) {\n\t\t\tdeferred.resolveWith( resolveContexts, resolveValues );\n\t\t}\n\n\t\treturn deferred.promise();\n\t}\n});\n\n\n// The deferred used on DOM ready\nvar readyList;\n\njQuery.fn.ready = function( fn ) {\n\t// Add the callback\n\tjQuery.ready.promise().done( fn );\n\n\treturn this;\n};\n\njQuery.extend({\n\t// Is the DOM ready to be used? Set to true once it occurs.\n\tisReady: false,\n\n\t// A counter to track how many items to wait for before\n\t// the ready event fires. See #6781\n\treadyWait: 1,\n\n\t// Hold (or release) the ready event\n\tholdReady: function( hold ) {\n\t\tif ( hold ) {\n\t\t\tjQuery.readyWait++;\n\t\t} else {\n\t\t\tjQuery.ready( true );\n\t\t}\n\t},\n\n\t// Handle when the DOM is ready\n\tready: function( wait ) {\n\n\t\t// Abort if there are pending holds or we're already ready\n\t\tif ( wait === true ? --jQuery.readyWait : jQuery.isReady ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Make sure body exists, at least, in case IE gets a little overzealous (ticket #5443).\n\t\tif ( !document.body ) {\n\t\t\treturn setTimeout( jQuery.ready );\n\t\t}\n\n\t\t// Remember that the DOM is ready\n\t\tjQuery.isReady = true;\n\n\t\t// If a normal DOM Ready event fired, decrement, and wait if need be\n\t\tif ( wait !== true && --jQuery.readyWait > 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If there are functions bound, to execute\n\t\treadyList.resolveWith( document, [ jQuery ] );\n\n\t\t// Trigger any bound ready events\n\t\tif ( jQuery.fn.triggerHandler ) {\n\t\t\tjQuery( document ).triggerHandler( \"ready\" );\n\t\t\tjQuery( document ).off( \"ready\" );\n\t\t}\n\t}\n});\n\n/**\n * Clean-up method for dom ready events\n */\nfunction detach() {\n\tif ( document.addEventListener ) {\n\t\tdocument.removeEventListener( \"DOMContentLoaded\", completed, false );\n\t\twindow.removeEventListener( \"load\", completed, false );\n\n\t} else {\n\t\tdocument.detachEvent( \"onreadystatechange\", completed );\n\t\twindow.detachEvent( \"onload\", completed );\n\t}\n}\n\n/**\n * The ready event handler and self cleanup method\n */\nfunction completed() {\n\t// readyState === \"complete\" is good enough for us to call the dom ready in oldIE\n\tif ( document.addEventListener || event.type === \"load\" || document.readyState === \"complete\" ) {\n\t\tdetach();\n\t\tjQuery.ready();\n\t}\n}\n\njQuery.ready.promise = function( obj ) {\n\tif ( !readyList ) {\n\n\t\treadyList = jQuery.Deferred();\n\n\t\t// Catch cases where $(document).ready() is called after the browser event has already occurred.\n\t\t// we once tried to use readyState \"interactive\" here, but it caused issues like the one\n\t\t// discovered by ChrisS here: http://bugs.jquery.com/ticket/12282#comment:15\n\t\tif ( document.readyState === \"complete\" ) {\n\t\t\t// Handle it asynchronously to allow scripts the opportunity to delay ready\n\t\t\tsetTimeout( jQuery.ready );\n\n\t\t// Standards-based browsers support DOMContentLoaded\n\t\t} else if ( document.addEventListener ) {\n\t\t\t// Use the handy event callback\n\t\t\tdocument.addEventListener( \"DOMContentLoaded\", completed, false );\n\n\t\t\t// A fallback to window.onload, that will always work\n\t\t\twindow.addEventListener( \"load\", completed, false );\n\n\t\t// If IE event model is used\n\t\t} else {\n\t\t\t// Ensure firing before onload, maybe late but safe also for iframes\n\t\t\tdocument.attachEvent( \"onreadystatechange\", completed );\n\n\t\t\t// A fallback to window.onload, that will always work\n\t\t\twindow.attachEvent( \"onload\", completed );\n\n\t\t\t// If IE and not a frame\n\t\t\t// continually check to see if the document is ready\n\t\t\tvar top = false;\n\n\t\t\ttry {\n\t\t\t\ttop = window.frameElement == null && document.documentElement;\n\t\t\t} catch(e) {}\n\n\t\t\tif ( top && top.doScroll ) {\n\t\t\t\t(function doScrollCheck() {\n\t\t\t\t\tif ( !jQuery.isReady ) {\n\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t// Use the trick by Diego Perini\n\t\t\t\t\t\t\t// http://javascript.nwbox.com/IEContentLoaded/\n\t\t\t\t\t\t\ttop.doScroll(\"left\");\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\treturn setTimeout( doScrollCheck, 50 );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// detach all dom ready events\n\t\t\t\t\t\tdetach();\n\n\t\t\t\t\t\t// and execute any waiting functions\n\t\t\t\t\t\tjQuery.ready();\n\t\t\t\t\t}\n\t\t\t\t})();\n\t\t\t}\n\t\t}\n\t}\n\treturn readyList.promise( obj );\n};\n\n\nvar strundefined = typeof undefined;\n\n\n\n// Support: IE<9\n// Iteration over object's inherited properties before its own\nvar i;\nfor ( i in jQuery( support ) ) {\n\tbreak;\n}\nsupport.ownLast = i !== \"0\";\n\n// Note: most support tests are defined in their respective modules.\n// false until the test is run\nsupport.inlineBlockNeedsLayout = false;\n\n// Execute ASAP in case we need to set body.style.zoom\njQuery(function() {\n\t// Minified: var a,b,c,d\n\tvar val, div, body, container;\n\n\tbody = document.getElementsByTagName( \"body\" )[ 0 ];\n\tif ( !body || !body.style ) {\n\t\t// Return for frameset docs that don't have a body\n\t\treturn;\n\t}\n\n\t// Setup\n\tdiv = document.createElement( \"div\" );\n\tcontainer = document.createElement( \"div\" );\n\tcontainer.style.cssText = \"position:absolute;border:0;width:0;height:0;top:0;left:-9999px\";\n\tbody.appendChild( container ).appendChild( div );\n\n\tif ( typeof div.style.zoom !== strundefined ) {\n\t\t// Support: IE<8\n\t\t// Check if natively block-level elements act like inline-block\n\t\t// elements when setting their display to 'inline' and giving\n\t\t// them layout\n\t\tdiv.style.cssText = \"display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1\";\n\n\t\tsupport.inlineBlockNeedsLayout = val = div.offsetWidth === 3;\n\t\tif ( val ) {\n\t\t\t// Prevent IE 6 from affecting layout for positioned elements #11048\n\t\t\t// Prevent IE from shrinking the body in IE 7 mode #12869\n\t\t\t// Support: IE<8\n\t\t\tbody.style.zoom = 1;\n\t\t}\n\t}\n\n\tbody.removeChild( container );\n});\n\n\n\n\n(function() {\n\tvar div = document.createElement( \"div\" );\n\n\t// Execute the test only if not already executed in another module.\n\tif (support.deleteExpando == null) {\n\t\t// Support: IE<9\n\t\tsupport.deleteExpando = true;\n\t\ttry {\n\t\t\tdelete div.test;\n\t\t} catch( e ) {\n\t\t\tsupport.deleteExpando = false;\n\t\t}\n\t}\n\n\t// Null elements to avoid leaks in IE.\n\tdiv = null;\n})();\n\n\n/**\n * Determines whether an object can have data\n */\njQuery.acceptData = function( elem ) {\n\tvar noData = jQuery.noData[ (elem.nodeName + \" \").toLowerCase() ],\n\t\tnodeType = +elem.nodeType || 1;\n\n\t// Do not set data on non-element DOM nodes because it will not be cleared (#8335).\n\treturn nodeType !== 1 && nodeType !== 9 ?\n\t\tfalse :\n\n\t\t// Nodes accept data unless otherwise specified; rejection can be conditional\n\t\t!noData || noData !== true && elem.getAttribute(\"classid\") === noData;\n};\n\n\nvar rbrace = /^(?:\\{[\\w\\W]*\\}|\\[[\\w\\W]*\\])$/,\n\trmultiDash = /([A-Z])/g;\n\nfunction dataAttr( elem, key, data ) {\n\t// If nothing was found internally, try to fetch any\n\t// data from the HTML5 data-* attribute\n\tif ( data === undefined && elem.nodeType === 1 ) {\n\n\t\tvar name = \"data-\" + key.replace( rmultiDash, \"-$1\" ).toLowerCase();\n\n\t\tdata = elem.getAttribute( name );\n\n\t\tif ( typeof data === \"string\" ) {\n\t\t\ttry {\n\t\t\t\tdata = data === \"true\" ? true :\n\t\t\t\t\tdata === \"false\" ? false :\n\t\t\t\t\tdata === \"null\" ? null :\n\t\t\t\t\t// Only convert to a number if it doesn't change the string\n\t\t\t\t\t+data + \"\" === data ? +data :\n\t\t\t\t\trbrace.test( data ) ? jQuery.parseJSON( data ) :\n\t\t\t\t\tdata;\n\t\t\t} catch( e ) {}\n\n\t\t\t// Make sure we set the data so it isn't changed later\n\t\t\tjQuery.data( elem, key, data );\n\n\t\t} else {\n\t\t\tdata = undefined;\n\t\t}\n\t}\n\n\treturn data;\n}\n\n// checks a cache object for emptiness\nfunction isEmptyDataObject( obj ) {\n\tvar name;\n\tfor ( name in obj ) {\n\n\t\t// if the public data object is empty, the private is still empty\n\t\tif ( name === \"data\" && jQuery.isEmptyObject( obj[name] ) ) {\n\t\t\tcontinue;\n\t\t}\n\t\tif ( name !== \"toJSON\" ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction internalData( elem, name, data, pvt /* Internal Use Only */ ) {\n\tif ( !jQuery.acceptData( elem ) ) {\n\t\treturn;\n\t}\n\n\tvar ret, thisCache,\n\t\tinternalKey = jQuery.expando,\n\n\t\t// We have to handle DOM nodes and JS objects differently because IE6-7\n\t\t// can't GC object references properly across the DOM-JS boundary\n\t\tisNode = elem.nodeType,\n\n\t\t// Only DOM nodes need the global jQuery cache; JS object data is\n\t\t// attached directly to the object so GC can occur automatically\n\t\tcache = isNode ? jQuery.cache : elem,\n\n\t\t// Only defining an ID for JS objects if its cache already exists allows\n\t\t// the code to shortcut on the same path as a DOM node with no cache\n\t\tid = isNode ? elem[ internalKey ] : elem[ internalKey ] && internalKey;\n\n\t// Avoid doing any more work than we need to when trying to get data on an\n\t// object that has no data at all\n\tif ( (!id || !cache[id] || (!pvt && !cache[id].data)) && data === undefined && typeof name === \"string\" ) {\n\t\treturn;\n\t}\n\n\tif ( !id ) {\n\t\t// Only DOM nodes need a new unique ID for each element since their data\n\t\t// ends up in the global cache\n\t\tif ( isNode ) {\n\t\t\tid = elem[ internalKey ] = deletedIds.pop() || jQuery.guid++;\n\t\t} else {\n\t\t\tid = internalKey;\n\t\t}\n\t}\n\n\tif ( !cache[ id ] ) {\n\t\t// Avoid exposing jQuery metadata on plain JS objects when the object\n\t\t// is serialized using JSON.stringify\n\t\tcache[ id ] = isNode ? {} : { toJSON: jQuery.noop };\n\t}\n\n\t// An object can be passed to jQuery.data instead of a key/value pair; this gets\n\t// shallow copied over onto the existing cache\n\tif ( typeof name === \"object\" || typeof name === \"function\" ) {\n\t\tif ( pvt ) {\n\t\t\tcache[ id ] = jQuery.extend( cache[ id ], name );\n\t\t} else {\n\t\t\tcache[ id ].data = jQuery.extend( cache[ id ].data, name );\n\t\t}\n\t}\n\n\tthisCache = cache[ id ];\n\n\t// jQuery data() is stored in a separate object inside the object's internal data\n\t// cache in order to avoid key collisions between internal data and user-defined\n\t// data.\n\tif ( !pvt ) {\n\t\tif ( !thisCache.data ) {\n\t\t\tthisCache.data = {};\n\t\t}\n\n\t\tthisCache = thisCache.data;\n\t}\n\n\tif ( data !== undefined ) {\n\t\tthisCache[ jQuery.camelCase( name ) ] = data;\n\t}\n\n\t// Check for both converted-to-camel and non-converted data property names\n\t// If a data property was specified\n\tif ( typeof name === \"string\" ) {\n\n\t\t// First Try to find as-is property data\n\t\tret = thisCache[ name ];\n\n\t\t// Test for null|undefined property data\n\t\tif ( ret == null ) {\n\n\t\t\t// Try to find the camelCased property\n\t\t\tret = thisCache[ jQuery.camelCase( name ) ];\n\t\t}\n\t} else {\n\t\tret = thisCache;\n\t}\n\n\treturn ret;\n}\n\nfunction internalRemoveData( elem, name, pvt ) {\n\tif ( !jQuery.acceptData( elem ) ) {\n\t\treturn;\n\t}\n\n\tvar thisCache, i,\n\t\tisNode = elem.nodeType,\n\n\t\t// See jQuery.data for more information\n\t\tcache = isNode ? jQuery.cache : elem,\n\t\tid = isNode ? elem[ jQuery.expando ] : jQuery.expando;\n\n\t// If there is already no cache entry for this object, there is no\n\t// purpose in continuing\n\tif ( !cache[ id ] ) {\n\t\treturn;\n\t}\n\n\tif ( name ) {\n\n\t\tthisCache = pvt ? cache[ id ] : cache[ id ].data;\n\n\t\tif ( thisCache ) {\n\n\t\t\t// Support array or space separated string names for data keys\n\t\t\tif ( !jQuery.isArray( name ) ) {\n\n\t\t\t\t// try the string as a key before any manipulation\n\t\t\t\tif ( name in thisCache ) {\n\t\t\t\t\tname = [ name ];\n\t\t\t\t} else {\n\n\t\t\t\t\t// split the camel cased version by spaces unless a key with the spaces exists\n\t\t\t\t\tname = jQuery.camelCase( name );\n\t\t\t\t\tif ( name in thisCache ) {\n\t\t\t\t\t\tname = [ name ];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tname = name.split(\" \");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// If \"name\" is an array of keys...\n\t\t\t\t// When data is initially created, via (\"key\", \"val\") signature,\n\t\t\t\t// keys will be converted to camelCase.\n\t\t\t\t// Since there is no way to tell _how_ a key was added, remove\n\t\t\t\t// both plain key and camelCase key. #12786\n\t\t\t\t// This will only penalize the array argument path.\n\t\t\t\tname = name.concat( jQuery.map( name, jQuery.camelCase ) );\n\t\t\t}\n\n\t\t\ti = name.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tdelete thisCache[ name[i] ];\n\t\t\t}\n\n\t\t\t// If there is no data left in the cache, we want to continue\n\t\t\t// and let the cache object itself get destroyed\n\t\t\tif ( pvt ? !isEmptyDataObject(thisCache) : !jQuery.isEmptyObject(thisCache) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\t// See jQuery.data for more information\n\tif ( !pvt ) {\n\t\tdelete cache[ id ].data;\n\n\t\t// Don't destroy the parent cache unless the internal data object\n\t\t// had been the only thing left in it\n\t\tif ( !isEmptyDataObject( cache[ id ] ) ) {\n\t\t\treturn;\n\t\t}\n\t}\n\n\t// Destroy the cache\n\tif ( isNode ) {\n\t\tjQuery.cleanData( [ elem ], true );\n\n\t// Use delete when supported for expandos or `cache` is not a window per isWindow (#10080)\n\t/* jshint eqeqeq: false */\n\t} else if ( support.deleteExpando || cache != cache.window ) {\n\t\t/* jshint eqeqeq: true */\n\t\tdelete cache[ id ];\n\n\t// When all else fails, null\n\t} else {\n\t\tcache[ id ] = null;\n\t}\n}\n\njQuery.extend({\n\tcache: {},\n\n\t// The following elements (space-suffixed to avoid Object.prototype collisions)\n\t// throw uncatchable exceptions if you attempt to set expando properties\n\tnoData: {\n\t\t\"applet \": true,\n\t\t\"embed \": true,\n\t\t// ...but Flash objects (which have this classid) *can* handle expandos\n\t\t\"object \": \"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\"\n\t},\n\n\thasData: function( elem ) {\n\t\telem = elem.nodeType ? jQuery.cache[ elem[jQuery.expando] ] : elem[ jQuery.expando ];\n\t\treturn !!elem && !isEmptyDataObject( elem );\n\t},\n\n\tdata: function( elem, name, data ) {\n\t\treturn internalData( elem, name, data );\n\t},\n\n\tremoveData: function( elem, name ) {\n\t\treturn internalRemoveData( elem, name );\n\t},\n\n\t// For internal use only.\n\t_data: function( elem, name, data ) {\n\t\treturn internalData( elem, name, data, true );\n\t},\n\n\t_removeData: function( elem, name ) {\n\t\treturn internalRemoveData( elem, name, true );\n\t}\n});\n\njQuery.fn.extend({\n\tdata: function( key, value ) {\n\t\tvar i, name, data,\n\t\t\telem = this[0],\n\t\t\tattrs = elem && elem.attributes;\n\n\t\t// Special expections of .data basically thwart jQuery.access,\n\t\t// so implement the relevant behavior ourselves\n\n\t\t// Gets all values\n\t\tif ( key === undefined ) {\n\t\t\tif ( this.length ) {\n\t\t\t\tdata = jQuery.data( elem );\n\n\t\t\t\tif ( elem.nodeType === 1 && !jQuery._data( elem, \"parsedAttrs\" ) ) {\n\t\t\t\t\ti = attrs.length;\n\t\t\t\t\twhile ( i-- ) {\n\n\t\t\t\t\t\t// Support: IE11+\n\t\t\t\t\t\t// The attrs elements can be null (#14894)\n\t\t\t\t\t\tif ( attrs[ i ] ) {\n\t\t\t\t\t\t\tname = attrs[ i ].name;\n\t\t\t\t\t\t\tif ( name.indexOf( \"data-\" ) === 0 ) {\n\t\t\t\t\t\t\t\tname = jQuery.camelCase( name.slice(5) );\n\t\t\t\t\t\t\t\tdataAttr( elem, name, data[ name ] );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tjQuery._data( elem, \"parsedAttrs\", true );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn data;\n\t\t}\n\n\t\t// Sets multiple values\n\t\tif ( typeof key === \"object\" ) {\n\t\t\treturn this.each(function() {\n\t\t\t\tjQuery.data( this, key );\n\t\t\t});\n\t\t}\n\n\t\treturn arguments.length > 1 ?\n\n\t\t\t// Sets one value\n\t\t\tthis.each(function() {\n\t\t\t\tjQuery.data( this, key, value );\n\t\t\t}) :\n\n\t\t\t// Gets one value\n\t\t\t// Try to fetch any internally stored data first\n\t\t\telem ? dataAttr( elem, key, jQuery.data( elem, key ) ) : undefined;\n\t},\n\n\tremoveData: function( key ) {\n\t\treturn this.each(function() {\n\t\t\tjQuery.removeData( this, key );\n\t\t});\n\t}\n});\n\n\njQuery.extend({\n\tqueue: function( elem, type, data ) {\n\t\tvar queue;\n\n\t\tif ( elem ) {\n\t\t\ttype = ( type || \"fx\" ) + \"queue\";\n\t\t\tqueue = jQuery._data( elem, type );\n\n\t\t\t// Speed up dequeue by getting out quickly if this is just a lookup\n\t\t\tif ( data ) {\n\t\t\t\tif ( !queue || jQuery.isArray(data) ) {\n\t\t\t\t\tqueue = jQuery._data( elem, type, jQuery.makeArray(data) );\n\t\t\t\t} else {\n\t\t\t\t\tqueue.push( data );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn queue || [];\n\t\t}\n\t},\n\n\tdequeue: function( elem, type ) {\n\t\ttype = type || \"fx\";\n\n\t\tvar queue = jQuery.queue( elem, type ),\n\t\t\tstartLength = queue.length,\n\t\t\tfn = queue.shift(),\n\t\t\thooks = jQuery._queueHooks( elem, type ),\n\t\t\tnext = function() {\n\t\t\t\tjQuery.dequeue( elem, type );\n\t\t\t};\n\n\t\t// If the fx queue is dequeued, always remove the progress sentinel\n\t\tif ( fn === \"inprogress\" ) {\n\t\t\tfn = queue.shift();\n\t\t\tstartLength--;\n\t\t}\n\n\t\tif ( fn ) {\n\n\t\t\t// Add a progress sentinel to prevent the fx queue from being\n\t\t\t// automatically dequeued\n\t\t\tif ( type === \"fx\" ) {\n\t\t\t\tqueue.unshift( \"inprogress\" );\n\t\t\t}\n\n\t\t\t// clear up the last queue stop function\n\t\t\tdelete hooks.stop;\n\t\t\tfn.call( elem, next, hooks );\n\t\t}\n\n\t\tif ( !startLength && hooks ) {\n\t\t\thooks.empty.fire();\n\t\t}\n\t},\n\n\t// not intended for public consumption - generates a queueHooks object, or returns the current one\n\t_queueHooks: function( elem, type ) {\n\t\tvar key = type + \"queueHooks\";\n\t\treturn jQuery._data( elem, key ) || jQuery._data( elem, key, {\n\t\t\tempty: jQuery.Callbacks(\"once memory\").add(function() {\n\t\t\t\tjQuery._removeData( elem, type + \"queue\" );\n\t\t\t\tjQuery._removeData( elem, key );\n\t\t\t})\n\t\t});\n\t}\n});\n\njQuery.fn.extend({\n\tqueue: function( type, data ) {\n\t\tvar setter = 2;\n\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tdata = type;\n\t\t\ttype = \"fx\";\n\t\t\tsetter--;\n\t\t}\n\n\t\tif ( arguments.length < setter ) {\n\t\t\treturn jQuery.queue( this[0], type );\n\t\t}\n\n\t\treturn data === undefined ?\n\t\t\tthis :\n\t\t\tthis.each(function() {\n\t\t\t\tvar queue = jQuery.queue( this, type, data );\n\n\t\t\t\t// ensure a hooks for this queue\n\t\t\t\tjQuery._queueHooks( this, type );\n\n\t\t\t\tif ( type === \"fx\" && queue[0] !== \"inprogress\" ) {\n\t\t\t\t\tjQuery.dequeue( this, type );\n\t\t\t\t}\n\t\t\t});\n\t},\n\tdequeue: function( type ) {\n\t\treturn this.each(function() {\n\t\t\tjQuery.dequeue( this, type );\n\t\t});\n\t},\n\tclearQueue: function( type ) {\n\t\treturn this.queue( type || \"fx\", [] );\n\t},\n\t// Get a promise resolved when queues of a certain type\n\t// are emptied (fx is the type by default)\n\tpromise: function( type, obj ) {\n\t\tvar tmp,\n\t\t\tcount = 1,\n\t\t\tdefer = jQuery.Deferred(),\n\t\t\telements = this,\n\t\t\ti = this.length,\n\t\t\tresolve = function() {\n\t\t\t\tif ( !( --count ) ) {\n\t\t\t\t\tdefer.resolveWith( elements, [ elements ] );\n\t\t\t\t}\n\t\t\t};\n\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tobj = type;\n\t\t\ttype = undefined;\n\t\t}\n\t\ttype = type || \"fx\";\n\n\t\twhile ( i-- ) {\n\t\t\ttmp = jQuery._data( elements[ i ], type + \"queueHooks\" );\n\t\t\tif ( tmp && tmp.empty ) {\n\t\t\t\tcount++;\n\t\t\t\ttmp.empty.add( resolve );\n\t\t\t}\n\t\t}\n\t\tresolve();\n\t\treturn defer.promise( obj );\n\t}\n});\nvar pnum = (/[+-]?(?:\\d*\\.|)\\d+(?:[eE][+-]?\\d+|)/).source;\n\nvar cssExpand = [ \"Top\", \"Right\", \"Bottom\", \"Left\" ];\n\nvar isHidden = function( elem, el ) {\n\t\t// isHidden might be called from jQuery#filter function;\n\t\t// in that case, element will be second argument\n\t\telem = el || elem;\n\t\treturn jQuery.css( elem, \"display\" ) === \"none\" || !jQuery.contains( elem.ownerDocument, elem );\n\t};\n\n\n\n// Multifunctional method to get and set values of a collection\n// The value/s can optionally be executed if it's a function\nvar access = jQuery.access = function( elems, fn, key, value, chainable, emptyGet, raw ) {\n\tvar i = 0,\n\t\tlength = elems.length,\n\t\tbulk = key == null;\n\n\t// Sets many values\n\tif ( jQuery.type( key ) === \"object\" ) {\n\t\tchainable = true;\n\t\tfor ( i in key ) {\n\t\t\tjQuery.access( elems, fn, i, key[i], true, emptyGet, raw );\n\t\t}\n\n\t// Sets one value\n\t} else if ( value !== undefined ) {\n\t\tchainable = true;\n\n\t\tif ( !jQuery.isFunction( value ) ) {\n\t\t\traw = true;\n\t\t}\n\n\t\tif ( bulk ) {\n\t\t\t// Bulk operations run against the entire set\n\t\t\tif ( raw ) {\n\t\t\t\tfn.call( elems, value );\n\t\t\t\tfn = null;\n\n\t\t\t// ...except when executing function values\n\t\t\t} else {\n\t\t\t\tbulk = fn;\n\t\t\t\tfn = function( elem, key, value ) {\n\t\t\t\t\treturn bulk.call( jQuery( elem ), value );\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\tif ( fn ) {\n\t\t\tfor ( ; i < length; i++ ) {\n\t\t\t\tfn( elems[i], key, raw ? value : value.call( elems[i], i, fn( elems[i], key ) ) );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn chainable ?\n\t\telems :\n\n\t\t// Gets\n\t\tbulk ?\n\t\t\tfn.call( elems ) :\n\t\t\tlength ? fn( elems[0], key ) : emptyGet;\n};\nvar rcheckableType = (/^(?:checkbox|radio)$/i);\n\n\n\n(function() {\n\t// Minified: var a,b,c\n\tvar input = document.createElement( \"input\" ),\n\t\tdiv = document.createElement( \"div\" ),\n\t\tfragment = document.createDocumentFragment();\n\n\t// Setup\n\tdiv.innerHTML = \"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\";\n\n\t// IE strips leading whitespace when .innerHTML is used\n\tsupport.leadingWhitespace = div.firstChild.nodeType === 3;\n\n\t// Make sure that tbody elements aren't automatically inserted\n\t// IE will insert them into empty tables\n\tsupport.tbody = !div.getElementsByTagName( \"tbody\" ).length;\n\n\t// Make sure that link elements get serialized correctly by innerHTML\n\t// This requires a wrapper element in IE\n\tsupport.htmlSerialize = !!div.getElementsByTagName( \"link\" ).length;\n\n\t// Makes sure cloning an html5 element does not cause problems\n\t// Where outerHTML is undefined, this still works\n\tsupport.html5Clone =\n\t\tdocument.createElement( \"nav\" ).cloneNode( true ).outerHTML !== \"<:nav></:nav>\";\n\n\t// Check if a disconnected checkbox will retain its checked\n\t// value of true after appended to the DOM (IE6/7)\n\tinput.type = \"checkbox\";\n\tinput.checked = true;\n\tfragment.appendChild( input );\n\tsupport.appendChecked = input.checked;\n\n\t// Make sure textarea (and checkbox) defaultValue is properly cloned\n\t// Support: IE6-IE11+\n\tdiv.innerHTML = \"<textarea>x</textarea>\";\n\tsupport.noCloneChecked = !!div.cloneNode( true ).lastChild.defaultValue;\n\n\t// #11217 - WebKit loses check when the name is after the checked attribute\n\tfragment.appendChild( div );\n\tdiv.innerHTML = \"<input type='radio' checked='checked' name='t'/>\";\n\n\t// Support: Safari 5.1, iOS 5.1, Android 4.x, Android 2.3\n\t// old WebKit doesn't clone checked state correctly in fragments\n\tsupport.checkClone = div.cloneNode( true ).cloneNode( true ).lastChild.checked;\n\n\t// Support: IE<9\n\t// Opera does not clone events (and typeof div.attachEvent === undefined).\n\t// IE9-10 clones events bound via attachEvent, but they don't trigger with .click()\n\tsupport.noCloneEvent = true;\n\tif ( div.attachEvent ) {\n\t\tdiv.attachEvent( \"onclick\", function() {\n\t\t\tsupport.noCloneEvent = false;\n\t\t});\n\n\t\tdiv.cloneNode( true ).click();\n\t}\n\n\t// Execute the test only if not already executed in another module.\n\tif (support.deleteExpando == null) {\n\t\t// Support: IE<9\n\t\tsupport.deleteExpando = true;\n\t\ttry {\n\t\t\tdelete div.test;\n\t\t} catch( e ) {\n\t\t\tsupport.deleteExpando = false;\n\t\t}\n\t}\n})();\n\n\n(function() {\n\tvar i, eventName,\n\t\tdiv = document.createElement( \"div\" );\n\n\t// Support: IE<9 (lack submit/change bubble), Firefox 23+ (lack focusin event)\n\tfor ( i in { submit: true, change: true, focusin: true }) {\n\t\teventName = \"on\" + i;\n\n\t\tif ( !(support[ i + \"Bubbles\" ] = eventName in window) ) {\n\t\t\t// Beware of CSP restrictions (https://developer.mozilla.org/en/Security/CSP)\n\t\t\tdiv.setAttribute( eventName, \"t\" );\n\t\t\tsupport[ i + \"Bubbles\" ] = div.attributes[ eventName ].expando === false;\n\t\t}\n\t}\n\n\t// Null elements to avoid leaks in IE.\n\tdiv = null;\n})();\n\n\nvar rformElems = /^(?:input|select|textarea)$/i,\n\trkeyEvent = /^key/,\n\trmouseEvent = /^(?:mouse|pointer|contextmenu)|click/,\n\trfocusMorph = /^(?:focusinfocus|focusoutblur)$/,\n\trtypenamespace = /^([^.]*)(?:\\.(.+)|)$/;\n\nfunction returnTrue() {\n\treturn true;\n}\n\nfunction returnFalse() {\n\treturn false;\n}\n\nfunction safeActiveElement() {\n\ttry {\n\t\treturn document.activeElement;\n\t} catch ( err ) { }\n}\n\n/*\n * Helper functions for managing events -- not part of the public interface.\n * Props to Dean Edwards' addEvent library for many of the ideas.\n */\njQuery.event = {\n\n\tglobal: {},\n\n\tadd: function( elem, types, handler, data, selector ) {\n\t\tvar tmp, events, t, handleObjIn,\n\t\t\tspecial, eventHandle, handleObj,\n\t\t\thandlers, type, namespaces, origType,\n\t\t\telemData = jQuery._data( elem );\n\n\t\t// Don't attach events to noData or text/comment nodes (but allow plain objects)\n\t\tif ( !elemData ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Caller can pass in an object of custom data in lieu of the handler\n\t\tif ( handler.handler ) {\n\t\t\thandleObjIn = handler;\n\t\t\thandler = handleObjIn.handler;\n\t\t\tselector = handleObjIn.selector;\n\t\t}\n\n\t\t// Make sure that the handler has a unique ID, used to find/remove it later\n\t\tif ( !handler.guid ) {\n\t\t\thandler.guid = jQuery.guid++;\n\t\t}\n\n\t\t// Init the element's event structure and main handler, if this is the first\n\t\tif ( !(events = elemData.events) ) {\n\t\t\tevents = elemData.events = {};\n\t\t}\n\t\tif ( !(eventHandle = elemData.handle) ) {\n\t\t\teventHandle = elemData.handle = function( e ) {\n\t\t\t\t// Discard the second event of a jQuery.event.trigger() and\n\t\t\t\t// when an event is called after a page has unloaded\n\t\t\t\treturn typeof jQuery !== strundefined && (!e || jQuery.event.triggered !== e.type) ?\n\t\t\t\t\tjQuery.event.dispatch.apply( eventHandle.elem, arguments ) :\n\t\t\t\t\tundefined;\n\t\t\t};\n\t\t\t// Add elem as a property of the handle fn to prevent a memory leak with IE non-native events\n\t\t\teventHandle.elem = elem;\n\t\t}\n\n\t\t// Handle multiple events separated by a space\n\t\ttypes = ( types || \"\" ).match( rnotwhite ) || [ \"\" ];\n\t\tt = types.length;\n\t\twhile ( t-- ) {\n\t\t\ttmp = rtypenamespace.exec( types[t] ) || [];\n\t\t\ttype = origType = tmp[1];\n\t\t\tnamespaces = ( tmp[2] || \"\" ).split( \".\" ).sort();\n\n\t\t\t// There *must* be a type, no attaching namespace-only handlers\n\t\t\tif ( !type ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If event changes its type, use the special event handlers for the changed type\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\n\t\t\t// If selector defined, determine special event api type, otherwise given type\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n\n\t\t\t// Update special based on newly reset type\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\n\t\t\t// handleObj is passed to all event handlers\n\t\t\thandleObj = jQuery.extend({\n\t\t\t\ttype: type,\n\t\t\t\torigType: origType,\n\t\t\t\tdata: data,\n\t\t\t\thandler: handler,\n\t\t\t\tguid: handler.guid,\n\t\t\t\tselector: selector,\n\t\t\t\tneedsContext: selector && jQuery.expr.match.needsContext.test( selector ),\n\t\t\t\tnamespace: namespaces.join(\".\")\n\t\t\t}, handleObjIn );\n\n\t\t\t// Init the event handler queue if we're the first\n\t\t\tif ( !(handlers = events[ type ]) ) {\n\t\t\t\thandlers = events[ type ] = [];\n\t\t\t\thandlers.delegateCount = 0;\n\n\t\t\t\t// Only use addEventListener/attachEvent if the special events handler returns false\n\t\t\t\tif ( !special.setup || special.setup.call( elem, data, namespaces, eventHandle ) === false ) {\n\t\t\t\t\t// Bind the global event handler to the element\n\t\t\t\t\tif ( elem.addEventListener ) {\n\t\t\t\t\t\telem.addEventListener( type, eventHandle, false );\n\n\t\t\t\t\t} else if ( elem.attachEvent ) {\n\t\t\t\t\t\telem.attachEvent( \"on\" + type, eventHandle );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif ( special.add ) {\n\t\t\t\tspecial.add.call( elem, handleObj );\n\n\t\t\t\tif ( !handleObj.handler.guid ) {\n\t\t\t\t\thandleObj.handler.guid = handler.guid;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add to the element's handler list, delegates in front\n\t\t\tif ( selector ) {\n\t\t\t\thandlers.splice( handlers.delegateCount++, 0, handleObj );\n\t\t\t} else {\n\t\t\t\thandlers.push( handleObj );\n\t\t\t}\n\n\t\t\t// Keep track of which events have ever been used, for event optimization\n\t\t\tjQuery.event.global[ type ] = true;\n\t\t}\n\n\t\t// Nullify elem to prevent memory leaks in IE\n\t\telem = null;\n\t},\n\n\t// Detach an event or set of events from an element\n\tremove: function( elem, types, handler, selector, mappedTypes ) {\n\t\tvar j, handleObj, tmp,\n\t\t\torigCount, t, events,\n\t\t\tspecial, handlers, type,\n\t\t\tnamespaces, origType,\n\t\t\telemData = jQuery.hasData( elem ) && jQuery._data( elem );\n\n\t\tif ( !elemData || !(events = elemData.events) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Once for each type.namespace in types; type may be omitted\n\t\ttypes = ( types || \"\" ).match( rnotwhite ) || [ \"\" ];\n\t\tt = types.length;\n\t\twhile ( t-- ) {\n\t\t\ttmp = rtypenamespace.exec( types[t] ) || [];\n\t\t\ttype = origType = tmp[1];\n\t\t\tnamespaces = ( tmp[2] || \"\" ).split( \".\" ).sort();\n\n\t\t\t// Unbind all events (on this namespace, if provided) for the element\n\t\t\tif ( !type ) {\n\t\t\t\tfor ( type in events ) {\n\t\t\t\t\tjQuery.event.remove( elem, type + types[ t ], handler, selector, true );\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tspecial = jQuery.event.special[ type ] || {};\n\t\t\ttype = ( selector ? special.delegateType : special.bindType ) || type;\n\t\t\thandlers = events[ type ] || [];\n\t\t\ttmp = tmp[2] && new RegExp( \"(^|\\\\.)\" + namespaces.join(\"\\\\.(?:.*\\\\.|)\") + \"(\\\\.|$)\" );\n\n\t\t\t// Remove matching events\n\t\t\torigCount = j = handlers.length;\n\t\t\twhile ( j-- ) {\n\t\t\t\thandleObj = handlers[ j ];\n\n\t\t\t\tif ( ( mappedTypes || origType === handleObj.origType ) &&\n\t\t\t\t\t( !handler || handler.guid === handleObj.guid ) &&\n\t\t\t\t\t( !tmp || tmp.test( handleObj.namespace ) ) &&\n\t\t\t\t\t( !selector || selector === handleObj.selector || selector === \"**\" && handleObj.selector ) ) {\n\t\t\t\t\thandlers.splice( j, 1 );\n\n\t\t\t\t\tif ( handleObj.selector ) {\n\t\t\t\t\t\thandlers.delegateCount--;\n\t\t\t\t\t}\n\t\t\t\t\tif ( special.remove ) {\n\t\t\t\t\t\tspecial.remove.call( elem, handleObj );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Remove generic event handler if we removed something and no more handlers exist\n\t\t\t// (avoids potential for endless recursion during removal of special event handlers)\n\t\t\tif ( origCount && !handlers.length ) {\n\t\t\t\tif ( !special.teardown || special.teardown.call( elem, namespaces, elemData.handle ) === false ) {\n\t\t\t\t\tjQuery.removeEvent( elem, type, elemData.handle );\n\t\t\t\t}\n\n\t\t\t\tdelete events[ type ];\n\t\t\t}\n\t\t}\n\n\t\t// Remove the expando if it's no longer used\n\t\tif ( jQuery.isEmptyObject( events ) ) {\n\t\t\tdelete elemData.handle;\n\n\t\t\t// removeData also checks for emptiness and clears the expando if empty\n\t\t\t// so use it instead of delete\n\t\t\tjQuery._removeData( elem, \"events\" );\n\t\t}\n\t},\n\n\ttrigger: function( event, data, elem, onlyHandlers ) {\n\t\tvar handle, ontype, cur,\n\t\t\tbubbleType, special, tmp, i,\n\t\t\teventPath = [ elem || document ],\n\t\t\ttype = hasOwn.call( event, \"type\" ) ? event.type : event,\n\t\t\tnamespaces = hasOwn.call( event, \"namespace\" ) ? event.namespace.split(\".\") : [];\n\n\t\tcur = tmp = elem = elem || document;\n\n\t\t// Don't do events on text and comment nodes\n\t\tif ( elem.nodeType === 3 || elem.nodeType === 8 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// focus/blur morphs to focusin/out; ensure we're not firing them right now\n\t\tif ( rfocusMorph.test( type + jQuery.event.triggered ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( type.indexOf(\".\") >= 0 ) {\n\t\t\t// Namespaced trigger; create a regexp to match event type in handle()\n\t\t\tnamespaces = type.split(\".\");\n\t\t\ttype = namespaces.shift();\n\t\t\tnamespaces.sort();\n\t\t}\n\t\tontype = type.indexOf(\":\") < 0 && \"on\" + type;\n\n\t\t// Caller can pass in a jQuery.Event object, Object, or just an event type string\n\t\tevent = event[ jQuery.expando ] ?\n\t\t\tevent :\n\t\t\tnew jQuery.Event( type, typeof event === \"object\" && event );\n\n\t\t// Trigger bitmask: & 1 for native handlers; & 2 for jQuery (always true)\n\t\tevent.isTrigger = onlyHandlers ? 2 : 3;\n\t\tevent.namespace = namespaces.join(\".\");\n\t\tevent.namespace_re = event.namespace ?\n\t\t\tnew RegExp( \"(^|\\\\.)\" + namespaces.join(\"\\\\.(?:.*\\\\.|)\") + \"(\\\\.|$)\" ) :\n\t\t\tnull;\n\n\t\t// Clean up the event in case it is being reused\n\t\tevent.result = undefined;\n\t\tif ( !event.target ) {\n\t\t\tevent.target = elem;\n\t\t}\n\n\t\t// Clone any incoming data and prepend the event, creating the handler arg list\n\t\tdata = data == null ?\n\t\t\t[ event ] :\n\t\t\tjQuery.makeArray( data, [ event ] );\n\n\t\t// Allow special events to draw outside the lines\n\t\tspecial = jQuery.event.special[ type ] || {};\n\t\tif ( !onlyHandlers && special.trigger && special.trigger.apply( elem, data ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine event propagation path in advance, per W3C events spec (#9951)\n\t\t// Bubble up to document, then to window; watch for a global ownerDocument var (#9724)\n\t\tif ( !onlyHandlers && !special.noBubble && !jQuery.isWindow( elem ) ) {\n\n\t\t\tbubbleType = special.delegateType || type;\n\t\t\tif ( !rfocusMorph.test( bubbleType + type ) ) {\n\t\t\t\tcur = cur.parentNode;\n\t\t\t}\n\t\t\tfor ( ; cur; cur = cur.parentNode ) {\n\t\t\t\teventPath.push( cur );\n\t\t\t\ttmp = cur;\n\t\t\t}\n\n\t\t\t// Only add window if we got to document (e.g., not plain obj or detached DOM)\n\t\t\tif ( tmp === (elem.ownerDocument || document) ) {\n\t\t\t\teventPath.push( tmp.defaultView || tmp.parentWindow || window );\n\t\t\t}\n\t\t}\n\n\t\t// Fire handlers on the event path\n\t\ti = 0;\n\t\twhile ( (cur = eventPath[i++]) && !event.isPropagationStopped() ) {\n\n\t\t\tevent.type = i > 1 ?\n\t\t\t\tbubbleType :\n\t\t\t\tspecial.bindType || type;\n\n\t\t\t// jQuery handler\n\t\t\thandle = ( jQuery._data( cur, \"events\" ) || {} )[ event.type ] && jQuery._data( cur, \"handle\" );\n\t\t\tif ( handle ) {\n\t\t\t\thandle.apply( cur, data );\n\t\t\t}\n\n\t\t\t// Native handler\n\t\t\thandle = ontype && cur[ ontype ];\n\t\t\tif ( handle && handle.apply && jQuery.acceptData( cur ) ) {\n\t\t\t\tevent.result = handle.apply( cur, data );\n\t\t\t\tif ( event.result === false ) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tevent.type = type;\n\n\t\t// If nobody prevented the default action, do it now\n\t\tif ( !onlyHandlers && !event.isDefaultPrevented() ) {\n\n\t\t\tif ( (!special._default || special._default.apply( eventPath.pop(), data ) === false) &&\n\t\t\t\tjQuery.acceptData( elem ) ) {\n\n\t\t\t\t// Call a native DOM method on the target with the same name name as the event.\n\t\t\t\t// Can't use an .isFunction() check here because IE6/7 fails that test.\n\t\t\t\t// Don't do default actions on window, that's where global variables be (#6170)\n\t\t\t\tif ( ontype && elem[ type ] && !jQuery.isWindow( elem ) ) {\n\n\t\t\t\t\t// Don't re-trigger an onFOO event when we call its FOO() method\n\t\t\t\t\ttmp = elem[ ontype ];\n\n\t\t\t\t\tif ( tmp ) {\n\t\t\t\t\t\telem[ ontype ] = null;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Prevent re-triggering of the same event, since we already bubbled it above\n\t\t\t\t\tjQuery.event.triggered = type;\n\t\t\t\t\ttry {\n\t\t\t\t\t\telem[ type ]();\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t// IE<9 dies on focus/blur to hidden element (#1486,#12518)\n\t\t\t\t\t\t// only reproducible on winXP IE8 native, not IE9 in IE8 mode\n\t\t\t\t\t}\n\t\t\t\t\tjQuery.event.triggered = undefined;\n\n\t\t\t\t\tif ( tmp ) {\n\t\t\t\t\t\telem[ ontype ] = tmp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn event.result;\n\t},\n\n\tdispatch: function( event ) {\n\n\t\t// Make a writable jQuery.Event from the native event object\n\t\tevent = jQuery.event.fix( event );\n\n\t\tvar i, ret, handleObj, matched, j,\n\t\t\thandlerQueue = [],\n\t\t\targs = slice.call( arguments ),\n\t\t\thandlers = ( jQuery._data( this, \"events\" ) || {} )[ event.type ] || [],\n\t\t\tspecial = jQuery.event.special[ event.type ] || {};\n\n\t\t// Use the fix-ed jQuery.Event rather than the (read-only) native event\n\t\targs[0] = event;\n\t\tevent.delegateTarget = this;\n\n\t\t// Call the preDispatch hook for the mapped type, and let it bail if desired\n\t\tif ( special.preDispatch && special.preDispatch.call( this, event ) === false ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Determine handlers\n\t\thandlerQueue = jQuery.event.handlers.call( this, event, handlers );\n\n\t\t// Run delegates first; they may want to stop propagation beneath us\n\t\ti = 0;\n\t\twhile ( (matched = handlerQueue[ i++ ]) && !event.isPropagationStopped() ) {\n\t\t\tevent.currentTarget = matched.elem;\n\n\t\t\tj = 0;\n\t\t\twhile ( (handleObj = matched.handlers[ j++ ]) && !event.isImmediatePropagationStopped() ) {\n\n\t\t\t\t// Triggered event must either 1) have no namespace, or\n\t\t\t\t// 2) have namespace(s) a subset or equal to those in the bound event (both can have no namespace).\n\t\t\t\tif ( !event.namespace_re || event.namespace_re.test( handleObj.namespace ) ) {\n\n\t\t\t\t\tevent.handleObj = handleObj;\n\t\t\t\t\tevent.data = handleObj.data;\n\n\t\t\t\t\tret = ( (jQuery.event.special[ handleObj.origType ] || {}).handle || handleObj.handler )\n\t\t\t\t\t\t\t.apply( matched.elem, args );\n\n\t\t\t\t\tif ( ret !== undefined ) {\n\t\t\t\t\t\tif ( (event.result = ret) === false ) {\n\t\t\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Call the postDispatch hook for the mapped type\n\t\tif ( special.postDispatch ) {\n\t\t\tspecial.postDispatch.call( this, event );\n\t\t}\n\n\t\treturn event.result;\n\t},\n\n\thandlers: function( event, handlers ) {\n\t\tvar sel, handleObj, matches, i,\n\t\t\thandlerQueue = [],\n\t\t\tdelegateCount = handlers.delegateCount,\n\t\t\tcur = event.target;\n\n\t\t// Find delegate handlers\n\t\t// Black-hole SVG <use> instance trees (#13180)\n\t\t// Avoid non-left-click bubbling in Firefox (#3861)\n\t\tif ( delegateCount && cur.nodeType && (!event.button || event.type !== \"click\") ) {\n\n\t\t\t/* jshint eqeqeq: false */\n\t\t\tfor ( ; cur != this; cur = cur.parentNode || this ) {\n\t\t\t\t/* jshint eqeqeq: true */\n\n\t\t\t\t// Don't check non-elements (#13208)\n\t\t\t\t// Don't process clicks on disabled elements (#6911, #8165, #11382, #11764)\n\t\t\t\tif ( cur.nodeType === 1 && (cur.disabled !== true || event.type !== \"click\") ) {\n\t\t\t\t\tmatches = [];\n\t\t\t\t\tfor ( i = 0; i < delegateCount; i++ ) {\n\t\t\t\t\t\thandleObj = handlers[ i ];\n\n\t\t\t\t\t\t// Don't conflict with Object.prototype properties (#13203)\n\t\t\t\t\t\tsel = handleObj.selector + \" \";\n\n\t\t\t\t\t\tif ( matches[ sel ] === undefined ) {\n\t\t\t\t\t\t\tmatches[ sel ] = handleObj.needsContext ?\n\t\t\t\t\t\t\t\tjQuery( sel, this ).index( cur ) >= 0 :\n\t\t\t\t\t\t\t\tjQuery.find( sel, this, null, [ cur ] ).length;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif ( matches[ sel ] ) {\n\t\t\t\t\t\t\tmatches.push( handleObj );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( matches.length ) {\n\t\t\t\t\t\thandlerQueue.push({ elem: cur, handlers: matches });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Add the remaining (directly-bound) handlers\n\t\tif ( delegateCount < handlers.length ) {\n\t\t\thandlerQueue.push({ elem: this, handlers: handlers.slice( delegateCount ) });\n\t\t}\n\n\t\treturn handlerQueue;\n\t},\n\n\tfix: function( event ) {\n\t\tif ( event[ jQuery.expando ] ) {\n\t\t\treturn event;\n\t\t}\n\n\t\t// Create a writable copy of the event object and normalize some properties\n\t\tvar i, prop, copy,\n\t\t\ttype = event.type,\n\t\t\toriginalEvent = event,\n\t\t\tfixHook = this.fixHooks[ type ];\n\n\t\tif ( !fixHook ) {\n\t\t\tthis.fixHooks[ type ] = fixHook =\n\t\t\t\trmouseEvent.test( type ) ? this.mouseHooks :\n\t\t\t\trkeyEvent.test( type ) ? this.keyHooks :\n\t\t\t\t{};\n\t\t}\n\t\tcopy = fixHook.props ? this.props.concat( fixHook.props ) : this.props;\n\n\t\tevent = new jQuery.Event( originalEvent );\n\n\t\ti = copy.length;\n\t\twhile ( i-- ) {\n\t\t\tprop = copy[ i ];\n\t\t\tevent[ prop ] = originalEvent[ prop ];\n\t\t}\n\n\t\t// Support: IE<9\n\t\t// Fix target property (#1925)\n\t\tif ( !event.target ) {\n\t\t\tevent.target = originalEvent.srcElement || document;\n\t\t}\n\n\t\t// Support: Chrome 23+, Safari?\n\t\t// Target should not be a text node (#504, #13143)\n\t\tif ( event.target.nodeType === 3 ) {\n\t\t\tevent.target = event.target.parentNode;\n\t\t}\n\n\t\t// Support: IE<9\n\t\t// For mouse/key events, metaKey==false if it's undefined (#3368, #11328)\n\t\tevent.metaKey = !!event.metaKey;\n\n\t\treturn fixHook.filter ? fixHook.filter( event, originalEvent ) : event;\n\t},\n\n\t// Includes some event props shared by KeyEvent and MouseEvent\n\tprops: \"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which\".split(\" \"),\n\n\tfixHooks: {},\n\n\tkeyHooks: {\n\t\tprops: \"char charCode key keyCode\".split(\" \"),\n\t\tfilter: function( event, original ) {\n\n\t\t\t// Add which for key events\n\t\t\tif ( event.which == null ) {\n\t\t\t\tevent.which = original.charCode != null ? original.charCode : original.keyCode;\n\t\t\t}\n\n\t\t\treturn event;\n\t\t}\n\t},\n\n\tmouseHooks: {\n\t\tprops: \"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement\".split(\" \"),\n\t\tfilter: function( event, original ) {\n\t\t\tvar body, eventDoc, doc,\n\t\t\t\tbutton = original.button,\n\t\t\t\tfromElement = original.fromElement;\n\n\t\t\t// Calculate pageX/Y if missing and clientX/Y available\n\t\t\tif ( event.pageX == null && original.clientX != null ) {\n\t\t\t\teventDoc = event.target.ownerDocument || document;\n\t\t\t\tdoc = eventDoc.documentElement;\n\t\t\t\tbody = eventDoc.body;\n\n\t\t\t\tevent.pageX = original.clientX + ( doc && doc.scrollLeft || body && body.scrollLeft || 0 ) - ( doc && doc.clientLeft || body && body.clientLeft || 0 );\n\t\t\t\tevent.pageY = original.clientY + ( doc && doc.scrollTop  || body && body.scrollTop  || 0 ) - ( doc && doc.clientTop  || body && body.clientTop  || 0 );\n\t\t\t}\n\n\t\t\t// Add relatedTarget, if necessary\n\t\t\tif ( !event.relatedTarget && fromElement ) {\n\t\t\t\tevent.relatedTarget = fromElement === event.target ? original.toElement : fromElement;\n\t\t\t}\n\n\t\t\t// Add which for click: 1 === left; 2 === middle; 3 === right\n\t\t\t// Note: button is not normalized, so don't use it\n\t\t\tif ( !event.which && button !== undefined ) {\n\t\t\t\tevent.which = ( button & 1 ? 1 : ( button & 2 ? 3 : ( button & 4 ? 2 : 0 ) ) );\n\t\t\t}\n\n\t\t\treturn event;\n\t\t}\n\t},\n\n\tspecial: {\n\t\tload: {\n\t\t\t// Prevent triggered image.load events from bubbling to window.load\n\t\t\tnoBubble: true\n\t\t},\n\t\tfocus: {\n\t\t\t// Fire native event if possible so blur/focus sequence is correct\n\t\t\ttrigger: function() {\n\t\t\t\tif ( this !== safeActiveElement() && this.focus ) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.focus();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t// Support: IE<9\n\t\t\t\t\t\t// If we error on focus to hidden element (#1486, #12518),\n\t\t\t\t\t\t// let .trigger() run the handlers\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelegateType: \"focusin\"\n\t\t},\n\t\tblur: {\n\t\t\ttrigger: function() {\n\t\t\t\tif ( this === safeActiveElement() && this.blur ) {\n\t\t\t\t\tthis.blur();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\t\t\tdelegateType: \"focusout\"\n\t\t},\n\t\tclick: {\n\t\t\t// For checkbox, fire native event so checked state will be right\n\t\t\ttrigger: function() {\n\t\t\t\tif ( jQuery.nodeName( this, \"input\" ) && this.type === \"checkbox\" && this.click ) {\n\t\t\t\t\tthis.click();\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\t// For cross-browser consistency, don't fire native .click() on links\n\t\t\t_default: function( event ) {\n\t\t\t\treturn jQuery.nodeName( event.target, \"a\" );\n\t\t\t}\n\t\t},\n\n\t\tbeforeunload: {\n\t\t\tpostDispatch: function( event ) {\n\n\t\t\t\t// Support: Firefox 20+\n\t\t\t\t// Firefox doesn't alert if the returnValue field is not set.\n\t\t\t\tif ( event.result !== undefined && event.originalEvent ) {\n\t\t\t\t\tevent.originalEvent.returnValue = event.result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\tsimulate: function( type, elem, event, bubble ) {\n\t\t// Piggyback on a donor event to simulate a different one.\n\t\t// Fake originalEvent to avoid donor's stopPropagation, but if the\n\t\t// simulated event prevents default then we do the same on the donor.\n\t\tvar e = jQuery.extend(\n\t\t\tnew jQuery.Event(),\n\t\t\tevent,\n\t\t\t{\n\t\t\t\ttype: type,\n\t\t\t\tisSimulated: true,\n\t\t\t\toriginalEvent: {}\n\t\t\t}\n\t\t);\n\t\tif ( bubble ) {\n\t\t\tjQuery.event.trigger( e, null, elem );\n\t\t} else {\n\t\t\tjQuery.event.dispatch.call( elem, e );\n\t\t}\n\t\tif ( e.isDefaultPrevented() ) {\n\t\t\tevent.preventDefault();\n\t\t}\n\t}\n};\n\njQuery.removeEvent = document.removeEventListener ?\n\tfunction( elem, type, handle ) {\n\t\tif ( elem.removeEventListener ) {\n\t\t\telem.removeEventListener( type, handle, false );\n\t\t}\n\t} :\n\tfunction( elem, type, handle ) {\n\t\tvar name = \"on\" + type;\n\n\t\tif ( elem.detachEvent ) {\n\n\t\t\t// #8545, #7054, preventing memory leaks for custom events in IE6-8\n\t\t\t// detachEvent needed property on element, by name of that event, to properly expose it to GC\n\t\t\tif ( typeof elem[ name ] === strundefined ) {\n\t\t\t\telem[ name ] = null;\n\t\t\t}\n\n\t\t\telem.detachEvent( name, handle );\n\t\t}\n\t};\n\njQuery.Event = function( src, props ) {\n\t// Allow instantiation without the 'new' keyword\n\tif ( !(this instanceof jQuery.Event) ) {\n\t\treturn new jQuery.Event( src, props );\n\t}\n\n\t// Event object\n\tif ( src && src.type ) {\n\t\tthis.originalEvent = src;\n\t\tthis.type = src.type;\n\n\t\t// Events bubbling up the document may have been marked as prevented\n\t\t// by a handler lower down the tree; reflect the correct value.\n\t\tthis.isDefaultPrevented = src.defaultPrevented ||\n\t\t\t\tsrc.defaultPrevented === undefined &&\n\t\t\t\t// Support: IE < 9, Android < 4.0\n\t\t\t\tsrc.returnValue === false ?\n\t\t\treturnTrue :\n\t\t\treturnFalse;\n\n\t// Event type\n\t} else {\n\t\tthis.type = src;\n\t}\n\n\t// Put explicitly provided properties onto the event object\n\tif ( props ) {\n\t\tjQuery.extend( this, props );\n\t}\n\n\t// Create a timestamp if incoming event doesn't have one\n\tthis.timeStamp = src && src.timeStamp || jQuery.now();\n\n\t// Mark it as fixed\n\tthis[ jQuery.expando ] = true;\n};\n\n// jQuery.Event is based on DOM3 Events as specified by the ECMAScript Language Binding\n// http://www.w3.org/TR/2003/WD-DOM-Level-3-Events-20030331/ecma-script-binding.html\njQuery.Event.prototype = {\n\tisDefaultPrevented: returnFalse,\n\tisPropagationStopped: returnFalse,\n\tisImmediatePropagationStopped: returnFalse,\n\n\tpreventDefault: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isDefaultPrevented = returnTrue;\n\t\tif ( !e ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// If preventDefault exists, run it on the original event\n\t\tif ( e.preventDefault ) {\n\t\t\te.preventDefault();\n\n\t\t// Support: IE\n\t\t// Otherwise set the returnValue property of the original event to false\n\t\t} else {\n\t\t\te.returnValue = false;\n\t\t}\n\t},\n\tstopPropagation: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isPropagationStopped = returnTrue;\n\t\tif ( !e ) {\n\t\t\treturn;\n\t\t}\n\t\t// If stopPropagation exists, run it on the original event\n\t\tif ( e.stopPropagation ) {\n\t\t\te.stopPropagation();\n\t\t}\n\n\t\t// Support: IE\n\t\t// Set the cancelBubble property of the original event to true\n\t\te.cancelBubble = true;\n\t},\n\tstopImmediatePropagation: function() {\n\t\tvar e = this.originalEvent;\n\n\t\tthis.isImmediatePropagationStopped = returnTrue;\n\n\t\tif ( e && e.stopImmediatePropagation ) {\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\n\t\tthis.stopPropagation();\n\t}\n};\n\n// Create mouseenter/leave events using mouseover/out and event-time checks\njQuery.each({\n\tmouseenter: \"mouseover\",\n\tmouseleave: \"mouseout\",\n\tpointerenter: \"pointerover\",\n\tpointerleave: \"pointerout\"\n}, function( orig, fix ) {\n\tjQuery.event.special[ orig ] = {\n\t\tdelegateType: fix,\n\t\tbindType: fix,\n\n\t\thandle: function( event ) {\n\t\t\tvar ret,\n\t\t\t\ttarget = this,\n\t\t\t\trelated = event.relatedTarget,\n\t\t\t\thandleObj = event.handleObj;\n\n\t\t\t// For mousenter/leave call the handler if related is outside the target.\n\t\t\t// NB: No relatedTarget if the mouse left/entered the browser window\n\t\t\tif ( !related || (related !== target && !jQuery.contains( target, related )) ) {\n\t\t\t\tevent.type = handleObj.origType;\n\t\t\t\tret = handleObj.handler.apply( this, arguments );\n\t\t\t\tevent.type = fix;\n\t\t\t}\n\t\t\treturn ret;\n\t\t}\n\t};\n});\n\n// IE submit delegation\nif ( !support.submitBubbles ) {\n\n\tjQuery.event.special.submit = {\n\t\tsetup: function() {\n\t\t\t// Only need this for delegated form submit events\n\t\t\tif ( jQuery.nodeName( this, \"form\" ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Lazy-add a submit handler when a descendant form may potentially be submitted\n\t\t\tjQuery.event.add( this, \"click._submit keypress._submit\", function( e ) {\n\t\t\t\t// Node name check avoids a VML-related crash in IE (#9807)\n\t\t\t\tvar elem = e.target,\n\t\t\t\t\tform = jQuery.nodeName( elem, \"input\" ) || jQuery.nodeName( elem, \"button\" ) ? elem.form : undefined;\n\t\t\t\tif ( form && !jQuery._data( form, \"submitBubbles\" ) ) {\n\t\t\t\t\tjQuery.event.add( form, \"submit._submit\", function( event ) {\n\t\t\t\t\t\tevent._submit_bubble = true;\n\t\t\t\t\t});\n\t\t\t\t\tjQuery._data( form, \"submitBubbles\", true );\n\t\t\t\t}\n\t\t\t});\n\t\t\t// return undefined since we don't need an event listener\n\t\t},\n\n\t\tpostDispatch: function( event ) {\n\t\t\t// If form was submitted by the user, bubble the event up the tree\n\t\t\tif ( event._submit_bubble ) {\n\t\t\t\tdelete event._submit_bubble;\n\t\t\t\tif ( this.parentNode && !event.isTrigger ) {\n\t\t\t\t\tjQuery.event.simulate( \"submit\", this.parentNode, event, true );\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tteardown: function() {\n\t\t\t// Only need this for delegated form submit events\n\t\t\tif ( jQuery.nodeName( this, \"form\" ) ) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Remove delegated handlers; cleanData eventually reaps submit handlers attached above\n\t\t\tjQuery.event.remove( this, \"._submit\" );\n\t\t}\n\t};\n}\n\n// IE change delegation and checkbox/radio fix\nif ( !support.changeBubbles ) {\n\n\tjQuery.event.special.change = {\n\n\t\tsetup: function() {\n\n\t\t\tif ( rformElems.test( this.nodeName ) ) {\n\t\t\t\t// IE doesn't fire change on a check/radio until blur; trigger it on click\n\t\t\t\t// after a propertychange. Eat the blur-change in special.change.handle.\n\t\t\t\t// This still fires onchange a second time for check/radio after blur.\n\t\t\t\tif ( this.type === \"checkbox\" || this.type === \"radio\" ) {\n\t\t\t\t\tjQuery.event.add( this, \"propertychange._change\", function( event ) {\n\t\t\t\t\t\tif ( event.originalEvent.propertyName === \"checked\" ) {\n\t\t\t\t\t\t\tthis._just_changed = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tjQuery.event.add( this, \"click._change\", function( event ) {\n\t\t\t\t\t\tif ( this._just_changed && !event.isTrigger ) {\n\t\t\t\t\t\t\tthis._just_changed = false;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Allow triggered, simulated change events (#11500)\n\t\t\t\t\t\tjQuery.event.simulate( \"change\", this, event, true );\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t// Delegated event; lazy-add a change handler on descendant inputs\n\t\t\tjQuery.event.add( this, \"beforeactivate._change\", function( e ) {\n\t\t\t\tvar elem = e.target;\n\n\t\t\t\tif ( rformElems.test( elem.nodeName ) && !jQuery._data( elem, \"changeBubbles\" ) ) {\n\t\t\t\t\tjQuery.event.add( elem, \"change._change\", function( event ) {\n\t\t\t\t\t\tif ( this.parentNode && !event.isSimulated && !event.isTrigger ) {\n\t\t\t\t\t\t\tjQuery.event.simulate( \"change\", this.parentNode, event, true );\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tjQuery._data( elem, \"changeBubbles\", true );\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\thandle: function( event ) {\n\t\t\tvar elem = event.target;\n\n\t\t\t// Swallow native change events from checkbox/radio, we already triggered them above\n\t\t\tif ( this !== elem || event.isSimulated || event.isTrigger || (elem.type !== \"radio\" && elem.type !== \"checkbox\") ) {\n\t\t\t\treturn event.handleObj.handler.apply( this, arguments );\n\t\t\t}\n\t\t},\n\n\t\tteardown: function() {\n\t\t\tjQuery.event.remove( this, \"._change\" );\n\n\t\t\treturn !rformElems.test( this.nodeName );\n\t\t}\n\t};\n}\n\n// Create \"bubbling\" focus and blur events\nif ( !support.focusinBubbles ) {\n\tjQuery.each({ focus: \"focusin\", blur: \"focusout\" }, function( orig, fix ) {\n\n\t\t// Attach a single capturing handler on the document while someone wants focusin/focusout\n\t\tvar handler = function( event ) {\n\t\t\t\tjQuery.event.simulate( fix, event.target, jQuery.event.fix( event ), true );\n\t\t\t};\n\n\t\tjQuery.event.special[ fix ] = {\n\t\t\tsetup: function() {\n\t\t\t\tvar doc = this.ownerDocument || this,\n\t\t\t\t\tattaches = jQuery._data( doc, fix );\n\n\t\t\t\tif ( !attaches ) {\n\t\t\t\t\tdoc.addEventListener( orig, handler, true );\n\t\t\t\t}\n\t\t\t\tjQuery._data( doc, fix, ( attaches || 0 ) + 1 );\n\t\t\t},\n\t\t\tteardown: function() {\n\t\t\t\tvar doc = this.ownerDocument || this,\n\t\t\t\t\tattaches = jQuery._data( doc, fix ) - 1;\n\n\t\t\t\tif ( !attaches ) {\n\t\t\t\t\tdoc.removeEventListener( orig, handler, true );\n\t\t\t\t\tjQuery._removeData( doc, fix );\n\t\t\t\t} else {\n\t\t\t\t\tjQuery._data( doc, fix, attaches );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t});\n}\n\njQuery.fn.extend({\n\n\ton: function( types, selector, data, fn, /*INTERNAL*/ one ) {\n\t\tvar type, origFn;\n\n\t\t// Types can be a map of types/handlers\n\t\tif ( typeof types === \"object\" ) {\n\t\t\t// ( types-Object, selector, data )\n\t\t\tif ( typeof selector !== \"string\" ) {\n\t\t\t\t// ( types-Object, data )\n\t\t\t\tdata = data || selector;\n\t\t\t\tselector = undefined;\n\t\t\t}\n\t\t\tfor ( type in types ) {\n\t\t\t\tthis.on( type, selector, data, types[ type ], one );\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\n\t\tif ( data == null && fn == null ) {\n\t\t\t// ( types, fn )\n\t\t\tfn = selector;\n\t\t\tdata = selector = undefined;\n\t\t} else if ( fn == null ) {\n\t\t\tif ( typeof selector === \"string\" ) {\n\t\t\t\t// ( types, selector, fn )\n\t\t\t\tfn = data;\n\t\t\t\tdata = undefined;\n\t\t\t} else {\n\t\t\t\t// ( types, data, fn )\n\t\t\t\tfn = data;\n\t\t\t\tdata = selector;\n\t\t\t\tselector = undefined;\n\t\t\t}\n\t\t}\n\t\tif ( fn === false ) {\n\t\t\tfn = returnFalse;\n\t\t} else if ( !fn ) {\n\t\t\treturn this;\n\t\t}\n\n\t\tif ( one === 1 ) {\n\t\t\torigFn = fn;\n\t\t\tfn = function( event ) {\n\t\t\t\t// Can use an empty set, since event contains the info\n\t\t\t\tjQuery().off( event );\n\t\t\t\treturn origFn.apply( this, arguments );\n\t\t\t};\n\t\t\t// Use same guid so caller can remove using origFn\n\t\t\tfn.guid = origFn.guid || ( origFn.guid = jQuery.guid++ );\n\t\t}\n\t\treturn this.each( function() {\n\t\t\tjQuery.event.add( this, types, fn, data, selector );\n\t\t});\n\t},\n\tone: function( types, selector, data, fn ) {\n\t\treturn this.on( types, selector, data, fn, 1 );\n\t},\n\toff: function( types, selector, fn ) {\n\t\tvar handleObj, type;\n\t\tif ( types && types.preventDefault && types.handleObj ) {\n\t\t\t// ( event )  dispatched jQuery.Event\n\t\t\thandleObj = types.handleObj;\n\t\t\tjQuery( types.delegateTarget ).off(\n\t\t\t\thandleObj.namespace ? handleObj.origType + \".\" + handleObj.namespace : handleObj.origType,\n\t\t\t\thandleObj.selector,\n\t\t\t\thandleObj.handler\n\t\t\t);\n\t\t\treturn this;\n\t\t}\n\t\tif ( typeof types === \"object\" ) {\n\t\t\t// ( types-object [, selector] )\n\t\t\tfor ( type in types ) {\n\t\t\t\tthis.off( type, selector, types[ type ] );\n\t\t\t}\n\t\t\treturn this;\n\t\t}\n\t\tif ( selector === false || typeof selector === \"function\" ) {\n\t\t\t// ( types [, fn] )\n\t\t\tfn = selector;\n\t\t\tselector = undefined;\n\t\t}\n\t\tif ( fn === false ) {\n\t\t\tfn = returnFalse;\n\t\t}\n\t\treturn this.each(function() {\n\t\t\tjQuery.event.remove( this, types, fn, selector );\n\t\t});\n\t},\n\n\ttrigger: function( type, data ) {\n\t\treturn this.each(function() {\n\t\t\tjQuery.event.trigger( type, data, this );\n\t\t});\n\t},\n\ttriggerHandler: function( type, data ) {\n\t\tvar elem = this[0];\n\t\tif ( elem ) {\n\t\t\treturn jQuery.event.trigger( type, data, elem, true );\n\t\t}\n\t}\n});\n\n\nfunction createSafeFragment( document ) {\n\tvar list = nodeNames.split( \"|\" ),\n\t\tsafeFrag = document.createDocumentFragment();\n\n\tif ( safeFrag.createElement ) {\n\t\twhile ( list.length ) {\n\t\t\tsafeFrag.createElement(\n\t\t\t\tlist.pop()\n\t\t\t);\n\t\t}\n\t}\n\treturn safeFrag;\n}\n\nvar nodeNames = \"abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|\" +\n\t\t\"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video\",\n\trinlinejQuery = / jQuery\\d+=\"(?:null|\\d+)\"/g,\n\trnoshimcache = new RegExp(\"<(?:\" + nodeNames + \")[\\\\s/>]\", \"i\"),\n\trleadingWhitespace = /^\\s+/,\n\trxhtmlTag = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\\w:]+)[^>]*)\\/>/gi,\n\trtagName = /<([\\w:]+)/,\n\trtbody = /<tbody/i,\n\trhtml = /<|&#?\\w+;/,\n\trnoInnerhtml = /<(?:script|style|link)/i,\n\t// checked=\"checked\" or checked\n\trchecked = /checked\\s*(?:[^=]|=\\s*.checked.)/i,\n\trscriptType = /^$|\\/(?:java|ecma)script/i,\n\trscriptTypeMasked = /^true\\/(.*)/,\n\trcleanScript = /^\\s*<!(?:\\[CDATA\\[|--)|(?:\\]\\]|--)>\\s*$/g,\n\n\t// We have to close these tags to support XHTML (#13200)\n\twrapMap = {\n\t\toption: [ 1, \"<select multiple='multiple'>\", \"</select>\" ],\n\t\tlegend: [ 1, \"<fieldset>\", \"</fieldset>\" ],\n\t\tarea: [ 1, \"<map>\", \"</map>\" ],\n\t\tparam: [ 1, \"<object>\", \"</object>\" ],\n\t\tthead: [ 1, \"<table>\", \"</table>\" ],\n\t\ttr: [ 2, \"<table><tbody>\", \"</tbody></table>\" ],\n\t\tcol: [ 2, \"<table><tbody></tbody><colgroup>\", \"</colgroup></table>\" ],\n\t\ttd: [ 3, \"<table><tbody><tr>\", \"</tr></tbody></table>\" ],\n\n\t\t// IE6-8 can't serialize link, script, style, or any html5 (NoScope) tags,\n\t\t// unless wrapped in a div with non-breaking characters in front of it.\n\t\t_default: support.htmlSerialize ? [ 0, \"\", \"\" ] : [ 1, \"X<div>\", \"</div>\"  ]\n\t},\n\tsafeFragment = createSafeFragment( document ),\n\tfragmentDiv = safeFragment.appendChild( document.createElement(\"div\") );\n\nwrapMap.optgroup = wrapMap.option;\nwrapMap.tbody = wrapMap.tfoot = wrapMap.colgroup = wrapMap.caption = wrapMap.thead;\nwrapMap.th = wrapMap.td;\n\nfunction getAll( context, tag ) {\n\tvar elems, elem,\n\t\ti = 0,\n\t\tfound = typeof context.getElementsByTagName !== strundefined ? context.getElementsByTagName( tag || \"*\" ) :\n\t\t\ttypeof context.querySelectorAll !== strundefined ? context.querySelectorAll( tag || \"*\" ) :\n\t\t\tundefined;\n\n\tif ( !found ) {\n\t\tfor ( found = [], elems = context.childNodes || context; (elem = elems[i]) != null; i++ ) {\n\t\t\tif ( !tag || jQuery.nodeName( elem, tag ) ) {\n\t\t\t\tfound.push( elem );\n\t\t\t} else {\n\t\t\t\tjQuery.merge( found, getAll( elem, tag ) );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn tag === undefined || tag && jQuery.nodeName( context, tag ) ?\n\t\tjQuery.merge( [ context ], found ) :\n\t\tfound;\n}\n\n// Used in buildFragment, fixes the defaultChecked property\nfunction fixDefaultChecked( elem ) {\n\tif ( rcheckableType.test( elem.type ) ) {\n\t\telem.defaultChecked = elem.checked;\n\t}\n}\n\n// Support: IE<8\n// Manipulating tables requires a tbody\nfunction manipulationTarget( elem, content ) {\n\treturn jQuery.nodeName( elem, \"table\" ) &&\n\t\tjQuery.nodeName( content.nodeType !== 11 ? content : content.firstChild, \"tr\" ) ?\n\n\t\telem.getElementsByTagName(\"tbody\")[0] ||\n\t\t\telem.appendChild( elem.ownerDocument.createElement(\"tbody\") ) :\n\t\telem;\n}\n\n// Replace/restore the type attribute of script elements for safe DOM manipulation\nfunction disableScript( elem ) {\n\telem.type = (jQuery.find.attr( elem, \"type\" ) !== null) + \"/\" + elem.type;\n\treturn elem;\n}\nfunction restoreScript( elem ) {\n\tvar match = rscriptTypeMasked.exec( elem.type );\n\tif ( match ) {\n\t\telem.type = match[1];\n\t} else {\n\t\telem.removeAttribute(\"type\");\n\t}\n\treturn elem;\n}\n\n// Mark scripts as having already been evaluated\nfunction setGlobalEval( elems, refElements ) {\n\tvar elem,\n\t\ti = 0;\n\tfor ( ; (elem = elems[i]) != null; i++ ) {\n\t\tjQuery._data( elem, \"globalEval\", !refElements || jQuery._data( refElements[i], \"globalEval\" ) );\n\t}\n}\n\nfunction cloneCopyEvent( src, dest ) {\n\n\tif ( dest.nodeType !== 1 || !jQuery.hasData( src ) ) {\n\t\treturn;\n\t}\n\n\tvar type, i, l,\n\t\toldData = jQuery._data( src ),\n\t\tcurData = jQuery._data( dest, oldData ),\n\t\tevents = oldData.events;\n\n\tif ( events ) {\n\t\tdelete curData.handle;\n\t\tcurData.events = {};\n\n\t\tfor ( type in events ) {\n\t\t\tfor ( i = 0, l = events[ type ].length; i < l; i++ ) {\n\t\t\t\tjQuery.event.add( dest, type, events[ type ][ i ] );\n\t\t\t}\n\t\t}\n\t}\n\n\t// make the cloned public data object a copy from the original\n\tif ( curData.data ) {\n\t\tcurData.data = jQuery.extend( {}, curData.data );\n\t}\n}\n\nfunction fixCloneNodeIssues( src, dest ) {\n\tvar nodeName, e, data;\n\n\t// We do not need to do anything for non-Elements\n\tif ( dest.nodeType !== 1 ) {\n\t\treturn;\n\t}\n\n\tnodeName = dest.nodeName.toLowerCase();\n\n\t// IE6-8 copies events bound via attachEvent when using cloneNode.\n\tif ( !support.noCloneEvent && dest[ jQuery.expando ] ) {\n\t\tdata = jQuery._data( dest );\n\n\t\tfor ( e in data.events ) {\n\t\t\tjQuery.removeEvent( dest, e, data.handle );\n\t\t}\n\n\t\t// Event data gets referenced instead of copied if the expando gets copied too\n\t\tdest.removeAttribute( jQuery.expando );\n\t}\n\n\t// IE blanks contents when cloning scripts, and tries to evaluate newly-set text\n\tif ( nodeName === \"script\" && dest.text !== src.text ) {\n\t\tdisableScript( dest ).text = src.text;\n\t\trestoreScript( dest );\n\n\t// IE6-10 improperly clones children of object elements using classid.\n\t// IE10 throws NoModificationAllowedError if parent is null, #12132.\n\t} else if ( nodeName === \"object\" ) {\n\t\tif ( dest.parentNode ) {\n\t\t\tdest.outerHTML = src.outerHTML;\n\t\t}\n\n\t\t// This path appears unavoidable for IE9. When cloning an object\n\t\t// element in IE9, the outerHTML strategy above is not sufficient.\n\t\t// If the src has innerHTML and the destination does not,\n\t\t// copy the src.innerHTML into the dest.innerHTML. #10324\n\t\tif ( support.html5Clone && ( src.innerHTML && !jQuery.trim(dest.innerHTML) ) ) {\n\t\t\tdest.innerHTML = src.innerHTML;\n\t\t}\n\n\t} else if ( nodeName === \"input\" && rcheckableType.test( src.type ) ) {\n\t\t// IE6-8 fails to persist the checked state of a cloned checkbox\n\t\t// or radio button. Worse, IE6-7 fail to give the cloned element\n\t\t// a checked appearance if the defaultChecked value isn't also set\n\n\t\tdest.defaultChecked = dest.checked = src.checked;\n\n\t\t// IE6-7 get confused and end up setting the value of a cloned\n\t\t// checkbox/radio button to an empty string instead of \"on\"\n\t\tif ( dest.value !== src.value ) {\n\t\t\tdest.value = src.value;\n\t\t}\n\n\t// IE6-8 fails to return the selected option to the default selected\n\t// state when cloning options\n\t} else if ( nodeName === \"option\" ) {\n\t\tdest.defaultSelected = dest.selected = src.defaultSelected;\n\n\t// IE6-8 fails to set the defaultValue to the correct value when\n\t// cloning other types of input fields\n\t} else if ( nodeName === \"input\" || nodeName === \"textarea\" ) {\n\t\tdest.defaultValue = src.defaultValue;\n\t}\n}\n\njQuery.extend({\n\tclone: function( elem, dataAndEvents, deepDataAndEvents ) {\n\t\tvar destElements, node, clone, i, srcElements,\n\t\t\tinPage = jQuery.contains( elem.ownerDocument, elem );\n\n\t\tif ( support.html5Clone || jQuery.isXMLDoc(elem) || !rnoshimcache.test( \"<\" + elem.nodeName + \">\" ) ) {\n\t\t\tclone = elem.cloneNode( true );\n\n\t\t// IE<=8 does not properly clone detached, unknown element nodes\n\t\t} else {\n\t\t\tfragmentDiv.innerHTML = elem.outerHTML;\n\t\t\tfragmentDiv.removeChild( clone = fragmentDiv.firstChild );\n\t\t}\n\n\t\tif ( (!support.noCloneEvent || !support.noCloneChecked) &&\n\t\t\t\t(elem.nodeType === 1 || elem.nodeType === 11) && !jQuery.isXMLDoc(elem) ) {\n\n\t\t\t// We eschew Sizzle here for performance reasons: http://jsperf.com/getall-vs-sizzle/2\n\t\t\tdestElements = getAll( clone );\n\t\t\tsrcElements = getAll( elem );\n\n\t\t\t// Fix all IE cloning issues\n\t\t\tfor ( i = 0; (node = srcElements[i]) != null; ++i ) {\n\t\t\t\t// Ensure that the destination node is not null; Fixes #9587\n\t\t\t\tif ( destElements[i] ) {\n\t\t\t\t\tfixCloneNodeIssues( node, destElements[i] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Copy the events from the original to the clone\n\t\tif ( dataAndEvents ) {\n\t\t\tif ( deepDataAndEvents ) {\n\t\t\t\tsrcElements = srcElements || getAll( elem );\n\t\t\t\tdestElements = destElements || getAll( clone );\n\n\t\t\t\tfor ( i = 0; (node = srcElements[i]) != null; i++ ) {\n\t\t\t\t\tcloneCopyEvent( node, destElements[i] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tcloneCopyEvent( elem, clone );\n\t\t\t}\n\t\t}\n\n\t\t// Preserve script evaluation history\n\t\tdestElements = getAll( clone, \"script\" );\n\t\tif ( destElements.length > 0 ) {\n\t\t\tsetGlobalEval( destElements, !inPage && getAll( elem, \"script\" ) );\n\t\t}\n\n\t\tdestElements = srcElements = node = null;\n\n\t\t// Return the cloned set\n\t\treturn clone;\n\t},\n\n\tbuildFragment: function( elems, context, scripts, selection ) {\n\t\tvar j, elem, contains,\n\t\t\ttmp, tag, tbody, wrap,\n\t\t\tl = elems.length,\n\n\t\t\t// Ensure a safe fragment\n\t\t\tsafe = createSafeFragment( context ),\n\n\t\t\tnodes = [],\n\t\t\ti = 0;\n\n\t\tfor ( ; i < l; i++ ) {\n\t\t\telem = elems[ i ];\n\n\t\t\tif ( elem || elem === 0 ) {\n\n\t\t\t\t// Add nodes directly\n\t\t\t\tif ( jQuery.type( elem ) === \"object\" ) {\n\t\t\t\t\tjQuery.merge( nodes, elem.nodeType ? [ elem ] : elem );\n\n\t\t\t\t// Convert non-html into a text node\n\t\t\t\t} else if ( !rhtml.test( elem ) ) {\n\t\t\t\t\tnodes.push( context.createTextNode( elem ) );\n\n\t\t\t\t// Convert html into DOM nodes\n\t\t\t\t} else {\n\t\t\t\t\ttmp = tmp || safe.appendChild( context.createElement(\"div\") );\n\n\t\t\t\t\t// Deserialize a standard representation\n\t\t\t\t\ttag = (rtagName.exec( elem ) || [ \"\", \"\" ])[ 1 ].toLowerCase();\n\t\t\t\t\twrap = wrapMap[ tag ] || wrapMap._default;\n\n\t\t\t\t\ttmp.innerHTML = wrap[1] + elem.replace( rxhtmlTag, \"<$1></$2>\" ) + wrap[2];\n\n\t\t\t\t\t// Descend through wrappers to the right content\n\t\t\t\t\tj = wrap[0];\n\t\t\t\t\twhile ( j-- ) {\n\t\t\t\t\t\ttmp = tmp.lastChild;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Manually add leading whitespace removed by IE\n\t\t\t\t\tif ( !support.leadingWhitespace && rleadingWhitespace.test( elem ) ) {\n\t\t\t\t\t\tnodes.push( context.createTextNode( rleadingWhitespace.exec( elem )[0] ) );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove IE's autoinserted <tbody> from table fragments\n\t\t\t\t\tif ( !support.tbody ) {\n\n\t\t\t\t\t\t// String was a <table>, *may* have spurious <tbody>\n\t\t\t\t\t\telem = tag === \"table\" && !rtbody.test( elem ) ?\n\t\t\t\t\t\t\ttmp.firstChild :\n\n\t\t\t\t\t\t\t// String was a bare <thead> or <tfoot>\n\t\t\t\t\t\t\twrap[1] === \"<table>\" && !rtbody.test( elem ) ?\n\t\t\t\t\t\t\t\ttmp :\n\t\t\t\t\t\t\t\t0;\n\n\t\t\t\t\t\tj = elem && elem.childNodes.length;\n\t\t\t\t\t\twhile ( j-- ) {\n\t\t\t\t\t\t\tif ( jQuery.nodeName( (tbody = elem.childNodes[j]), \"tbody\" ) && !tbody.childNodes.length ) {\n\t\t\t\t\t\t\t\telem.removeChild( tbody );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tjQuery.merge( nodes, tmp.childNodes );\n\n\t\t\t\t\t// Fix #12392 for WebKit and IE > 9\n\t\t\t\t\ttmp.textContent = \"\";\n\n\t\t\t\t\t// Fix #12392 for oldIE\n\t\t\t\t\twhile ( tmp.firstChild ) {\n\t\t\t\t\t\ttmp.removeChild( tmp.firstChild );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remember the top-level container for proper cleanup\n\t\t\t\t\ttmp = safe.lastChild;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Fix #11356: Clear elements from fragment\n\t\tif ( tmp ) {\n\t\t\tsafe.removeChild( tmp );\n\t\t}\n\n\t\t// Reset defaultChecked for any radios and checkboxes\n\t\t// about to be appended to the DOM in IE 6/7 (#8060)\n\t\tif ( !support.appendChecked ) {\n\t\t\tjQuery.grep( getAll( nodes, \"input\" ), fixDefaultChecked );\n\t\t}\n\n\t\ti = 0;\n\t\twhile ( (elem = nodes[ i++ ]) ) {\n\n\t\t\t// #4087 - If origin and destination elements are the same, and this is\n\t\t\t// that element, do not do anything\n\t\t\tif ( selection && jQuery.inArray( elem, selection ) !== -1 ) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tcontains = jQuery.contains( elem.ownerDocument, elem );\n\n\t\t\t// Append to fragment\n\t\t\ttmp = getAll( safe.appendChild( elem ), \"script\" );\n\n\t\t\t// Preserve script evaluation history\n\t\t\tif ( contains ) {\n\t\t\t\tsetGlobalEval( tmp );\n\t\t\t}\n\n\t\t\t// Capture executables\n\t\t\tif ( scripts ) {\n\t\t\t\tj = 0;\n\t\t\t\twhile ( (elem = tmp[ j++ ]) ) {\n\t\t\t\t\tif ( rscriptType.test( elem.type || \"\" ) ) {\n\t\t\t\t\t\tscripts.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ttmp = null;\n\n\t\treturn safe;\n\t},\n\n\tcleanData: function( elems, /* internal */ acceptData ) {\n\t\tvar elem, type, id, data,\n\t\t\ti = 0,\n\t\t\tinternalKey = jQuery.expando,\n\t\t\tcache = jQuery.cache,\n\t\t\tdeleteExpando = support.deleteExpando,\n\t\t\tspecial = jQuery.event.special;\n\n\t\tfor ( ; (elem = elems[i]) != null; i++ ) {\n\t\t\tif ( acceptData || jQuery.acceptData( elem ) ) {\n\n\t\t\t\tid = elem[ internalKey ];\n\t\t\t\tdata = id && cache[ id ];\n\n\t\t\t\tif ( data ) {\n\t\t\t\t\tif ( data.events ) {\n\t\t\t\t\t\tfor ( type in data.events ) {\n\t\t\t\t\t\t\tif ( special[ type ] ) {\n\t\t\t\t\t\t\t\tjQuery.event.remove( elem, type );\n\n\t\t\t\t\t\t\t// This is a shortcut to avoid jQuery.event.remove's overhead\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tjQuery.removeEvent( elem, type, data.handle );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Remove cache only if it was not already removed by jQuery.event.remove\n\t\t\t\t\tif ( cache[ id ] ) {\n\n\t\t\t\t\t\tdelete cache[ id ];\n\n\t\t\t\t\t\t// IE does not allow us to delete expando properties from nodes,\n\t\t\t\t\t\t// nor does it have a removeAttribute function on Document nodes;\n\t\t\t\t\t\t// we must handle all of these cases\n\t\t\t\t\t\tif ( deleteExpando ) {\n\t\t\t\t\t\t\tdelete elem[ internalKey ];\n\n\t\t\t\t\t\t} else if ( typeof elem.removeAttribute !== strundefined ) {\n\t\t\t\t\t\t\telem.removeAttribute( internalKey );\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\telem[ internalKey ] = null;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdeletedIds.push( id );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\njQuery.fn.extend({\n\ttext: function( value ) {\n\t\treturn access( this, function( value ) {\n\t\t\treturn value === undefined ?\n\t\t\t\tjQuery.text( this ) :\n\t\t\t\tthis.empty().append( ( this[0] && this[0].ownerDocument || document ).createTextNode( value ) );\n\t\t}, null, value, arguments.length );\n\t},\n\n\tappend: function() {\n\t\treturn this.domManip( arguments, function( elem ) {\n\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n\t\t\t\tvar target = manipulationTarget( this, elem );\n\t\t\t\ttarget.appendChild( elem );\n\t\t\t}\n\t\t});\n\t},\n\n\tprepend: function() {\n\t\treturn this.domManip( arguments, function( elem ) {\n\t\t\tif ( this.nodeType === 1 || this.nodeType === 11 || this.nodeType === 9 ) {\n\t\t\t\tvar target = manipulationTarget( this, elem );\n\t\t\t\ttarget.insertBefore( elem, target.firstChild );\n\t\t\t}\n\t\t});\n\t},\n\n\tbefore: function() {\n\t\treturn this.domManip( arguments, function( elem ) {\n\t\t\tif ( this.parentNode ) {\n\t\t\t\tthis.parentNode.insertBefore( elem, this );\n\t\t\t}\n\t\t});\n\t},\n\n\tafter: function() {\n\t\treturn this.domManip( arguments, function( elem ) {\n\t\t\tif ( this.parentNode ) {\n\t\t\t\tthis.parentNode.insertBefore( elem, this.nextSibling );\n\t\t\t}\n\t\t});\n\t},\n\n\tremove: function( selector, keepData /* Internal Use Only */ ) {\n\t\tvar elem,\n\t\t\telems = selector ? jQuery.filter( selector, this ) : this,\n\t\t\ti = 0;\n\n\t\tfor ( ; (elem = elems[i]) != null; i++ ) {\n\n\t\t\tif ( !keepData && elem.nodeType === 1 ) {\n\t\t\t\tjQuery.cleanData( getAll( elem ) );\n\t\t\t}\n\n\t\t\tif ( elem.parentNode ) {\n\t\t\t\tif ( keepData && jQuery.contains( elem.ownerDocument, elem ) ) {\n\t\t\t\t\tsetGlobalEval( getAll( elem, \"script\" ) );\n\t\t\t\t}\n\t\t\t\telem.parentNode.removeChild( elem );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tempty: function() {\n\t\tvar elem,\n\t\t\ti = 0;\n\n\t\tfor ( ; (elem = this[i]) != null; i++ ) {\n\t\t\t// Remove element nodes and prevent memory leaks\n\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\n\t\t\t}\n\n\t\t\t// Remove any remaining nodes\n\t\t\twhile ( elem.firstChild ) {\n\t\t\t\telem.removeChild( elem.firstChild );\n\t\t\t}\n\n\t\t\t// If this is a select, ensure that it displays empty (#12336)\n\t\t\t// Support: IE<9\n\t\t\tif ( elem.options && jQuery.nodeName( elem, \"select\" ) ) {\n\t\t\t\telem.options.length = 0;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tclone: function( dataAndEvents, deepDataAndEvents ) {\n\t\tdataAndEvents = dataAndEvents == null ? false : dataAndEvents;\n\t\tdeepDataAndEvents = deepDataAndEvents == null ? dataAndEvents : deepDataAndEvents;\n\n\t\treturn this.map(function() {\n\t\t\treturn jQuery.clone( this, dataAndEvents, deepDataAndEvents );\n\t\t});\n\t},\n\n\thtml: function( value ) {\n\t\treturn access( this, function( value ) {\n\t\t\tvar elem = this[ 0 ] || {},\n\t\t\t\ti = 0,\n\t\t\t\tl = this.length;\n\n\t\t\tif ( value === undefined ) {\n\t\t\t\treturn elem.nodeType === 1 ?\n\t\t\t\t\telem.innerHTML.replace( rinlinejQuery, \"\" ) :\n\t\t\t\t\tundefined;\n\t\t\t}\n\n\t\t\t// See if we can take a shortcut and just use innerHTML\n\t\t\tif ( typeof value === \"string\" && !rnoInnerhtml.test( value ) &&\n\t\t\t\t( support.htmlSerialize || !rnoshimcache.test( value )  ) &&\n\t\t\t\t( support.leadingWhitespace || !rleadingWhitespace.test( value ) ) &&\n\t\t\t\t!wrapMap[ (rtagName.exec( value ) || [ \"\", \"\" ])[ 1 ].toLowerCase() ] ) {\n\n\t\t\t\tvalue = value.replace( rxhtmlTag, \"<$1></$2>\" );\n\n\t\t\t\ttry {\n\t\t\t\t\tfor (; i < l; i++ ) {\n\t\t\t\t\t\t// Remove element nodes and prevent memory leaks\n\t\t\t\t\t\telem = this[i] || {};\n\t\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\t\tjQuery.cleanData( getAll( elem, false ) );\n\t\t\t\t\t\t\telem.innerHTML = value;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\telem = 0;\n\n\t\t\t\t// If using innerHTML throws an exception, use the fallback method\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\n\t\t\tif ( elem ) {\n\t\t\t\tthis.empty().append( value );\n\t\t\t}\n\t\t}, null, value, arguments.length );\n\t},\n\n\treplaceWith: function() {\n\t\tvar arg = arguments[ 0 ];\n\n\t\t// Make the changes, replacing each context element with the new content\n\t\tthis.domManip( arguments, function( elem ) {\n\t\t\targ = this.parentNode;\n\n\t\t\tjQuery.cleanData( getAll( this ) );\n\n\t\t\tif ( arg ) {\n\t\t\t\targ.replaceChild( elem, this );\n\t\t\t}\n\t\t});\n\n\t\t// Force removal if there was no new content (e.g., from empty arguments)\n\t\treturn arg && (arg.length || arg.nodeType) ? this : this.remove();\n\t},\n\n\tdetach: function( selector ) {\n\t\treturn this.remove( selector, true );\n\t},\n\n\tdomManip: function( args, callback ) {\n\n\t\t// Flatten any nested arrays\n\t\targs = concat.apply( [], args );\n\n\t\tvar first, node, hasScripts,\n\t\t\tscripts, doc, fragment,\n\t\t\ti = 0,\n\t\t\tl = this.length,\n\t\t\tset = this,\n\t\t\tiNoClone = l - 1,\n\t\t\tvalue = args[0],\n\t\t\tisFunction = jQuery.isFunction( value );\n\n\t\t// We can't cloneNode fragments that contain checked, in WebKit\n\t\tif ( isFunction ||\n\t\t\t\t( l > 1 && typeof value === \"string\" &&\n\t\t\t\t\t!support.checkClone && rchecked.test( value ) ) ) {\n\t\t\treturn this.each(function( index ) {\n\t\t\t\tvar self = set.eq( index );\n\t\t\t\tif ( isFunction ) {\n\t\t\t\t\targs[0] = value.call( this, index, self.html() );\n\t\t\t\t}\n\t\t\t\tself.domManip( args, callback );\n\t\t\t});\n\t\t}\n\n\t\tif ( l ) {\n\t\t\tfragment = jQuery.buildFragment( args, this[ 0 ].ownerDocument, false, this );\n\t\t\tfirst = fragment.firstChild;\n\n\t\t\tif ( fragment.childNodes.length === 1 ) {\n\t\t\t\tfragment = first;\n\t\t\t}\n\n\t\t\tif ( first ) {\n\t\t\t\tscripts = jQuery.map( getAll( fragment, \"script\" ), disableScript );\n\t\t\t\thasScripts = scripts.length;\n\n\t\t\t\t// Use the original fragment for the last item instead of the first because it can end up\n\t\t\t\t// being emptied incorrectly in certain situations (#8070).\n\t\t\t\tfor ( ; i < l; i++ ) {\n\t\t\t\t\tnode = fragment;\n\n\t\t\t\t\tif ( i !== iNoClone ) {\n\t\t\t\t\t\tnode = jQuery.clone( node, true, true );\n\n\t\t\t\t\t\t// Keep references to cloned scripts for later restoration\n\t\t\t\t\t\tif ( hasScripts ) {\n\t\t\t\t\t\t\tjQuery.merge( scripts, getAll( node, \"script\" ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tcallback.call( this[i], node, i );\n\t\t\t\t}\n\n\t\t\t\tif ( hasScripts ) {\n\t\t\t\t\tdoc = scripts[ scripts.length - 1 ].ownerDocument;\n\n\t\t\t\t\t// Reenable scripts\n\t\t\t\t\tjQuery.map( scripts, restoreScript );\n\n\t\t\t\t\t// Evaluate executable scripts on first document insertion\n\t\t\t\t\tfor ( i = 0; i < hasScripts; i++ ) {\n\t\t\t\t\t\tnode = scripts[ i ];\n\t\t\t\t\t\tif ( rscriptType.test( node.type || \"\" ) &&\n\t\t\t\t\t\t\t!jQuery._data( node, \"globalEval\" ) && jQuery.contains( doc, node ) ) {\n\n\t\t\t\t\t\t\tif ( node.src ) {\n\t\t\t\t\t\t\t\t// Optional AJAX dependency, but won't run scripts if not present\n\t\t\t\t\t\t\t\tif ( jQuery._evalUrl ) {\n\t\t\t\t\t\t\t\t\tjQuery._evalUrl( node.src );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tjQuery.globalEval( ( node.text || node.textContent || node.innerHTML || \"\" ).replace( rcleanScript, \"\" ) );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Fix #11809: Avoid leaking memory\n\t\t\t\tfragment = first = null;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n});\n\njQuery.each({\n\tappendTo: \"append\",\n\tprependTo: \"prepend\",\n\tinsertBefore: \"before\",\n\tinsertAfter: \"after\",\n\treplaceAll: \"replaceWith\"\n}, function( name, original ) {\n\tjQuery.fn[ name ] = function( selector ) {\n\t\tvar elems,\n\t\t\ti = 0,\n\t\t\tret = [],\n\t\t\tinsert = jQuery( selector ),\n\t\t\tlast = insert.length - 1;\n\n\t\tfor ( ; i <= last; i++ ) {\n\t\t\telems = i === last ? this : this.clone(true);\n\t\t\tjQuery( insert[i] )[ original ]( elems );\n\n\t\t\t// Modern browsers can apply jQuery collections as arrays, but oldIE needs a .get()\n\t\t\tpush.apply( ret, elems.get() );\n\t\t}\n\n\t\treturn this.pushStack( ret );\n\t};\n});\n\n\nvar iframe,\n\telemdisplay = {};\n\n/**\n * Retrieve the actual display of a element\n * @param {String} name nodeName of the element\n * @param {Object} doc Document object\n */\n// Called only from within defaultDisplay\nfunction actualDisplay( name, doc ) {\n\tvar style,\n\t\telem = jQuery( doc.createElement( name ) ).appendTo( doc.body ),\n\n\t\t// getDefaultComputedStyle might be reliably used only on attached element\n\t\tdisplay = window.getDefaultComputedStyle && ( style = window.getDefaultComputedStyle( elem[ 0 ] ) ) ?\n\n\t\t\t// Use of this method is a temporary fix (more like optmization) until something better comes along,\n\t\t\t// since it was removed from specification and supported only in FF\n\t\t\tstyle.display : jQuery.css( elem[ 0 ], \"display\" );\n\n\t// We don't have any data stored on the element,\n\t// so use \"detach\" method as fast way to get rid of the element\n\telem.detach();\n\n\treturn display;\n}\n\n/**\n * Try to determine the default display value of an element\n * @param {String} nodeName\n */\nfunction defaultDisplay( nodeName ) {\n\tvar doc = document,\n\t\tdisplay = elemdisplay[ nodeName ];\n\n\tif ( !display ) {\n\t\tdisplay = actualDisplay( nodeName, doc );\n\n\t\t// If the simple way fails, read from inside an iframe\n\t\tif ( display === \"none\" || !display ) {\n\n\t\t\t// Use the already-created iframe if possible\n\t\t\tiframe = (iframe || jQuery( \"<iframe frameborder='0' width='0' height='0'/>\" )).appendTo( doc.documentElement );\n\n\t\t\t// Always write a new HTML skeleton so Webkit and Firefox don't choke on reuse\n\t\t\tdoc = ( iframe[ 0 ].contentWindow || iframe[ 0 ].contentDocument ).document;\n\n\t\t\t// Support: IE\n\t\t\tdoc.write();\n\t\t\tdoc.close();\n\n\t\t\tdisplay = actualDisplay( nodeName, doc );\n\t\t\tiframe.detach();\n\t\t}\n\n\t\t// Store the correct default display\n\t\telemdisplay[ nodeName ] = display;\n\t}\n\n\treturn display;\n}\n\n\n(function() {\n\tvar shrinkWrapBlocksVal;\n\n\tsupport.shrinkWrapBlocks = function() {\n\t\tif ( shrinkWrapBlocksVal != null ) {\n\t\t\treturn shrinkWrapBlocksVal;\n\t\t}\n\n\t\t// Will be changed later if needed.\n\t\tshrinkWrapBlocksVal = false;\n\n\t\t// Minified: var b,c,d\n\t\tvar div, body, container;\n\n\t\tbody = document.getElementsByTagName( \"body\" )[ 0 ];\n\t\tif ( !body || !body.style ) {\n\t\t\t// Test fired too early or in an unsupported environment, exit.\n\t\t\treturn;\n\t\t}\n\n\t\t// Setup\n\t\tdiv = document.createElement( \"div\" );\n\t\tcontainer = document.createElement( \"div\" );\n\t\tcontainer.style.cssText = \"position:absolute;border:0;width:0;height:0;top:0;left:-9999px\";\n\t\tbody.appendChild( container ).appendChild( div );\n\n\t\t// Support: IE6\n\t\t// Check if elements with layout shrink-wrap their children\n\t\tif ( typeof div.style.zoom !== strundefined ) {\n\t\t\t// Reset CSS: box-sizing; display; margin; border\n\t\t\tdiv.style.cssText =\n\t\t\t\t// Support: Firefox<29, Android 2.3\n\t\t\t\t// Vendor-prefix box-sizing\n\t\t\t\t\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;\" +\n\t\t\t\t\"box-sizing:content-box;display:block;margin:0;border:0;\" +\n\t\t\t\t\"padding:1px;width:1px;zoom:1\";\n\t\t\tdiv.appendChild( document.createElement( \"div\" ) ).style.width = \"5px\";\n\t\t\tshrinkWrapBlocksVal = div.offsetWidth !== 3;\n\t\t}\n\n\t\tbody.removeChild( container );\n\n\t\treturn shrinkWrapBlocksVal;\n\t};\n\n})();\nvar rmargin = (/^margin/);\n\nvar rnumnonpx = new RegExp( \"^(\" + pnum + \")(?!px)[a-z%]+$\", \"i\" );\n\n\n\nvar getStyles, curCSS,\n\trposition = /^(top|right|bottom|left)$/;\n\nif ( window.getComputedStyle ) {\n\tgetStyles = function( elem ) {\n\t\t// Support: IE<=11+, Firefox<=30+ (#15098, #14150)\n\t\t// IE throws on elements created in popups\n\t\t// FF meanwhile throws on frame elements through \"defaultView.getComputedStyle\"\n\t\tif ( elem.ownerDocument.defaultView.opener ) {\n\t\t\treturn elem.ownerDocument.defaultView.getComputedStyle( elem, null );\n\t\t}\n\n\t\treturn window.getComputedStyle( elem, null );\n\t};\n\n\tcurCSS = function( elem, name, computed ) {\n\t\tvar width, minWidth, maxWidth, ret,\n\t\t\tstyle = elem.style;\n\n\t\tcomputed = computed || getStyles( elem );\n\n\t\t// getPropertyValue is only needed for .css('filter') in IE9, see #12537\n\t\tret = computed ? computed.getPropertyValue( name ) || computed[ name ] : undefined;\n\n\t\tif ( computed ) {\n\n\t\t\tif ( ret === \"\" && !jQuery.contains( elem.ownerDocument, elem ) ) {\n\t\t\t\tret = jQuery.style( elem, name );\n\t\t\t}\n\n\t\t\t// A tribute to the \"awesome hack by Dean Edwards\"\n\t\t\t// Chrome < 17 and Safari 5.0 uses \"computed value\" instead of \"used value\" for margin-right\n\t\t\t// Safari 5.1.7 (at least) returns percentage for a larger set of values, but width seems to be reliably pixels\n\t\t\t// this is against the CSSOM draft spec: http://dev.w3.org/csswg/cssom/#resolved-values\n\t\t\tif ( rnumnonpx.test( ret ) && rmargin.test( name ) ) {\n\n\t\t\t\t// Remember the original values\n\t\t\t\twidth = style.width;\n\t\t\t\tminWidth = style.minWidth;\n\t\t\t\tmaxWidth = style.maxWidth;\n\n\t\t\t\t// Put in the new values to get a computed value out\n\t\t\t\tstyle.minWidth = style.maxWidth = style.width = ret;\n\t\t\t\tret = computed.width;\n\n\t\t\t\t// Revert the changed values\n\t\t\t\tstyle.width = width;\n\t\t\t\tstyle.minWidth = minWidth;\n\t\t\t\tstyle.maxWidth = maxWidth;\n\t\t\t}\n\t\t}\n\n\t\t// Support: IE\n\t\t// IE returns zIndex value as an integer.\n\t\treturn ret === undefined ?\n\t\t\tret :\n\t\t\tret + \"\";\n\t};\n} else if ( document.documentElement.currentStyle ) {\n\tgetStyles = function( elem ) {\n\t\treturn elem.currentStyle;\n\t};\n\n\tcurCSS = function( elem, name, computed ) {\n\t\tvar left, rs, rsLeft, ret,\n\t\t\tstyle = elem.style;\n\n\t\tcomputed = computed || getStyles( elem );\n\t\tret = computed ? computed[ name ] : undefined;\n\n\t\t// Avoid setting ret to empty string here\n\t\t// so we don't default to auto\n\t\tif ( ret == null && style && style[ name ] ) {\n\t\t\tret = style[ name ];\n\t\t}\n\n\t\t// From the awesome hack by Dean Edwards\n\t\t// http://erik.eae.net/archives/2007/07/27/18.54.15/#comment-102291\n\n\t\t// If we're not dealing with a regular pixel number\n\t\t// but a number that has a weird ending, we need to convert it to pixels\n\t\t// but not position css attributes, as those are proportional to the parent element instead\n\t\t// and we can't measure the parent instead because it might trigger a \"stacking dolls\" problem\n\t\tif ( rnumnonpx.test( ret ) && !rposition.test( name ) ) {\n\n\t\t\t// Remember the original values\n\t\t\tleft = style.left;\n\t\t\trs = elem.runtimeStyle;\n\t\t\trsLeft = rs && rs.left;\n\n\t\t\t// Put in the new values to get a computed value out\n\t\t\tif ( rsLeft ) {\n\t\t\t\trs.left = elem.currentStyle.left;\n\t\t\t}\n\t\t\tstyle.left = name === \"fontSize\" ? \"1em\" : ret;\n\t\t\tret = style.pixelLeft + \"px\";\n\n\t\t\t// Revert the changed values\n\t\t\tstyle.left = left;\n\t\t\tif ( rsLeft ) {\n\t\t\t\trs.left = rsLeft;\n\t\t\t}\n\t\t}\n\n\t\t// Support: IE\n\t\t// IE returns zIndex value as an integer.\n\t\treturn ret === undefined ?\n\t\t\tret :\n\t\t\tret + \"\" || \"auto\";\n\t};\n}\n\n\n\n\nfunction addGetHookIf( conditionFn, hookFn ) {\n\t// Define the hook, we'll check on the first run if it's really needed.\n\treturn {\n\t\tget: function() {\n\t\t\tvar condition = conditionFn();\n\n\t\t\tif ( condition == null ) {\n\t\t\t\t// The test was not ready at this point; screw the hook this time\n\t\t\t\t// but check again when needed next time.\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( condition ) {\n\t\t\t\t// Hook not needed (or it's not possible to use it due to missing dependency),\n\t\t\t\t// remove it.\n\t\t\t\t// Since there are no other hooks for marginRight, remove the whole object.\n\t\t\t\tdelete this.get;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Hook needed; redefine it so that the support test is not executed again.\n\n\t\t\treturn (this.get = hookFn).apply( this, arguments );\n\t\t}\n\t};\n}\n\n\n(function() {\n\t// Minified: var b,c,d,e,f,g, h,i\n\tvar div, style, a, pixelPositionVal, boxSizingReliableVal,\n\t\treliableHiddenOffsetsVal, reliableMarginRightVal;\n\n\t// Setup\n\tdiv = document.createElement( \"div\" );\n\tdiv.innerHTML = \"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\";\n\ta = div.getElementsByTagName( \"a\" )[ 0 ];\n\tstyle = a && a.style;\n\n\t// Finish early in limited (non-browser) environments\n\tif ( !style ) {\n\t\treturn;\n\t}\n\n\tstyle.cssText = \"float:left;opacity:.5\";\n\n\t// Support: IE<9\n\t// Make sure that element opacity exists (as opposed to filter)\n\tsupport.opacity = style.opacity === \"0.5\";\n\n\t// Verify style float existence\n\t// (IE uses styleFloat instead of cssFloat)\n\tsupport.cssFloat = !!style.cssFloat;\n\n\tdiv.style.backgroundClip = \"content-box\";\n\tdiv.cloneNode( true ).style.backgroundClip = \"\";\n\tsupport.clearCloneStyle = div.style.backgroundClip === \"content-box\";\n\n\t// Support: Firefox<29, Android 2.3\n\t// Vendor-prefix box-sizing\n\tsupport.boxSizing = style.boxSizing === \"\" || style.MozBoxSizing === \"\" ||\n\t\tstyle.WebkitBoxSizing === \"\";\n\n\tjQuery.extend(support, {\n\t\treliableHiddenOffsets: function() {\n\t\t\tif ( reliableHiddenOffsetsVal == null ) {\n\t\t\t\tcomputeStyleTests();\n\t\t\t}\n\t\t\treturn reliableHiddenOffsetsVal;\n\t\t},\n\n\t\tboxSizingReliable: function() {\n\t\t\tif ( boxSizingReliableVal == null ) {\n\t\t\t\tcomputeStyleTests();\n\t\t\t}\n\t\t\treturn boxSizingReliableVal;\n\t\t},\n\n\t\tpixelPosition: function() {\n\t\t\tif ( pixelPositionVal == null ) {\n\t\t\t\tcomputeStyleTests();\n\t\t\t}\n\t\t\treturn pixelPositionVal;\n\t\t},\n\n\t\t// Support: Android 2.3\n\t\treliableMarginRight: function() {\n\t\t\tif ( reliableMarginRightVal == null ) {\n\t\t\t\tcomputeStyleTests();\n\t\t\t}\n\t\t\treturn reliableMarginRightVal;\n\t\t}\n\t});\n\n\tfunction computeStyleTests() {\n\t\t// Minified: var b,c,d,j\n\t\tvar div, body, container, contents;\n\n\t\tbody = document.getElementsByTagName( \"body\" )[ 0 ];\n\t\tif ( !body || !body.style ) {\n\t\t\t// Test fired too early or in an unsupported environment, exit.\n\t\t\treturn;\n\t\t}\n\n\t\t// Setup\n\t\tdiv = document.createElement( \"div\" );\n\t\tcontainer = document.createElement( \"div\" );\n\t\tcontainer.style.cssText = \"position:absolute;border:0;width:0;height:0;top:0;left:-9999px\";\n\t\tbody.appendChild( container ).appendChild( div );\n\n\t\tdiv.style.cssText =\n\t\t\t// Support: Firefox<29, Android 2.3\n\t\t\t// Vendor-prefix box-sizing\n\t\t\t\"-webkit-box-sizing:border-box;-moz-box-sizing:border-box;\" +\n\t\t\t\"box-sizing:border-box;display:block;margin-top:1%;top:1%;\" +\n\t\t\t\"border:1px;padding:1px;width:4px;position:absolute\";\n\n\t\t// Support: IE<9\n\t\t// Assume reasonable values in the absence of getComputedStyle\n\t\tpixelPositionVal = boxSizingReliableVal = false;\n\t\treliableMarginRightVal = true;\n\n\t\t// Check for getComputedStyle so that this code is not run in IE<9.\n\t\tif ( window.getComputedStyle ) {\n\t\t\tpixelPositionVal = ( window.getComputedStyle( div, null ) || {} ).top !== \"1%\";\n\t\t\tboxSizingReliableVal =\n\t\t\t\t( window.getComputedStyle( div, null ) || { width: \"4px\" } ).width === \"4px\";\n\n\t\t\t// Support: Android 2.3\n\t\t\t// Div with explicit width and no margin-right incorrectly\n\t\t\t// gets computed margin-right based on width of container (#3333)\n\t\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\n\t\t\tcontents = div.appendChild( document.createElement( \"div\" ) );\n\n\t\t\t// Reset CSS: box-sizing; display; margin; border; padding\n\t\t\tcontents.style.cssText = div.style.cssText =\n\t\t\t\t// Support: Firefox<29, Android 2.3\n\t\t\t\t// Vendor-prefix box-sizing\n\t\t\t\t\"-webkit-box-sizing:content-box;-moz-box-sizing:content-box;\" +\n\t\t\t\t\"box-sizing:content-box;display:block;margin:0;border:0;padding:0\";\n\t\t\tcontents.style.marginRight = contents.style.width = \"0\";\n\t\t\tdiv.style.width = \"1px\";\n\n\t\t\treliableMarginRightVal =\n\t\t\t\t!parseFloat( ( window.getComputedStyle( contents, null ) || {} ).marginRight );\n\n\t\t\tdiv.removeChild( contents );\n\t\t}\n\n\t\t// Support: IE8\n\t\t// Check if table cells still have offsetWidth/Height when they are set\n\t\t// to display:none and there are still other visible table cells in a\n\t\t// table row; if so, offsetWidth/Height are not reliable for use when\n\t\t// determining if an element has been hidden directly using\n\t\t// display:none (it is still safe to use offsets if a parent element is\n\t\t// hidden; don safety goggles and see bug #4512 for more information).\n\t\tdiv.innerHTML = \"<table><tr><td></td><td>t</td></tr></table>\";\n\t\tcontents = div.getElementsByTagName( \"td\" );\n\t\tcontents[ 0 ].style.cssText = \"margin:0;border:0;padding:0;display:none\";\n\t\treliableHiddenOffsetsVal = contents[ 0 ].offsetHeight === 0;\n\t\tif ( reliableHiddenOffsetsVal ) {\n\t\t\tcontents[ 0 ].style.display = \"\";\n\t\t\tcontents[ 1 ].style.display = \"none\";\n\t\t\treliableHiddenOffsetsVal = contents[ 0 ].offsetHeight === 0;\n\t\t}\n\n\t\tbody.removeChild( container );\n\t}\n\n})();\n\n\n// A method for quickly swapping in/out CSS properties to get correct calculations.\njQuery.swap = function( elem, options, callback, args ) {\n\tvar ret, name,\n\t\told = {};\n\n\t// Remember the old values, and insert the new ones\n\tfor ( name in options ) {\n\t\told[ name ] = elem.style[ name ];\n\t\telem.style[ name ] = options[ name ];\n\t}\n\n\tret = callback.apply( elem, args || [] );\n\n\t// Revert the old values\n\tfor ( name in options ) {\n\t\telem.style[ name ] = old[ name ];\n\t}\n\n\treturn ret;\n};\n\n\nvar\n\t\tralpha = /alpha\\([^)]*\\)/i,\n\tropacity = /opacity\\s*=\\s*([^)]*)/,\n\n\t// swappable if display is none or starts with table except \"table\", \"table-cell\", or \"table-caption\"\n\t// see here for display values: https://developer.mozilla.org/en-US/docs/CSS/display\n\trdisplayswap = /^(none|table(?!-c[ea]).+)/,\n\trnumsplit = new RegExp( \"^(\" + pnum + \")(.*)$\", \"i\" ),\n\trrelNum = new RegExp( \"^([+-])=(\" + pnum + \")\", \"i\" ),\n\n\tcssShow = { position: \"absolute\", visibility: \"hidden\", display: \"block\" },\n\tcssNormalTransform = {\n\t\tletterSpacing: \"0\",\n\t\tfontWeight: \"400\"\n\t},\n\n\tcssPrefixes = [ \"Webkit\", \"O\", \"Moz\", \"ms\" ];\n\n\n// return a css property mapped to a potentially vendor prefixed property\nfunction vendorPropName( style, name ) {\n\n\t// shortcut for names that are not vendor prefixed\n\tif ( name in style ) {\n\t\treturn name;\n\t}\n\n\t// check for vendor prefixed names\n\tvar capName = name.charAt(0).toUpperCase() + name.slice(1),\n\t\torigName = name,\n\t\ti = cssPrefixes.length;\n\n\twhile ( i-- ) {\n\t\tname = cssPrefixes[ i ] + capName;\n\t\tif ( name in style ) {\n\t\t\treturn name;\n\t\t}\n\t}\n\n\treturn origName;\n}\n\nfunction showHide( elements, show ) {\n\tvar display, elem, hidden,\n\t\tvalues = [],\n\t\tindex = 0,\n\t\tlength = elements.length;\n\n\tfor ( ; index < length; index++ ) {\n\t\telem = elements[ index ];\n\t\tif ( !elem.style ) {\n\t\t\tcontinue;\n\t\t}\n\n\t\tvalues[ index ] = jQuery._data( elem, \"olddisplay\" );\n\t\tdisplay = elem.style.display;\n\t\tif ( show ) {\n\t\t\t// Reset the inline display of this element to learn if it is\n\t\t\t// being hidden by cascaded rules or not\n\t\t\tif ( !values[ index ] && display === \"none\" ) {\n\t\t\t\telem.style.display = \"\";\n\t\t\t}\n\n\t\t\t// Set elements which have been overridden with display: none\n\t\t\t// in a stylesheet to whatever the default browser style is\n\t\t\t// for such an element\n\t\t\tif ( elem.style.display === \"\" && isHidden( elem ) ) {\n\t\t\t\tvalues[ index ] = jQuery._data( elem, \"olddisplay\", defaultDisplay(elem.nodeName) );\n\t\t\t}\n\t\t} else {\n\t\t\thidden = isHidden( elem );\n\n\t\t\tif ( display && display !== \"none\" || !hidden ) {\n\t\t\t\tjQuery._data( elem, \"olddisplay\", hidden ? display : jQuery.css( elem, \"display\" ) );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Set the display of most of the elements in a second loop\n\t// to avoid the constant reflow\n\tfor ( index = 0; index < length; index++ ) {\n\t\telem = elements[ index ];\n\t\tif ( !elem.style ) {\n\t\t\tcontinue;\n\t\t}\n\t\tif ( !show || elem.style.display === \"none\" || elem.style.display === \"\" ) {\n\t\t\telem.style.display = show ? values[ index ] || \"\" : \"none\";\n\t\t}\n\t}\n\n\treturn elements;\n}\n\nfunction setPositiveNumber( elem, value, subtract ) {\n\tvar matches = rnumsplit.exec( value );\n\treturn matches ?\n\t\t// Guard against undefined \"subtract\", e.g., when used as in cssHooks\n\t\tMath.max( 0, matches[ 1 ] - ( subtract || 0 ) ) + ( matches[ 2 ] || \"px\" ) :\n\t\tvalue;\n}\n\nfunction augmentWidthOrHeight( elem, name, extra, isBorderBox, styles ) {\n\tvar i = extra === ( isBorderBox ? \"border\" : \"content\" ) ?\n\t\t// If we already have the right measurement, avoid augmentation\n\t\t4 :\n\t\t// Otherwise initialize for horizontal or vertical properties\n\t\tname === \"width\" ? 1 : 0,\n\n\t\tval = 0;\n\n\tfor ( ; i < 4; i += 2 ) {\n\t\t// both box models exclude margin, so add it if we want it\n\t\tif ( extra === \"margin\" ) {\n\t\t\tval += jQuery.css( elem, extra + cssExpand[ i ], true, styles );\n\t\t}\n\n\t\tif ( isBorderBox ) {\n\t\t\t// border-box includes padding, so remove it if we want content\n\t\t\tif ( extra === \"content\" ) {\n\t\t\t\tval -= jQuery.css( elem, \"padding\" + cssExpand[ i ], true, styles );\n\t\t\t}\n\n\t\t\t// at this point, extra isn't border nor margin, so remove border\n\t\t\tif ( extra !== \"margin\" ) {\n\t\t\t\tval -= jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\n\t\t\t}\n\t\t} else {\n\t\t\t// at this point, extra isn't content, so add padding\n\t\t\tval += jQuery.css( elem, \"padding\" + cssExpand[ i ], true, styles );\n\n\t\t\t// at this point, extra isn't content nor padding, so add border\n\t\t\tif ( extra !== \"padding\" ) {\n\t\t\t\tval += jQuery.css( elem, \"border\" + cssExpand[ i ] + \"Width\", true, styles );\n\t\t\t}\n\t\t}\n\t}\n\n\treturn val;\n}\n\nfunction getWidthOrHeight( elem, name, extra ) {\n\n\t// Start with offset property, which is equivalent to the border-box value\n\tvar valueIsBorderBox = true,\n\t\tval = name === \"width\" ? elem.offsetWidth : elem.offsetHeight,\n\t\tstyles = getStyles( elem ),\n\t\tisBorderBox = support.boxSizing && jQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\";\n\n\t// some non-html elements return undefined for offsetWidth, so check for null/undefined\n\t// svg - https://bugzilla.mozilla.org/show_bug.cgi?id=649285\n\t// MathML - https://bugzilla.mozilla.org/show_bug.cgi?id=491668\n\tif ( val <= 0 || val == null ) {\n\t\t// Fall back to computed then uncomputed css if necessary\n\t\tval = curCSS( elem, name, styles );\n\t\tif ( val < 0 || val == null ) {\n\t\t\tval = elem.style[ name ];\n\t\t}\n\n\t\t// Computed unit is not pixels. Stop here and return.\n\t\tif ( rnumnonpx.test(val) ) {\n\t\t\treturn val;\n\t\t}\n\n\t\t// we need the check for style in case a browser which returns unreliable values\n\t\t// for getComputedStyle silently falls back to the reliable elem.style\n\t\tvalueIsBorderBox = isBorderBox && ( support.boxSizingReliable() || val === elem.style[ name ] );\n\n\t\t// Normalize \"\", auto, and prepare for extra\n\t\tval = parseFloat( val ) || 0;\n\t}\n\n\t// use the active box-sizing model to add/subtract irrelevant styles\n\treturn ( val +\n\t\taugmentWidthOrHeight(\n\t\t\telem,\n\t\t\tname,\n\t\t\textra || ( isBorderBox ? \"border\" : \"content\" ),\n\t\t\tvalueIsBorderBox,\n\t\t\tstyles\n\t\t)\n\t) + \"px\";\n}\n\njQuery.extend({\n\t// Add in style property hooks for overriding the default\n\t// behavior of getting and setting a style property\n\tcssHooks: {\n\t\topacity: {\n\t\t\tget: function( elem, computed ) {\n\t\t\t\tif ( computed ) {\n\t\t\t\t\t// We should always get a number back from opacity\n\t\t\t\t\tvar ret = curCSS( elem, \"opacity\" );\n\t\t\t\t\treturn ret === \"\" ? \"1\" : ret;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\n\t// Don't automatically add \"px\" to these possibly-unitless properties\n\tcssNumber: {\n\t\t\"columnCount\": true,\n\t\t\"fillOpacity\": true,\n\t\t\"flexGrow\": true,\n\t\t\"flexShrink\": true,\n\t\t\"fontWeight\": true,\n\t\t\"lineHeight\": true,\n\t\t\"opacity\": true,\n\t\t\"order\": true,\n\t\t\"orphans\": true,\n\t\t\"widows\": true,\n\t\t\"zIndex\": true,\n\t\t\"zoom\": true\n\t},\n\n\t// Add in properties whose names you wish to fix before\n\t// setting or getting the value\n\tcssProps: {\n\t\t// normalize float css property\n\t\t\"float\": support.cssFloat ? \"cssFloat\" : \"styleFloat\"\n\t},\n\n\t// Get and set the style property on a DOM Node\n\tstyle: function( elem, name, value, extra ) {\n\t\t// Don't set styles on text and comment nodes\n\t\tif ( !elem || elem.nodeType === 3 || elem.nodeType === 8 || !elem.style ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Make sure that we're working with the right name\n\t\tvar ret, type, hooks,\n\t\t\torigName = jQuery.camelCase( name ),\n\t\t\tstyle = elem.style;\n\n\t\tname = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( style, origName ) );\n\n\t\t// gets hook for the prefixed version\n\t\t// followed by the unprefixed version\n\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n\n\t\t// Check if we're setting a value\n\t\tif ( value !== undefined ) {\n\t\t\ttype = typeof value;\n\n\t\t\t// convert relative number strings (+= or -=) to relative numbers. #7345\n\t\t\tif ( type === \"string\" && (ret = rrelNum.exec( value )) ) {\n\t\t\t\tvalue = ( ret[1] + 1 ) * ret[2] + parseFloat( jQuery.css( elem, name ) );\n\t\t\t\t// Fixes bug #9237\n\t\t\t\ttype = \"number\";\n\t\t\t}\n\n\t\t\t// Make sure that null and NaN values aren't set. See: #7116\n\t\t\tif ( value == null || value !== value ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If a number was passed in, add 'px' to the (except for certain CSS properties)\n\t\t\tif ( type === \"number\" && !jQuery.cssNumber[ origName ] ) {\n\t\t\t\tvalue += \"px\";\n\t\t\t}\n\n\t\t\t// Fixes #8908, it can be done more correctly by specifing setters in cssHooks,\n\t\t\t// but it would mean to define eight (for every problematic property) identical functions\n\t\t\tif ( !support.clearCloneStyle && value === \"\" && name.indexOf(\"background\") === 0 ) {\n\t\t\t\tstyle[ name ] = \"inherit\";\n\t\t\t}\n\n\t\t\t// If a hook was provided, use that value, otherwise just set the specified value\n\t\t\tif ( !hooks || !(\"set\" in hooks) || (value = hooks.set( elem, value, extra )) !== undefined ) {\n\n\t\t\t\t// Support: IE\n\t\t\t\t// Swallow errors from 'invalid' CSS values (#5509)\n\t\t\t\ttry {\n\t\t\t\t\tstyle[ name ] = value;\n\t\t\t\t} catch(e) {}\n\t\t\t}\n\n\t\t} else {\n\t\t\t// If a hook was provided get the non-computed value from there\n\t\t\tif ( hooks && \"get\" in hooks && (ret = hooks.get( elem, false, extra )) !== undefined ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\t// Otherwise just get the value from the style object\n\t\t\treturn style[ name ];\n\t\t}\n\t},\n\n\tcss: function( elem, name, extra, styles ) {\n\t\tvar num, val, hooks,\n\t\t\torigName = jQuery.camelCase( name );\n\n\t\t// Make sure that we're working with the right name\n\t\tname = jQuery.cssProps[ origName ] || ( jQuery.cssProps[ origName ] = vendorPropName( elem.style, origName ) );\n\n\t\t// gets hook for the prefixed version\n\t\t// followed by the unprefixed version\n\t\thooks = jQuery.cssHooks[ name ] || jQuery.cssHooks[ origName ];\n\n\t\t// If a hook was provided get the computed value from there\n\t\tif ( hooks && \"get\" in hooks ) {\n\t\t\tval = hooks.get( elem, true, extra );\n\t\t}\n\n\t\t// Otherwise, if a way to get the computed value exists, use that\n\t\tif ( val === undefined ) {\n\t\t\tval = curCSS( elem, name, styles );\n\t\t}\n\n\t\t//convert \"normal\" to computed value\n\t\tif ( val === \"normal\" && name in cssNormalTransform ) {\n\t\t\tval = cssNormalTransform[ name ];\n\t\t}\n\n\t\t// Return, converting to number if forced or a qualifier was provided and val looks numeric\n\t\tif ( extra === \"\" || extra ) {\n\t\t\tnum = parseFloat( val );\n\t\t\treturn extra === true || jQuery.isNumeric( num ) ? num || 0 : val;\n\t\t}\n\t\treturn val;\n\t}\n});\n\njQuery.each([ \"height\", \"width\" ], function( i, name ) {\n\tjQuery.cssHooks[ name ] = {\n\t\tget: function( elem, computed, extra ) {\n\t\t\tif ( computed ) {\n\t\t\t\t// certain elements can have dimension info if we invisibly show them\n\t\t\t\t// however, it must have a current display style that would benefit from this\n\t\t\t\treturn rdisplayswap.test( jQuery.css( elem, \"display\" ) ) && elem.offsetWidth === 0 ?\n\t\t\t\t\tjQuery.swap( elem, cssShow, function() {\n\t\t\t\t\t\treturn getWidthOrHeight( elem, name, extra );\n\t\t\t\t\t}) :\n\t\t\t\t\tgetWidthOrHeight( elem, name, extra );\n\t\t\t}\n\t\t},\n\n\t\tset: function( elem, value, extra ) {\n\t\t\tvar styles = extra && getStyles( elem );\n\t\t\treturn setPositiveNumber( elem, value, extra ?\n\t\t\t\taugmentWidthOrHeight(\n\t\t\t\t\telem,\n\t\t\t\t\tname,\n\t\t\t\t\textra,\n\t\t\t\t\tsupport.boxSizing && jQuery.css( elem, \"boxSizing\", false, styles ) === \"border-box\",\n\t\t\t\t\tstyles\n\t\t\t\t) : 0\n\t\t\t);\n\t\t}\n\t};\n});\n\nif ( !support.opacity ) {\n\tjQuery.cssHooks.opacity = {\n\t\tget: function( elem, computed ) {\n\t\t\t// IE uses filters for opacity\n\t\t\treturn ropacity.test( (computed && elem.currentStyle ? elem.currentStyle.filter : elem.style.filter) || \"\" ) ?\n\t\t\t\t( 0.01 * parseFloat( RegExp.$1 ) ) + \"\" :\n\t\t\t\tcomputed ? \"1\" : \"\";\n\t\t},\n\n\t\tset: function( elem, value ) {\n\t\t\tvar style = elem.style,\n\t\t\t\tcurrentStyle = elem.currentStyle,\n\t\t\t\topacity = jQuery.isNumeric( value ) ? \"alpha(opacity=\" + value * 100 + \")\" : \"\",\n\t\t\t\tfilter = currentStyle && currentStyle.filter || style.filter || \"\";\n\n\t\t\t// IE has trouble with opacity if it does not have layout\n\t\t\t// Force it by setting the zoom level\n\t\t\tstyle.zoom = 1;\n\n\t\t\t// if setting opacity to 1, and no other filters exist - attempt to remove filter attribute #6652\n\t\t\t// if value === \"\", then remove inline opacity #12685\n\t\t\tif ( ( value >= 1 || value === \"\" ) &&\n\t\t\t\t\tjQuery.trim( filter.replace( ralpha, \"\" ) ) === \"\" &&\n\t\t\t\t\tstyle.removeAttribute ) {\n\n\t\t\t\t// Setting style.filter to null, \"\" & \" \" still leave \"filter:\" in the cssText\n\t\t\t\t// if \"filter:\" is present at all, clearType is disabled, we want to avoid this\n\t\t\t\t// style.removeAttribute is IE Only, but so apparently is this code path...\n\t\t\t\tstyle.removeAttribute( \"filter\" );\n\n\t\t\t\t// if there is no filter style applied in a css rule or unset inline opacity, we are done\n\t\t\t\tif ( value === \"\" || currentStyle && !currentStyle.filter ) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// otherwise, set new filter values\n\t\t\tstyle.filter = ralpha.test( filter ) ?\n\t\t\t\tfilter.replace( ralpha, opacity ) :\n\t\t\t\tfilter + \" \" + opacity;\n\t\t}\n\t};\n}\n\njQuery.cssHooks.marginRight = addGetHookIf( support.reliableMarginRight,\n\tfunction( elem, computed ) {\n\t\tif ( computed ) {\n\t\t\t// WebKit Bug 13343 - getComputedStyle returns wrong value for margin-right\n\t\t\t// Work around by temporarily setting element display to inline-block\n\t\t\treturn jQuery.swap( elem, { \"display\": \"inline-block\" },\n\t\t\t\tcurCSS, [ elem, \"marginRight\" ] );\n\t\t}\n\t}\n);\n\n// These hooks are used by animate to expand properties\njQuery.each({\n\tmargin: \"\",\n\tpadding: \"\",\n\tborder: \"Width\"\n}, function( prefix, suffix ) {\n\tjQuery.cssHooks[ prefix + suffix ] = {\n\t\texpand: function( value ) {\n\t\t\tvar i = 0,\n\t\t\t\texpanded = {},\n\n\t\t\t\t// assumes a single number if not a string\n\t\t\t\tparts = typeof value === \"string\" ? value.split(\" \") : [ value ];\n\n\t\t\tfor ( ; i < 4; i++ ) {\n\t\t\t\texpanded[ prefix + cssExpand[ i ] + suffix ] =\n\t\t\t\t\tparts[ i ] || parts[ i - 2 ] || parts[ 0 ];\n\t\t\t}\n\n\t\t\treturn expanded;\n\t\t}\n\t};\n\n\tif ( !rmargin.test( prefix ) ) {\n\t\tjQuery.cssHooks[ prefix + suffix ].set = setPositiveNumber;\n\t}\n});\n\njQuery.fn.extend({\n\tcss: function( name, value ) {\n\t\treturn access( this, function( elem, name, value ) {\n\t\t\tvar styles, len,\n\t\t\t\tmap = {},\n\t\t\t\ti = 0;\n\n\t\t\tif ( jQuery.isArray( name ) ) {\n\t\t\t\tstyles = getStyles( elem );\n\t\t\t\tlen = name.length;\n\n\t\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\t\tmap[ name[ i ] ] = jQuery.css( elem, name[ i ], false, styles );\n\t\t\t\t}\n\n\t\t\t\treturn map;\n\t\t\t}\n\n\t\t\treturn value !== undefined ?\n\t\t\t\tjQuery.style( elem, name, value ) :\n\t\t\t\tjQuery.css( elem, name );\n\t\t}, name, value, arguments.length > 1 );\n\t},\n\tshow: function() {\n\t\treturn showHide( this, true );\n\t},\n\thide: function() {\n\t\treturn showHide( this );\n\t},\n\ttoggle: function( state ) {\n\t\tif ( typeof state === \"boolean\" ) {\n\t\t\treturn state ? this.show() : this.hide();\n\t\t}\n\n\t\treturn this.each(function() {\n\t\t\tif ( isHidden( this ) ) {\n\t\t\t\tjQuery( this ).show();\n\t\t\t} else {\n\t\t\t\tjQuery( this ).hide();\n\t\t\t}\n\t\t});\n\t}\n});\n\n\nfunction Tween( elem, options, prop, end, easing ) {\n\treturn new Tween.prototype.init( elem, options, prop, end, easing );\n}\njQuery.Tween = Tween;\n\nTween.prototype = {\n\tconstructor: Tween,\n\tinit: function( elem, options, prop, end, easing, unit ) {\n\t\tthis.elem = elem;\n\t\tthis.prop = prop;\n\t\tthis.easing = easing || \"swing\";\n\t\tthis.options = options;\n\t\tthis.start = this.now = this.cur();\n\t\tthis.end = end;\n\t\tthis.unit = unit || ( jQuery.cssNumber[ prop ] ? \"\" : \"px\" );\n\t},\n\tcur: function() {\n\t\tvar hooks = Tween.propHooks[ this.prop ];\n\n\t\treturn hooks && hooks.get ?\n\t\t\thooks.get( this ) :\n\t\t\tTween.propHooks._default.get( this );\n\t},\n\trun: function( percent ) {\n\t\tvar eased,\n\t\t\thooks = Tween.propHooks[ this.prop ];\n\n\t\tif ( this.options.duration ) {\n\t\t\tthis.pos = eased = jQuery.easing[ this.easing ](\n\t\t\t\tpercent, this.options.duration * percent, 0, 1, this.options.duration\n\t\t\t);\n\t\t} else {\n\t\t\tthis.pos = eased = percent;\n\t\t}\n\t\tthis.now = ( this.end - this.start ) * eased + this.start;\n\n\t\tif ( this.options.step ) {\n\t\t\tthis.options.step.call( this.elem, this.now, this );\n\t\t}\n\n\t\tif ( hooks && hooks.set ) {\n\t\t\thooks.set( this );\n\t\t} else {\n\t\t\tTween.propHooks._default.set( this );\n\t\t}\n\t\treturn this;\n\t}\n};\n\nTween.prototype.init.prototype = Tween.prototype;\n\nTween.propHooks = {\n\t_default: {\n\t\tget: function( tween ) {\n\t\t\tvar result;\n\n\t\t\tif ( tween.elem[ tween.prop ] != null &&\n\t\t\t\t(!tween.elem.style || tween.elem.style[ tween.prop ] == null) ) {\n\t\t\t\treturn tween.elem[ tween.prop ];\n\t\t\t}\n\n\t\t\t// passing an empty string as a 3rd parameter to .css will automatically\n\t\t\t// attempt a parseFloat and fallback to a string if the parse fails\n\t\t\t// so, simple values such as \"10px\" are parsed to Float.\n\t\t\t// complex values such as \"rotate(1rad)\" are returned as is.\n\t\t\tresult = jQuery.css( tween.elem, tween.prop, \"\" );\n\t\t\t// Empty strings, null, undefined and \"auto\" are converted to 0.\n\t\t\treturn !result || result === \"auto\" ? 0 : result;\n\t\t},\n\t\tset: function( tween ) {\n\t\t\t// use step hook for back compat - use cssHook if its there - use .style if its\n\t\t\t// available and use plain properties where available\n\t\t\tif ( jQuery.fx.step[ tween.prop ] ) {\n\t\t\t\tjQuery.fx.step[ tween.prop ]( tween );\n\t\t\t} else if ( tween.elem.style && ( tween.elem.style[ jQuery.cssProps[ tween.prop ] ] != null || jQuery.cssHooks[ tween.prop ] ) ) {\n\t\t\t\tjQuery.style( tween.elem, tween.prop, tween.now + tween.unit );\n\t\t\t} else {\n\t\t\t\ttween.elem[ tween.prop ] = tween.now;\n\t\t\t}\n\t\t}\n\t}\n};\n\n// Support: IE <=9\n// Panic based approach to setting things on disconnected nodes\n\nTween.propHooks.scrollTop = Tween.propHooks.scrollLeft = {\n\tset: function( tween ) {\n\t\tif ( tween.elem.nodeType && tween.elem.parentNode ) {\n\t\t\ttween.elem[ tween.prop ] = tween.now;\n\t\t}\n\t}\n};\n\njQuery.easing = {\n\tlinear: function( p ) {\n\t\treturn p;\n\t},\n\tswing: function( p ) {\n\t\treturn 0.5 - Math.cos( p * Math.PI ) / 2;\n\t}\n};\n\njQuery.fx = Tween.prototype.init;\n\n// Back Compat <1.8 extension point\njQuery.fx.step = {};\n\n\n\n\nvar\n\tfxNow, timerId,\n\trfxtypes = /^(?:toggle|show|hide)$/,\n\trfxnum = new RegExp( \"^(?:([+-])=|)(\" + pnum + \")([a-z%]*)$\", \"i\" ),\n\trrun = /queueHooks$/,\n\tanimationPrefilters = [ defaultPrefilter ],\n\ttweeners = {\n\t\t\"*\": [ function( prop, value ) {\n\t\t\tvar tween = this.createTween( prop, value ),\n\t\t\t\ttarget = tween.cur(),\n\t\t\t\tparts = rfxnum.exec( value ),\n\t\t\t\tunit = parts && parts[ 3 ] || ( jQuery.cssNumber[ prop ] ? \"\" : \"px\" ),\n\n\t\t\t\t// Starting value computation is required for potential unit mismatches\n\t\t\t\tstart = ( jQuery.cssNumber[ prop ] || unit !== \"px\" && +target ) &&\n\t\t\t\t\trfxnum.exec( jQuery.css( tween.elem, prop ) ),\n\t\t\t\tscale = 1,\n\t\t\t\tmaxIterations = 20;\n\n\t\t\tif ( start && start[ 3 ] !== unit ) {\n\t\t\t\t// Trust units reported by jQuery.css\n\t\t\t\tunit = unit || start[ 3 ];\n\n\t\t\t\t// Make sure we update the tween properties later on\n\t\t\t\tparts = parts || [];\n\n\t\t\t\t// Iteratively approximate from a nonzero starting point\n\t\t\t\tstart = +target || 1;\n\n\t\t\t\tdo {\n\t\t\t\t\t// If previous iteration zeroed out, double until we get *something*\n\t\t\t\t\t// Use a string for doubling factor so we don't accidentally see scale as unchanged below\n\t\t\t\t\tscale = scale || \".5\";\n\n\t\t\t\t\t// Adjust and apply\n\t\t\t\t\tstart = start / scale;\n\t\t\t\t\tjQuery.style( tween.elem, prop, start + unit );\n\n\t\t\t\t// Update scale, tolerating zero or NaN from tween.cur()\n\t\t\t\t// And breaking the loop if scale is unchanged or perfect, or if we've just had enough\n\t\t\t\t} while ( scale !== (scale = tween.cur() / target) && scale !== 1 && --maxIterations );\n\t\t\t}\n\n\t\t\t// Update tween properties\n\t\t\tif ( parts ) {\n\t\t\t\tstart = tween.start = +start || +target || 0;\n\t\t\t\ttween.unit = unit;\n\t\t\t\t// If a +=/-= token was provided, we're doing a relative animation\n\t\t\t\ttween.end = parts[ 1 ] ?\n\t\t\t\t\tstart + ( parts[ 1 ] + 1 ) * parts[ 2 ] :\n\t\t\t\t\t+parts[ 2 ];\n\t\t\t}\n\n\t\t\treturn tween;\n\t\t} ]\n\t};\n\n// Animations created synchronously will run synchronously\nfunction createFxNow() {\n\tsetTimeout(function() {\n\t\tfxNow = undefined;\n\t});\n\treturn ( fxNow = jQuery.now() );\n}\n\n// Generate parameters to create a standard animation\nfunction genFx( type, includeWidth ) {\n\tvar which,\n\t\tattrs = { height: type },\n\t\ti = 0;\n\n\t// if we include width, step value is 1 to do all cssExpand values,\n\t// if we don't include width, step value is 2 to skip over Left and Right\n\tincludeWidth = includeWidth ? 1 : 0;\n\tfor ( ; i < 4 ; i += 2 - includeWidth ) {\n\t\twhich = cssExpand[ i ];\n\t\tattrs[ \"margin\" + which ] = attrs[ \"padding\" + which ] = type;\n\t}\n\n\tif ( includeWidth ) {\n\t\tattrs.opacity = attrs.width = type;\n\t}\n\n\treturn attrs;\n}\n\nfunction createTween( value, prop, animation ) {\n\tvar tween,\n\t\tcollection = ( tweeners[ prop ] || [] ).concat( tweeners[ \"*\" ] ),\n\t\tindex = 0,\n\t\tlength = collection.length;\n\tfor ( ; index < length; index++ ) {\n\t\tif ( (tween = collection[ index ].call( animation, prop, value )) ) {\n\n\t\t\t// we're done with this property\n\t\t\treturn tween;\n\t\t}\n\t}\n}\n\nfunction defaultPrefilter( elem, props, opts ) {\n\t/* jshint validthis: true */\n\tvar prop, value, toggle, tween, hooks, oldfire, display, checkDisplay,\n\t\tanim = this,\n\t\torig = {},\n\t\tstyle = elem.style,\n\t\thidden = elem.nodeType && isHidden( elem ),\n\t\tdataShow = jQuery._data( elem, \"fxshow\" );\n\n\t// handle queue: false promises\n\tif ( !opts.queue ) {\n\t\thooks = jQuery._queueHooks( elem, \"fx\" );\n\t\tif ( hooks.unqueued == null ) {\n\t\t\thooks.unqueued = 0;\n\t\t\toldfire = hooks.empty.fire;\n\t\t\thooks.empty.fire = function() {\n\t\t\t\tif ( !hooks.unqueued ) {\n\t\t\t\t\toldfire();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\thooks.unqueued++;\n\n\t\tanim.always(function() {\n\t\t\t// doing this makes sure that the complete handler will be called\n\t\t\t// before this completes\n\t\t\tanim.always(function() {\n\t\t\t\thooks.unqueued--;\n\t\t\t\tif ( !jQuery.queue( elem, \"fx\" ).length ) {\n\t\t\t\t\thooks.empty.fire();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\t// height/width overflow pass\n\tif ( elem.nodeType === 1 && ( \"height\" in props || \"width\" in props ) ) {\n\t\t// Make sure that nothing sneaks out\n\t\t// Record all 3 overflow attributes because IE does not\n\t\t// change the overflow attribute when overflowX and\n\t\t// overflowY are set to the same value\n\t\topts.overflow = [ style.overflow, style.overflowX, style.overflowY ];\n\n\t\t// Set display property to inline-block for height/width\n\t\t// animations on inline elements that are having width/height animated\n\t\tdisplay = jQuery.css( elem, \"display\" );\n\n\t\t// Test default display if display is currently \"none\"\n\t\tcheckDisplay = display === \"none\" ?\n\t\t\tjQuery._data( elem, \"olddisplay\" ) || defaultDisplay( elem.nodeName ) : display;\n\n\t\tif ( checkDisplay === \"inline\" && jQuery.css( elem, \"float\" ) === \"none\" ) {\n\n\t\t\t// inline-level elements accept inline-block;\n\t\t\t// block-level elements need to be inline with layout\n\t\t\tif ( !support.inlineBlockNeedsLayout || defaultDisplay( elem.nodeName ) === \"inline\" ) {\n\t\t\t\tstyle.display = \"inline-block\";\n\t\t\t} else {\n\t\t\t\tstyle.zoom = 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tif ( opts.overflow ) {\n\t\tstyle.overflow = \"hidden\";\n\t\tif ( !support.shrinkWrapBlocks() ) {\n\t\t\tanim.always(function() {\n\t\t\t\tstyle.overflow = opts.overflow[ 0 ];\n\t\t\t\tstyle.overflowX = opts.overflow[ 1 ];\n\t\t\t\tstyle.overflowY = opts.overflow[ 2 ];\n\t\t\t});\n\t\t}\n\t}\n\n\t// show/hide pass\n\tfor ( prop in props ) {\n\t\tvalue = props[ prop ];\n\t\tif ( rfxtypes.exec( value ) ) {\n\t\t\tdelete props[ prop ];\n\t\t\ttoggle = toggle || value === \"toggle\";\n\t\t\tif ( value === ( hidden ? \"hide\" : \"show\" ) ) {\n\n\t\t\t\t// If there is dataShow left over from a stopped hide or show and we are going to proceed with show, we should pretend to be hidden\n\t\t\t\tif ( value === \"show\" && dataShow && dataShow[ prop ] !== undefined ) {\n\t\t\t\t\thidden = true;\n\t\t\t\t} else {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\torig[ prop ] = dataShow && dataShow[ prop ] || jQuery.style( elem, prop );\n\n\t\t// Any non-fx value stops us from restoring the original display value\n\t\t} else {\n\t\t\tdisplay = undefined;\n\t\t}\n\t}\n\n\tif ( !jQuery.isEmptyObject( orig ) ) {\n\t\tif ( dataShow ) {\n\t\t\tif ( \"hidden\" in dataShow ) {\n\t\t\t\thidden = dataShow.hidden;\n\t\t\t}\n\t\t} else {\n\t\t\tdataShow = jQuery._data( elem, \"fxshow\", {} );\n\t\t}\n\n\t\t// store state if its toggle - enables .stop().toggle() to \"reverse\"\n\t\tif ( toggle ) {\n\t\t\tdataShow.hidden = !hidden;\n\t\t}\n\t\tif ( hidden ) {\n\t\t\tjQuery( elem ).show();\n\t\t} else {\n\t\t\tanim.done(function() {\n\t\t\t\tjQuery( elem ).hide();\n\t\t\t});\n\t\t}\n\t\tanim.done(function() {\n\t\t\tvar prop;\n\t\t\tjQuery._removeData( elem, \"fxshow\" );\n\t\t\tfor ( prop in orig ) {\n\t\t\t\tjQuery.style( elem, prop, orig[ prop ] );\n\t\t\t}\n\t\t});\n\t\tfor ( prop in orig ) {\n\t\t\ttween = createTween( hidden ? dataShow[ prop ] : 0, prop, anim );\n\n\t\t\tif ( !( prop in dataShow ) ) {\n\t\t\t\tdataShow[ prop ] = tween.start;\n\t\t\t\tif ( hidden ) {\n\t\t\t\t\ttween.end = tween.start;\n\t\t\t\t\ttween.start = prop === \"width\" || prop === \"height\" ? 1 : 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t// If this is a noop like .hide().hide(), restore an overwritten display value\n\t} else if ( (display === \"none\" ? defaultDisplay( elem.nodeName ) : display) === \"inline\" ) {\n\t\tstyle.display = display;\n\t}\n}\n\nfunction propFilter( props, specialEasing ) {\n\tvar index, name, easing, value, hooks;\n\n\t// camelCase, specialEasing and expand cssHook pass\n\tfor ( index in props ) {\n\t\tname = jQuery.camelCase( index );\n\t\teasing = specialEasing[ name ];\n\t\tvalue = props[ index ];\n\t\tif ( jQuery.isArray( value ) ) {\n\t\t\teasing = value[ 1 ];\n\t\t\tvalue = props[ index ] = value[ 0 ];\n\t\t}\n\n\t\tif ( index !== name ) {\n\t\t\tprops[ name ] = value;\n\t\t\tdelete props[ index ];\n\t\t}\n\n\t\thooks = jQuery.cssHooks[ name ];\n\t\tif ( hooks && \"expand\" in hooks ) {\n\t\t\tvalue = hooks.expand( value );\n\t\t\tdelete props[ name ];\n\n\t\t\t// not quite $.extend, this wont overwrite keys already present.\n\t\t\t// also - reusing 'index' from above because we have the correct \"name\"\n\t\t\tfor ( index in value ) {\n\t\t\t\tif ( !( index in props ) ) {\n\t\t\t\t\tprops[ index ] = value[ index ];\n\t\t\t\t\tspecialEasing[ index ] = easing;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tspecialEasing[ name ] = easing;\n\t\t}\n\t}\n}\n\nfunction Animation( elem, properties, options ) {\n\tvar result,\n\t\tstopped,\n\t\tindex = 0,\n\t\tlength = animationPrefilters.length,\n\t\tdeferred = jQuery.Deferred().always( function() {\n\t\t\t// don't match elem in the :animated selector\n\t\t\tdelete tick.elem;\n\t\t}),\n\t\ttick = function() {\n\t\t\tif ( stopped ) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar currentTime = fxNow || createFxNow(),\n\t\t\t\tremaining = Math.max( 0, animation.startTime + animation.duration - currentTime ),\n\t\t\t\t// archaic crash bug won't allow us to use 1 - ( 0.5 || 0 ) (#12497)\n\t\t\t\ttemp = remaining / animation.duration || 0,\n\t\t\t\tpercent = 1 - temp,\n\t\t\t\tindex = 0,\n\t\t\t\tlength = animation.tweens.length;\n\n\t\t\tfor ( ; index < length ; index++ ) {\n\t\t\t\tanimation.tweens[ index ].run( percent );\n\t\t\t}\n\n\t\t\tdeferred.notifyWith( elem, [ animation, percent, remaining ]);\n\n\t\t\tif ( percent < 1 && length ) {\n\t\t\t\treturn remaining;\n\t\t\t} else {\n\t\t\t\tdeferred.resolveWith( elem, [ animation ] );\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\tanimation = deferred.promise({\n\t\t\telem: elem,\n\t\t\tprops: jQuery.extend( {}, properties ),\n\t\t\topts: jQuery.extend( true, { specialEasing: {} }, options ),\n\t\t\toriginalProperties: properties,\n\t\t\toriginalOptions: options,\n\t\t\tstartTime: fxNow || createFxNow(),\n\t\t\tduration: options.duration,\n\t\t\ttweens: [],\n\t\t\tcreateTween: function( prop, end ) {\n\t\t\t\tvar tween = jQuery.Tween( elem, animation.opts, prop, end,\n\t\t\t\t\t\tanimation.opts.specialEasing[ prop ] || animation.opts.easing );\n\t\t\t\tanimation.tweens.push( tween );\n\t\t\t\treturn tween;\n\t\t\t},\n\t\t\tstop: function( gotoEnd ) {\n\t\t\t\tvar index = 0,\n\t\t\t\t\t// if we are going to the end, we want to run all the tweens\n\t\t\t\t\t// otherwise we skip this part\n\t\t\t\t\tlength = gotoEnd ? animation.tweens.length : 0;\n\t\t\t\tif ( stopped ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t\tstopped = true;\n\t\t\t\tfor ( ; index < length ; index++ ) {\n\t\t\t\t\tanimation.tweens[ index ].run( 1 );\n\t\t\t\t}\n\n\t\t\t\t// resolve when we played the last frame\n\t\t\t\t// otherwise, reject\n\t\t\t\tif ( gotoEnd ) {\n\t\t\t\t\tdeferred.resolveWith( elem, [ animation, gotoEnd ] );\n\t\t\t\t} else {\n\t\t\t\t\tdeferred.rejectWith( elem, [ animation, gotoEnd ] );\n\t\t\t\t}\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}),\n\t\tprops = animation.props;\n\n\tpropFilter( props, animation.opts.specialEasing );\n\n\tfor ( ; index < length ; index++ ) {\n\t\tresult = animationPrefilters[ index ].call( animation, elem, props, animation.opts );\n\t\tif ( result ) {\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tjQuery.map( props, createTween, animation );\n\n\tif ( jQuery.isFunction( animation.opts.start ) ) {\n\t\tanimation.opts.start.call( elem, animation );\n\t}\n\n\tjQuery.fx.timer(\n\t\tjQuery.extend( tick, {\n\t\t\telem: elem,\n\t\t\tanim: animation,\n\t\t\tqueue: animation.opts.queue\n\t\t})\n\t);\n\n\t// attach callbacks from options\n\treturn animation.progress( animation.opts.progress )\n\t\t.done( animation.opts.done, animation.opts.complete )\n\t\t.fail( animation.opts.fail )\n\t\t.always( animation.opts.always );\n}\n\njQuery.Animation = jQuery.extend( Animation, {\n\ttweener: function( props, callback ) {\n\t\tif ( jQuery.isFunction( props ) ) {\n\t\t\tcallback = props;\n\t\t\tprops = [ \"*\" ];\n\t\t} else {\n\t\t\tprops = props.split(\" \");\n\t\t}\n\n\t\tvar prop,\n\t\t\tindex = 0,\n\t\t\tlength = props.length;\n\n\t\tfor ( ; index < length ; index++ ) {\n\t\t\tprop = props[ index ];\n\t\t\ttweeners[ prop ] = tweeners[ prop ] || [];\n\t\t\ttweeners[ prop ].unshift( callback );\n\t\t}\n\t},\n\n\tprefilter: function( callback, prepend ) {\n\t\tif ( prepend ) {\n\t\t\tanimationPrefilters.unshift( callback );\n\t\t} else {\n\t\t\tanimationPrefilters.push( callback );\n\t\t}\n\t}\n});\n\njQuery.speed = function( speed, easing, fn ) {\n\tvar opt = speed && typeof speed === \"object\" ? jQuery.extend( {}, speed ) : {\n\t\tcomplete: fn || !fn && easing ||\n\t\t\tjQuery.isFunction( speed ) && speed,\n\t\tduration: speed,\n\t\teasing: fn && easing || easing && !jQuery.isFunction( easing ) && easing\n\t};\n\n\topt.duration = jQuery.fx.off ? 0 : typeof opt.duration === \"number\" ? opt.duration :\n\t\topt.duration in jQuery.fx.speeds ? jQuery.fx.speeds[ opt.duration ] : jQuery.fx.speeds._default;\n\n\t// normalize opt.queue - true/undefined/null -> \"fx\"\n\tif ( opt.queue == null || opt.queue === true ) {\n\t\topt.queue = \"fx\";\n\t}\n\n\t// Queueing\n\topt.old = opt.complete;\n\n\topt.complete = function() {\n\t\tif ( jQuery.isFunction( opt.old ) ) {\n\t\t\topt.old.call( this );\n\t\t}\n\n\t\tif ( opt.queue ) {\n\t\t\tjQuery.dequeue( this, opt.queue );\n\t\t}\n\t};\n\n\treturn opt;\n};\n\njQuery.fn.extend({\n\tfadeTo: function( speed, to, easing, callback ) {\n\n\t\t// show any hidden elements after setting opacity to 0\n\t\treturn this.filter( isHidden ).css( \"opacity\", 0 ).show()\n\n\t\t\t// animate to the value specified\n\t\t\t.end().animate({ opacity: to }, speed, easing, callback );\n\t},\n\tanimate: function( prop, speed, easing, callback ) {\n\t\tvar empty = jQuery.isEmptyObject( prop ),\n\t\t\toptall = jQuery.speed( speed, easing, callback ),\n\t\t\tdoAnimation = function() {\n\t\t\t\t// Operate on a copy of prop so per-property easing won't be lost\n\t\t\t\tvar anim = Animation( this, jQuery.extend( {}, prop ), optall );\n\n\t\t\t\t// Empty animations, or finishing resolves immediately\n\t\t\t\tif ( empty || jQuery._data( this, \"finish\" ) ) {\n\t\t\t\t\tanim.stop( true );\n\t\t\t\t}\n\t\t\t};\n\t\t\tdoAnimation.finish = doAnimation;\n\n\t\treturn empty || optall.queue === false ?\n\t\t\tthis.each( doAnimation ) :\n\t\t\tthis.queue( optall.queue, doAnimation );\n\t},\n\tstop: function( type, clearQueue, gotoEnd ) {\n\t\tvar stopQueue = function( hooks ) {\n\t\t\tvar stop = hooks.stop;\n\t\t\tdelete hooks.stop;\n\t\t\tstop( gotoEnd );\n\t\t};\n\n\t\tif ( typeof type !== \"string\" ) {\n\t\t\tgotoEnd = clearQueue;\n\t\t\tclearQueue = type;\n\t\t\ttype = undefined;\n\t\t}\n\t\tif ( clearQueue && type !== false ) {\n\t\t\tthis.queue( type || \"fx\", [] );\n\t\t}\n\n\t\treturn this.each(function() {\n\t\t\tvar dequeue = true,\n\t\t\t\tindex = type != null && type + \"queueHooks\",\n\t\t\t\ttimers = jQuery.timers,\n\t\t\t\tdata = jQuery._data( this );\n\n\t\t\tif ( index ) {\n\t\t\t\tif ( data[ index ] && data[ index ].stop ) {\n\t\t\t\t\tstopQueue( data[ index ] );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor ( index in data ) {\n\t\t\t\t\tif ( data[ index ] && data[ index ].stop && rrun.test( index ) ) {\n\t\t\t\t\t\tstopQueue( data[ index ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor ( index = timers.length; index--; ) {\n\t\t\t\tif ( timers[ index ].elem === this && (type == null || timers[ index ].queue === type) ) {\n\t\t\t\t\ttimers[ index ].anim.stop( gotoEnd );\n\t\t\t\t\tdequeue = false;\n\t\t\t\t\ttimers.splice( index, 1 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// start the next in the queue if the last step wasn't forced\n\t\t\t// timers currently will call their complete callbacks, which will dequeue\n\t\t\t// but only if they were gotoEnd\n\t\t\tif ( dequeue || !gotoEnd ) {\n\t\t\t\tjQuery.dequeue( this, type );\n\t\t\t}\n\t\t});\n\t},\n\tfinish: function( type ) {\n\t\tif ( type !== false ) {\n\t\t\ttype = type || \"fx\";\n\t\t}\n\t\treturn this.each(function() {\n\t\t\tvar index,\n\t\t\t\tdata = jQuery._data( this ),\n\t\t\t\tqueue = data[ type + \"queue\" ],\n\t\t\t\thooks = data[ type + \"queueHooks\" ],\n\t\t\t\ttimers = jQuery.timers,\n\t\t\t\tlength = queue ? queue.length : 0;\n\n\t\t\t// enable finishing flag on private data\n\t\t\tdata.finish = true;\n\n\t\t\t// empty the queue first\n\t\t\tjQuery.queue( this, type, [] );\n\n\t\t\tif ( hooks && hooks.stop ) {\n\t\t\t\thooks.stop.call( this, true );\n\t\t\t}\n\n\t\t\t// look for any active animations, and finish them\n\t\t\tfor ( index = timers.length; index--; ) {\n\t\t\t\tif ( timers[ index ].elem === this && timers[ index ].queue === type ) {\n\t\t\t\t\ttimers[ index ].anim.stop( true );\n\t\t\t\t\ttimers.splice( index, 1 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// look for any animations in the old queue and finish them\n\t\t\tfor ( index = 0; index < length; index++ ) {\n\t\t\t\tif ( queue[ index ] && queue[ index ].finish ) {\n\t\t\t\t\tqueue[ index ].finish.call( this );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// turn off finishing flag\n\t\t\tdelete data.finish;\n\t\t});\n\t}\n});\n\njQuery.each([ \"toggle\", \"show\", \"hide\" ], function( i, name ) {\n\tvar cssFn = jQuery.fn[ name ];\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n\t\treturn speed == null || typeof speed === \"boolean\" ?\n\t\t\tcssFn.apply( this, arguments ) :\n\t\t\tthis.animate( genFx( name, true ), speed, easing, callback );\n\t};\n});\n\n// Generate shortcuts for custom animations\njQuery.each({\n\tslideDown: genFx(\"show\"),\n\tslideUp: genFx(\"hide\"),\n\tslideToggle: genFx(\"toggle\"),\n\tfadeIn: { opacity: \"show\" },\n\tfadeOut: { opacity: \"hide\" },\n\tfadeToggle: { opacity: \"toggle\" }\n}, function( name, props ) {\n\tjQuery.fn[ name ] = function( speed, easing, callback ) {\n\t\treturn this.animate( props, speed, easing, callback );\n\t};\n});\n\njQuery.timers = [];\njQuery.fx.tick = function() {\n\tvar timer,\n\t\ttimers = jQuery.timers,\n\t\ti = 0;\n\n\tfxNow = jQuery.now();\n\n\tfor ( ; i < timers.length; i++ ) {\n\t\ttimer = timers[ i ];\n\t\t// Checks the timer has not already been removed\n\t\tif ( !timer() && timers[ i ] === timer ) {\n\t\t\ttimers.splice( i--, 1 );\n\t\t}\n\t}\n\n\tif ( !timers.length ) {\n\t\tjQuery.fx.stop();\n\t}\n\tfxNow = undefined;\n};\n\njQuery.fx.timer = function( timer ) {\n\tjQuery.timers.push( timer );\n\tif ( timer() ) {\n\t\tjQuery.fx.start();\n\t} else {\n\t\tjQuery.timers.pop();\n\t}\n};\n\njQuery.fx.interval = 13;\n\njQuery.fx.start = function() {\n\tif ( !timerId ) {\n\t\ttimerId = setInterval( jQuery.fx.tick, jQuery.fx.interval );\n\t}\n};\n\njQuery.fx.stop = function() {\n\tclearInterval( timerId );\n\ttimerId = null;\n};\n\njQuery.fx.speeds = {\n\tslow: 600,\n\tfast: 200,\n\t// Default speed\n\t_default: 400\n};\n\n\n// Based off of the plugin by Clint Helfers, with permission.\n// http://blindsignals.com/index.php/2009/07/jquery-delay/\njQuery.fn.delay = function( time, type ) {\n\ttime = jQuery.fx ? jQuery.fx.speeds[ time ] || time : time;\n\ttype = type || \"fx\";\n\n\treturn this.queue( type, function( next, hooks ) {\n\t\tvar timeout = setTimeout( next, time );\n\t\thooks.stop = function() {\n\t\t\tclearTimeout( timeout );\n\t\t};\n\t});\n};\n\n\n(function() {\n\t// Minified: var a,b,c,d,e\n\tvar input, div, select, a, opt;\n\n\t// Setup\n\tdiv = document.createElement( \"div\" );\n\tdiv.setAttribute( \"className\", \"t\" );\n\tdiv.innerHTML = \"  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>\";\n\ta = div.getElementsByTagName(\"a\")[ 0 ];\n\n\t// First batch of tests.\n\tselect = document.createElement(\"select\");\n\topt = select.appendChild( document.createElement(\"option\") );\n\tinput = div.getElementsByTagName(\"input\")[ 0 ];\n\n\ta.style.cssText = \"top:1px\";\n\n\t// Test setAttribute on camelCase class. If it works, we need attrFixes when doing get/setAttribute (ie6/7)\n\tsupport.getSetAttribute = div.className !== \"t\";\n\n\t// Get the style information from getAttribute\n\t// (IE uses .cssText instead)\n\tsupport.style = /top/.test( a.getAttribute(\"style\") );\n\n\t// Make sure that URLs aren't manipulated\n\t// (IE normalizes it by default)\n\tsupport.hrefNormalized = a.getAttribute(\"href\") === \"/a\";\n\n\t// Check the default checkbox/radio value (\"\" on WebKit; \"on\" elsewhere)\n\tsupport.checkOn = !!input.value;\n\n\t// Make sure that a selected-by-default option has a working selected property.\n\t// (WebKit defaults to false instead of true, IE too, if it's in an optgroup)\n\tsupport.optSelected = opt.selected;\n\n\t// Tests for enctype support on a form (#6743)\n\tsupport.enctype = !!document.createElement(\"form\").enctype;\n\n\t// Make sure that the options inside disabled selects aren't marked as disabled\n\t// (WebKit marks them as disabled)\n\tselect.disabled = true;\n\tsupport.optDisabled = !opt.disabled;\n\n\t// Support: IE8 only\n\t// Check if we can trust getAttribute(\"value\")\n\tinput = document.createElement( \"input\" );\n\tinput.setAttribute( \"value\", \"\" );\n\tsupport.input = input.getAttribute( \"value\" ) === \"\";\n\n\t// Check if an input maintains its value after becoming a radio\n\tinput.value = \"t\";\n\tinput.setAttribute( \"type\", \"radio\" );\n\tsupport.radioValue = input.value === \"t\";\n})();\n\n\nvar rreturn = /\\r/g;\n\njQuery.fn.extend({\n\tval: function( value ) {\n\t\tvar hooks, ret, isFunction,\n\t\t\telem = this[0];\n\n\t\tif ( !arguments.length ) {\n\t\t\tif ( elem ) {\n\t\t\t\thooks = jQuery.valHooks[ elem.type ] || jQuery.valHooks[ elem.nodeName.toLowerCase() ];\n\n\t\t\t\tif ( hooks && \"get\" in hooks && (ret = hooks.get( elem, \"value\" )) !== undefined ) {\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\n\t\t\t\tret = elem.value;\n\n\t\t\t\treturn typeof ret === \"string\" ?\n\t\t\t\t\t// handle most common string cases\n\t\t\t\t\tret.replace(rreturn, \"\") :\n\t\t\t\t\t// handle cases where value is null/undef or number\n\t\t\t\t\tret == null ? \"\" : ret;\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tisFunction = jQuery.isFunction( value );\n\n\t\treturn this.each(function( i ) {\n\t\t\tvar val;\n\n\t\t\tif ( this.nodeType !== 1 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif ( isFunction ) {\n\t\t\t\tval = value.call( this, i, jQuery( this ).val() );\n\t\t\t} else {\n\t\t\t\tval = value;\n\t\t\t}\n\n\t\t\t// Treat null/undefined as \"\"; convert numbers to string\n\t\t\tif ( val == null ) {\n\t\t\t\tval = \"\";\n\t\t\t} else if ( typeof val === \"number\" ) {\n\t\t\t\tval += \"\";\n\t\t\t} else if ( jQuery.isArray( val ) ) {\n\t\t\t\tval = jQuery.map( val, function( value ) {\n\t\t\t\t\treturn value == null ? \"\" : value + \"\";\n\t\t\t\t});\n\t\t\t}\n\n\t\t\thooks = jQuery.valHooks[ this.type ] || jQuery.valHooks[ this.nodeName.toLowerCase() ];\n\n\t\t\t// If set returns undefined, fall back to normal setting\n\t\t\tif ( !hooks || !(\"set\" in hooks) || hooks.set( this, val, \"value\" ) === undefined ) {\n\t\t\t\tthis.value = val;\n\t\t\t}\n\t\t});\n\t}\n});\n\njQuery.extend({\n\tvalHooks: {\n\t\toption: {\n\t\t\tget: function( elem ) {\n\t\t\t\tvar val = jQuery.find.attr( elem, \"value\" );\n\t\t\t\treturn val != null ?\n\t\t\t\t\tval :\n\t\t\t\t\t// Support: IE10-11+\n\t\t\t\t\t// option.text throws exceptions (#14686, #14858)\n\t\t\t\t\tjQuery.trim( jQuery.text( elem ) );\n\t\t\t}\n\t\t},\n\t\tselect: {\n\t\t\tget: function( elem ) {\n\t\t\t\tvar value, option,\n\t\t\t\t\toptions = elem.options,\n\t\t\t\t\tindex = elem.selectedIndex,\n\t\t\t\t\tone = elem.type === \"select-one\" || index < 0,\n\t\t\t\t\tvalues = one ? null : [],\n\t\t\t\t\tmax = one ? index + 1 : options.length,\n\t\t\t\t\ti = index < 0 ?\n\t\t\t\t\t\tmax :\n\t\t\t\t\t\tone ? index : 0;\n\n\t\t\t\t// Loop through all the selected options\n\t\t\t\tfor ( ; i < max; i++ ) {\n\t\t\t\t\toption = options[ i ];\n\n\t\t\t\t\t// oldIE doesn't update selected after form reset (#2551)\n\t\t\t\t\tif ( ( option.selected || i === index ) &&\n\t\t\t\t\t\t\t// Don't return options that are disabled or in a disabled optgroup\n\t\t\t\t\t\t\t( support.optDisabled ? !option.disabled : option.getAttribute(\"disabled\") === null ) &&\n\t\t\t\t\t\t\t( !option.parentNode.disabled || !jQuery.nodeName( option.parentNode, \"optgroup\" ) ) ) {\n\n\t\t\t\t\t\t// Get the specific value for the option\n\t\t\t\t\t\tvalue = jQuery( option ).val();\n\n\t\t\t\t\t\t// We don't need an array for one selects\n\t\t\t\t\t\tif ( one ) {\n\t\t\t\t\t\t\treturn value;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Multi-Selects return an array\n\t\t\t\t\t\tvalues.push( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn values;\n\t\t\t},\n\n\t\t\tset: function( elem, value ) {\n\t\t\t\tvar optionSet, option,\n\t\t\t\t\toptions = elem.options,\n\t\t\t\t\tvalues = jQuery.makeArray( value ),\n\t\t\t\t\ti = options.length;\n\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\toption = options[ i ];\n\n\t\t\t\t\tif ( jQuery.inArray( jQuery.valHooks.option.get( option ), values ) >= 0 ) {\n\n\t\t\t\t\t\t// Support: IE6\n\t\t\t\t\t\t// When new option element is added to select box we need to\n\t\t\t\t\t\t// force reflow of newly added node in order to workaround delay\n\t\t\t\t\t\t// of initialization properties\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\toption.selected = optionSet = true;\n\n\t\t\t\t\t\t} catch ( _ ) {\n\n\t\t\t\t\t\t\t// Will be executed only in IE6\n\t\t\t\t\t\t\toption.scrollHeight;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\toption.selected = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Force browsers to behave consistently when non-matching value is set\n\t\t\t\tif ( !optionSet ) {\n\t\t\t\t\telem.selectedIndex = -1;\n\t\t\t\t}\n\n\t\t\t\treturn options;\n\t\t\t}\n\t\t}\n\t}\n});\n\n// Radios and checkboxes getter/setter\njQuery.each([ \"radio\", \"checkbox\" ], function() {\n\tjQuery.valHooks[ this ] = {\n\t\tset: function( elem, value ) {\n\t\t\tif ( jQuery.isArray( value ) ) {\n\t\t\t\treturn ( elem.checked = jQuery.inArray( jQuery(elem).val(), value ) >= 0 );\n\t\t\t}\n\t\t}\n\t};\n\tif ( !support.checkOn ) {\n\t\tjQuery.valHooks[ this ].get = function( elem ) {\n\t\t\t// Support: Webkit\n\t\t\t// \"\" is returned instead of \"on\" if a value isn't specified\n\t\t\treturn elem.getAttribute(\"value\") === null ? \"on\" : elem.value;\n\t\t};\n\t}\n});\n\n\n\n\nvar nodeHook, boolHook,\n\tattrHandle = jQuery.expr.attrHandle,\n\truseDefault = /^(?:checked|selected)$/i,\n\tgetSetAttribute = support.getSetAttribute,\n\tgetSetInput = support.input;\n\njQuery.fn.extend({\n\tattr: function( name, value ) {\n\t\treturn access( this, jQuery.attr, name, value, arguments.length > 1 );\n\t},\n\n\tremoveAttr: function( name ) {\n\t\treturn this.each(function() {\n\t\t\tjQuery.removeAttr( this, name );\n\t\t});\n\t}\n});\n\njQuery.extend({\n\tattr: function( elem, name, value ) {\n\t\tvar hooks, ret,\n\t\t\tnType = elem.nodeType;\n\n\t\t// don't get/set attributes on text, comment and attribute nodes\n\t\tif ( !elem || nType === 3 || nType === 8 || nType === 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Fallback to prop when attributes are not supported\n\t\tif ( typeof elem.getAttribute === strundefined ) {\n\t\t\treturn jQuery.prop( elem, name, value );\n\t\t}\n\n\t\t// All attributes are lowercase\n\t\t// Grab necessary hook if one is defined\n\t\tif ( nType !== 1 || !jQuery.isXMLDoc( elem ) ) {\n\t\t\tname = name.toLowerCase();\n\t\t\thooks = jQuery.attrHooks[ name ] ||\n\t\t\t\t( jQuery.expr.match.bool.test( name ) ? boolHook : nodeHook );\n\t\t}\n\n\t\tif ( value !== undefined ) {\n\n\t\t\tif ( value === null ) {\n\t\t\t\tjQuery.removeAttr( elem, name );\n\n\t\t\t} else if ( hooks && \"set\" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ) {\n\t\t\t\treturn ret;\n\n\t\t\t} else {\n\t\t\t\telem.setAttribute( name, value + \"\" );\n\t\t\t\treturn value;\n\t\t\t}\n\n\t\t} else if ( hooks && \"get\" in hooks && (ret = hooks.get( elem, name )) !== null ) {\n\t\t\treturn ret;\n\n\t\t} else {\n\t\t\tret = jQuery.find.attr( elem, name );\n\n\t\t\t// Non-existent attributes return null, we normalize to undefined\n\t\t\treturn ret == null ?\n\t\t\t\tundefined :\n\t\t\t\tret;\n\t\t}\n\t},\n\n\tremoveAttr: function( elem, value ) {\n\t\tvar name, propName,\n\t\t\ti = 0,\n\t\t\tattrNames = value && value.match( rnotwhite );\n\n\t\tif ( attrNames && elem.nodeType === 1 ) {\n\t\t\twhile ( (name = attrNames[i++]) ) {\n\t\t\t\tpropName = jQuery.propFix[ name ] || name;\n\n\t\t\t\t// Boolean attributes get special treatment (#10870)\n\t\t\t\tif ( jQuery.expr.match.bool.test( name ) ) {\n\t\t\t\t\t// Set corresponding property to false\n\t\t\t\t\tif ( getSetInput && getSetAttribute || !ruseDefault.test( name ) ) {\n\t\t\t\t\t\telem[ propName ] = false;\n\t\t\t\t\t// Support: IE<9\n\t\t\t\t\t// Also clear defaultChecked/defaultSelected (if appropriate)\n\t\t\t\t\t} else {\n\t\t\t\t\t\telem[ jQuery.camelCase( \"default-\" + name ) ] =\n\t\t\t\t\t\t\telem[ propName ] = false;\n\t\t\t\t\t}\n\n\t\t\t\t// See #9699 for explanation of this approach (setting first, then removal)\n\t\t\t\t} else {\n\t\t\t\t\tjQuery.attr( elem, name, \"\" );\n\t\t\t\t}\n\n\t\t\t\telem.removeAttribute( getSetAttribute ? name : propName );\n\t\t\t}\n\t\t}\n\t},\n\n\tattrHooks: {\n\t\ttype: {\n\t\t\tset: function( elem, value ) {\n\t\t\t\tif ( !support.radioValue && value === \"radio\" && jQuery.nodeName(elem, \"input\") ) {\n\t\t\t\t\t// Setting the type on a radio button after the value resets the value in IE6-9\n\t\t\t\t\t// Reset value to default in case type is set after value during creation\n\t\t\t\t\tvar val = elem.value;\n\t\t\t\t\telem.setAttribute( \"type\", value );\n\t\t\t\t\tif ( val ) {\n\t\t\t\t\t\telem.value = val;\n\t\t\t\t\t}\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n});\n\n// Hook for boolean attributes\nboolHook = {\n\tset: function( elem, value, name ) {\n\t\tif ( value === false ) {\n\t\t\t// Remove boolean attributes when set to false\n\t\t\tjQuery.removeAttr( elem, name );\n\t\t} else if ( getSetInput && getSetAttribute || !ruseDefault.test( name ) ) {\n\t\t\t// IE<8 needs the *property* name\n\t\t\telem.setAttribute( !getSetAttribute && jQuery.propFix[ name ] || name, name );\n\n\t\t// Use defaultChecked and defaultSelected for oldIE\n\t\t} else {\n\t\t\telem[ jQuery.camelCase( \"default-\" + name ) ] = elem[ name ] = true;\n\t\t}\n\n\t\treturn name;\n\t}\n};\n\n// Retrieve booleans specially\njQuery.each( jQuery.expr.match.bool.source.match( /\\w+/g ), function( i, name ) {\n\n\tvar getter = attrHandle[ name ] || jQuery.find.attr;\n\n\tattrHandle[ name ] = getSetInput && getSetAttribute || !ruseDefault.test( name ) ?\n\t\tfunction( elem, name, isXML ) {\n\t\t\tvar ret, handle;\n\t\t\tif ( !isXML ) {\n\t\t\t\t// Avoid an infinite loop by temporarily removing this function from the getter\n\t\t\t\thandle = attrHandle[ name ];\n\t\t\t\tattrHandle[ name ] = ret;\n\t\t\t\tret = getter( elem, name, isXML ) != null ?\n\t\t\t\t\tname.toLowerCase() :\n\t\t\t\t\tnull;\n\t\t\t\tattrHandle[ name ] = handle;\n\t\t\t}\n\t\t\treturn ret;\n\t\t} :\n\t\tfunction( elem, name, isXML ) {\n\t\t\tif ( !isXML ) {\n\t\t\t\treturn elem[ jQuery.camelCase( \"default-\" + name ) ] ?\n\t\t\t\t\tname.toLowerCase() :\n\t\t\t\t\tnull;\n\t\t\t}\n\t\t};\n});\n\n// fix oldIE attroperties\nif ( !getSetInput || !getSetAttribute ) {\n\tjQuery.attrHooks.value = {\n\t\tset: function( elem, value, name ) {\n\t\t\tif ( jQuery.nodeName( elem, \"input\" ) ) {\n\t\t\t\t// Does not return so that setAttribute is also used\n\t\t\t\telem.defaultValue = value;\n\t\t\t} else {\n\t\t\t\t// Use nodeHook if defined (#1954); otherwise setAttribute is fine\n\t\t\t\treturn nodeHook && nodeHook.set( elem, value, name );\n\t\t\t}\n\t\t}\n\t};\n}\n\n// IE6/7 do not support getting/setting some attributes with get/setAttribute\nif ( !getSetAttribute ) {\n\n\t// Use this for any attribute in IE6/7\n\t// This fixes almost every IE6/7 issue\n\tnodeHook = {\n\t\tset: function( elem, value, name ) {\n\t\t\t// Set the existing or create a new attribute node\n\t\t\tvar ret = elem.getAttributeNode( name );\n\t\t\tif ( !ret ) {\n\t\t\t\telem.setAttributeNode(\n\t\t\t\t\t(ret = elem.ownerDocument.createAttribute( name ))\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tret.value = value += \"\";\n\n\t\t\t// Break association with cloned elements by also using setAttribute (#9646)\n\t\t\tif ( name === \"value\" || value === elem.getAttribute( name ) ) {\n\t\t\t\treturn value;\n\t\t\t}\n\t\t}\n\t};\n\n\t// Some attributes are constructed with empty-string values when not defined\n\tattrHandle.id = attrHandle.name = attrHandle.coords =\n\t\tfunction( elem, name, isXML ) {\n\t\t\tvar ret;\n\t\t\tif ( !isXML ) {\n\t\t\t\treturn (ret = elem.getAttributeNode( name )) && ret.value !== \"\" ?\n\t\t\t\t\tret.value :\n\t\t\t\t\tnull;\n\t\t\t}\n\t\t};\n\n\t// Fixing value retrieval on a button requires this module\n\tjQuery.valHooks.button = {\n\t\tget: function( elem, name ) {\n\t\t\tvar ret = elem.getAttributeNode( name );\n\t\t\tif ( ret && ret.specified ) {\n\t\t\t\treturn ret.value;\n\t\t\t}\n\t\t},\n\t\tset: nodeHook.set\n\t};\n\n\t// Set contenteditable to false on removals(#10429)\n\t// Setting to empty string throws an error as an invalid value\n\tjQuery.attrHooks.contenteditable = {\n\t\tset: function( elem, value, name ) {\n\t\t\tnodeHook.set( elem, value === \"\" ? false : value, name );\n\t\t}\n\t};\n\n\t// Set width and height to auto instead of 0 on empty string( Bug #8150 )\n\t// This is for removals\n\tjQuery.each([ \"width\", \"height\" ], function( i, name ) {\n\t\tjQuery.attrHooks[ name ] = {\n\t\t\tset: function( elem, value ) {\n\t\t\t\tif ( value === \"\" ) {\n\t\t\t\t\telem.setAttribute( name, \"auto\" );\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t});\n}\n\nif ( !support.style ) {\n\tjQuery.attrHooks.style = {\n\t\tget: function( elem ) {\n\t\t\t// Return undefined in the case of empty string\n\t\t\t// Note: IE uppercases css property names, but if we were to .toLowerCase()\n\t\t\t// .cssText, that would destroy case senstitivity in URL's, like in \"background\"\n\t\t\treturn elem.style.cssText || undefined;\n\t\t},\n\t\tset: function( elem, value ) {\n\t\t\treturn ( elem.style.cssText = value + \"\" );\n\t\t}\n\t};\n}\n\n\n\n\nvar rfocusable = /^(?:input|select|textarea|button|object)$/i,\n\trclickable = /^(?:a|area)$/i;\n\njQuery.fn.extend({\n\tprop: function( name, value ) {\n\t\treturn access( this, jQuery.prop, name, value, arguments.length > 1 );\n\t},\n\n\tremoveProp: function( name ) {\n\t\tname = jQuery.propFix[ name ] || name;\n\t\treturn this.each(function() {\n\t\t\t// try/catch handles cases where IE balks (such as removing a property on window)\n\t\t\ttry {\n\t\t\t\tthis[ name ] = undefined;\n\t\t\t\tdelete this[ name ];\n\t\t\t} catch( e ) {}\n\t\t});\n\t}\n});\n\njQuery.extend({\n\tpropFix: {\n\t\t\"for\": \"htmlFor\",\n\t\t\"class\": \"className\"\n\t},\n\n\tprop: function( elem, name, value ) {\n\t\tvar ret, hooks, notxml,\n\t\t\tnType = elem.nodeType;\n\n\t\t// don't get/set properties on text, comment and attribute nodes\n\t\tif ( !elem || nType === 3 || nType === 8 || nType === 2 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tnotxml = nType !== 1 || !jQuery.isXMLDoc( elem );\n\n\t\tif ( notxml ) {\n\t\t\t// Fix name and attach hooks\n\t\t\tname = jQuery.propFix[ name ] || name;\n\t\t\thooks = jQuery.propHooks[ name ];\n\t\t}\n\n\t\tif ( value !== undefined ) {\n\t\t\treturn hooks && \"set\" in hooks && (ret = hooks.set( elem, value, name )) !== undefined ?\n\t\t\t\tret :\n\t\t\t\t( elem[ name ] = value );\n\n\t\t} else {\n\t\t\treturn hooks && \"get\" in hooks && (ret = hooks.get( elem, name )) !== null ?\n\t\t\t\tret :\n\t\t\t\telem[ name ];\n\t\t}\n\t},\n\n\tpropHooks: {\n\t\ttabIndex: {\n\t\t\tget: function( elem ) {\n\t\t\t\t// elem.tabIndex doesn't always return the correct value when it hasn't been explicitly set\n\t\t\t\t// http://fluidproject.org/blog/2008/01/09/getting-setting-and-removing-tabindex-values-with-javascript/\n\t\t\t\t// Use proper attribute retrieval(#12072)\n\t\t\t\tvar tabindex = jQuery.find.attr( elem, \"tabindex\" );\n\n\t\t\t\treturn tabindex ?\n\t\t\t\t\tparseInt( tabindex, 10 ) :\n\t\t\t\t\trfocusable.test( elem.nodeName ) || rclickable.test( elem.nodeName ) && elem.href ?\n\t\t\t\t\t\t0 :\n\t\t\t\t\t\t-1;\n\t\t\t}\n\t\t}\n\t}\n});\n\n// Some attributes require a special call on IE\n// http://msdn.microsoft.com/en-us/library/ms536429%28VS.85%29.aspx\nif ( !support.hrefNormalized ) {\n\t// href/src property should get the full normalized URL (#10299/#12915)\n\tjQuery.each([ \"href\", \"src\" ], function( i, name ) {\n\t\tjQuery.propHooks[ name ] = {\n\t\t\tget: function( elem ) {\n\t\t\t\treturn elem.getAttribute( name, 4 );\n\t\t\t}\n\t\t};\n\t});\n}\n\n// Support: Safari, IE9+\n// mis-reports the default selected property of an option\n// Accessing the parent's selectedIndex property fixes it\nif ( !support.optSelected ) {\n\tjQuery.propHooks.selected = {\n\t\tget: function( elem ) {\n\t\t\tvar parent = elem.parentNode;\n\n\t\t\tif ( parent ) {\n\t\t\t\tparent.selectedIndex;\n\n\t\t\t\t// Make sure that it also works with optgroups, see #5701\n\t\t\t\tif ( parent.parentNode ) {\n\t\t\t\t\tparent.parentNode.selectedIndex;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t};\n}\n\njQuery.each([\n\t\"tabIndex\",\n\t\"readOnly\",\n\t\"maxLength\",\n\t\"cellSpacing\",\n\t\"cellPadding\",\n\t\"rowSpan\",\n\t\"colSpan\",\n\t\"useMap\",\n\t\"frameBorder\",\n\t\"contentEditable\"\n], function() {\n\tjQuery.propFix[ this.toLowerCase() ] = this;\n});\n\n// IE6/7 call enctype encoding\nif ( !support.enctype ) {\n\tjQuery.propFix.enctype = \"encoding\";\n}\n\n\n\n\nvar rclass = /[\\t\\r\\n\\f]/g;\n\njQuery.fn.extend({\n\taddClass: function( value ) {\n\t\tvar classes, elem, cur, clazz, j, finalValue,\n\t\t\ti = 0,\n\t\t\tlen = this.length,\n\t\t\tproceed = typeof value === \"string\" && value;\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each(function( j ) {\n\t\t\t\tjQuery( this ).addClass( value.call( this, j, this.className ) );\n\t\t\t});\n\t\t}\n\n\t\tif ( proceed ) {\n\t\t\t// The disjunction here is for better compressibility (see removeClass)\n\t\t\tclasses = ( value || \"\" ).match( rnotwhite ) || [];\n\n\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\telem = this[ i ];\n\t\t\t\tcur = elem.nodeType === 1 && ( elem.className ?\n\t\t\t\t\t( \" \" + elem.className + \" \" ).replace( rclass, \" \" ) :\n\t\t\t\t\t\" \"\n\t\t\t\t);\n\n\t\t\t\tif ( cur ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( (clazz = classes[j++]) ) {\n\t\t\t\t\t\tif ( cur.indexOf( \" \" + clazz + \" \" ) < 0 ) {\n\t\t\t\t\t\t\tcur += clazz + \" \";\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// only assign if different to avoid unneeded rendering.\n\t\t\t\t\tfinalValue = jQuery.trim( cur );\n\t\t\t\t\tif ( elem.className !== finalValue ) {\n\t\t\t\t\t\telem.className = finalValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\tremoveClass: function( value ) {\n\t\tvar classes, elem, cur, clazz, j, finalValue,\n\t\t\ti = 0,\n\t\t\tlen = this.length,\n\t\t\tproceed = arguments.length === 0 || typeof value === \"string\" && value;\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each(function( j ) {\n\t\t\t\tjQuery( this ).removeClass( value.call( this, j, this.className ) );\n\t\t\t});\n\t\t}\n\t\tif ( proceed ) {\n\t\t\tclasses = ( value || \"\" ).match( rnotwhite ) || [];\n\n\t\t\tfor ( ; i < len; i++ ) {\n\t\t\t\telem = this[ i ];\n\t\t\t\t// This expression is here for better compressibility (see addClass)\n\t\t\t\tcur = elem.nodeType === 1 && ( elem.className ?\n\t\t\t\t\t( \" \" + elem.className + \" \" ).replace( rclass, \" \" ) :\n\t\t\t\t\t\"\"\n\t\t\t\t);\n\n\t\t\t\tif ( cur ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( (clazz = classes[j++]) ) {\n\t\t\t\t\t\t// Remove *all* instances\n\t\t\t\t\t\twhile ( cur.indexOf( \" \" + clazz + \" \" ) >= 0 ) {\n\t\t\t\t\t\t\tcur = cur.replace( \" \" + clazz + \" \", \" \" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// only assign if different to avoid unneeded rendering.\n\t\t\t\t\tfinalValue = value ? jQuery.trim( cur ) : \"\";\n\t\t\t\t\tif ( elem.className !== finalValue ) {\n\t\t\t\t\t\telem.className = finalValue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t},\n\n\ttoggleClass: function( value, stateVal ) {\n\t\tvar type = typeof value;\n\n\t\tif ( typeof stateVal === \"boolean\" && type === \"string\" ) {\n\t\t\treturn stateVal ? this.addClass( value ) : this.removeClass( value );\n\t\t}\n\n\t\tif ( jQuery.isFunction( value ) ) {\n\t\t\treturn this.each(function( i ) {\n\t\t\t\tjQuery( this ).toggleClass( value.call(this, i, this.className, stateVal), stateVal );\n\t\t\t});\n\t\t}\n\n\t\treturn this.each(function() {\n\t\t\tif ( type === \"string\" ) {\n\t\t\t\t// toggle individual class names\n\t\t\t\tvar className,\n\t\t\t\t\ti = 0,\n\t\t\t\t\tself = jQuery( this ),\n\t\t\t\t\tclassNames = value.match( rnotwhite ) || [];\n\n\t\t\t\twhile ( (className = classNames[ i++ ]) ) {\n\t\t\t\t\t// check each className given, space separated list\n\t\t\t\t\tif ( self.hasClass( className ) ) {\n\t\t\t\t\t\tself.removeClass( className );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tself.addClass( className );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Toggle whole class name\n\t\t\t} else if ( type === strundefined || type === \"boolean\" ) {\n\t\t\t\tif ( this.className ) {\n\t\t\t\t\t// store className if set\n\t\t\t\t\tjQuery._data( this, \"__className__\", this.className );\n\t\t\t\t}\n\n\t\t\t\t// If the element has a class name or if we're passed \"false\",\n\t\t\t\t// then remove the whole classname (if there was one, the above saved it).\n\t\t\t\t// Otherwise bring back whatever was previously saved (if anything),\n\t\t\t\t// falling back to the empty string if nothing was stored.\n\t\t\t\tthis.className = this.className || value === false ? \"\" : jQuery._data( this, \"__className__\" ) || \"\";\n\t\t\t}\n\t\t});\n\t},\n\n\thasClass: function( selector ) {\n\t\tvar className = \" \" + selector + \" \",\n\t\t\ti = 0,\n\t\t\tl = this.length;\n\t\tfor ( ; i < l; i++ ) {\n\t\t\tif ( this[i].nodeType === 1 && (\" \" + this[i].className + \" \").replace(rclass, \" \").indexOf( className ) >= 0 ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n});\n\n\n\n\n// Return jQuery for attributes-only inclusion\n\n\njQuery.each( (\"blur focus focusin focusout load resize scroll unload click dblclick \" +\n\t\"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave \" +\n\t\"change select submit keydown keypress keyup error contextmenu\").split(\" \"), function( i, name ) {\n\n\t// Handle event binding\n\tjQuery.fn[ name ] = function( data, fn ) {\n\t\treturn arguments.length > 0 ?\n\t\t\tthis.on( name, null, data, fn ) :\n\t\t\tthis.trigger( name );\n\t};\n});\n\njQuery.fn.extend({\n\thover: function( fnOver, fnOut ) {\n\t\treturn this.mouseenter( fnOver ).mouseleave( fnOut || fnOver );\n\t},\n\n\tbind: function( types, data, fn ) {\n\t\treturn this.on( types, null, data, fn );\n\t},\n\tunbind: function( types, fn ) {\n\t\treturn this.off( types, null, fn );\n\t},\n\n\tdelegate: function( selector, types, data, fn ) {\n\t\treturn this.on( types, selector, data, fn );\n\t},\n\tundelegate: function( selector, types, fn ) {\n\t\t// ( namespace ) or ( selector, types [, fn] )\n\t\treturn arguments.length === 1 ? this.off( selector, \"**\" ) : this.off( types, selector || \"**\", fn );\n\t}\n});\n\n\nvar nonce = jQuery.now();\n\nvar rquery = (/\\?/);\n\n\n\nvar rvalidtokens = /(,)|(\\[|{)|(}|])|\"(?:[^\"\\\\\\r\\n]|\\\\[\"\\\\\\/bfnrt]|\\\\u[\\da-fA-F]{4})*\"\\s*:?|true|false|null|-?(?!0\\d)\\d+(?:\\.\\d+|)(?:[eE][+-]?\\d+|)/g;\n\njQuery.parseJSON = function( data ) {\n\t// Attempt to parse using the native JSON parser first\n\tif ( window.JSON && window.JSON.parse ) {\n\t\t// Support: Android 2.3\n\t\t// Workaround failure to string-cast null input\n\t\treturn window.JSON.parse( data + \"\" );\n\t}\n\n\tvar requireNonComma,\n\t\tdepth = null,\n\t\tstr = jQuery.trim( data + \"\" );\n\n\t// Guard against invalid (and possibly dangerous) input by ensuring that nothing remains\n\t// after removing valid tokens\n\treturn str && !jQuery.trim( str.replace( rvalidtokens, function( token, comma, open, close ) {\n\n\t\t// Force termination if we see a misplaced comma\n\t\tif ( requireNonComma && comma ) {\n\t\t\tdepth = 0;\n\t\t}\n\n\t\t// Perform no more replacements after returning to outermost depth\n\t\tif ( depth === 0 ) {\n\t\t\treturn token;\n\t\t}\n\n\t\t// Commas must not follow \"[\", \"{\", or \",\"\n\t\trequireNonComma = open || comma;\n\n\t\t// Determine new depth\n\t\t// array/object open (\"[\" or \"{\"): depth += true - false (increment)\n\t\t// array/object close (\"]\" or \"}\"): depth += false - true (decrement)\n\t\t// other cases (\",\" or primitive): depth += true - true (numeric cast)\n\t\tdepth += !close - !open;\n\n\t\t// Remove this token\n\t\treturn \"\";\n\t}) ) ?\n\t\t( Function( \"return \" + str ) )() :\n\t\tjQuery.error( \"Invalid JSON: \" + data );\n};\n\n\n// Cross-browser xml parsing\njQuery.parseXML = function( data ) {\n\tvar xml, tmp;\n\tif ( !data || typeof data !== \"string\" ) {\n\t\treturn null;\n\t}\n\ttry {\n\t\tif ( window.DOMParser ) { // Standard\n\t\t\ttmp = new DOMParser();\n\t\t\txml = tmp.parseFromString( data, \"text/xml\" );\n\t\t} else { // IE\n\t\t\txml = new ActiveXObject( \"Microsoft.XMLDOM\" );\n\t\t\txml.async = \"false\";\n\t\t\txml.loadXML( data );\n\t\t}\n\t} catch( e ) {\n\t\txml = undefined;\n\t}\n\tif ( !xml || !xml.documentElement || xml.getElementsByTagName( \"parsererror\" ).length ) {\n\t\tjQuery.error( \"Invalid XML: \" + data );\n\t}\n\treturn xml;\n};\n\n\nvar\n\t// Document location\n\tajaxLocParts,\n\tajaxLocation,\n\n\trhash = /#.*$/,\n\trts = /([?&])_=[^&]*/,\n\trheaders = /^(.*?):[ \\t]*([^\\r\\n]*)\\r?$/mg, // IE leaves an \\r character at EOL\n\t// #7653, #8125, #8152: local protocol detection\n\trlocalProtocol = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/,\n\trnoContent = /^(?:GET|HEAD)$/,\n\trprotocol = /^\\/\\//,\n\trurl = /^([\\w.+-]+:)(?:\\/\\/(?:[^\\/?#]*@|)([^\\/?#:]*)(?::(\\d+)|)|)/,\n\n\t/* Prefilters\n\t * 1) They are useful to introduce custom dataTypes (see ajax/jsonp.js for an example)\n\t * 2) These are called:\n\t *    - BEFORE asking for a transport\n\t *    - AFTER param serialization (s.data is a string if s.processData is true)\n\t * 3) key is the dataType\n\t * 4) the catchall symbol \"*\" can be used\n\t * 5) execution will start with transport dataType and THEN continue down to \"*\" if needed\n\t */\n\tprefilters = {},\n\n\t/* Transports bindings\n\t * 1) key is the dataType\n\t * 2) the catchall symbol \"*\" can be used\n\t * 3) selection will start with transport dataType and THEN go to \"*\" if needed\n\t */\n\ttransports = {},\n\n\t// Avoid comment-prolog char sequence (#10098); must appease lint and evade compression\n\tallTypes = \"*/\".concat(\"*\");\n\n// #8138, IE may throw an exception when accessing\n// a field from window.location if document.domain has been set\ntry {\n\tajaxLocation = location.href;\n} catch( e ) {\n\t// Use the href attribute of an A element\n\t// since IE will modify it given document.location\n\tajaxLocation = document.createElement( \"a\" );\n\tajaxLocation.href = \"\";\n\tajaxLocation = ajaxLocation.href;\n}\n\n// Segment location into parts\najaxLocParts = rurl.exec( ajaxLocation.toLowerCase() ) || [];\n\n// Base \"constructor\" for jQuery.ajaxPrefilter and jQuery.ajaxTransport\nfunction addToPrefiltersOrTransports( structure ) {\n\n\t// dataTypeExpression is optional and defaults to \"*\"\n\treturn function( dataTypeExpression, func ) {\n\n\t\tif ( typeof dataTypeExpression !== \"string\" ) {\n\t\t\tfunc = dataTypeExpression;\n\t\t\tdataTypeExpression = \"*\";\n\t\t}\n\n\t\tvar dataType,\n\t\t\ti = 0,\n\t\t\tdataTypes = dataTypeExpression.toLowerCase().match( rnotwhite ) || [];\n\n\t\tif ( jQuery.isFunction( func ) ) {\n\t\t\t// For each dataType in the dataTypeExpression\n\t\t\twhile ( (dataType = dataTypes[i++]) ) {\n\t\t\t\t// Prepend if requested\n\t\t\t\tif ( dataType.charAt( 0 ) === \"+\" ) {\n\t\t\t\t\tdataType = dataType.slice( 1 ) || \"*\";\n\t\t\t\t\t(structure[ dataType ] = structure[ dataType ] || []).unshift( func );\n\n\t\t\t\t// Otherwise append\n\t\t\t\t} else {\n\t\t\t\t\t(structure[ dataType ] = structure[ dataType ] || []).push( func );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}\n\n// Base inspection function for prefilters and transports\nfunction inspectPrefiltersOrTransports( structure, options, originalOptions, jqXHR ) {\n\n\tvar inspected = {},\n\t\tseekingTransport = ( structure === transports );\n\n\tfunction inspect( dataType ) {\n\t\tvar selected;\n\t\tinspected[ dataType ] = true;\n\t\tjQuery.each( structure[ dataType ] || [], function( _, prefilterOrFactory ) {\n\t\t\tvar dataTypeOrTransport = prefilterOrFactory( options, originalOptions, jqXHR );\n\t\t\tif ( typeof dataTypeOrTransport === \"string\" && !seekingTransport && !inspected[ dataTypeOrTransport ] ) {\n\t\t\t\toptions.dataTypes.unshift( dataTypeOrTransport );\n\t\t\t\tinspect( dataTypeOrTransport );\n\t\t\t\treturn false;\n\t\t\t} else if ( seekingTransport ) {\n\t\t\t\treturn !( selected = dataTypeOrTransport );\n\t\t\t}\n\t\t});\n\t\treturn selected;\n\t}\n\n\treturn inspect( options.dataTypes[ 0 ] ) || !inspected[ \"*\" ] && inspect( \"*\" );\n}\n\n// A special extend for ajax options\n// that takes \"flat\" options (not to be deep extended)\n// Fixes #9887\nfunction ajaxExtend( target, src ) {\n\tvar deep, key,\n\t\tflatOptions = jQuery.ajaxSettings.flatOptions || {};\n\n\tfor ( key in src ) {\n\t\tif ( src[ key ] !== undefined ) {\n\t\t\t( flatOptions[ key ] ? target : ( deep || (deep = {}) ) )[ key ] = src[ key ];\n\t\t}\n\t}\n\tif ( deep ) {\n\t\tjQuery.extend( true, target, deep );\n\t}\n\n\treturn target;\n}\n\n/* Handles responses to an ajax request:\n * - finds the right dataType (mediates between content-type and expected dataType)\n * - returns the corresponding response\n */\nfunction ajaxHandleResponses( s, jqXHR, responses ) {\n\tvar firstDataType, ct, finalDataType, type,\n\t\tcontents = s.contents,\n\t\tdataTypes = s.dataTypes;\n\n\t// Remove auto dataType and get content-type in the process\n\twhile ( dataTypes[ 0 ] === \"*\" ) {\n\t\tdataTypes.shift();\n\t\tif ( ct === undefined ) {\n\t\t\tct = s.mimeType || jqXHR.getResponseHeader(\"Content-Type\");\n\t\t}\n\t}\n\n\t// Check if we're dealing with a known content-type\n\tif ( ct ) {\n\t\tfor ( type in contents ) {\n\t\t\tif ( contents[ type ] && contents[ type ].test( ct ) ) {\n\t\t\t\tdataTypes.unshift( type );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Check to see if we have a response for the expected dataType\n\tif ( dataTypes[ 0 ] in responses ) {\n\t\tfinalDataType = dataTypes[ 0 ];\n\t} else {\n\t\t// Try convertible dataTypes\n\t\tfor ( type in responses ) {\n\t\t\tif ( !dataTypes[ 0 ] || s.converters[ type + \" \" + dataTypes[0] ] ) {\n\t\t\t\tfinalDataType = type;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif ( !firstDataType ) {\n\t\t\t\tfirstDataType = type;\n\t\t\t}\n\t\t}\n\t\t// Or just use first one\n\t\tfinalDataType = finalDataType || firstDataType;\n\t}\n\n\t// If we found a dataType\n\t// We add the dataType to the list if needed\n\t// and return the corresponding response\n\tif ( finalDataType ) {\n\t\tif ( finalDataType !== dataTypes[ 0 ] ) {\n\t\t\tdataTypes.unshift( finalDataType );\n\t\t}\n\t\treturn responses[ finalDataType ];\n\t}\n}\n\n/* Chain conversions given the request and the original response\n * Also sets the responseXXX fields on the jqXHR instance\n */\nfunction ajaxConvert( s, response, jqXHR, isSuccess ) {\n\tvar conv2, current, conv, tmp, prev,\n\t\tconverters = {},\n\t\t// Work with a copy of dataTypes in case we need to modify it for conversion\n\t\tdataTypes = s.dataTypes.slice();\n\n\t// Create converters map with lowercased keys\n\tif ( dataTypes[ 1 ] ) {\n\t\tfor ( conv in s.converters ) {\n\t\t\tconverters[ conv.toLowerCase() ] = s.converters[ conv ];\n\t\t}\n\t}\n\n\tcurrent = dataTypes.shift();\n\n\t// Convert to each sequential dataType\n\twhile ( current ) {\n\n\t\tif ( s.responseFields[ current ] ) {\n\t\t\tjqXHR[ s.responseFields[ current ] ] = response;\n\t\t}\n\n\t\t// Apply the dataFilter if provided\n\t\tif ( !prev && isSuccess && s.dataFilter ) {\n\t\t\tresponse = s.dataFilter( response, s.dataType );\n\t\t}\n\n\t\tprev = current;\n\t\tcurrent = dataTypes.shift();\n\n\t\tif ( current ) {\n\n\t\t\t// There's only work to do if current dataType is non-auto\n\t\t\tif ( current === \"*\" ) {\n\n\t\t\t\tcurrent = prev;\n\n\t\t\t// Convert response if prev dataType is non-auto and differs from current\n\t\t\t} else if ( prev !== \"*\" && prev !== current ) {\n\n\t\t\t\t// Seek a direct converter\n\t\t\t\tconv = converters[ prev + \" \" + current ] || converters[ \"* \" + current ];\n\n\t\t\t\t// If none found, seek a pair\n\t\t\t\tif ( !conv ) {\n\t\t\t\t\tfor ( conv2 in converters ) {\n\n\t\t\t\t\t\t// If conv2 outputs current\n\t\t\t\t\t\ttmp = conv2.split( \" \" );\n\t\t\t\t\t\tif ( tmp[ 1 ] === current ) {\n\n\t\t\t\t\t\t\t// If prev can be converted to accepted input\n\t\t\t\t\t\t\tconv = converters[ prev + \" \" + tmp[ 0 ] ] ||\n\t\t\t\t\t\t\t\tconverters[ \"* \" + tmp[ 0 ] ];\n\t\t\t\t\t\t\tif ( conv ) {\n\t\t\t\t\t\t\t\t// Condense equivalence converters\n\t\t\t\t\t\t\t\tif ( conv === true ) {\n\t\t\t\t\t\t\t\t\tconv = converters[ conv2 ];\n\n\t\t\t\t\t\t\t\t// Otherwise, insert the intermediate dataType\n\t\t\t\t\t\t\t\t} else if ( converters[ conv2 ] !== true ) {\n\t\t\t\t\t\t\t\t\tcurrent = tmp[ 0 ];\n\t\t\t\t\t\t\t\t\tdataTypes.unshift( tmp[ 1 ] );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Apply converter (if not an equivalence)\n\t\t\t\tif ( conv !== true ) {\n\n\t\t\t\t\t// Unless errors are allowed to bubble, catch and return them\n\t\t\t\t\tif ( conv && s[ \"throws\" ] ) {\n\t\t\t\t\t\tresponse = conv( response );\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tresponse = conv( response );\n\t\t\t\t\t\t} catch ( e ) {\n\t\t\t\t\t\t\treturn { state: \"parsererror\", error: conv ? e : \"No conversion from \" + prev + \" to \" + current };\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn { state: \"success\", data: response };\n}\n\njQuery.extend({\n\n\t// Counter for holding the number of active queries\n\tactive: 0,\n\n\t// Last-Modified header cache for next request\n\tlastModified: {},\n\tetag: {},\n\n\tajaxSettings: {\n\t\turl: ajaxLocation,\n\t\ttype: \"GET\",\n\t\tisLocal: rlocalProtocol.test( ajaxLocParts[ 1 ] ),\n\t\tglobal: true,\n\t\tprocessData: true,\n\t\tasync: true,\n\t\tcontentType: \"application/x-www-form-urlencoded; charset=UTF-8\",\n\t\t/*\n\t\ttimeout: 0,\n\t\tdata: null,\n\t\tdataType: null,\n\t\tusername: null,\n\t\tpassword: null,\n\t\tcache: null,\n\t\tthrows: false,\n\t\ttraditional: false,\n\t\theaders: {},\n\t\t*/\n\n\t\taccepts: {\n\t\t\t\"*\": allTypes,\n\t\t\ttext: \"text/plain\",\n\t\t\thtml: \"text/html\",\n\t\t\txml: \"application/xml, text/xml\",\n\t\t\tjson: \"application/json, text/javascript\"\n\t\t},\n\n\t\tcontents: {\n\t\t\txml: /xml/,\n\t\t\thtml: /html/,\n\t\t\tjson: /json/\n\t\t},\n\n\t\tresponseFields: {\n\t\t\txml: \"responseXML\",\n\t\t\ttext: \"responseText\",\n\t\t\tjson: \"responseJSON\"\n\t\t},\n\n\t\t// Data converters\n\t\t// Keys separate source (or catchall \"*\") and destination types with a single space\n\t\tconverters: {\n\n\t\t\t// Convert anything to text\n\t\t\t\"* text\": String,\n\n\t\t\t// Text to html (true = no transformation)\n\t\t\t\"text html\": true,\n\n\t\t\t// Evaluate text as a json expression\n\t\t\t\"text json\": jQuery.parseJSON,\n\n\t\t\t// Parse text as xml\n\t\t\t\"text xml\": jQuery.parseXML\n\t\t},\n\n\t\t// For options that shouldn't be deep extended:\n\t\t// you can add your own custom options here if\n\t\t// and when you create one that shouldn't be\n\t\t// deep extended (see ajaxExtend)\n\t\tflatOptions: {\n\t\t\turl: true,\n\t\t\tcontext: true\n\t\t}\n\t},\n\n\t// Creates a full fledged settings object into target\n\t// with both ajaxSettings and settings fields.\n\t// If target is omitted, writes into ajaxSettings.\n\tajaxSetup: function( target, settings ) {\n\t\treturn settings ?\n\n\t\t\t// Building a settings object\n\t\t\tajaxExtend( ajaxExtend( target, jQuery.ajaxSettings ), settings ) :\n\n\t\t\t// Extending ajaxSettings\n\t\t\tajaxExtend( jQuery.ajaxSettings, target );\n\t},\n\n\tajaxPrefilter: addToPrefiltersOrTransports( prefilters ),\n\tajaxTransport: addToPrefiltersOrTransports( transports ),\n\n\t// Main method\n\tajax: function( url, options ) {\n\n\t\t// If url is an object, simulate pre-1.5 signature\n\t\tif ( typeof url === \"object\" ) {\n\t\t\toptions = url;\n\t\t\turl = undefined;\n\t\t}\n\n\t\t// Force options to be an object\n\t\toptions = options || {};\n\n\t\tvar // Cross-domain detection vars\n\t\t\tparts,\n\t\t\t// Loop variable\n\t\t\ti,\n\t\t\t// URL without anti-cache param\n\t\t\tcacheURL,\n\t\t\t// Response headers as string\n\t\t\tresponseHeadersString,\n\t\t\t// timeout handle\n\t\t\ttimeoutTimer,\n\n\t\t\t// To know if global events are to be dispatched\n\t\t\tfireGlobals,\n\n\t\t\ttransport,\n\t\t\t// Response headers\n\t\t\tresponseHeaders,\n\t\t\t// Create the final options object\n\t\t\ts = jQuery.ajaxSetup( {}, options ),\n\t\t\t// Callbacks context\n\t\t\tcallbackContext = s.context || s,\n\t\t\t// Context for global events is callbackContext if it is a DOM node or jQuery collection\n\t\t\tglobalEventContext = s.context && ( callbackContext.nodeType || callbackContext.jquery ) ?\n\t\t\t\tjQuery( callbackContext ) :\n\t\t\t\tjQuery.event,\n\t\t\t// Deferreds\n\t\t\tdeferred = jQuery.Deferred(),\n\t\t\tcompleteDeferred = jQuery.Callbacks(\"once memory\"),\n\t\t\t// Status-dependent callbacks\n\t\t\tstatusCode = s.statusCode || {},\n\t\t\t// Headers (they are sent all at once)\n\t\t\trequestHeaders = {},\n\t\t\trequestHeadersNames = {},\n\t\t\t// The jqXHR state\n\t\t\tstate = 0,\n\t\t\t// Default abort message\n\t\t\tstrAbort = \"canceled\",\n\t\t\t// Fake xhr\n\t\t\tjqXHR = {\n\t\t\t\treadyState: 0,\n\n\t\t\t\t// Builds headers hashtable if needed\n\t\t\t\tgetResponseHeader: function( key ) {\n\t\t\t\t\tvar match;\n\t\t\t\t\tif ( state === 2 ) {\n\t\t\t\t\t\tif ( !responseHeaders ) {\n\t\t\t\t\t\t\tresponseHeaders = {};\n\t\t\t\t\t\t\twhile ( (match = rheaders.exec( responseHeadersString )) ) {\n\t\t\t\t\t\t\t\tresponseHeaders[ match[1].toLowerCase() ] = match[ 2 ];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmatch = responseHeaders[ key.toLowerCase() ];\n\t\t\t\t\t}\n\t\t\t\t\treturn match == null ? null : match;\n\t\t\t\t},\n\n\t\t\t\t// Raw string\n\t\t\t\tgetAllResponseHeaders: function() {\n\t\t\t\t\treturn state === 2 ? responseHeadersString : null;\n\t\t\t\t},\n\n\t\t\t\t// Caches the header\n\t\t\t\tsetRequestHeader: function( name, value ) {\n\t\t\t\t\tvar lname = name.toLowerCase();\n\t\t\t\t\tif ( !state ) {\n\t\t\t\t\t\tname = requestHeadersNames[ lname ] = requestHeadersNames[ lname ] || name;\n\t\t\t\t\t\trequestHeaders[ name ] = value;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Overrides response content-type header\n\t\t\t\toverrideMimeType: function( type ) {\n\t\t\t\t\tif ( !state ) {\n\t\t\t\t\t\ts.mimeType = type;\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Status-dependent callbacks\n\t\t\t\tstatusCode: function( map ) {\n\t\t\t\t\tvar code;\n\t\t\t\t\tif ( map ) {\n\t\t\t\t\t\tif ( state < 2 ) {\n\t\t\t\t\t\t\tfor ( code in map ) {\n\t\t\t\t\t\t\t\t// Lazy-add the new callback in a way that preserves old ones\n\t\t\t\t\t\t\t\tstatusCode[ code ] = [ statusCode[ code ], map[ code ] ];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Execute the appropriate callbacks\n\t\t\t\t\t\t\tjqXHR.always( map[ jqXHR.status ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn this;\n\t\t\t\t},\n\n\t\t\t\t// Cancel the request\n\t\t\t\tabort: function( statusText ) {\n\t\t\t\t\tvar finalText = statusText || strAbort;\n\t\t\t\t\tif ( transport ) {\n\t\t\t\t\t\ttransport.abort( finalText );\n\t\t\t\t\t}\n\t\t\t\t\tdone( 0, finalText );\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t};\n\n\t\t// Attach deferreds\n\t\tdeferred.promise( jqXHR ).complete = completeDeferred.add;\n\t\tjqXHR.success = jqXHR.done;\n\t\tjqXHR.error = jqXHR.fail;\n\n\t\t// Remove hash character (#7531: and string promotion)\n\t\t// Add protocol if not provided (#5866: IE7 issue with protocol-less urls)\n\t\t// Handle falsy url in the settings object (#10093: consistency with old signature)\n\t\t// We also use the url parameter if available\n\t\ts.url = ( ( url || s.url || ajaxLocation ) + \"\" ).replace( rhash, \"\" ).replace( rprotocol, ajaxLocParts[ 1 ] + \"//\" );\n\n\t\t// Alias method option to type as per ticket #12004\n\t\ts.type = options.method || options.type || s.method || s.type;\n\n\t\t// Extract dataTypes list\n\t\ts.dataTypes = jQuery.trim( s.dataType || \"*\" ).toLowerCase().match( rnotwhite ) || [ \"\" ];\n\n\t\t// A cross-domain request is in order when we have a protocol:host:port mismatch\n\t\tif ( s.crossDomain == null ) {\n\t\t\tparts = rurl.exec( s.url.toLowerCase() );\n\t\t\ts.crossDomain = !!( parts &&\n\t\t\t\t( parts[ 1 ] !== ajaxLocParts[ 1 ] || parts[ 2 ] !== ajaxLocParts[ 2 ] ||\n\t\t\t\t\t( parts[ 3 ] || ( parts[ 1 ] === \"http:\" ? \"80\" : \"443\" ) ) !==\n\t\t\t\t\t\t( ajaxLocParts[ 3 ] || ( ajaxLocParts[ 1 ] === \"http:\" ? \"80\" : \"443\" ) ) )\n\t\t\t);\n\t\t}\n\n\t\t// Convert data if not already a string\n\t\tif ( s.data && s.processData && typeof s.data !== \"string\" ) {\n\t\t\ts.data = jQuery.param( s.data, s.traditional );\n\t\t}\n\n\t\t// Apply prefilters\n\t\tinspectPrefiltersOrTransports( prefilters, s, options, jqXHR );\n\n\t\t// If request was aborted inside a prefilter, stop there\n\t\tif ( state === 2 ) {\n\t\t\treturn jqXHR;\n\t\t}\n\n\t\t// We can fire global events as of now if asked to\n\t\t// Don't fire events if jQuery.event is undefined in an AMD-usage scenario (#15118)\n\t\tfireGlobals = jQuery.event && s.global;\n\n\t\t// Watch for a new set of requests\n\t\tif ( fireGlobals && jQuery.active++ === 0 ) {\n\t\t\tjQuery.event.trigger(\"ajaxStart\");\n\t\t}\n\n\t\t// Uppercase the type\n\t\ts.type = s.type.toUpperCase();\n\n\t\t// Determine if request has content\n\t\ts.hasContent = !rnoContent.test( s.type );\n\n\t\t// Save the URL in case we're toying with the If-Modified-Since\n\t\t// and/or If-None-Match header later on\n\t\tcacheURL = s.url;\n\n\t\t// More options handling for requests with no content\n\t\tif ( !s.hasContent ) {\n\n\t\t\t// If data is available, append data to url\n\t\t\tif ( s.data ) {\n\t\t\t\tcacheURL = ( s.url += ( rquery.test( cacheURL ) ? \"&\" : \"?\" ) + s.data );\n\t\t\t\t// #9682: remove data so that it's not used in an eventual retry\n\t\t\t\tdelete s.data;\n\t\t\t}\n\n\t\t\t// Add anti-cache in url if needed\n\t\t\tif ( s.cache === false ) {\n\t\t\t\ts.url = rts.test( cacheURL ) ?\n\n\t\t\t\t\t// If there is already a '_' parameter, set its value\n\t\t\t\t\tcacheURL.replace( rts, \"$1_=\" + nonce++ ) :\n\n\t\t\t\t\t// Otherwise add one to the end\n\t\t\t\t\tcacheURL + ( rquery.test( cacheURL ) ? \"&\" : \"?\" ) + \"_=\" + nonce++;\n\t\t\t}\n\t\t}\n\n\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n\t\tif ( s.ifModified ) {\n\t\t\tif ( jQuery.lastModified[ cacheURL ] ) {\n\t\t\t\tjqXHR.setRequestHeader( \"If-Modified-Since\", jQuery.lastModified[ cacheURL ] );\n\t\t\t}\n\t\t\tif ( jQuery.etag[ cacheURL ] ) {\n\t\t\t\tjqXHR.setRequestHeader( \"If-None-Match\", jQuery.etag[ cacheURL ] );\n\t\t\t}\n\t\t}\n\n\t\t// Set the correct header, if data is being sent\n\t\tif ( s.data && s.hasContent && s.contentType !== false || options.contentType ) {\n\t\t\tjqXHR.setRequestHeader( \"Content-Type\", s.contentType );\n\t\t}\n\n\t\t// Set the Accepts header for the server, depending on the dataType\n\t\tjqXHR.setRequestHeader(\n\t\t\t\"Accept\",\n\t\t\ts.dataTypes[ 0 ] && s.accepts[ s.dataTypes[0] ] ?\n\t\t\t\ts.accepts[ s.dataTypes[0] ] + ( s.dataTypes[ 0 ] !== \"*\" ? \", \" + allTypes + \"; q=0.01\" : \"\" ) :\n\t\t\t\ts.accepts[ \"*\" ]\n\t\t);\n\n\t\t// Check for headers option\n\t\tfor ( i in s.headers ) {\n\t\t\tjqXHR.setRequestHeader( i, s.headers[ i ] );\n\t\t}\n\n\t\t// Allow custom headers/mimetypes and early abort\n\t\tif ( s.beforeSend && ( s.beforeSend.call( callbackContext, jqXHR, s ) === false || state === 2 ) ) {\n\t\t\t// Abort if not done already and return\n\t\t\treturn jqXHR.abort();\n\t\t}\n\n\t\t// aborting is no longer a cancellation\n\t\tstrAbort = \"abort\";\n\n\t\t// Install callbacks on deferreds\n\t\tfor ( i in { success: 1, error: 1, complete: 1 } ) {\n\t\t\tjqXHR[ i ]( s[ i ] );\n\t\t}\n\n\t\t// Get transport\n\t\ttransport = inspectPrefiltersOrTransports( transports, s, options, jqXHR );\n\n\t\t// If no transport, we auto-abort\n\t\tif ( !transport ) {\n\t\t\tdone( -1, \"No Transport\" );\n\t\t} else {\n\t\t\tjqXHR.readyState = 1;\n\n\t\t\t// Send global event\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( \"ajaxSend\", [ jqXHR, s ] );\n\t\t\t}\n\t\t\t// Timeout\n\t\t\tif ( s.async && s.timeout > 0 ) {\n\t\t\t\ttimeoutTimer = setTimeout(function() {\n\t\t\t\t\tjqXHR.abort(\"timeout\");\n\t\t\t\t}, s.timeout );\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tstate = 1;\n\t\t\t\ttransport.send( requestHeaders, done );\n\t\t\t} catch ( e ) {\n\t\t\t\t// Propagate exception as error if not done\n\t\t\t\tif ( state < 2 ) {\n\t\t\t\t\tdone( -1, e );\n\t\t\t\t// Simply rethrow otherwise\n\t\t\t\t} else {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Callback for when everything is done\n\t\tfunction done( status, nativeStatusText, responses, headers ) {\n\t\t\tvar isSuccess, success, error, response, modified,\n\t\t\t\tstatusText = nativeStatusText;\n\n\t\t\t// Called once\n\t\t\tif ( state === 2 ) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// State is \"done\" now\n\t\t\tstate = 2;\n\n\t\t\t// Clear timeout if it exists\n\t\t\tif ( timeoutTimer ) {\n\t\t\t\tclearTimeout( timeoutTimer );\n\t\t\t}\n\n\t\t\t// Dereference transport for early garbage collection\n\t\t\t// (no matter how long the jqXHR object will be used)\n\t\t\ttransport = undefined;\n\n\t\t\t// Cache response headers\n\t\t\tresponseHeadersString = headers || \"\";\n\n\t\t\t// Set readyState\n\t\t\tjqXHR.readyState = status > 0 ? 4 : 0;\n\n\t\t\t// Determine if successful\n\t\t\tisSuccess = status >= 200 && status < 300 || status === 304;\n\n\t\t\t// Get response data\n\t\t\tif ( responses ) {\n\t\t\t\tresponse = ajaxHandleResponses( s, jqXHR, responses );\n\t\t\t}\n\n\t\t\t// Convert no matter what (that way responseXXX fields are always set)\n\t\t\tresponse = ajaxConvert( s, response, jqXHR, isSuccess );\n\n\t\t\t// If successful, handle type chaining\n\t\t\tif ( isSuccess ) {\n\n\t\t\t\t// Set the If-Modified-Since and/or If-None-Match header, if in ifModified mode.\n\t\t\t\tif ( s.ifModified ) {\n\t\t\t\t\tmodified = jqXHR.getResponseHeader(\"Last-Modified\");\n\t\t\t\t\tif ( modified ) {\n\t\t\t\t\t\tjQuery.lastModified[ cacheURL ] = modified;\n\t\t\t\t\t}\n\t\t\t\t\tmodified = jqXHR.getResponseHeader(\"etag\");\n\t\t\t\t\tif ( modified ) {\n\t\t\t\t\t\tjQuery.etag[ cacheURL ] = modified;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// if no content\n\t\t\t\tif ( status === 204 || s.type === \"HEAD\" ) {\n\t\t\t\t\tstatusText = \"nocontent\";\n\n\t\t\t\t// if not modified\n\t\t\t\t} else if ( status === 304 ) {\n\t\t\t\t\tstatusText = \"notmodified\";\n\n\t\t\t\t// If we have data, let's convert it\n\t\t\t\t} else {\n\t\t\t\t\tstatusText = response.state;\n\t\t\t\t\tsuccess = response.data;\n\t\t\t\t\terror = response.error;\n\t\t\t\t\tisSuccess = !error;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We extract error from statusText\n\t\t\t\t// then normalize statusText and status for non-aborts\n\t\t\t\terror = statusText;\n\t\t\t\tif ( status || !statusText ) {\n\t\t\t\t\tstatusText = \"error\";\n\t\t\t\t\tif ( status < 0 ) {\n\t\t\t\t\t\tstatus = 0;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Set data for the fake xhr object\n\t\t\tjqXHR.status = status;\n\t\t\tjqXHR.statusText = ( nativeStatusText || statusText ) + \"\";\n\n\t\t\t// Success/Error\n\t\t\tif ( isSuccess ) {\n\t\t\t\tdeferred.resolveWith( callbackContext, [ success, statusText, jqXHR ] );\n\t\t\t} else {\n\t\t\t\tdeferred.rejectWith( callbackContext, [ jqXHR, statusText, error ] );\n\t\t\t}\n\n\t\t\t// Status-dependent callbacks\n\t\t\tjqXHR.statusCode( statusCode );\n\t\t\tstatusCode = undefined;\n\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( isSuccess ? \"ajaxSuccess\" : \"ajaxError\",\n\t\t\t\t\t[ jqXHR, s, isSuccess ? success : error ] );\n\t\t\t}\n\n\t\t\t// Complete\n\t\t\tcompleteDeferred.fireWith( callbackContext, [ jqXHR, statusText ] );\n\n\t\t\tif ( fireGlobals ) {\n\t\t\t\tglobalEventContext.trigger( \"ajaxComplete\", [ jqXHR, s ] );\n\t\t\t\t// Handle the global AJAX counter\n\t\t\t\tif ( !( --jQuery.active ) ) {\n\t\t\t\t\tjQuery.event.trigger(\"ajaxStop\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn jqXHR;\n\t},\n\n\tgetJSON: function( url, data, callback ) {\n\t\treturn jQuery.get( url, data, callback, \"json\" );\n\t},\n\n\tgetScript: function( url, callback ) {\n\t\treturn jQuery.get( url, undefined, callback, \"script\" );\n\t}\n});\n\njQuery.each( [ \"get\", \"post\" ], function( i, method ) {\n\tjQuery[ method ] = function( url, data, callback, type ) {\n\t\t// shift arguments if data argument was omitted\n\t\tif ( jQuery.isFunction( data ) ) {\n\t\t\ttype = type || callback;\n\t\t\tcallback = data;\n\t\t\tdata = undefined;\n\t\t}\n\n\t\treturn jQuery.ajax({\n\t\t\turl: url,\n\t\t\ttype: method,\n\t\t\tdataType: type,\n\t\t\tdata: data,\n\t\t\tsuccess: callback\n\t\t});\n\t};\n});\n\n\njQuery._evalUrl = function( url ) {\n\treturn jQuery.ajax({\n\t\turl: url,\n\t\ttype: \"GET\",\n\t\tdataType: \"script\",\n\t\tasync: false,\n\t\tglobal: false,\n\t\t\"throws\": true\n\t});\n};\n\n\njQuery.fn.extend({\n\twrapAll: function( html ) {\n\t\tif ( jQuery.isFunction( html ) ) {\n\t\t\treturn this.each(function(i) {\n\t\t\t\tjQuery(this).wrapAll( html.call(this, i) );\n\t\t\t});\n\t\t}\n\n\t\tif ( this[0] ) {\n\t\t\t// The elements to wrap the target around\n\t\t\tvar wrap = jQuery( html, this[0].ownerDocument ).eq(0).clone(true);\n\n\t\t\tif ( this[0].parentNode ) {\n\t\t\t\twrap.insertBefore( this[0] );\n\t\t\t}\n\n\t\t\twrap.map(function() {\n\t\t\t\tvar elem = this;\n\n\t\t\t\twhile ( elem.firstChild && elem.firstChild.nodeType === 1 ) {\n\t\t\t\t\telem = elem.firstChild;\n\t\t\t\t}\n\n\t\t\t\treturn elem;\n\t\t\t}).append( this );\n\t\t}\n\n\t\treturn this;\n\t},\n\n\twrapInner: function( html ) {\n\t\tif ( jQuery.isFunction( html ) ) {\n\t\t\treturn this.each(function(i) {\n\t\t\t\tjQuery(this).wrapInner( html.call(this, i) );\n\t\t\t});\n\t\t}\n\n\t\treturn this.each(function() {\n\t\t\tvar self = jQuery( this ),\n\t\t\t\tcontents = self.contents();\n\n\t\t\tif ( contents.length ) {\n\t\t\t\tcontents.wrapAll( html );\n\n\t\t\t} else {\n\t\t\t\tself.append( html );\n\t\t\t}\n\t\t});\n\t},\n\n\twrap: function( html ) {\n\t\tvar isFunction = jQuery.isFunction( html );\n\n\t\treturn this.each(function(i) {\n\t\t\tjQuery( this ).wrapAll( isFunction ? html.call(this, i) : html );\n\t\t});\n\t},\n\n\tunwrap: function() {\n\t\treturn this.parent().each(function() {\n\t\t\tif ( !jQuery.nodeName( this, \"body\" ) ) {\n\t\t\t\tjQuery( this ).replaceWith( this.childNodes );\n\t\t\t}\n\t\t}).end();\n\t}\n});\n\n\njQuery.expr.filters.hidden = function( elem ) {\n\t// Support: Opera <= 12.12\n\t// Opera reports offsetWidths and offsetHeights less than zero on some elements\n\treturn elem.offsetWidth <= 0 && elem.offsetHeight <= 0 ||\n\t\t(!support.reliableHiddenOffsets() &&\n\t\t\t((elem.style && elem.style.display) || jQuery.css( elem, \"display\" )) === \"none\");\n};\n\njQuery.expr.filters.visible = function( elem ) {\n\treturn !jQuery.expr.filters.hidden( elem );\n};\n\n\n\n\nvar r20 = /%20/g,\n\trbracket = /\\[\\]$/,\n\trCRLF = /\\r?\\n/g,\n\trsubmitterTypes = /^(?:submit|button|image|reset|file)$/i,\n\trsubmittable = /^(?:input|select|textarea|keygen)/i;\n\nfunction buildParams( prefix, obj, traditional, add ) {\n\tvar name;\n\n\tif ( jQuery.isArray( obj ) ) {\n\t\t// Serialize array item.\n\t\tjQuery.each( obj, function( i, v ) {\n\t\t\tif ( traditional || rbracket.test( prefix ) ) {\n\t\t\t\t// Treat each array item as a scalar.\n\t\t\t\tadd( prefix, v );\n\n\t\t\t} else {\n\t\t\t\t// Item is non-scalar (array or object), encode its numeric index.\n\t\t\t\tbuildParams( prefix + \"[\" + ( typeof v === \"object\" ? i : \"\" ) + \"]\", v, traditional, add );\n\t\t\t}\n\t\t});\n\n\t} else if ( !traditional && jQuery.type( obj ) === \"object\" ) {\n\t\t// Serialize object item.\n\t\tfor ( name in obj ) {\n\t\t\tbuildParams( prefix + \"[\" + name + \"]\", obj[ name ], traditional, add );\n\t\t}\n\n\t} else {\n\t\t// Serialize scalar item.\n\t\tadd( prefix, obj );\n\t}\n}\n\n// Serialize an array of form elements or a set of\n// key/values into a query string\njQuery.param = function( a, traditional ) {\n\tvar prefix,\n\t\ts = [],\n\t\tadd = function( key, value ) {\n\t\t\t// If value is a function, invoke it and return its value\n\t\t\tvalue = jQuery.isFunction( value ) ? value() : ( value == null ? \"\" : value );\n\t\t\ts[ s.length ] = encodeURIComponent( key ) + \"=\" + encodeURIComponent( value );\n\t\t};\n\n\t// Set traditional to true for jQuery <= 1.3.2 behavior.\n\tif ( traditional === undefined ) {\n\t\ttraditional = jQuery.ajaxSettings && jQuery.ajaxSettings.traditional;\n\t}\n\n\t// If an array was passed in, assume that it is an array of form elements.\n\tif ( jQuery.isArray( a ) || ( a.jquery && !jQuery.isPlainObject( a ) ) ) {\n\t\t// Serialize the form elements\n\t\tjQuery.each( a, function() {\n\t\t\tadd( this.name, this.value );\n\t\t});\n\n\t} else {\n\t\t// If traditional, encode the \"old\" way (the way 1.3.2 or older\n\t\t// did it), otherwise encode params recursively.\n\t\tfor ( prefix in a ) {\n\t\t\tbuildParams( prefix, a[ prefix ], traditional, add );\n\t\t}\n\t}\n\n\t// Return the resulting serialization\n\treturn s.join( \"&\" ).replace( r20, \"+\" );\n};\n\njQuery.fn.extend({\n\tserialize: function() {\n\t\treturn jQuery.param( this.serializeArray() );\n\t},\n\tserializeArray: function() {\n\t\treturn this.map(function() {\n\t\t\t// Can add propHook for \"elements\" to filter or add form elements\n\t\t\tvar elements = jQuery.prop( this, \"elements\" );\n\t\t\treturn elements ? jQuery.makeArray( elements ) : this;\n\t\t})\n\t\t.filter(function() {\n\t\t\tvar type = this.type;\n\t\t\t// Use .is(\":disabled\") so that fieldset[disabled] works\n\t\t\treturn this.name && !jQuery( this ).is( \":disabled\" ) &&\n\t\t\t\trsubmittable.test( this.nodeName ) && !rsubmitterTypes.test( type ) &&\n\t\t\t\t( this.checked || !rcheckableType.test( type ) );\n\t\t})\n\t\t.map(function( i, elem ) {\n\t\t\tvar val = jQuery( this ).val();\n\n\t\t\treturn val == null ?\n\t\t\t\tnull :\n\t\t\t\tjQuery.isArray( val ) ?\n\t\t\t\t\tjQuery.map( val, function( val ) {\n\t\t\t\t\t\treturn { name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\n\t\t\t\t\t}) :\n\t\t\t\t\t{ name: elem.name, value: val.replace( rCRLF, \"\\r\\n\" ) };\n\t\t}).get();\n\t}\n});\n\n\n// Create the request object\n// (This is still attached to ajaxSettings for backward compatibility)\njQuery.ajaxSettings.xhr = window.ActiveXObject !== undefined ?\n\t// Support: IE6+\n\tfunction() {\n\n\t\t// XHR cannot access local files, always use ActiveX for that case\n\t\treturn !this.isLocal &&\n\n\t\t\t// Support: IE7-8\n\t\t\t// oldIE XHR does not support non-RFC2616 methods (#13240)\n\t\t\t// See http://msdn.microsoft.com/en-us/library/ie/ms536648(v=vs.85).aspx\n\t\t\t// and http://www.w3.org/Protocols/rfc2616/rfc2616-sec9.html#sec9\n\t\t\t// Although this check for six methods instead of eight\n\t\t\t// since IE also does not support \"trace\" and \"connect\"\n\t\t\t/^(get|post|head|put|delete|options)$/i.test( this.type ) &&\n\n\t\t\tcreateStandardXHR() || createActiveXHR();\n\t} :\n\t// For all other browsers, use the standard XMLHttpRequest object\n\tcreateStandardXHR;\n\nvar xhrId = 0,\n\txhrCallbacks = {},\n\txhrSupported = jQuery.ajaxSettings.xhr();\n\n// Support: IE<10\n// Open requests must be manually aborted on unload (#5280)\n// See https://support.microsoft.com/kb/2856746 for more info\nif ( window.attachEvent ) {\n\twindow.attachEvent( \"onunload\", function() {\n\t\tfor ( var key in xhrCallbacks ) {\n\t\t\txhrCallbacks[ key ]( undefined, true );\n\t\t}\n\t});\n}\n\n// Determine support properties\nsupport.cors = !!xhrSupported && ( \"withCredentials\" in xhrSupported );\nxhrSupported = support.ajax = !!xhrSupported;\n\n// Create transport if the browser can provide an xhr\nif ( xhrSupported ) {\n\n\tjQuery.ajaxTransport(function( options ) {\n\t\t// Cross domain only allowed if supported through XMLHttpRequest\n\t\tif ( !options.crossDomain || support.cors ) {\n\n\t\t\tvar callback;\n\n\t\t\treturn {\n\t\t\t\tsend: function( headers, complete ) {\n\t\t\t\t\tvar i,\n\t\t\t\t\t\txhr = options.xhr(),\n\t\t\t\t\t\tid = ++xhrId;\n\n\t\t\t\t\t// Open the socket\n\t\t\t\t\txhr.open( options.type, options.url, options.async, options.username, options.password );\n\n\t\t\t\t\t// Apply custom fields if provided\n\t\t\t\t\tif ( options.xhrFields ) {\n\t\t\t\t\t\tfor ( i in options.xhrFields ) {\n\t\t\t\t\t\t\txhr[ i ] = options.xhrFields[ i ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Override mime type if needed\n\t\t\t\t\tif ( options.mimeType && xhr.overrideMimeType ) {\n\t\t\t\t\t\txhr.overrideMimeType( options.mimeType );\n\t\t\t\t\t}\n\n\t\t\t\t\t// X-Requested-With header\n\t\t\t\t\t// For cross-domain requests, seeing as conditions for a preflight are\n\t\t\t\t\t// akin to a jigsaw puzzle, we simply never set it to be sure.\n\t\t\t\t\t// (it can always be set on a per-request basis or even using ajaxSetup)\n\t\t\t\t\t// For same-domain requests, won't change header if already provided.\n\t\t\t\t\tif ( !options.crossDomain && !headers[\"X-Requested-With\"] ) {\n\t\t\t\t\t\theaders[\"X-Requested-With\"] = \"XMLHttpRequest\";\n\t\t\t\t\t}\n\n\t\t\t\t\t// Set headers\n\t\t\t\t\tfor ( i in headers ) {\n\t\t\t\t\t\t// Support: IE<9\n\t\t\t\t\t\t// IE's ActiveXObject throws a 'Type Mismatch' exception when setting\n\t\t\t\t\t\t// request header to a null-value.\n\t\t\t\t\t\t//\n\t\t\t\t\t\t// To keep consistent with other XHR implementations, cast the value\n\t\t\t\t\t\t// to string and ignore `undefined`.\n\t\t\t\t\t\tif ( headers[ i ] !== undefined ) {\n\t\t\t\t\t\t\txhr.setRequestHeader( i, headers[ i ] + \"\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Do send the request\n\t\t\t\t\t// This may raise an exception which is actually\n\t\t\t\t\t// handled in jQuery.ajax (so no try/catch here)\n\t\t\t\t\txhr.send( ( options.hasContent && options.data ) || null );\n\n\t\t\t\t\t// Listener\n\t\t\t\t\tcallback = function( _, isAbort ) {\n\t\t\t\t\t\tvar status, statusText, responses;\n\n\t\t\t\t\t\t// Was never called and is aborted or complete\n\t\t\t\t\t\tif ( callback && ( isAbort || xhr.readyState === 4 ) ) {\n\t\t\t\t\t\t\t// Clean up\n\t\t\t\t\t\t\tdelete xhrCallbacks[ id ];\n\t\t\t\t\t\t\tcallback = undefined;\n\t\t\t\t\t\t\txhr.onreadystatechange = jQuery.noop;\n\n\t\t\t\t\t\t\t// Abort manually if needed\n\t\t\t\t\t\t\tif ( isAbort ) {\n\t\t\t\t\t\t\t\tif ( xhr.readyState !== 4 ) {\n\t\t\t\t\t\t\t\t\txhr.abort();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tresponses = {};\n\t\t\t\t\t\t\t\tstatus = xhr.status;\n\n\t\t\t\t\t\t\t\t// Support: IE<10\n\t\t\t\t\t\t\t\t// Accessing binary-data responseText throws an exception\n\t\t\t\t\t\t\t\t// (#11426)\n\t\t\t\t\t\t\t\tif ( typeof xhr.responseText === \"string\" ) {\n\t\t\t\t\t\t\t\t\tresponses.text = xhr.responseText;\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Firefox throws an exception when accessing\n\t\t\t\t\t\t\t\t// statusText for faulty cross-domain requests\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tstatusText = xhr.statusText;\n\t\t\t\t\t\t\t\t} catch( e ) {\n\t\t\t\t\t\t\t\t\t// We normalize with Webkit giving an empty statusText\n\t\t\t\t\t\t\t\t\tstatusText = \"\";\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t// Filter status for non standard behaviors\n\n\t\t\t\t\t\t\t\t// If the request is local and we have data: assume a success\n\t\t\t\t\t\t\t\t// (success with no data won't get notified, that's the best we\n\t\t\t\t\t\t\t\t// can do given current implementations)\n\t\t\t\t\t\t\t\tif ( !status && options.isLocal && !options.crossDomain ) {\n\t\t\t\t\t\t\t\t\tstatus = responses.text ? 200 : 404;\n\t\t\t\t\t\t\t\t// IE - #1450: sometimes returns 1223 when it should be 204\n\t\t\t\t\t\t\t\t} else if ( status === 1223 ) {\n\t\t\t\t\t\t\t\t\tstatus = 204;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Call complete if needed\n\t\t\t\t\t\tif ( responses ) {\n\t\t\t\t\t\t\tcomplete( status, statusText, responses, xhr.getAllResponseHeaders() );\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\n\t\t\t\t\tif ( !options.async ) {\n\t\t\t\t\t\t// if we're in sync mode we fire the callback\n\t\t\t\t\t\tcallback();\n\t\t\t\t\t} else if ( xhr.readyState === 4 ) {\n\t\t\t\t\t\t// (IE6 & IE7) if it's in cache and has been\n\t\t\t\t\t\t// retrieved directly we need to fire the callback\n\t\t\t\t\t\tsetTimeout( callback );\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Add to the list of active xhr callbacks\n\t\t\t\t\t\txhr.onreadystatechange = xhrCallbacks[ id ] = callback;\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tabort: function() {\n\t\t\t\t\tif ( callback ) {\n\t\t\t\t\t\tcallback( undefined, true );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t});\n}\n\n// Functions to create xhrs\nfunction createStandardXHR() {\n\ttry {\n\t\treturn new window.XMLHttpRequest();\n\t} catch( e ) {}\n}\n\nfunction createActiveXHR() {\n\ttry {\n\t\treturn new window.ActiveXObject( \"Microsoft.XMLHTTP\" );\n\t} catch( e ) {}\n}\n\n\n\n\n// Install script dataType\njQuery.ajaxSetup({\n\taccepts: {\n\t\tscript: \"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript\"\n\t},\n\tcontents: {\n\t\tscript: /(?:java|ecma)script/\n\t},\n\tconverters: {\n\t\t\"text script\": function( text ) {\n\t\t\tjQuery.globalEval( text );\n\t\t\treturn text;\n\t\t}\n\t}\n});\n\n// Handle cache's special case and global\njQuery.ajaxPrefilter( \"script\", function( s ) {\n\tif ( s.cache === undefined ) {\n\t\ts.cache = false;\n\t}\n\tif ( s.crossDomain ) {\n\t\ts.type = \"GET\";\n\t\ts.global = false;\n\t}\n});\n\n// Bind script tag hack transport\njQuery.ajaxTransport( \"script\", function(s) {\n\n\t// This transport only deals with cross domain requests\n\tif ( s.crossDomain ) {\n\n\t\tvar script,\n\t\t\thead = document.head || jQuery(\"head\")[0] || document.documentElement;\n\n\t\treturn {\n\n\t\t\tsend: function( _, callback ) {\n\n\t\t\t\tscript = document.createElement(\"script\");\n\n\t\t\t\tscript.async = true;\n\n\t\t\t\tif ( s.scriptCharset ) {\n\t\t\t\t\tscript.charset = s.scriptCharset;\n\t\t\t\t}\n\n\t\t\t\tscript.src = s.url;\n\n\t\t\t\t// Attach handlers for all browsers\n\t\t\t\tscript.onload = script.onreadystatechange = function( _, isAbort ) {\n\n\t\t\t\t\tif ( isAbort || !script.readyState || /loaded|complete/.test( script.readyState ) ) {\n\n\t\t\t\t\t\t// Handle memory leak in IE\n\t\t\t\t\t\tscript.onload = script.onreadystatechange = null;\n\n\t\t\t\t\t\t// Remove the script\n\t\t\t\t\t\tif ( script.parentNode ) {\n\t\t\t\t\t\t\tscript.parentNode.removeChild( script );\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Dereference the script\n\t\t\t\t\t\tscript = null;\n\n\t\t\t\t\t\t// Callback if not abort\n\t\t\t\t\t\tif ( !isAbort ) {\n\t\t\t\t\t\t\tcallback( 200, \"success\" );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\t// Circumvent IE6 bugs with base elements (#2709 and #4378) by prepending\n\t\t\t\t// Use native DOM manipulation to avoid our domManip AJAX trickery\n\t\t\t\thead.insertBefore( script, head.firstChild );\n\t\t\t},\n\n\t\t\tabort: function() {\n\t\t\t\tif ( script ) {\n\t\t\t\t\tscript.onload( undefined, true );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n});\n\n\n\n\nvar oldCallbacks = [],\n\trjsonp = /(=)\\?(?=&|$)|\\?\\?/;\n\n// Default jsonp settings\njQuery.ajaxSetup({\n\tjsonp: \"callback\",\n\tjsonpCallback: function() {\n\t\tvar callback = oldCallbacks.pop() || ( jQuery.expando + \"_\" + ( nonce++ ) );\n\t\tthis[ callback ] = true;\n\t\treturn callback;\n\t}\n});\n\n// Detect, normalize options and install callbacks for jsonp requests\njQuery.ajaxPrefilter( \"json jsonp\", function( s, originalSettings, jqXHR ) {\n\n\tvar callbackName, overwritten, responseContainer,\n\t\tjsonProp = s.jsonp !== false && ( rjsonp.test( s.url ) ?\n\t\t\t\"url\" :\n\t\t\ttypeof s.data === \"string\" && !( s.contentType || \"\" ).indexOf(\"application/x-www-form-urlencoded\") && rjsonp.test( s.data ) && \"data\"\n\t\t);\n\n\t// Handle iff the expected data type is \"jsonp\" or we have a parameter to set\n\tif ( jsonProp || s.dataTypes[ 0 ] === \"jsonp\" ) {\n\n\t\t// Get callback name, remembering preexisting value associated with it\n\t\tcallbackName = s.jsonpCallback = jQuery.isFunction( s.jsonpCallback ) ?\n\t\t\ts.jsonpCallback() :\n\t\t\ts.jsonpCallback;\n\n\t\t// Insert callback into url or form data\n\t\tif ( jsonProp ) {\n\t\t\ts[ jsonProp ] = s[ jsonProp ].replace( rjsonp, \"$1\" + callbackName );\n\t\t} else if ( s.jsonp !== false ) {\n\t\t\ts.url += ( rquery.test( s.url ) ? \"&\" : \"?\" ) + s.jsonp + \"=\" + callbackName;\n\t\t}\n\n\t\t// Use data converter to retrieve json after script execution\n\t\ts.converters[\"script json\"] = function() {\n\t\t\tif ( !responseContainer ) {\n\t\t\t\tjQuery.error( callbackName + \" was not called\" );\n\t\t\t}\n\t\t\treturn responseContainer[ 0 ];\n\t\t};\n\n\t\t// force json dataType\n\t\ts.dataTypes[ 0 ] = \"json\";\n\n\t\t// Install callback\n\t\toverwritten = window[ callbackName ];\n\t\twindow[ callbackName ] = function() {\n\t\t\tresponseContainer = arguments;\n\t\t};\n\n\t\t// Clean-up function (fires after converters)\n\t\tjqXHR.always(function() {\n\t\t\t// Restore preexisting value\n\t\t\twindow[ callbackName ] = overwritten;\n\n\t\t\t// Save back as free\n\t\t\tif ( s[ callbackName ] ) {\n\t\t\t\t// make sure that re-using the options doesn't screw things around\n\t\t\t\ts.jsonpCallback = originalSettings.jsonpCallback;\n\n\t\t\t\t// save the callback name for future use\n\t\t\t\toldCallbacks.push( callbackName );\n\t\t\t}\n\n\t\t\t// Call if it was a function and we have a response\n\t\t\tif ( responseContainer && jQuery.isFunction( overwritten ) ) {\n\t\t\t\toverwritten( responseContainer[ 0 ] );\n\t\t\t}\n\n\t\t\tresponseContainer = overwritten = undefined;\n\t\t});\n\n\t\t// Delegate to script\n\t\treturn \"script\";\n\t}\n});\n\n\n\n\n// data: string of html\n// context (optional): If specified, the fragment will be created in this context, defaults to document\n// keepScripts (optional): If true, will include scripts passed in the html string\njQuery.parseHTML = function( data, context, keepScripts ) {\n\tif ( !data || typeof data !== \"string\" ) {\n\t\treturn null;\n\t}\n\tif ( typeof context === \"boolean\" ) {\n\t\tkeepScripts = context;\n\t\tcontext = false;\n\t}\n\tcontext = context || document;\n\n\tvar parsed = rsingleTag.exec( data ),\n\t\tscripts = !keepScripts && [];\n\n\t// Single tag\n\tif ( parsed ) {\n\t\treturn [ context.createElement( parsed[1] ) ];\n\t}\n\n\tparsed = jQuery.buildFragment( [ data ], context, scripts );\n\n\tif ( scripts && scripts.length ) {\n\t\tjQuery( scripts ).remove();\n\t}\n\n\treturn jQuery.merge( [], parsed.childNodes );\n};\n\n\n// Keep a copy of the old load method\nvar _load = jQuery.fn.load;\n\n/**\n * Load a url into a page\n */\njQuery.fn.load = function( url, params, callback ) {\n\tif ( typeof url !== \"string\" && _load ) {\n\t\treturn _load.apply( this, arguments );\n\t}\n\n\tvar selector, response, type,\n\t\tself = this,\n\t\toff = url.indexOf(\" \");\n\n\tif ( off >= 0 ) {\n\t\tselector = jQuery.trim( url.slice( off, url.length ) );\n\t\turl = url.slice( 0, off );\n\t}\n\n\t// If it's a function\n\tif ( jQuery.isFunction( params ) ) {\n\n\t\t// We assume that it's the callback\n\t\tcallback = params;\n\t\tparams = undefined;\n\n\t// Otherwise, build a param string\n\t} else if ( params && typeof params === \"object\" ) {\n\t\ttype = \"POST\";\n\t}\n\n\t// If we have elements to modify, make the request\n\tif ( self.length > 0 ) {\n\t\tjQuery.ajax({\n\t\t\turl: url,\n\n\t\t\t// if \"type\" variable is undefined, then \"GET\" method will be used\n\t\t\ttype: type,\n\t\t\tdataType: \"html\",\n\t\t\tdata: params\n\t\t}).done(function( responseText ) {\n\n\t\t\t// Save response for use in complete callback\n\t\t\tresponse = arguments;\n\n\t\t\tself.html( selector ?\n\n\t\t\t\t// If a selector was specified, locate the right elements in a dummy div\n\t\t\t\t// Exclude scripts to avoid IE 'Permission Denied' errors\n\t\t\t\tjQuery(\"<div>\").append( jQuery.parseHTML( responseText ) ).find( selector ) :\n\n\t\t\t\t// Otherwise use the full result\n\t\t\t\tresponseText );\n\n\t\t}).complete( callback && function( jqXHR, status ) {\n\t\t\tself.each( callback, response || [ jqXHR.responseText, status, jqXHR ] );\n\t\t});\n\t}\n\n\treturn this;\n};\n\n\n\n\n// Attach a bunch of functions for handling common AJAX events\njQuery.each( [ \"ajaxStart\", \"ajaxStop\", \"ajaxComplete\", \"ajaxError\", \"ajaxSuccess\", \"ajaxSend\" ], function( i, type ) {\n\tjQuery.fn[ type ] = function( fn ) {\n\t\treturn this.on( type, fn );\n\t};\n});\n\n\n\n\njQuery.expr.filters.animated = function( elem ) {\n\treturn jQuery.grep(jQuery.timers, function( fn ) {\n\t\treturn elem === fn.elem;\n\t}).length;\n};\n\n\n\n\n\nvar docElem = window.document.documentElement;\n\n/**\n * Gets a window from an element\n */\nfunction getWindow( elem ) {\n\treturn jQuery.isWindow( elem ) ?\n\t\telem :\n\t\telem.nodeType === 9 ?\n\t\t\telem.defaultView || elem.parentWindow :\n\t\t\tfalse;\n}\n\njQuery.offset = {\n\tsetOffset: function( elem, options, i ) {\n\t\tvar curPosition, curLeft, curCSSTop, curTop, curOffset, curCSSLeft, calculatePosition,\n\t\t\tposition = jQuery.css( elem, \"position\" ),\n\t\t\tcurElem = jQuery( elem ),\n\t\t\tprops = {};\n\n\t\t// set position first, in-case top/left are set even on static elem\n\t\tif ( position === \"static\" ) {\n\t\t\telem.style.position = \"relative\";\n\t\t}\n\n\t\tcurOffset = curElem.offset();\n\t\tcurCSSTop = jQuery.css( elem, \"top\" );\n\t\tcurCSSLeft = jQuery.css( elem, \"left\" );\n\t\tcalculatePosition = ( position === \"absolute\" || position === \"fixed\" ) &&\n\t\t\tjQuery.inArray(\"auto\", [ curCSSTop, curCSSLeft ] ) > -1;\n\n\t\t// need to be able to calculate position if either top or left is auto and position is either absolute or fixed\n\t\tif ( calculatePosition ) {\n\t\t\tcurPosition = curElem.position();\n\t\t\tcurTop = curPosition.top;\n\t\t\tcurLeft = curPosition.left;\n\t\t} else {\n\t\t\tcurTop = parseFloat( curCSSTop ) || 0;\n\t\t\tcurLeft = parseFloat( curCSSLeft ) || 0;\n\t\t}\n\n\t\tif ( jQuery.isFunction( options ) ) {\n\t\t\toptions = options.call( elem, i, curOffset );\n\t\t}\n\n\t\tif ( options.top != null ) {\n\t\t\tprops.top = ( options.top - curOffset.top ) + curTop;\n\t\t}\n\t\tif ( options.left != null ) {\n\t\t\tprops.left = ( options.left - curOffset.left ) + curLeft;\n\t\t}\n\n\t\tif ( \"using\" in options ) {\n\t\t\toptions.using.call( elem, props );\n\t\t} else {\n\t\t\tcurElem.css( props );\n\t\t}\n\t}\n};\n\njQuery.fn.extend({\n\toffset: function( options ) {\n\t\tif ( arguments.length ) {\n\t\t\treturn options === undefined ?\n\t\t\t\tthis :\n\t\t\t\tthis.each(function( i ) {\n\t\t\t\t\tjQuery.offset.setOffset( this, options, i );\n\t\t\t\t});\n\t\t}\n\n\t\tvar docElem, win,\n\t\t\tbox = { top: 0, left: 0 },\n\t\t\telem = this[ 0 ],\n\t\t\tdoc = elem && elem.ownerDocument;\n\n\t\tif ( !doc ) {\n\t\t\treturn;\n\t\t}\n\n\t\tdocElem = doc.documentElement;\n\n\t\t// Make sure it's not a disconnected DOM node\n\t\tif ( !jQuery.contains( docElem, elem ) ) {\n\t\t\treturn box;\n\t\t}\n\n\t\t// If we don't have gBCR, just use 0,0 rather than error\n\t\t// BlackBerry 5, iOS 3 (original iPhone)\n\t\tif ( typeof elem.getBoundingClientRect !== strundefined ) {\n\t\t\tbox = elem.getBoundingClientRect();\n\t\t}\n\t\twin = getWindow( doc );\n\t\treturn {\n\t\t\ttop: box.top  + ( win.pageYOffset || docElem.scrollTop )  - ( docElem.clientTop  || 0 ),\n\t\t\tleft: box.left + ( win.pageXOffset || docElem.scrollLeft ) - ( docElem.clientLeft || 0 )\n\t\t};\n\t},\n\n\tposition: function() {\n\t\tif ( !this[ 0 ] ) {\n\t\t\treturn;\n\t\t}\n\n\t\tvar offsetParent, offset,\n\t\t\tparentOffset = { top: 0, left: 0 },\n\t\t\telem = this[ 0 ];\n\n\t\t// fixed elements are offset from window (parentOffset = {top:0, left: 0}, because it is its only offset parent\n\t\tif ( jQuery.css( elem, \"position\" ) === \"fixed\" ) {\n\t\t\t// we assume that getBoundingClientRect is available when computed position is fixed\n\t\t\toffset = elem.getBoundingClientRect();\n\t\t} else {\n\t\t\t// Get *real* offsetParent\n\t\t\toffsetParent = this.offsetParent();\n\n\t\t\t// Get correct offsets\n\t\t\toffset = this.offset();\n\t\t\tif ( !jQuery.nodeName( offsetParent[ 0 ], \"html\" ) ) {\n\t\t\t\tparentOffset = offsetParent.offset();\n\t\t\t}\n\n\t\t\t// Add offsetParent borders\n\t\t\tparentOffset.top  += jQuery.css( offsetParent[ 0 ], \"borderTopWidth\", true );\n\t\t\tparentOffset.left += jQuery.css( offsetParent[ 0 ], \"borderLeftWidth\", true );\n\t\t}\n\n\t\t// Subtract parent offsets and element margins\n\t\t// note: when an element has margin: auto the offsetLeft and marginLeft\n\t\t// are the same in Safari causing offset.left to incorrectly be 0\n\t\treturn {\n\t\t\ttop:  offset.top  - parentOffset.top - jQuery.css( elem, \"marginTop\", true ),\n\t\t\tleft: offset.left - parentOffset.left - jQuery.css( elem, \"marginLeft\", true)\n\t\t};\n\t},\n\n\toffsetParent: function() {\n\t\treturn this.map(function() {\n\t\t\tvar offsetParent = this.offsetParent || docElem;\n\n\t\t\twhile ( offsetParent && ( !jQuery.nodeName( offsetParent, \"html\" ) && jQuery.css( offsetParent, \"position\" ) === \"static\" ) ) {\n\t\t\t\toffsetParent = offsetParent.offsetParent;\n\t\t\t}\n\t\t\treturn offsetParent || docElem;\n\t\t});\n\t}\n});\n\n// Create scrollLeft and scrollTop methods\njQuery.each( { scrollLeft: \"pageXOffset\", scrollTop: \"pageYOffset\" }, function( method, prop ) {\n\tvar top = /Y/.test( prop );\n\n\tjQuery.fn[ method ] = function( val ) {\n\t\treturn access( this, function( elem, method, val ) {\n\t\t\tvar win = getWindow( elem );\n\n\t\t\tif ( val === undefined ) {\n\t\t\t\treturn win ? (prop in win) ? win[ prop ] :\n\t\t\t\t\twin.document.documentElement[ method ] :\n\t\t\t\t\telem[ method ];\n\t\t\t}\n\n\t\t\tif ( win ) {\n\t\t\t\twin.scrollTo(\n\t\t\t\t\t!top ? val : jQuery( win ).scrollLeft(),\n\t\t\t\t\ttop ? val : jQuery( win ).scrollTop()\n\t\t\t\t);\n\n\t\t\t} else {\n\t\t\t\telem[ method ] = val;\n\t\t\t}\n\t\t}, method, val, arguments.length, null );\n\t};\n});\n\n// Add the top/left cssHooks using jQuery.fn.position\n// Webkit bug: https://bugs.webkit.org/show_bug.cgi?id=29084\n// getComputedStyle returns percent when specified for top/left/bottom/right\n// rather than make the css module depend on the offset module, we just check for it here\njQuery.each( [ \"top\", \"left\" ], function( i, prop ) {\n\tjQuery.cssHooks[ prop ] = addGetHookIf( support.pixelPosition,\n\t\tfunction( elem, computed ) {\n\t\t\tif ( computed ) {\n\t\t\t\tcomputed = curCSS( elem, prop );\n\t\t\t\t// if curCSS returns percentage, fallback to offset\n\t\t\t\treturn rnumnonpx.test( computed ) ?\n\t\t\t\t\tjQuery( elem ).position()[ prop ] + \"px\" :\n\t\t\t\t\tcomputed;\n\t\t\t}\n\t\t}\n\t);\n});\n\n\n// Create innerHeight, innerWidth, height, width, outerHeight and outerWidth methods\njQuery.each( { Height: \"height\", Width: \"width\" }, function( name, type ) {\n\tjQuery.each( { padding: \"inner\" + name, content: type, \"\": \"outer\" + name }, function( defaultExtra, funcName ) {\n\t\t// margin is only for outerHeight, outerWidth\n\t\tjQuery.fn[ funcName ] = function( margin, value ) {\n\t\t\tvar chainable = arguments.length && ( defaultExtra || typeof margin !== \"boolean\" ),\n\t\t\t\textra = defaultExtra || ( margin === true || value === true ? \"margin\" : \"border\" );\n\n\t\t\treturn access( this, function( elem, type, value ) {\n\t\t\t\tvar doc;\n\n\t\t\t\tif ( jQuery.isWindow( elem ) ) {\n\t\t\t\t\t// As of 5/8/2012 this will yield incorrect results for Mobile Safari, but there\n\t\t\t\t\t// isn't a whole lot we can do. See pull request at this URL for discussion:\n\t\t\t\t\t// https://github.com/jquery/jquery/pull/764\n\t\t\t\t\treturn elem.document.documentElement[ \"client\" + name ];\n\t\t\t\t}\n\n\t\t\t\t// Get document width or height\n\t\t\t\tif ( elem.nodeType === 9 ) {\n\t\t\t\t\tdoc = elem.documentElement;\n\n\t\t\t\t\t// Either scroll[Width/Height] or offset[Width/Height] or client[Width/Height], whichever is greatest\n\t\t\t\t\t// unfortunately, this causes bug #3838 in IE6/8 only, but there is currently no good, small way to fix it.\n\t\t\t\t\treturn Math.max(\n\t\t\t\t\t\telem.body[ \"scroll\" + name ], doc[ \"scroll\" + name ],\n\t\t\t\t\t\telem.body[ \"offset\" + name ], doc[ \"offset\" + name ],\n\t\t\t\t\t\tdoc[ \"client\" + name ]\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\treturn value === undefined ?\n\t\t\t\t\t// Get width or height on the element, requesting but not forcing parseFloat\n\t\t\t\t\tjQuery.css( elem, type, extra ) :\n\n\t\t\t\t\t// Set width or height on the element\n\t\t\t\t\tjQuery.style( elem, type, value, extra );\n\t\t\t}, type, chainable ? margin : undefined, chainable, null );\n\t\t};\n\t});\n});\n\n\n// The number of elements contained in the matched element set\njQuery.fn.size = function() {\n\treturn this.length;\n};\n\njQuery.fn.andSelf = jQuery.fn.addBack;\n\n\n\n\n// Register as a named AMD module, since jQuery can be concatenated with other\n// files that may use define, but not via a proper concatenation script that\n// understands anonymous AMD modules. A named AMD is safest and most robust\n// way to register. Lowercase jquery is used because AMD module names are\n// derived from file names, and jQuery is normally delivered in a lowercase\n// file name. Do this after creating the global so that if an AMD module wants\n// to call noConflict to hide this version of jQuery, it will work.\n\n// Note that for maximum portability, libraries that are not jQuery should\n// declare themselves as anonymous modules, and avoid setting a global if an\n// AMD loader is present. jQuery is a special case. For more information, see\n// https://github.com/jrburke/requirejs/wiki/Updating-existing-libraries#wiki-anon\n\nif ( typeof define === \"function\" && define.amd ) {\n\tdefine( \"jquery\", [], function() {\n\t\treturn jQuery;\n\t});\n}\n\n\n\n\nvar\n\t// Map over jQuery in case of overwrite\n\t_jQuery = window.jQuery,\n\n\t// Map over the $ in case of overwrite\n\t_$ = window.$;\n\njQuery.noConflict = function( deep ) {\n\tif ( window.$ === jQuery ) {\n\t\twindow.$ = _$;\n\t}\n\n\tif ( deep && window.jQuery === jQuery ) {\n\t\twindow.jQuery = _jQuery;\n\t}\n\n\treturn jQuery;\n};\n\n// Expose jQuery and $ identifiers, even in\n// AMD (#7102#comment:10, https://github.com/jquery/jquery/pull/557)\n// and CommonJS for browser emulators (#13566)\nif ( typeof noGlobal === strundefined ) {\n\twindow.jQuery = window.$ = jQuery;\n}\n\n\n\n\nreturn jQuery;\n\n}));\n\n// Console-polyfill. MIT license.\r\n// https://github.com/paulmillr/console-polyfill\r\n// Make it safe to do console.log() always.\r\n(function(global) {\r\n  'use strict';\r\n  if (!global.console) {\r\n    global.console = {};\r\n  }\r\n  var con = global.console;\r\n  var prop, method;\r\n  var dummy = function() {};\r\n  var properties = ['memory'];\r\n  var methods = ('assert,clear,count,debug,dir,dirxml,error,exception,group,' +\r\n     'groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,' +\r\n     'show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn').split(',');\r\n  while (prop = properties.pop()) if (!con[prop]) con[prop] = {};\r\n  while (method = methods.pop()) if (typeof con[method] !== 'function') con[method] = dummy;\r\n  // Using `this` for web workers & supports Browserify / Webpack.\r\n})(typeof window === 'undefined' ? this : window);\r\n\n/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */\r\n/*! NOTE: If you're already including a window.matchMedia polyfill via Modernizr or otherwise, you don't need this part */\r\n(function(w) {\r\n  \"use strict\";\r\n  w.matchMedia = w.matchMedia || function(doc, undefined) {\r\n    var bool, docElem = doc.documentElement, refNode = docElem.firstElementChild || docElem.firstChild, fakeBody = doc.createElement(\"body\"), div = doc.createElement(\"div\");\r\n    div.id = \"mq-test-1\";\r\n    div.style.cssText = \"position:absolute;top:-100em\";\r\n    fakeBody.style.background = \"none\";\r\n    fakeBody.appendChild(div);\r\n    return function(q) {\r\n      div.innerHTML = '&shy;<style media=\"' + q + '\"> #mq-test-1 { width: 42px; }</style>';\r\n      docElem.insertBefore(fakeBody, refNode);\r\n      bool = div.offsetWidth === 42;\r\n      docElem.removeChild(fakeBody);\r\n      return {\r\n        matches: bool,\r\n        media: q\r\n      };\r\n    };\r\n  }(w.document);\r\n})(this);\r\n\r\n/*! Respond.js v1.4.0: min/max-width media query polyfill. (c) Scott Jehl. MIT Lic. j.mp/respondjs  */\r\n(function(w) {\r\n  \"use strict\";\r\n  var respond = {};\r\n  w.respond = respond;\r\n  respond.update = function() {};\r\n  var requestQueue = [], xmlHttp = function() {\r\n    var xmlhttpmethod = false;\r\n    try {\r\n      xmlhttpmethod = new w.XMLHttpRequest();\r\n    } catch (e) {\r\n      xmlhttpmethod = new w.ActiveXObject(\"Microsoft.XMLHTTP\");\r\n    }\r\n    return function() {\r\n      return xmlhttpmethod;\r\n    };\r\n  }(), ajax = function(url, callback) {\r\n    var req = xmlHttp();\r\n    if (!req) {\r\n      return;\r\n    }\r\n    req.open(\"GET\", url, true);\r\n    req.onreadystatechange = function() {\r\n      if (req.readyState !== 4 || req.status !== 200 && req.status !== 304) {\r\n        return;\r\n      }\r\n      callback(req.responseText);\r\n    };\r\n    if (req.readyState === 4) {\r\n      return;\r\n    }\r\n    req.send(null);\r\n  };\r\n  respond.ajax = ajax;\r\n  respond.queue = requestQueue;\r\n  respond.regex = {\r\n    media: /@media[^\\{]+\\{([^\\{\\}]*\\{[^\\}\\{]*\\})+/gi,\r\n    keyframes: /@(?:\\-(?:o|moz|webkit)\\-)?keyframes[^\\{]+\\{(?:[^\\{\\}]*\\{[^\\}\\{]*\\})+[^\\}]*\\}/gi,\r\n    urls: /(url\\()['\"]?([^\\/\\)'\"][^:\\)'\"]+)['\"]?(\\))/g,\r\n    findStyles: /@media *([^\\{]+)\\{([\\S\\s]+?)$/,\r\n    only: /(only\\s+)?([a-zA-Z]+)\\s?/,\r\n    minw: /\\([\\s]*min\\-width\\s*:[\\s]*([\\s]*[0-9\\.]+)(px|em)[\\s]*\\)/,\r\n    maxw: /\\([\\s]*max\\-width\\s*:[\\s]*([\\s]*[0-9\\.]+)(px|em)[\\s]*\\)/\r\n  };\r\n  respond.mediaQueriesSupported = w.matchMedia && w.matchMedia(\"only all\") !== null && w.matchMedia(\"only all\").matches;\r\n  if (respond.mediaQueriesSupported) {\r\n    return;\r\n  }\r\n  var doc = w.document, docElem = doc.documentElement, mediastyles = [], rules = [], appendedEls = [], parsedSheets = {}, resizeThrottle = 30, head = doc.getElementsByTagName(\"head\")[0] || docElem, base = doc.getElementsByTagName(\"base\")[0], links = head.getElementsByTagName(\"link\"), lastCall, resizeDefer, eminpx, getEmValue = function() {\r\n    var ret, div = doc.createElement(\"div\"), body = doc.body, originalHTMLFontSize = docElem.style.fontSize, originalBodyFontSize = body && body.style.fontSize, fakeUsed = false;\r\n    div.style.cssText = \"position:absolute;font-size:1em;width:1em\";\r\n    if (!body) {\r\n      body = fakeUsed = doc.createElement(\"body\");\r\n      body.style.background = \"none\";\r\n    }\r\n    docElem.style.fontSize = \"100%\";\r\n    body.style.fontSize = \"100%\";\r\n    body.appendChild(div);\r\n    if (fakeUsed) {\r\n      docElem.insertBefore(body, docElem.firstChild);\r\n    }\r\n    ret = div.offsetWidth;\r\n    if (fakeUsed) {\r\n      docElem.removeChild(body);\r\n    } else {\r\n      body.removeChild(div);\r\n    }\r\n    docElem.style.fontSize = originalHTMLFontSize;\r\n    if (originalBodyFontSize) {\r\n      body.style.fontSize = originalBodyFontSize;\r\n    }\r\n    ret = eminpx = parseFloat(ret);\r\n    return ret;\r\n  }, applyMedia = function(fromResize) {\r\n    var name = \"clientWidth\", docElemProp = docElem[name], currWidth = doc.compatMode === \"CSS1Compat\" && docElemProp || doc.body[name] || docElemProp, styleBlocks = {}, lastLink = links[links.length - 1], now = new Date().getTime();\r\n    if (fromResize && lastCall && now - lastCall < resizeThrottle) {\r\n      w.clearTimeout(resizeDefer);\r\n      resizeDefer = w.setTimeout(applyMedia, resizeThrottle);\r\n      return;\r\n    } else {\r\n      lastCall = now;\r\n    }\r\n    for (var i in mediastyles) {\r\n      if (mediastyles.hasOwnProperty(i)) {\r\n        var thisstyle = mediastyles[i], min = thisstyle.minw, max = thisstyle.maxw, minnull = min === null, maxnull = max === null, em = \"em\";\r\n        if (!!min) {\r\n          min = parseFloat(min) * (min.indexOf(em) > -1 ? eminpx || getEmValue() : 1);\r\n        }\r\n        if (!!max) {\r\n          max = parseFloat(max) * (max.indexOf(em) > -1 ? eminpx || getEmValue() : 1);\r\n        }\r\n        if (!thisstyle.hasquery || (!minnull || !maxnull) && (minnull || currWidth >= min) && (maxnull || currWidth <= max)) {\r\n          if (!styleBlocks[thisstyle.media]) {\r\n            styleBlocks[thisstyle.media] = [];\r\n          }\r\n          styleBlocks[thisstyle.media].push(rules[thisstyle.rules]);\r\n        }\r\n      }\r\n    }\r\n    for (var j in appendedEls) {\r\n      if (appendedEls.hasOwnProperty(j)) {\r\n        if (appendedEls[j] && appendedEls[j].parentNode === head) {\r\n          head.removeChild(appendedEls[j]);\r\n        }\r\n      }\r\n    }\r\n    appendedEls.length = 0;\r\n    for (var k in styleBlocks) {\r\n      if (styleBlocks.hasOwnProperty(k)) {\r\n        var ss = doc.createElement(\"style\"), css = styleBlocks[k].join(\"\\n\");\r\n        ss.type = \"text/css\";\r\n        ss.media = k;\r\n        head.insertBefore(ss, lastLink.nextSibling);\r\n        if (ss.styleSheet) {\r\n          ss.styleSheet.cssText = css;\r\n        } else {\r\n          ss.appendChild(doc.createTextNode(css));\r\n        }\r\n        appendedEls.push(ss);\r\n      }\r\n    }\r\n  }, translate = function(styles, href, media) {\r\n    var qs = styles.replace(respond.regex.keyframes, \"\").match(respond.regex.media), ql = qs && qs.length || 0;\r\n    href = href.substring(0, href.lastIndexOf(\"/\"));\r\n    var repUrls = function(css) {\r\n      return css.replace(respond.regex.urls, \"$1\" + href + \"$2$3\");\r\n    }, useMedia = !ql && media;\r\n    if (href.length) {\r\n      href += \"/\";\r\n    }\r\n    if (useMedia) {\r\n      ql = 1;\r\n    }\r\n    for (var i = 0; i < ql; i++) {\r\n      var fullq, thisq, eachq, eql;\r\n      if (useMedia) {\r\n        fullq = media;\r\n        rules.push(repUrls(styles));\r\n      } else {\r\n        fullq = qs[i].match(respond.regex.findStyles) && RegExp.$1;\r\n        rules.push(RegExp.$2 && repUrls(RegExp.$2));\r\n      }\r\n      eachq = fullq.split(\",\");\r\n      eql = eachq.length;\r\n      for (var j = 0; j < eql; j++) {\r\n        thisq = eachq[j];\r\n        mediastyles.push({\r\n          media: thisq.split(\"(\")[0].match(respond.regex.only) && RegExp.$2 || \"all\",\r\n          rules: rules.length - 1,\r\n          hasquery: thisq.indexOf(\"(\") > -1,\r\n          minw: thisq.match(respond.regex.minw) && parseFloat(RegExp.$1) + (RegExp.$2 || \"\"),\r\n          maxw: thisq.match(respond.regex.maxw) && parseFloat(RegExp.$1) + (RegExp.$2 || \"\")\r\n        });\r\n      }\r\n    }\r\n    applyMedia();\r\n  }, makeRequests = function() {\r\n    if (requestQueue.length) {\r\n      var thisRequest = requestQueue.shift();\r\n      ajax(thisRequest.href, function(styles) {\r\n        translate(styles, thisRequest.href, thisRequest.media);\r\n        parsedSheets[thisRequest.href] = true;\r\n        w.setTimeout(function() {\r\n          makeRequests();\r\n        }, 0);\r\n      });\r\n    }\r\n  }, ripCSS = function() {\r\n    for (var i = 0; i < links.length; i++) {\r\n      var sheet = links[i], href = sheet.href, media = sheet.media, isCSS = sheet.rel && sheet.rel.toLowerCase() === \"stylesheet\";\r\n      if (!!href && isCSS && !parsedSheets[href]) {\r\n        if (sheet.styleSheet && sheet.styleSheet.rawCssText) {\r\n          translate(sheet.styleSheet.rawCssText, href, media);\r\n          parsedSheets[href] = true;\r\n        } else {\r\n          if (!/^([a-zA-Z:]*\\/\\/)/.test(href) && !base || href.replace(RegExp.$1, \"\").split(\"/\")[0] === w.location.host) {\r\n            if (href.substring(0, 2) === \"//\") {\r\n              href = w.location.protocol + href;\r\n            }\r\n            requestQueue.push({\r\n              href: href,\r\n              media: media\r\n            });\r\n          }\r\n        }\r\n      }\r\n    }\r\n    makeRequests();\r\n  };\r\n  ripCSS();\r\n  respond.update = ripCSS;\r\n  respond.getEmValue = getEmValue;\r\n  function callMedia() {\r\n    applyMedia(true);\r\n  }\r\n  if (w.addEventListener) {\r\n    w.addEventListener(\"resize\", callMedia, false);\r\n  } else if (w.attachEvent) {\r\n    w.attachEvent(\"onresize\", callMedia);\r\n  }\r\n})(this);\n/*\r\nselectivizr v1.0.2b - (c) Keith Clark, freely distributable under the terms \r\nof the MIT license.\r\n\r\nselectivizr.com\r\n*/\r\n/* \r\n  \r\nNotes about this source\r\n-----------------------\r\n\r\n * The #DEBUG_START and #DEBUG_END comments are used to mark blocks of code\r\n   that will be removed prior to building a final release version (using a\r\n   pre-compression script)\r\n  \r\n  \r\nReferences:\r\n-----------\r\n \r\n * CSS Syntax          : http://www.w3.org/TR/2003/WD-css3-syntax-20030813/#style\r\n * Selectors           : http://www.w3.org/TR/css3-selectors/#selectors\r\n * IE Compatability    : http://msdn.microsoft.com/en-us/library/cc351024(VS.85).aspx\r\n * W3C Selector Tests  : http://www.w3.org/Style/CSS/Test/CSS3/Selectors/current/html/tests/\r\n \r\n*/\r\n\r\n(function(win) {\r\n\r\n\t// If browser isn't IE, then stop execution! This handles the script \r\n\t// being loaded by non IE browsers because the developer didn't use \r\n\t// conditional comments.\r\n\tif (/*@cc_on!@*/true) return;\r\n\r\n\t// =========================== Init Objects ============================\r\n\r\n\tvar doc = document;\r\n\tvar root = doc.documentElement;\r\n\tvar xhr = getXHRObject();\r\n\tvar ieVersion = /MSIE (\\d+)/.exec(navigator.userAgent)[1];\r\n\t\r\n\t// If were not in standards mode, IE is too old / new or we can't create\r\n\t// an XMLHttpRequest object then we should get out now.\r\n\tif (doc.compatMode != 'CSS1Compat' || ieVersion<6 || ieVersion>8 || !xhr) {\r\n\t\treturn;\r\n\t}\r\n\t\r\n\t\r\n\t// ========================= Common Objects ============================\r\n\r\n\t// Compatiable selector engines in order of CSS3 support. Note: '*' is\r\n\t// a placholder for the object key name. (basically, crude compression)\r\n\tvar selectorEngines = {\r\n\t\t\"NW\"\t\t\t\t\t\t\t\t: \"*.Dom.select\",\r\n\t\t\"MooTools\"\t\t\t\t\t\t\t: \"$$\",\r\n\t\t\"DOMAssistant\"\t\t\t\t\t\t: \"*.$\", \r\n\t\t\"Prototype\"\t\t\t\t\t\t\t: \"$$\",\r\n\t\t\"YAHOO\"\t\t\t\t\t\t\t\t: \"*.util.Selector.query\",\r\n\t\t\"Sizzle\"\t\t\t\t\t\t\t: \"*\", \r\n\t\t\"jQuery\"\t\t\t\t\t\t\t: \"*\",\r\n\t\t\"dojo\"\t\t\t\t\t\t\t\t: \"*.query\"\r\n\t};\r\n\r\n\tvar selectorMethod;\r\n\tvar enabledWatchers \t\t\t\t\t= [];     // array of :enabled/:disabled elements to poll\r\n\tvar ie6PatchID \t\t\t\t\t\t\t= 0;      // used to solve ie6's multiple class bug\r\n\tvar patchIE6MultipleClasses\t\t\t\t= true;   // if true adds class bloat to ie6\r\n\tvar namespace \t\t\t\t\t\t\t= \"slvzr\";\r\n\t\r\n\t// Stylesheet parsing regexp's\r\n\tvar RE_COMMENT\t\t\t\t\t\t\t= /(\\/\\*[^*]*\\*+([^\\/][^*]*\\*+)*\\/)\\s*/g;\r\n\tvar RE_IMPORT\t\t\t\t\t\t\t= /@import\\s*(?:(?:(?:url\\(\\s*(['\"]?)(.*)\\1)\\s*\\))|(?:(['\"])(.*)\\3))[^;]*;/g;\r\n\tvar RE_ASSET_URL \t\t\t\t\t\t= /\\burl\\(\\s*([\"']?)(?!data:)([^\"')]+)\\1\\s*\\)/g;\r\n\tvar RE_PSEUDO_STRUCTURAL\t\t\t\t= /^:(empty|(first|last|only|nth(-last)?)-(child|of-type))$/;\r\n\tvar RE_PSEUDO_ELEMENTS\t\t\t\t\t= /:(:first-(?:line|letter))/g;\r\n\tvar RE_SELECTOR_GROUP\t\t\t\t\t= /(^|})\\s*([^\\{]*?[\\[:][^{]+)/g;\r\n\tvar RE_SELECTOR_PARSE\t\t\t\t\t= /([ +~>])|(:[a-z-]+(?:\\(.*?\\)+)?)|(\\[.*?\\])/g; \r\n\tvar RE_LIBRARY_INCOMPATIBLE_PSEUDOS\t\t= /(:not\\()?:(hover|enabled|disabled|focus|checked|target|active|visited|first-line|first-letter)\\)?/g;\r\n\tvar RE_PATCH_CLASS_NAME_REPLACE\t\t\t= /[^\\w-]/g;\r\n\t\r\n\t// HTML UI element regexp's\r\n\tvar RE_INPUT_ELEMENTS\t\t\t\t\t= /^(INPUT|SELECT|TEXTAREA|BUTTON)$/;\r\n\tvar RE_INPUT_CHECKABLE_TYPES\t\t\t= /^(checkbox|radio)$/;\r\n\r\n\t// Broken attribute selector implementations (IE7/8 native [^=\"\"], [$=\"\"] and [*=\"\"])\r\n\tvar BROKEN_ATTR_IMPLEMENTATIONS\t\t\t= ieVersion>6 ? /[\\$\\^*]=(['\"])\\1/ : null;\r\n\r\n\t// Whitespace normalization regexp's\r\n\tvar RE_TIDY_TRAILING_WHITESPACE\t\t\t= /([(\\[+~])\\s+/g;\r\n\tvar RE_TIDY_LEADING_WHITESPACE\t\t\t= /\\s+([)\\]+~])/g;\r\n\tvar RE_TIDY_CONSECUTIVE_WHITESPACE\t\t= /\\s+/g;\r\n\tvar RE_TIDY_TRIM_WHITESPACE\t\t\t\t= /^\\s*((?:[\\S\\s]*\\S)?)\\s*$/;\r\n\t\r\n\t// String constants\r\n\tvar EMPTY_STRING\t\t\t\t\t\t= \"\";\r\n\tvar SPACE_STRING\t\t\t\t\t\t= \" \";\r\n\tvar PLACEHOLDER_STRING\t\t\t\t\t= \"$1\";\r\n\r\n\t// =========================== Patching ================================\r\n\r\n\t// --[ patchStyleSheet() ]----------------------------------------------\r\n\t// Scans the passed cssText for selectors that require emulation and\r\n\t// creates one or more patches for each matched selector.\r\n\tfunction patchStyleSheet( cssText ) {\r\n\t\treturn cssText.replace(RE_PSEUDO_ELEMENTS, PLACEHOLDER_STRING).\r\n\t\t\treplace(RE_SELECTOR_GROUP, function(m, prefix, selectorText) {\t\r\n    \t\t\tvar selectorGroups = selectorText.split(\",\");\r\n    \t\t\tfor (var c = 0, cs = selectorGroups.length; c < cs; c++) {\r\n    \t\t\t\tvar selector = normalizeSelectorWhitespace(selectorGroups[c]) + SPACE_STRING;\r\n    \t\t\t\tvar patches = [];\r\n    \t\t\t\tselectorGroups[c] = selector.replace(RE_SELECTOR_PARSE, \r\n    \t\t\t\t\tfunction(match, combinator, pseudo, attribute, index) {\r\n    \t\t\t\t\t\tif (combinator) {\r\n    \t\t\t\t\t\t\tif (patches.length>0) {\r\n    \t\t\t\t\t\t\t\tapplyPatches( selector.substring(0, index), patches );\r\n    \t\t\t\t\t\t\t\tpatches = [];\r\n    \t\t\t\t\t\t\t}\r\n    \t\t\t\t\t\t\treturn combinator;\r\n    \t\t\t\t\t\t}\t\t\r\n    \t\t\t\t\t\telse {\r\n    \t\t\t\t\t\t\tvar patch = (pseudo) ? patchPseudoClass( pseudo ) : patchAttribute( attribute );\r\n    \t\t\t\t\t\t\tif (patch) {\r\n    \t\t\t\t\t\t\t\tpatches.push(patch);\r\n    \t\t\t\t\t\t\t\treturn \".\" + patch.className;\r\n    \t\t\t\t\t\t\t}\r\n    \t\t\t\t\t\t\treturn match;\r\n    \t\t\t\t\t\t}\r\n    \t\t\t\t\t}\r\n    \t\t\t\t);\r\n    \t\t\t}\r\n    \t\t\treturn prefix + selectorGroups.join(\",\");\r\n    \t\t});\r\n\t};\r\n\r\n\t// --[ patchAttribute() ]-----------------------------------------------\r\n\t// returns a patch for an attribute selector.\r\n\tfunction patchAttribute( attr ) {\r\n\t\treturn (!BROKEN_ATTR_IMPLEMENTATIONS || BROKEN_ATTR_IMPLEMENTATIONS.test(attr)) ? \r\n\t\t\t{ className: createClassName(attr), applyClass: true } : null;\r\n\t};\r\n\r\n\t// --[ patchPseudoClass() ]---------------------------------------------\r\n\t// returns a patch for a pseudo-class\r\n\tfunction patchPseudoClass( pseudo ) {\r\n\r\n\t\tvar applyClass = true;\r\n\t\tvar className = createClassName(pseudo.slice(1));\r\n\t\tvar isNegated = pseudo.substring(0, 5) == \":not(\";\r\n\t\tvar activateEventName;\r\n\t\tvar deactivateEventName;\r\n\r\n\t\t// if negated, remove :not() \r\n\t\tif (isNegated) {\r\n\t\t\tpseudo = pseudo.slice(5, -1);\r\n\t\t}\r\n\t\t\r\n\t\t// bracket contents are irrelevant - remove them\r\n\t\tvar bracketIndex = pseudo.indexOf(\"(\")\r\n\t\tif (bracketIndex > -1) {\r\n\t\t\tpseudo = pseudo.substring(0, bracketIndex);\r\n\t\t}\t\t\r\n\t\t\r\n\t\t// check we're still dealing with a pseudo-class\r\n\t\tif (pseudo.charAt(0) == \":\") {\r\n\t\t\tswitch (pseudo.slice(1)) {\r\n\r\n\t\t\t\tcase \"root\":\r\n\t\t\t\t\tapplyClass = function(e) {\r\n\t\t\t\t\t\treturn isNegated ? e != root : e == root;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\r\n\t\t\t\tcase \"target\":\r\n\t\t\t\t\t// :target is only supported in IE8\r\n\t\t\t\t\tif (ieVersion == 8) {\r\n\t\t\t\t\t\tapplyClass = function(e) {\r\n\t\t\t\t\t\t\tvar handler = function() { \r\n\t\t\t\t\t\t\t\tvar hash = location.hash;\r\n\t\t\t\t\t\t\t\tvar hashID = hash.slice(1);\r\n\t\t\t\t\t\t\t\treturn isNegated ? (hash == EMPTY_STRING || e.id != hashID) : (hash != EMPTY_STRING && e.id == hashID);\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\taddEvent( win, \"hashchange\", function() {\r\n\t\t\t\t\t\t\t\ttoggleElementClass(e, className, handler());\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\treturn handler();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t\r\n\t\t\t\tcase \"checked\":\r\n\t\t\t\t\tapplyClass = function(e) { \r\n\t\t\t\t\t\tif (RE_INPUT_CHECKABLE_TYPES.test(e.type)) {\r\n\t\t\t\t\t\t\taddEvent( e, \"propertychange\", function() {\r\n\t\t\t\t\t\t\t\tif (event.propertyName == \"checked\") {\r\n\t\t\t\t\t\t\t\t\ttoggleElementClass( e, className, e.checked !== isNegated );\r\n\t\t\t\t\t\t\t\t} \t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn e.checked !== isNegated;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t\tcase \"disabled\":\r\n\t\t\t\t\tisNegated = !isNegated;\r\n\r\n\t\t\t\tcase \"enabled\":\r\n\t\t\t\t\tapplyClass = function(e) { \r\n\t\t\t\t\t\tif (RE_INPUT_ELEMENTS.test(e.tagName)) {\r\n\t\t\t\t\t\t\taddEvent( e, \"propertychange\", function() {\r\n\t\t\t\t\t\t\t\tif (event.propertyName == \"$disabled\") {\r\n\t\t\t\t\t\t\t\t\ttoggleElementClass( e, className, e.$disabled === isNegated );\r\n\t\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tenabledWatchers.push(e);\r\n\t\t\t\t\t\t\te.$disabled = e.disabled;\r\n\t\t\t\t\t\t\treturn e.disabled === isNegated;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn pseudo == \":enabled\" ? isNegated : !isNegated;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t\tcase \"focus\":\r\n\t\t\t\t\tactivateEventName = \"focus\";\r\n\t\t\t\t\tdeactivateEventName = \"blur\";\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\tcase \"hover\":\r\n\t\t\t\t\tif (!activateEventName) {\r\n\t\t\t\t\t\tactivateEventName = \"mouseenter\";\r\n\t\t\t\t\t\tdeactivateEventName = \"mouseleave\";\r\n\t\t\t\t\t}\r\n\t\t\t\t\tapplyClass = function(e) {\r\n\t\t\t\t\t\taddEvent( e, isNegated ? deactivateEventName : activateEventName, function() {\r\n\t\t\t\t\t\t\ttoggleElementClass( e, className, true );\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\taddEvent( e, isNegated ? activateEventName : deactivateEventName, function() {\r\n\t\t\t\t\t\t\ttoggleElementClass( e, className, false );\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t\treturn isNegated;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t\t\r\n\t\t\t\t// everything else\r\n\t\t\t\tdefault:\r\n\t\t\t\t\t// If we don't support this pseudo-class don't create \r\n\t\t\t\t\t// a patch for it\r\n\t\t\t\t\tif (!RE_PSEUDO_STRUCTURAL.test(pseudo)) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn { className: className, applyClass: applyClass };\r\n\t};\r\n\r\n\t// --[ applyPatches() ]-------------------------------------------------\r\n\t// uses the passed selector text to find DOM nodes and patch them\t\r\n\tfunction applyPatches(selectorText, patches) {\r\n\t\tvar elms;\r\n\t\t\r\n\t\t// Although some selector libraries can find :checked :enabled etc. \r\n\t\t// we need to find all elements that could have that state because \r\n\t\t// it can be changed by the user.\r\n\t\tvar domSelectorText = selectorText.replace(RE_LIBRARY_INCOMPATIBLE_PSEUDOS, EMPTY_STRING);\r\n\t\t\r\n\t\t// If the dom selector equates to an empty string or ends with \r\n\t\t// whitespace then we need to append a universal selector (*) to it.\r\n\t\tif (domSelectorText == EMPTY_STRING || domSelectorText.charAt(domSelectorText.length - 1) == SPACE_STRING) {\r\n\t\t\tdomSelectorText += \"*\";\r\n\t\t}\r\n\t\t\r\n\t\t// Ensure we catch errors from the selector library\r\n\t\ttry {\r\n\t\t\telms = selectorMethod( domSelectorText );\r\n\t\t} catch (ex) {\r\n\t\t\t// #DEBUG_START\r\n\t\t\tlog( \"Selector '\" + selectorText + \"' threw exception '\" + ex + \"'\" );\r\n\t\t\t// #DEBUG_END\r\n\t\t}\r\n\r\n\r\n\t\tif (elms) {\r\n\t\t\tfor (var d = 0, dl = elms.length; d < dl; d++) {\t\r\n\t\t\t\tvar elm = elms[d];\r\n\t\t\t\tvar cssClasses = elm.className;\r\n\t\t\t\tfor (var f = 0, fl = patches.length; f < fl; f++) {\r\n\t\t\t\t\tvar patch = patches[f];\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (!hasPatch(elm, patch)) {\r\n\t\t\t\t\t\tif (patch.applyClass && (patch.applyClass === true || patch.applyClass(elm) === true)) {\r\n\t\t\t\t\t\t\tcssClasses = toggleClass(cssClasses, patch.className, true );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telm.className = cssClasses;\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// --[ hasPatch() ]-----------------------------------------------------\r\n\t// checks for the exsistence of a patch on an element\r\n\tfunction hasPatch( elm, patch ) {\r\n\t\treturn new RegExp(\"(^|\\\\s)\" + patch.className + \"(\\\\s|$)\").test(elm.className);\r\n\t};\r\n\t\r\n\t\r\n\t// =========================== Utility =================================\r\n\t\r\n\tfunction createClassName( className ) {\r\n\t\treturn namespace + \"-\" + ((ieVersion == 6 && patchIE6MultipleClasses) ?\r\n\t\t\tie6PatchID++\r\n\t\t:\r\n\t\t\tclassName.replace(RE_PATCH_CLASS_NAME_REPLACE, function(a) { return a.charCodeAt(0) }));\r\n\t};\r\n\r\n\t// --[ log() ]----------------------------------------------------------\r\n\t// #DEBUG_START\r\n\tfunction log( message ) {\r\n\t\tif (win.console) {\r\n\t\t\twin.console.log(message);\r\n\t\t}\r\n\t};\r\n\t// #DEBUG_END\r\n\r\n\t// --[ trim() ]---------------------------------------------------------\r\n\t// removes leading, trailing whitespace from a string\r\n\tfunction trim( text ) {\r\n\t\treturn text.replace(RE_TIDY_TRIM_WHITESPACE, PLACEHOLDER_STRING);\r\n\t};\r\n\r\n\t// --[ normalizeWhitespace() ]------------------------------------------\r\n\t// removes leading, trailing and consecutive whitespace from a string\r\n\tfunction normalizeWhitespace( text ) {\r\n\t\treturn trim(text).replace(RE_TIDY_CONSECUTIVE_WHITESPACE, SPACE_STRING);\r\n\t};\r\n\r\n\t// --[ normalizeSelectorWhitespace() ]----------------------------------\r\n\t// tidies whitespace around selector brackets and combinators\r\n\tfunction normalizeSelectorWhitespace( selectorText ) {\r\n\t\treturn normalizeWhitespace(selectorText.\r\n\t\t\treplace(RE_TIDY_TRAILING_WHITESPACE, PLACEHOLDER_STRING).\r\n\t\t\treplace(RE_TIDY_LEADING_WHITESPACE, PLACEHOLDER_STRING)\r\n\t\t);\r\n\t};\r\n\r\n\t// --[ toggleElementClass() ]-------------------------------------------\r\n\t// toggles a single className on an element\r\n\tfunction toggleElementClass( elm, className, on ) {\r\n\t\tvar oldClassName = elm.className;\r\n\t\tvar newClassName = toggleClass(oldClassName, className, on);\r\n\t\tif (newClassName != oldClassName) {\r\n\t\t\telm.className = newClassName;\r\n\t\t\telm.parentNode.className += EMPTY_STRING;\r\n\t\t}\r\n\t};\r\n\r\n\t// --[ toggleClass() ]--------------------------------------------------\r\n\t// adds / removes a className from a string of classNames. Used to \r\n\t// manage multiple class changes without forcing a DOM redraw\r\n\tfunction toggleClass( classList, className, on ) {\r\n\t\tvar re = RegExp(\"(^|\\\\s)\" + className + \"(\\\\s|$)\");\r\n\t\tvar classExists = re.test(classList);\r\n\t\tif (on) {\r\n\t\t\treturn classExists ? classList : classList + SPACE_STRING + className;\r\n\t\t} else {\r\n\t\t\treturn classExists ? trim(classList.replace(re, PLACEHOLDER_STRING)) : classList;\r\n\t\t}\r\n\t};\r\n\t\r\n\t// --[ addEvent() ]-----------------------------------------------------\r\n\tfunction addEvent(elm, eventName, eventHandler) {\r\n\t\telm.attachEvent(\"on\" + eventName, eventHandler);\r\n\t};\r\n\r\n\t// --[ getXHRObject() ]-------------------------------------------------\r\n\tfunction getXHRObject()\r\n\t{\r\n\t\tif (win.XMLHttpRequest) {\r\n\t\t\treturn new XMLHttpRequest;\r\n\t\t}\r\n\t\ttry\t{ \r\n\t\t\treturn new ActiveXObject('Microsoft.XMLHTTP');\r\n\t\t} catch(e) { \r\n\t\t\treturn null;\r\n\t\t}\r\n\t};\r\n\r\n\t// --[ loadStyleSheet() ]-----------------------------------------------\r\n\tfunction loadStyleSheet( url ) {\r\n\t\txhr.open(\"GET\", url, false);\r\n\t\txhr.send();\r\n\t\treturn (xhr.status==200) ? xhr.responseText : EMPTY_STRING;\t\r\n\t};\r\n\t\r\n\t// --[ resolveUrl() ]---------------------------------------------------\r\n\t// Converts a URL fragment to a fully qualified URL using the specified\r\n\t// context URL. Returns null if same-origin policy is broken\r\n\tfunction resolveUrl( url, contextUrl ) {\r\n\t\r\n\t\tfunction getProtocolAndHost( url ) {\r\n\t\t\treturn url.substring(0, url.indexOf(\"/\", 8));\r\n\t\t};\r\n\t\t\r\n\t\t// absolute path\r\n\t\tif (/^https?:\\/\\//i.test(url)) {\r\n\t\t\treturn getProtocolAndHost(contextUrl) == getProtocolAndHost(url) ? url : null;\r\n\t\t}\r\n\t\t\r\n\t\t// root-relative path\r\n\t\tif (url.charAt(0)==\"/\")\t{\r\n\t\t\treturn getProtocolAndHost(contextUrl) + url;\r\n\t\t}\r\n\r\n\t\t// relative path\r\n\t\tvar contextUrlPath = contextUrl.split(/[?#]/)[0]; // ignore query string in the contextUrl\t\r\n\t\tif (url.charAt(0) != \"?\" && contextUrlPath.charAt(contextUrlPath.length - 1) != \"/\") {\r\n\t\t\tcontextUrlPath = contextUrlPath.substring(0, contextUrlPath.lastIndexOf(\"/\") + 1);\r\n\t\t}\r\n\t\t\r\n\t\treturn contextUrlPath + url;\r\n\t};\r\n\t\r\n\t// --[ parseStyleSheet() ]----------------------------------------------\r\n\t// Downloads the stylesheet specified by the URL, removes it's comments\r\n\t// and recursivly replaces @import rules with their contents, ultimately\r\n\t// returning the full cssText.\r\n\tfunction parseStyleSheet( url ) {\r\n\t\tif (url) {\r\n\t\t\treturn loadStyleSheet(url).replace(RE_COMMENT, EMPTY_STRING).\r\n\t\t\treplace(RE_IMPORT, function( match, quoteChar, importUrl, quoteChar2, importUrl2 ) { \r\n\t\t\t\treturn parseStyleSheet(resolveUrl(importUrl || importUrl2, url));\r\n\t\t\t}).\r\n\t\t\treplace(RE_ASSET_URL, function( match, quoteChar, assetUrl ) { \r\n\t\t\t\tquoteChar = quoteChar || EMPTY_STRING;\r\n\t\t\t\treturn \" url(\" + quoteChar + resolveUrl(assetUrl, url) + quoteChar + \") \"; \r\n\t\t\t});\r\n\t\t}\r\n\t\treturn EMPTY_STRING;\r\n\t};\r\n\t\r\n\t// --[ init() ]---------------------------------------------------------\r\n\tfunction init() {\r\n\t\t// honour the <base> tag\r\n\t\tvar url, stylesheet;\r\n\t\tvar baseTags = doc.getElementsByTagName(\"BASE\");\r\n\t\tvar baseUrl = (baseTags.length > 0) ? baseTags[0].href : doc.location.href;\r\n\t\t\r\n\t\t/* Note: This code prevents IE from freezing / crashing when using \r\n\t\t@font-face .eot files but it modifies the <head> tag and could\r\n\t\ttrigger the IE stylesheet limit. It will also cause FOUC issues.\r\n\t\tIf you choose to use it, make sure you comment out the for loop \r\n\t\tdirectly below this comment.\r\n\r\n\t\tvar head = doc.getElementsByTagName(\"head\")[0];\r\n\t\tfor (var c=doc.styleSheets.length-1; c>=0; c--) {\r\n\t\t\tstylesheet = doc.styleSheets[c]\r\n\t\t\thead.appendChild(doc.createElement(\"style\"))\r\n\t\t\tvar patchedStylesheet = doc.styleSheets[doc.styleSheets.length-1];\r\n\t\t\t\r\n\t\t\tif (stylesheet.href != EMPTY_STRING) {\r\n\t\t\t\turl = resolveUrl(stylesheet.href, baseUrl)\r\n\t\t\t\tif (url) {\r\n\t\t\t\t\tpatchedStylesheet.cssText = patchStyleSheet( parseStyleSheet( url ) )\r\n\t\t\t\t\tstylesheet.disabled = true\r\n\t\t\t\t\tsetTimeout( function () {\r\n\t\t\t\t\t\tstylesheet.owningElement.parentNode.removeChild(stylesheet.owningElement)\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\t\r\n\t\tfor (var c = 0; c < doc.styleSheets.length; c++) {\r\n\t\t\tstylesheet = doc.styleSheets[c]\r\n\t\t\tif (stylesheet.href != EMPTY_STRING) {\r\n\t\t\t\turl = resolveUrl(stylesheet.href, baseUrl);\r\n\t\t\t\tif (url) {\r\n\t\t\t\t\tstylesheet.cssText = patchStyleSheet( parseStyleSheet( url ) );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// :enabled & :disabled polling script (since we can't hook \r\n\t\t// onpropertychange event when an element is disabled) \r\n\t\tif (enabledWatchers.length > 0) {\r\n\t\t\tsetInterval( function() {\r\n\t\t\t\tfor (var c = 0, cl = enabledWatchers.length; c < cl; c++) {\r\n\t\t\t\t\tvar e = enabledWatchers[c];\r\n\t\t\t\t\tif (e.disabled !== e.$disabled) {\r\n\t\t\t\t\t\tif (e.disabled) {\r\n\t\t\t\t\t\t\te.disabled = false;\r\n\t\t\t\t\t\t\te.$disabled = true;\r\n\t\t\t\t\t\t\te.disabled = true;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\te.$disabled = e.disabled;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},250)\r\n\t\t}\r\n\t};\r\n\t\r\n\t// Bind selectivizr to the ContentLoaded event. \r\n\tContentLoaded(win, function() {\r\n\t\t// Determine the \"best fit\" selector engine\r\n\t\tfor (var engine in selectorEngines) {\r\n\t\t\tvar members, member, context = win;\r\n\t\t\tif (win[engine]) {\r\n\t\t\t\tmembers = selectorEngines[engine].replace(\"*\", engine).split(\".\");\r\n\t\t\t\twhile ((member = members.shift()) && (context = context[member])) {}\r\n\t\t\t\tif (typeof context == \"function\") {\r\n\t\t\t\t\tselectorMethod = context;\r\n\t\t\t\t\tinit();\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n\t\r\n\t\r\n\t/*!\r\n\t * ContentLoaded.js by Diego Perini, modified for IE<9 only (to save space)\r\n\t *\r\n\t * Author: Diego Perini (diego.perini at gmail.com)\r\n\t * Summary: cross-browser wrapper for DOMContentLoaded\r\n\t * Updated: 20101020\r\n\t * License: MIT\r\n\t * Version: 1.2\r\n\t *\r\n\t * URL:\r\n\t * http://javascript.nwbox.com/ContentLoaded/\r\n\t * http://javascript.nwbox.com/ContentLoaded/MIT-LICENSE\r\n\t *\r\n\t */\r\n\r\n\t// @w window reference\r\n\t// @f function reference\r\n\tfunction ContentLoaded(win, fn) {\r\n\r\n\t\tvar done = false, top = true,\r\n\t\tinit = function(e) {\r\n\t\t\tif (e.type == \"readystatechange\" && doc.readyState != \"complete\") return;\r\n\t\t\t(e.type == \"load\" ? win : doc).detachEvent(\"on\" + e.type, init, false);\r\n\t\t\tif (!done && (done = true)) fn.call(win, e.type || e);\r\n\t\t},\r\n\t\tpoll = function() {\r\n\t\t\ttry { root.doScroll(\"left\"); } catch(e) { setTimeout(poll, 50); return; }\r\n\t\t\tinit('poll');\r\n\t\t};\r\n\r\n\t\tif (doc.readyState == \"complete\") fn.call(win, EMPTY_STRING);\r\n\t\telse {\r\n\t\t\tif (doc.createEventObject && root.doScroll) {\r\n\t\t\t\ttry { top = !win.frameElement; } catch(e) { }\r\n\t\t\t\tif (top) poll();\r\n\t\t\t}\r\n\t\t\taddEvent(doc,\"readystatechange\", init);\r\n\t\t\taddEvent(win,\"load\", init);\r\n\t\t}\r\n\t};\r\n})(this);\n/*!\r\n * reveal.js\r\n * http://lab.hakim.se/reveal-js\r\n * MIT licensed\r\n *\r\n * Copyright (C) 2015 Hakim El Hattab, http://hakim.se\r\n */\r\n(function( root, factory ) {\r\n\tif( typeof define === 'function' && define.amd ) {\r\n\t\t// AMD. Register as an anonymous module.\r\n\t\tdefine( function() {\r\n\t\t\troot.Reveal = factory();\r\n\t\t\treturn root.Reveal;\r\n\t\t} );\r\n\t} else if( typeof exports === 'object' ) {\r\n\t\t// Node. Does not work with strict CommonJS.\r\n\t\tmodule.exports = factory();\r\n\t} else {\r\n\t\t// Browser globals.\r\n\t\troot.Reveal = factory();\r\n\t}\r\n}( this, function() {\r\n\r\n\t'use strict';\r\n\r\n\tvar Reveal;\r\n\r\n\tvar SLIDES_SELECTOR = '.slides section',\r\n\t\tHORIZONTAL_SLIDES_SELECTOR = '.slides>section',\r\n\t\tVERTICAL_SLIDES_SELECTOR = '.slides>section.present>section',\r\n\t\tHOME_SLIDE_SELECTOR = '.slides>section:first-of-type',\r\n\r\n\t\t// Configuration defaults, can be overridden at initialization time\r\n\t\tconfig = {\r\n\r\n\t\t\t// The \"normal\" size of the presentation, aspect ratio will be preserved\r\n\t\t\t// when the presentation is scaled to fit different resolutions\r\n\t\t\twidth: 960,\r\n\t\t\theight: 700,\r\n\r\n\t\t\t// Factor of the display size that should remain empty around the content\r\n\t\t\tmargin: 0.1,\r\n\r\n\t\t\t// Bounds for smallest/largest possible scale to apply to content\r\n\t\t\tminScale: 0.2,\r\n\t\t\tmaxScale: 1.5,\r\n\r\n\t\t\t// Display controls in the bottom right corner\r\n\t\t\tcontrols: true,\r\n\r\n\t\t\t// Display a presentation progress bar\r\n\t\t\tprogress: true,\r\n\r\n\t\t\t// Display the page number of the current slide\r\n\t\t\tslideNumber: false,\r\n\r\n\t\t\t// Push each slide change to the browser history\r\n\t\t\thistory: false,\r\n\r\n\t\t\t// Enable keyboard shortcuts for navigation\r\n\t\t\tkeyboard: true,\r\n\r\n\t\t\t// Optional function that blocks keyboard events when retuning false\r\n\t\t\tkeyboardCondition: null,\r\n\r\n\t\t\t// Enable the slide overview mode\r\n\t\t\toverview: true,\r\n\r\n\t\t\t// Vertical centering of slides\r\n\t\t\tcenter: true,\r\n\r\n\t\t\t// Enables touch navigation on devices with touch input\r\n\t\t\ttouch: true,\r\n\r\n\t\t\t// Loop the presentation\r\n\t\t\tloop: false,\r\n\r\n\t\t\t// Change the presentation direction to be RTL\r\n\t\t\trtl: false,\r\n\r\n\t\t\t// Turns fragments on and off globally\r\n\t\t\tfragments: true,\r\n\r\n\t\t\t// Flags if the presentation is running in an embedded mode,\r\n\t\t\t// i.e. contained within a limited portion of the screen\r\n\t\t\tembedded: false,\r\n\r\n\t\t\t// Flags if we should show a help overlay when the questionmark\r\n\t\t\t// key is pressed\r\n\t\t\thelp: true,\r\n\r\n\t\t\t// Flags if it should be possible to pause the presentation (blackout)\r\n\t\t\tpause: true,\r\n\r\n\t\t\t// Number of milliseconds between automatically proceeding to the\r\n\t\t\t// next slide, disabled when set to 0, this value can be overwritten\r\n\t\t\t// by using a data-autoslide attribute on your slides\r\n\t\t\tautoSlide: 0,\r\n\r\n\t\t\t// Stop auto-sliding after user input\r\n\t\t\tautoSlideStoppable: true,\r\n\r\n\t\t\t// Enable slide navigation via mouse wheel\r\n\t\t\tmouseWheel: false,\r\n\r\n\t\t\t// Apply a 3D roll to links on hover\r\n\t\t\trollingLinks: false,\r\n\r\n\t\t\t// Hides the address bar on mobile devices\r\n\t\t\thideAddressBar: true,\r\n\r\n\t\t\t// Opens links in an iframe preview overlay\r\n\t\t\tpreviewLinks: false,\r\n\r\n\t\t\t// Exposes the reveal.js API through window.postMessage\r\n\t\t\tpostMessage: true,\r\n\r\n\t\t\t// Dispatches all reveal.js events to the parent window through postMessage\r\n\t\t\tpostMessageEvents: false,\r\n\r\n\t\t\t// Focuses body when page changes visiblity to ensure keyboard shortcuts work\r\n\t\t\tfocusBodyOnPageVisibilityChange: true,\r\n\r\n\t\t\t// Transition style\r\n\t\t\ttransition: 'slide', // none/fade/slide/convex/concave/zoom\r\n\r\n\t\t\t// Transition speed\r\n\t\t\ttransitionSpeed: 'default', // default/fast/slow\r\n\r\n\t\t\t// Transition style for full page slide backgrounds\r\n\t\t\tbackgroundTransition: 'fade', // none/fade/slide/convex/concave/zoom\r\n\r\n\t\t\t// Parallax background image\r\n\t\t\tparallaxBackgroundImage: '', // CSS syntax, e.g. \"a.jpg\"\r\n\r\n\t\t\t// Parallax background size\r\n\t\t\tparallaxBackgroundSize: '', // CSS syntax, e.g. \"3000px 2000px\"\r\n\r\n\t\t\t// Amount of pixels to move the parallax background per slide step\r\n\t\t\tparallaxBackgroundHorizontal: null,\r\n\t\t\tparallaxBackgroundVertical: null,\r\n\r\n\t\t\t// Number of slides away from the current that are visible\r\n\t\t\tviewDistance: 3,\r\n\r\n\t\t\t// Script dependencies to load\r\n\t\t\tdependencies: []\r\n\r\n\t\t},\r\n\r\n\t\t// Flags if reveal.js is loaded (has dispatched the 'ready' event)\r\n\t\tloaded = false,\r\n\r\n\t\t// Flags if the overview mode is currently active\r\n\t\toverview = false,\r\n\r\n\t\t// The horizontal and vertical index of the currently active slide\r\n\t\tindexh,\r\n\t\tindexv,\r\n\r\n\t\t// The previous and current slide HTML elements\r\n\t\tpreviousSlide,\r\n\t\tcurrentSlide,\r\n\r\n\t\tpreviousBackground,\r\n\r\n\t\t// Slides may hold a data-state attribute which we pick up and apply\r\n\t\t// as a class to the body. This list contains the combined state of\r\n\t\t// all current slides.\r\n\t\tstate = [],\r\n\r\n\t\t// The current scale of the presentation (see width/height config)\r\n\t\tscale = 1,\r\n\r\n\t\t// CSS transform that is currently applied to the slides container,\r\n\t\t// split into two groups\r\n\t\tslidesTransform = { layout: '', overview: '' },\r\n\r\n\t\t// Cached references to DOM elements\r\n\t\tdom = {},\r\n\r\n\t\t// Features supported by the browser, see #checkCapabilities()\r\n\t\tfeatures = {},\r\n\r\n\t\t// Client is a mobile device, see #checkCapabilities()\r\n\t\tisMobileDevice,\r\n\r\n\t\t// Throttles mouse wheel navigation\r\n\t\tlastMouseWheelStep = 0,\r\n\r\n\t\t// Delays updates to the URL due to a Chrome thumbnailer bug\r\n\t\twriteURLTimeout = 0,\r\n\r\n\t\t// Flags if the interaction event listeners are bound\r\n\t\teventsAreBound = false,\r\n\r\n\t\t// The current auto-slide duration\r\n\t\tautoSlide = 0,\r\n\r\n\t\t// Auto slide properties\r\n\t\tautoSlidePlayer,\r\n\t\tautoSlideTimeout = 0,\r\n\t\tautoSlideStartTime = -1,\r\n\t\tautoSlidePaused = false,\r\n\r\n\t\t// Holds information about the currently ongoing touch input\r\n\t\ttouch = {\r\n\t\t\tstartX: 0,\r\n\t\t\tstartY: 0,\r\n\t\t\tstartSpan: 0,\r\n\t\t\tstartCount: 0,\r\n\t\t\tcaptured: false,\r\n\t\t\tthreshold: 40\r\n\t\t},\r\n\r\n\t\t// Holds information about the keyboard shortcuts\r\n\t\tkeyboardShortcuts = {\r\n\t\t\t'N  ,  SPACE':\t\t\t'Next slide',\r\n\t\t\t'P':\t\t\t\t\t'Previous slide',\r\n\t\t\t'&#8592;  ,  H':\t\t'Navigate left',\r\n\t\t\t'&#8594;  ,  L':\t\t'Navigate right',\r\n\t\t\t'&#8593;  ,  K':\t\t'Navigate up',\r\n\t\t\t'&#8595;  ,  J':\t\t'Navigate down',\r\n\t\t\t'Home':\t\t\t\t\t'First slide',\r\n\t\t\t'End':\t\t\t\t\t'Last slide',\r\n\t\t\t'B  ,  .':\t\t\t\t'Pause',\r\n\t\t\t'F':\t\t\t\t\t'Fullscreen',\r\n\t\t\t'ESC, O':\t\t\t\t'Slide overview'\r\n\t\t};\r\n\r\n\t/**\r\n\t * Starts up the presentation if the client is capable.\r\n\t */\r\n\tfunction initialize( options ) {\r\n\r\n\t\tcheckCapabilities();\r\n\r\n\t\tif( !features.transforms2d && !features.transforms3d ) {\r\n\t\t\tdocument.body.setAttribute( 'class', 'no-transforms' );\r\n\r\n\t\t\t// Since JS won't be running any further, we load all lazy\r\n\t\t\t// loading elements upfront\r\n\t\t\tvar images = toArray( document.getElementsByTagName( 'img' ) ),\r\n\t\t\t\tiframes = toArray( document.getElementsByTagName( 'iframe' ) );\r\n\r\n\t\t\tvar lazyLoadable = images.concat( iframes );\r\n\r\n\t\t\tfor( var i = 0, len = lazyLoadable.length; i < len; i++ ) {\r\n\t\t\t\tvar element = lazyLoadable[i];\r\n\t\t\t\tif( element.getAttribute( 'data-src' ) ) {\r\n\t\t\t\t\telement.setAttribute( 'src', element.getAttribute( 'data-src' ) );\r\n\t\t\t\t\telement.removeAttribute( 'data-src' );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// If the browser doesn't support core features we won't be\r\n\t\t\t// using JavaScript to control the presentation\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// Cache references to key DOM elements\r\n\t\tdom.wrapper = document.querySelector( '.reveal' );\r\n\t\tdom.slides = document.querySelector( '.reveal .slides' );\r\n\r\n\t\t// Force a layout when the whole page, incl fonts, has loaded\r\n\t\twindow.addEventListener( 'load', layout, false );\r\n\r\n\t\tvar query = Reveal.getQueryHash();\r\n\r\n\t\t// Do not accept new dependencies via query config to avoid\r\n\t\t// the potential of malicious script injection\r\n\t\tif( typeof query['dependencies'] !== 'undefined' ) delete query['dependencies'];\r\n\r\n\t\t// Copy options over to our config object\r\n\t\textend( config, options );\r\n\t\textend( config, query );\r\n\r\n\t\t// Hide the address bar in mobile browsers\r\n\t\thideAddressBar();\r\n\r\n\t\t// Loads the dependencies and continues to #start() once done\r\n\t\tload();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Inspect the client to see what it's capable of, this\r\n\t * should only happens once per runtime.\r\n\t */\r\n\tfunction checkCapabilities() {\r\n\r\n\t\tfeatures.transforms3d = 'WebkitPerspective' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'MozPerspective' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'msPerspective' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'OPerspective' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'perspective' in document.body.style;\r\n\r\n\t\tfeatures.transforms2d = 'WebkitTransform' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'MozTransform' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'msTransform' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'OTransform' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'transform' in document.body.style;\r\n\r\n\t\tfeatures.requestAnimationFrameMethod = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame;\r\n\t\tfeatures.requestAnimationFrame = typeof features.requestAnimationFrameMethod === 'function';\r\n\r\n\t\tfeatures.canvas = !!document.createElement( 'canvas' ).getContext;\r\n\r\n\t\tfeatures.touch = !!( 'ontouchstart' in window );\r\n\r\n\t\t// Transitions in the overview are disabled in desktop and\r\n\t\t// mobile Safari due to lag\r\n\t\tfeatures.overviewTransitions = !/Version\\/[\\d\\.]+.*Safari/.test( navigator.userAgent );\r\n\r\n\t\tisMobileDevice = /(iphone|ipod|ipad|android)/gi.test( navigator.userAgent );\r\n\r\n\t}\r\n\r\n    /**\r\n     * Loads the dependencies of reveal.js. Dependencies are\r\n     * defined via the configuration option 'dependencies'\r\n     * and will be loaded prior to starting/binding reveal.js.\r\n     * Some dependencies may have an 'async' flag, if so they\r\n     * will load after reveal.js has been started up.\r\n     */\r\n\tfunction load() {\r\n\r\n\t\tvar scripts = [],\r\n\t\t\tscriptsAsync = [],\r\n\t\t\tscriptsToPreload = 0;\r\n\r\n\t\t// Called once synchronous scripts finish loading\r\n\t\tfunction proceed() {\r\n\t\t\tif( scriptsAsync.length ) {\r\n\t\t\t\t// Load asynchronous scripts\r\n\t\t\t\thead.js.apply( null, scriptsAsync );\r\n\t\t\t}\r\n\r\n\t\t\tstart();\r\n\t\t}\r\n\r\n\t\tfunction loadScript( s ) {\r\n\t\t\thead.ready( s.src.match( /([\\w\\d_\\-]*)\\.?js$|[^\\\\\\/]*$/i )[0], function() {\r\n\t\t\t\t// Extension may contain callback functions\r\n\t\t\t\tif( typeof s.callback === 'function' ) {\r\n\t\t\t\t\ts.callback.apply( this );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( --scriptsToPreload === 0 ) {\r\n\t\t\t\t\tproceed();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor( var i = 0, len = config.dependencies.length; i < len; i++ ) {\r\n\t\t\tvar s = config.dependencies[i];\r\n\r\n\t\t\t// Load if there's no condition or the condition is truthy\r\n\t\t\tif( !s.condition || s.condition() ) {\r\n\t\t\t\tif( s.async ) {\r\n\t\t\t\t\tscriptsAsync.push( s.src );\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tscripts.push( s.src );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tloadScript( s );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif( scripts.length ) {\r\n\t\t\tscriptsToPreload = scripts.length;\r\n\r\n\t\t\t// Load synchronous scripts\r\n\t\t\thead.js.apply( null, scripts );\r\n\t\t}\r\n\t\telse {\r\n\t\t\tproceed();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Starts up reveal.js by binding input events and navigating\r\n\t * to the current URL deeplink if there is one.\r\n\t */\r\n\tfunction start() {\r\n\r\n\t\t// Make sure we've got all the DOM elements we need\r\n\t\tsetupDOM();\r\n\r\n\t\t// Listen to messages posted to this window\r\n\t\tsetupPostMessage();\r\n\r\n\t\t// Prevent iframes from scrolling the slides out of view\r\n\t\tsetupIframeScrollPrevention();\r\n\r\n\t\t// Resets all vertical slides so that only the first is visible\r\n\t\tresetVerticalSlides();\r\n\r\n\t\t// Updates the presentation to match the current configuration values\r\n\t\tconfigure();\r\n\r\n\t\t// Read the initial hash\r\n\t\treadURL();\r\n\r\n\t\t// Update all backgrounds\r\n\t\tupdateBackground( true );\r\n\r\n\t\t// Notify listeners that the presentation is ready but use a 1ms\r\n\t\t// timeout to ensure it's not fired synchronously after #initialize()\r\n\t\tsetTimeout( function() {\r\n\t\t\t// Enable transitions now that we're loaded\r\n\t\t\tdom.slides.classList.remove( 'no-transition' );\r\n\r\n\t\t\tloaded = true;\r\n\r\n\t\t\tdispatchEvent( 'ready', {\r\n\t\t\t\t'indexh': indexh,\r\n\t\t\t\t'indexv': indexv,\r\n\t\t\t\t'currentSlide': currentSlide\r\n\t\t\t} );\r\n\t\t}, 1 );\r\n\r\n\t\t// Special setup and config is required when printing to PDF\r\n\t\tif( isPrintingPDF() ) {\r\n\t\t\tremoveEventListeners();\r\n\r\n\t\t\t// The document needs to have loaded for the PDF layout\r\n\t\t\t// measurements to be accurate\r\n\t\t\tif( document.readyState === 'complete' ) {\r\n\t\t\t\tsetupPDF();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\twindow.addEventListener( 'load', setupPDF );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Finds and stores references to DOM elements which are\r\n\t * required by the presentation. If a required element is\r\n\t * not found, it is created.\r\n\t */\r\n\tfunction setupDOM() {\r\n\r\n\t\t// Prevent transitions while we're loading\r\n\t\tdom.slides.classList.add( 'no-transition' );\r\n\r\n\t\t// Background element\r\n\t\tdom.background = createSingletonNode( dom.wrapper, 'div', 'backgrounds', null );\r\n\r\n\t\t// Progress bar\r\n\t\tdom.progress = createSingletonNode( dom.wrapper, 'div', 'progress', '<span></span>' );\r\n\t\tdom.progressbar = dom.progress.querySelector( 'span' );\r\n\r\n\t\t// Arrow controls\r\n\t\tcreateSingletonNode( dom.wrapper, 'aside', 'controls',\r\n\t\t\t'<div class=\"navigate-left\"></div>' +\r\n\t\t\t'<div class=\"navigate-right\"></div>' +\r\n\t\t\t'<div class=\"navigate-up\"></div>' +\r\n\t\t\t'<div class=\"navigate-down\"></div>' );\r\n\r\n\t\t// Slide number\r\n\t\tdom.slideNumber = createSingletonNode( dom.wrapper, 'div', 'slide-number', '' );\r\n\r\n\t\t// Overlay graphic which is displayed during the paused mode\r\n\t\tcreateSingletonNode( dom.wrapper, 'div', 'pause-overlay', null );\r\n\r\n\t\t// Cache references to elements\r\n\t\tdom.controls = document.querySelector( '.reveal .controls' );\r\n\t\tdom.theme = document.querySelector( '#theme' );\r\n\r\n\t\tdom.wrapper.setAttribute( 'role', 'application' );\r\n\r\n\t\t// There can be multiple instances of controls throughout the page\r\n\t\tdom.controlsLeft = toArray( document.querySelectorAll( '.navigate-left' ) );\r\n\t\tdom.controlsRight = toArray( document.querySelectorAll( '.navigate-right' ) );\r\n\t\tdom.controlsUp = toArray( document.querySelectorAll( '.navigate-up' ) );\r\n\t\tdom.controlsDown = toArray( document.querySelectorAll( '.navigate-down' ) );\r\n\t\tdom.controlsPrev = toArray( document.querySelectorAll( '.navigate-prev' ) );\r\n\t\tdom.controlsNext = toArray( document.querySelectorAll( '.navigate-next' ) );\r\n\r\n\t\tdom.statusDiv = createStatusDiv();\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a hidden div with role aria-live to announce the\r\n\t * current slide content. Hide the div off-screen to make it\r\n\t * available only to Assistive Technologies.\r\n\t */\r\n\tfunction createStatusDiv() {\r\n\r\n\t\tvar statusDiv = document.getElementById( 'aria-status-div' );\r\n\t\tif( !statusDiv ) {\r\n\t\t\tstatusDiv = document.createElement( 'div' );\r\n\t\t\tstatusDiv.style.position = 'absolute';\r\n\t\t\tstatusDiv.style.height = '1px';\r\n\t\t\tstatusDiv.style.width = '1px';\r\n\t\t\tstatusDiv.style.overflow ='hidden';\r\n\t\t\tstatusDiv.style.clip = 'rect( 1px, 1px, 1px, 1px )';\r\n\t\t\tstatusDiv.setAttribute( 'id', 'aria-status-div' );\r\n\t\t\tstatusDiv.setAttribute( 'aria-live', 'polite' );\r\n\t\t\tstatusDiv.setAttribute( 'aria-atomic','true' );\r\n\t\t\tdom.wrapper.appendChild( statusDiv );\r\n\t\t}\r\n\t\treturn statusDiv;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Configures the presentation for printing to a static\r\n\t * PDF.\r\n\t */\r\n\tfunction setupPDF() {\r\n\r\n\t\tvar slideSize = getComputedSlideSize( window.innerWidth, window.innerHeight );\r\n\r\n\t\t// Dimensions of the PDF pages\r\n\t\tvar pageWidth = Math.floor( slideSize.width * ( 1 + config.margin ) ),\r\n\t\t\tpageHeight = Math.floor( slideSize.height * ( 1 + config.margin  ) );\r\n\r\n\t\t// Dimensions of slides within the pages\r\n\t\tvar slideWidth = slideSize.width,\r\n\t\t\tslideHeight = slideSize.height;\r\n\r\n\t\t// Let the browser know what page size we want to print\r\n\t\tinjectStyleSheet( '@page{size:'+ pageWidth +'px '+ pageHeight +'px; margin: 0;}' );\r\n\r\n\t\t// Limit the size of certain elements to the dimensions of the slide\r\n\t\tinjectStyleSheet( '.reveal section>img, .reveal section>video, .reveal section>iframe{max-width: '+ slideWidth +'px; max-height:'+ slideHeight +'px}' );\r\n\r\n\t\tdocument.body.classList.add( 'print-pdf' );\r\n\t\tdocument.body.style.width = pageWidth + 'px';\r\n\t\tdocument.body.style.height = pageHeight + 'px';\r\n\r\n\t\t// Slide and slide background layout\r\n\t\ttoArray( dom.wrapper.querySelectorAll( SLIDES_SELECTOR ) ).forEach( function( slide ) {\r\n\r\n\t\t\t// Vertical stacks are not centred since their section\r\n\t\t\t// children will be\r\n\t\t\tif( slide.classList.contains( 'stack' ) === false ) {\r\n\t\t\t\t// Center the slide inside of the page, giving the slide some margin\r\n\t\t\t\tvar left = ( pageWidth - slideWidth ) / 2,\r\n\t\t\t\t\ttop = ( pageHeight - slideHeight ) / 2;\r\n\r\n\t\t\t\tvar contentHeight = getAbsoluteHeight( slide );\r\n\t\t\t\tvar numberOfPages = Math.max( Math.ceil( contentHeight / pageHeight ), 1 );\r\n\r\n\t\t\t\t// Center slides vertically\r\n\t\t\t\tif( numberOfPages === 1 && config.center || slide.classList.contains( 'center' ) ) {\r\n\t\t\t\t\ttop = Math.max( ( pageHeight - contentHeight ) / 2, 0 );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Position the slide inside of the page\r\n\t\t\t\tslide.style.left = left + 'px';\r\n\t\t\t\tslide.style.top = top + 'px';\r\n\t\t\t\tslide.style.width = slideWidth + 'px';\r\n\r\n\t\t\t\t// TODO Backgrounds need to be multiplied when the slide\r\n\t\t\t\t// stretches over multiple pages\r\n\t\t\t\tvar background = slide.querySelector( '.slide-background' );\r\n\t\t\t\tif( background ) {\r\n\t\t\t\t\tbackground.style.width = pageWidth + 'px';\r\n\t\t\t\t\tbackground.style.height = ( pageHeight * numberOfPages ) + 'px';\r\n\t\t\t\t\tbackground.style.top = -top + 'px';\r\n\t\t\t\t\tbackground.style.left = -left + 'px';\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\t// Show all fragments\r\n\t\ttoArray( dom.wrapper.querySelectorAll( SLIDES_SELECTOR + ' .fragment' ) ).forEach( function( fragment ) {\r\n\t\t\tfragment.classList.add( 'visible' );\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * This is an unfortunate necessity. Iframes can trigger the\r\n\t * parent window to scroll, for example by focusing an input.\r\n\t * This scrolling can not be prevented by hiding overflow in\r\n\t * CSS so we have to resort to repeatedly checking if the\r\n\t * browser has decided to offset our slides :(\r\n\t */\r\n\tfunction setupIframeScrollPrevention() {\r\n\r\n\t\tif( dom.slides.querySelector( 'iframe' ) ) {\r\n\t\t\tsetInterval( function() {\r\n\t\t\t\tif( dom.wrapper.scrollTop !== 0 || dom.wrapper.scrollLeft !== 0 ) {\r\n\t\t\t\t\tdom.wrapper.scrollTop = 0;\r\n\t\t\t\t\tdom.wrapper.scrollLeft = 0;\r\n\t\t\t\t}\r\n\t\t\t}, 500 );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Creates an HTML element and returns a reference to it.\r\n\t * If the element already exists the existing instance will\r\n\t * be returned.\r\n\t */\r\n\tfunction createSingletonNode( container, tagname, classname, innerHTML ) {\r\n\r\n\t\t// Find all nodes matching the description\r\n\t\tvar nodes = container.querySelectorAll( '.' + classname );\r\n\r\n\t\t// Check all matches to find one which is a direct child of\r\n\t\t// the specified container\r\n\t\tfor( var i = 0; i < nodes.length; i++ ) {\r\n\t\t\tvar testNode = nodes[i];\r\n\t\t\tif( testNode.parentNode === container ) {\r\n\t\t\t\treturn testNode;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// If no node was found, create it now\r\n\t\tvar node = document.createElement( tagname );\r\n\t\tnode.classList.add( classname );\r\n\t\tif( typeof innerHTML === 'string' ) {\r\n\t\t\tnode.innerHTML = innerHTML;\r\n\t\t}\r\n\t\tcontainer.appendChild( node );\r\n\r\n\t\treturn node;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Creates the slide background elements and appends them\r\n\t * to the background container. One element is created per\r\n\t * slide no matter if the given slide has visible background.\r\n\t */\r\n\tfunction createBackgrounds() {\r\n\r\n\t\tvar printMode = isPrintingPDF();\r\n\r\n\t\t// Clear prior backgrounds\r\n\t\tdom.background.innerHTML = '';\r\n\t\tdom.background.classList.add( 'no-transition' );\r\n\r\n\t\t// Iterate over all horizontal slides\r\n\t\ttoArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ) ).forEach( function( slideh ) {\r\n\r\n\t\t\tvar backgroundStack;\r\n\r\n\t\t\tif( printMode ) {\r\n\t\t\t\tbackgroundStack = createBackground( slideh, slideh );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tbackgroundStack = createBackground( slideh, dom.background );\r\n\t\t\t}\r\n\r\n\t\t\t// Iterate over all vertical slides\r\n\t\t\ttoArray( slideh.querySelectorAll( 'section' ) ).forEach( function( slidev ) {\r\n\r\n\t\t\t\tif( printMode ) {\r\n\t\t\t\t\tcreateBackground( slidev, slidev );\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tcreateBackground( slidev, backgroundStack );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tbackgroundStack.classList.add( 'stack' );\r\n\r\n\t\t\t} );\r\n\r\n\t\t} );\r\n\r\n\t\t// Add parallax background if specified\r\n\t\tif( config.parallaxBackgroundImage ) {\r\n\r\n\t\t\tdom.background.style.backgroundImage = 'url(\"' + config.parallaxBackgroundImage + '\")';\r\n\t\t\tdom.background.style.backgroundSize = config.parallaxBackgroundSize;\r\n\r\n\t\t\t// Make sure the below properties are set on the element - these properties are\r\n\t\t\t// needed for proper transitions to be set on the element via CSS. To remove\r\n\t\t\t// annoying background slide-in effect when the presentation starts, apply\r\n\t\t\t// these properties after short time delay\r\n\t\t\tsetTimeout( function() {\r\n\t\t\t\tdom.wrapper.classList.add( 'has-parallax-background' );\r\n\t\t\t}, 1 );\r\n\r\n\t\t}\r\n\t\telse {\r\n\r\n\t\t\tdom.background.style.backgroundImage = '';\r\n\t\t\tdom.wrapper.classList.remove( 'has-parallax-background' );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Creates a background for the given slide.\r\n\t *\r\n\t * @param {HTMLElement} slide\r\n\t * @param {HTMLElement} container The element that the background\r\n\t * should be appended to\r\n\t */\r\n\tfunction createBackground( slide, container ) {\r\n\r\n\t\tvar data = {\r\n\t\t\tbackground: slide.getAttribute( 'data-background' ),\r\n\t\t\tbackgroundSize: slide.getAttribute( 'data-background-size' ),\r\n\t\t\tbackgroundImage: slide.getAttribute( 'data-background-image' ),\r\n\t\t\tbackgroundVideo: slide.getAttribute( 'data-background-video' ),\r\n\t\t\tbackgroundIframe: slide.getAttribute( 'data-background-iframe' ),\r\n\t\t\tbackgroundColor: slide.getAttribute( 'data-background-color' ),\r\n\t\t\tbackgroundRepeat: slide.getAttribute( 'data-background-repeat' ),\r\n\t\t\tbackgroundPosition: slide.getAttribute( 'data-background-position' ),\r\n\t\t\tbackgroundTransition: slide.getAttribute( 'data-background-transition' )\r\n\t\t};\r\n\r\n\t\tvar element = document.createElement( 'div' );\r\n\r\n\t\t// Carry over custom classes from the slide to the background\r\n\t\telement.className = 'slide-background ' + slide.className.replace( /present|past|future/, '' );\r\n\r\n\t\tif( data.background ) {\r\n\t\t\t// Auto-wrap image urls in url(...)\r\n\t\t\tif( /^(http|file|\\/\\/)/gi.test( data.background ) || /\\.(svg|png|jpg|jpeg|gif|bmp)$/gi.test( data.background ) ) {\r\n\t\t\t\tslide.setAttribute( 'data-background-image', data.background );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\telement.style.background = data.background;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Create a hash for this combination of background settings.\r\n\t\t// This is used to determine when two slide backgrounds are\r\n\t\t// the same.\r\n\t\tif( data.background || data.backgroundColor || data.backgroundImage || data.backgroundVideo || data.backgroundIframe ) {\r\n\t\t\telement.setAttribute( 'data-background-hash', data.background +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundSize +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundImage +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundVideo +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundIframe +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundColor +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundRepeat +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundPosition +\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tdata.backgroundTransition );\r\n\t\t}\r\n\r\n\t\t// Additional and optional background properties\r\n\t\tif( data.backgroundSize ) element.style.backgroundSize = data.backgroundSize;\r\n\t\tif( data.backgroundColor ) element.style.backgroundColor = data.backgroundColor;\r\n\t\tif( data.backgroundRepeat ) element.style.backgroundRepeat = data.backgroundRepeat;\r\n\t\tif( data.backgroundPosition ) element.style.backgroundPosition = data.backgroundPosition;\r\n\t\tif( data.backgroundTransition ) element.setAttribute( 'data-background-transition', data.backgroundTransition );\r\n\r\n\t\tcontainer.appendChild( element );\r\n\r\n\t\t// If backgrounds are being recreated, clear old classes\r\n\t\tslide.classList.remove( 'has-dark-background' );\r\n\t\tslide.classList.remove( 'has-light-background' );\r\n\r\n\t\t// If this slide has a background color, add a class that\r\n\t\t// signals if it is light or dark. If the slide has no background\r\n\t\t// color, no class will be set\r\n\t\tvar computedBackgroundColor = window.getComputedStyle( element ).backgroundColor;\r\n\t\tif( computedBackgroundColor ) {\r\n\t\t\tvar rgb = colorToRgb( computedBackgroundColor );\r\n\r\n\t\t\t// Ignore fully transparent backgrounds. Some browsers return\r\n\t\t\t// rgba(0,0,0,0) when reading the computed background color of\r\n\t\t\t// an element with no background\r\n\t\t\tif( rgb && rgb.a !== 0 ) {\r\n\t\t\t\tif( colorBrightness( computedBackgroundColor ) < 128 ) {\r\n\t\t\t\t\tslide.classList.add( 'has-dark-background' );\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tslide.classList.add( 'has-light-background' );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn element;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Registers a listener to postMessage events, this makes it\r\n\t * possible to call all reveal.js API methods from another\r\n\t * window. For example:\r\n\t *\r\n\t * revealWindow.postMessage( JSON.stringify({\r\n\t *   method: 'slide',\r\n\t *   args: [ 2 ]\r\n\t * }), '*' );\r\n\t */\r\n\tfunction setupPostMessage() {\r\n\r\n\t\tif( config.postMessage ) {\r\n\t\t\twindow.addEventListener( 'message', function ( event ) {\r\n\t\t\t\tvar data = event.data;\r\n\r\n\t\t\t\t// Make sure we're dealing with JSON\r\n\t\t\t\tif( typeof data === 'string' && data.charAt( 0 ) === '{' && data.charAt( data.length - 1 ) === '}' ) {\r\n\t\t\t\t\tdata = JSON.parse( data );\r\n\r\n\t\t\t\t\t// Check if the requested method can be found\r\n\t\t\t\t\tif( data.method && typeof Reveal[data.method] === 'function' ) {\r\n\t\t\t\t\t\tReveal[data.method].apply( Reveal, data.args );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, false );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Applies the configuration settings from the config\r\n\t * object. May be called multiple times.\r\n\t */\r\n\tfunction configure( options ) {\r\n\r\n\t\tvar numberOfSlides = dom.wrapper.querySelectorAll( SLIDES_SELECTOR ).length;\r\n\r\n\t\tdom.wrapper.classList.remove( config.transition );\r\n\r\n\t\t// New config options may be passed when this method\r\n\t\t// is invoked through the API after initialization\r\n\t\tif( typeof options === 'object' ) extend( config, options );\r\n\r\n\t\t// Force linear transition based on browser capabilities\r\n\t\tif( features.transforms3d === false ) config.transition = 'linear';\r\n\r\n\t\tdom.wrapper.classList.add( config.transition );\r\n\r\n\t\tdom.wrapper.setAttribute( 'data-transition-speed', config.transitionSpeed );\r\n\t\tdom.wrapper.setAttribute( 'data-background-transition', config.backgroundTransition );\r\n\r\n\t\tdom.controls.style.display = config.controls ? 'block' : 'none';\r\n\t\tdom.progress.style.display = config.progress ? 'block' : 'none';\r\n\r\n\t\tif( config.rtl ) {\r\n\t\t\tdom.wrapper.classList.add( 'rtl' );\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdom.wrapper.classList.remove( 'rtl' );\r\n\t\t}\r\n\r\n\t\tif( config.center ) {\r\n\t\t\tdom.wrapper.classList.add( 'center' );\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdom.wrapper.classList.remove( 'center' );\r\n\t\t}\r\n\r\n\t\t// Exit the paused mode if it was configured off\r\n\t\tif( config.pause === false ) {\r\n\t\t\tresume();\r\n\t\t}\r\n\r\n\t\tif( config.mouseWheel ) {\r\n\t\t\tdocument.addEventListener( 'DOMMouseScroll', onDocumentMouseScroll, false ); // FF\r\n\t\t\tdocument.addEventListener( 'mousewheel', onDocumentMouseScroll, false );\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdocument.removeEventListener( 'DOMMouseScroll', onDocumentMouseScroll, false ); // FF\r\n\t\t\tdocument.removeEventListener( 'mousewheel', onDocumentMouseScroll, false );\r\n\t\t}\r\n\r\n\t\t// Rolling 3D links\r\n\t\tif( config.rollingLinks ) {\r\n\t\t\tenableRollingLinks();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdisableRollingLinks();\r\n\t\t}\r\n\r\n\t\t// Iframe link previews\r\n\t\tif( config.previewLinks ) {\r\n\t\t\tenablePreviewLinks();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdisablePreviewLinks();\r\n\t\t\tenablePreviewLinks( '[data-preview-link]' );\r\n\t\t}\r\n\r\n\t\t// Remove existing auto-slide controls\r\n\t\tif( autoSlidePlayer ) {\r\n\t\t\tautoSlidePlayer.destroy();\r\n\t\t\tautoSlidePlayer = null;\r\n\t\t}\r\n\r\n\t\t// Generate auto-slide controls if needed\r\n\t\tif( numberOfSlides > 1 && config.autoSlide && config.autoSlideStoppable && features.canvas && features.requestAnimationFrame ) {\r\n\t\t\tautoSlidePlayer = new Playback( dom.wrapper, function() {\r\n\t\t\t\treturn Math.min( Math.max( ( Date.now() - autoSlideStartTime ) / autoSlide, 0 ), 1 );\r\n\t\t\t} );\r\n\r\n\t\t\tautoSlidePlayer.on( 'click', onAutoSlidePlayerClick );\r\n\t\t\tautoSlidePaused = false;\r\n\t\t}\r\n\r\n\t\t// When fragments are turned off they should be visible\r\n\t\tif( config.fragments === false ) {\r\n\t\t\ttoArray( dom.slides.querySelectorAll( '.fragment' ) ).forEach( function( element ) {\r\n\t\t\t\telement.classList.add( 'visible' );\r\n\t\t\t\telement.classList.remove( 'current-fragment' );\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\tsync();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Binds all event listeners.\r\n\t */\r\n\tfunction addEventListeners() {\r\n\r\n\t\teventsAreBound = true;\r\n\r\n\t\twindow.addEventListener( 'hashchange', onWindowHashChange, false );\r\n\t\twindow.addEventListener( 'resize', onWindowResize, false );\r\n\r\n\t\tif( config.touch ) {\r\n\t\t\tdom.wrapper.addEventListener( 'touchstart', onTouchStart, false );\r\n\t\t\tdom.wrapper.addEventListener( 'touchmove', onTouchMove, false );\r\n\t\t\tdom.wrapper.addEventListener( 'touchend', onTouchEnd, false );\r\n\r\n\t\t\t// Support pointer-style touch interaction as well\r\n\t\t\tif( window.navigator.pointerEnabled ) {\r\n\t\t\t\t// IE 11 uses un-prefixed version of pointer events\r\n\t\t\t\tdom.wrapper.addEventListener( 'pointerdown', onPointerDown, false );\r\n\t\t\t\tdom.wrapper.addEventListener( 'pointermove', onPointerMove, false );\r\n\t\t\t\tdom.wrapper.addEventListener( 'pointerup', onPointerUp, false );\r\n\t\t\t}\r\n\t\t\telse if( window.navigator.msPointerEnabled ) {\r\n\t\t\t\t// IE 10 uses prefixed version of pointer events\r\n\t\t\t\tdom.wrapper.addEventListener( 'MSPointerDown', onPointerDown, false );\r\n\t\t\t\tdom.wrapper.addEventListener( 'MSPointerMove', onPointerMove, false );\r\n\t\t\t\tdom.wrapper.addEventListener( 'MSPointerUp', onPointerUp, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif( config.keyboard ) {\r\n\t\t\tdocument.addEventListener( 'keydown', onDocumentKeyDown, false );\r\n\t\t\tdocument.addEventListener( 'keypress', onDocumentKeyPress, false );\r\n\t\t}\r\n\r\n\t\tif( config.progress && dom.progress ) {\r\n\t\t\tdom.progress.addEventListener( 'click', onProgressClicked, false );\r\n\t\t}\r\n\r\n\t\tif( config.focusBodyOnPageVisibilityChange ) {\r\n\t\t\tvar visibilityChange;\r\n\r\n\t\t\tif( 'hidden' in document ) {\r\n\t\t\t\tvisibilityChange = 'visibilitychange';\r\n\t\t\t}\r\n\t\t\telse if( 'msHidden' in document ) {\r\n\t\t\t\tvisibilityChange = 'msvisibilitychange';\r\n\t\t\t}\r\n\t\t\telse if( 'webkitHidden' in document ) {\r\n\t\t\t\tvisibilityChange = 'webkitvisibilitychange';\r\n\t\t\t}\r\n\r\n\t\t\tif( visibilityChange ) {\r\n\t\t\t\tdocument.addEventListener( visibilityChange, onPageVisibilityChange, false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Listen to both touch and click events, in case the device\r\n\t\t// supports both\r\n\t\tvar pointerEvents = [ 'touchstart', 'click' ];\r\n\r\n\t\t// Only support touch for Android, fixes double navigations in\r\n\t\t// stock browser\r\n\t\tif( navigator.userAgent.match( /android/gi ) ) {\r\n\t\t\tpointerEvents = [ 'touchstart' ];\r\n\t\t}\r\n\r\n\t\tpointerEvents.forEach( function( eventName ) {\r\n\t\t\tdom.controlsLeft.forEach( function( el ) { el.addEventListener( eventName, onNavigateLeftClicked, false ); } );\r\n\t\t\tdom.controlsRight.forEach( function( el ) { el.addEventListener( eventName, onNavigateRightClicked, false ); } );\r\n\t\t\tdom.controlsUp.forEach( function( el ) { el.addEventListener( eventName, onNavigateUpClicked, false ); } );\r\n\t\t\tdom.controlsDown.forEach( function( el ) { el.addEventListener( eventName, onNavigateDownClicked, false ); } );\r\n\t\t\tdom.controlsPrev.forEach( function( el ) { el.addEventListener( eventName, onNavigatePrevClicked, false ); } );\r\n\t\t\tdom.controlsNext.forEach( function( el ) { el.addEventListener( eventName, onNavigateNextClicked, false ); } );\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Unbinds all event listeners.\r\n\t */\r\n\tfunction removeEventListeners() {\r\n\r\n\t\teventsAreBound = false;\r\n\r\n\t\tdocument.removeEventListener( 'keydown', onDocumentKeyDown, false );\r\n\t\tdocument.removeEventListener( 'keypress', onDocumentKeyPress, false );\r\n\t\twindow.removeEventListener( 'hashchange', onWindowHashChange, false );\r\n\t\twindow.removeEventListener( 'resize', onWindowResize, false );\r\n\r\n\t\tdom.wrapper.removeEventListener( 'touchstart', onTouchStart, false );\r\n\t\tdom.wrapper.removeEventListener( 'touchmove', onTouchMove, false );\r\n\t\tdom.wrapper.removeEventListener( 'touchend', onTouchEnd, false );\r\n\r\n\t\t// IE11\r\n\t\tif( window.navigator.pointerEnabled ) {\r\n\t\t\tdom.wrapper.removeEventListener( 'pointerdown', onPointerDown, false );\r\n\t\t\tdom.wrapper.removeEventListener( 'pointermove', onPointerMove, false );\r\n\t\t\tdom.wrapper.removeEventListener( 'pointerup', onPointerUp, false );\r\n\t\t}\r\n\t\t// IE10\r\n\t\telse if( window.navigator.msPointerEnabled ) {\r\n\t\t\tdom.wrapper.removeEventListener( 'MSPointerDown', onPointerDown, false );\r\n\t\t\tdom.wrapper.removeEventListener( 'MSPointerMove', onPointerMove, false );\r\n\t\t\tdom.wrapper.removeEventListener( 'MSPointerUp', onPointerUp, false );\r\n\t\t}\r\n\r\n\t\tif ( config.progress && dom.progress ) {\r\n\t\t\tdom.progress.removeEventListener( 'click', onProgressClicked, false );\r\n\t\t}\r\n\r\n\t\t[ 'touchstart', 'click' ].forEach( function( eventName ) {\r\n\t\t\tdom.controlsLeft.forEach( function( el ) { el.removeEventListener( eventName, onNavigateLeftClicked, false ); } );\r\n\t\t\tdom.controlsRight.forEach( function( el ) { el.removeEventListener( eventName, onNavigateRightClicked, false ); } );\r\n\t\t\tdom.controlsUp.forEach( function( el ) { el.removeEventListener( eventName, onNavigateUpClicked, false ); } );\r\n\t\t\tdom.controlsDown.forEach( function( el ) { el.removeEventListener( eventName, onNavigateDownClicked, false ); } );\r\n\t\t\tdom.controlsPrev.forEach( function( el ) { el.removeEventListener( eventName, onNavigatePrevClicked, false ); } );\r\n\t\t\tdom.controlsNext.forEach( function( el ) { el.removeEventListener( eventName, onNavigateNextClicked, false ); } );\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Extend object a with the properties of object b.\r\n\t * If there's a conflict, object b takes precedence.\r\n\t */\r\n\tfunction extend( a, b ) {\r\n\r\n\t\tfor( var i in b ) {\r\n\t\t\ta[ i ] = b[ i ];\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Converts the target object to an array.\r\n\t */\r\n\tfunction toArray( o ) {\r\n\r\n\t\treturn Array.prototype.slice.call( o );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Utility for deserializing a value.\r\n\t */\r\n\tfunction deserialize( value ) {\r\n\r\n\t\tif( typeof value === 'string' ) {\r\n\t\t\tif( value === 'null' ) return null;\r\n\t\t\telse if( value === 'true' ) return true;\r\n\t\t\telse if( value === 'false' ) return false;\r\n\t\t\telse if( value.match( /^\\d+$/ ) ) return parseFloat( value );\r\n\t\t}\r\n\r\n\t\treturn value;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Measures the distance in pixels between point a\r\n\t * and point b.\r\n\t *\r\n\t * @param {Object} a point with x/y properties\r\n\t * @param {Object} b point with x/y properties\r\n\t */\r\n\tfunction distanceBetween( a, b ) {\r\n\r\n\t\tvar dx = a.x - b.x,\r\n\t\t\tdy = a.y - b.y;\r\n\r\n\t\treturn Math.sqrt( dx*dx + dy*dy );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Applies a CSS transform to the target element.\r\n\t */\r\n\tfunction transformElement( element, transform ) {\r\n\r\n\t\telement.style.WebkitTransform = transform;\r\n\t\telement.style.MozTransform = transform;\r\n\t\telement.style.msTransform = transform;\r\n\t\telement.style.transform = transform;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Applies CSS transforms to the slides container. The container\r\n\t * is transformed from two separate sources: layout and the overview\r\n\t * mode.\r\n\t */\r\n\tfunction transformSlides( transforms ) {\r\n\r\n\t\t// Pick up new transforms from arguments\r\n\t\tif( typeof transforms.layout === 'string' ) slidesTransform.layout = transforms.layout;\r\n\t\tif( typeof transforms.overview === 'string' ) slidesTransform.overview = transforms.overview;\r\n\r\n\t\t// Apply the transforms to the slides container\r\n\t\tif( slidesTransform.layout ) {\r\n\t\t\ttransformElement( dom.slides, slidesTransform.layout + ' ' + slidesTransform.overview );\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttransformElement( dom.slides, slidesTransform.overview );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Injects the given CSS styles into the DOM.\r\n\t */\r\n\tfunction injectStyleSheet( value ) {\r\n\r\n\t\tvar tag = document.createElement( 'style' );\r\n\t\ttag.type = 'text/css';\r\n\t\tif( tag.styleSheet ) {\r\n\t\t\ttag.styleSheet.cssText = value;\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttag.appendChild( document.createTextNode( value ) );\r\n\t\t}\r\n\t\tdocument.getElementsByTagName( 'head' )[0].appendChild( tag );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Converts various color input formats to an {r:0,g:0,b:0} object.\r\n\t *\r\n\t * @param {String} color The string representation of a color,\r\n\t * the following formats are supported:\r\n\t * - #000\r\n\t * - #000000\r\n\t * - rgb(0,0,0)\r\n\t */\r\n\tfunction colorToRgb( color ) {\r\n\r\n\t\tvar hex3 = color.match( /^#([0-9a-f]{3})$/i );\r\n\t\tif( hex3 && hex3[1] ) {\r\n\t\t\thex3 = hex3[1];\r\n\t\t\treturn {\r\n\t\t\t\tr: parseInt( hex3.charAt( 0 ), 16 ) * 0x11,\r\n\t\t\t\tg: parseInt( hex3.charAt( 1 ), 16 ) * 0x11,\r\n\t\t\t\tb: parseInt( hex3.charAt( 2 ), 16 ) * 0x11\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar hex6 = color.match( /^#([0-9a-f]{6})$/i );\r\n\t\tif( hex6 && hex6[1] ) {\r\n\t\t\thex6 = hex6[1];\r\n\t\t\treturn {\r\n\t\t\t\tr: parseInt( hex6.substr( 0, 2 ), 16 ),\r\n\t\t\t\tg: parseInt( hex6.substr( 2, 2 ), 16 ),\r\n\t\t\t\tb: parseInt( hex6.substr( 4, 2 ), 16 )\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar rgb = color.match( /^rgb\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)$/i );\r\n\t\tif( rgb ) {\r\n\t\t\treturn {\r\n\t\t\t\tr: parseInt( rgb[1], 10 ),\r\n\t\t\t\tg: parseInt( rgb[2], 10 ),\r\n\t\t\t\tb: parseInt( rgb[3], 10 )\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\tvar rgba = color.match( /^rgba\\s*\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\,\\s*([\\d]+|[\\d]*.[\\d]+)\\s*\\)$/i );\r\n\t\tif( rgba ) {\r\n\t\t\treturn {\r\n\t\t\t\tr: parseInt( rgba[1], 10 ),\r\n\t\t\t\tg: parseInt( rgba[2], 10 ),\r\n\t\t\t\tb: parseInt( rgba[3], 10 ),\r\n\t\t\t\ta: parseFloat( rgba[4] )\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Calculates brightness on a scale of 0-255.\r\n\t *\r\n\t * @param color See colorStringToRgb for supported formats.\r\n\t */\r\n\tfunction colorBrightness( color ) {\r\n\r\n\t\tif( typeof color === 'string' ) color = colorToRgb( color );\r\n\r\n\t\tif( color ) {\r\n\t\t\treturn ( color.r * 299 + color.g * 587 + color.b * 114 ) / 1000;\r\n\t\t}\r\n\r\n\t\treturn null;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves the height of the given element by looking\r\n\t * at the position and height of its immediate children.\r\n\t */\r\n\tfunction getAbsoluteHeight( element ) {\r\n\r\n\t\tvar height = 0;\r\n\r\n\t\tif( element ) {\r\n\t\t\tvar absoluteChildren = 0;\r\n\r\n\t\t\ttoArray( element.childNodes ).forEach( function( child ) {\r\n\r\n\t\t\t\tif( typeof child.offsetTop === 'number' && child.style ) {\r\n\t\t\t\t\t// Count # of abs children\r\n\t\t\t\t\tif( window.getComputedStyle( child ).position === 'absolute' ) {\r\n\t\t\t\t\t\tabsoluteChildren += 1;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\theight = Math.max( height, child.offsetTop + child.offsetHeight );\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t\t// If there are no absolute children, use offsetHeight\r\n\t\t\tif( absoluteChildren === 0 ) {\r\n\t\t\t\theight = element.offsetHeight;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn height;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the remaining height within the parent of the\r\n\t * target element.\r\n\t *\r\n\t * remaining height = [ configured parent height ] - [ current parent height ]\r\n\t */\r\n\tfunction getRemainingHeight( element, height ) {\r\n\r\n\t\theight = height || 0;\r\n\r\n\t\tif( element ) {\r\n\t\t\tvar newHeight, oldHeight = element.style.height;\r\n\r\n\t\t\t// Change the .stretch element height to 0 in order find the height of all\r\n\t\t\t// the other elements\r\n\t\t\telement.style.height = '0px';\r\n\t\t\tnewHeight = height - element.parentNode.offsetHeight;\r\n\r\n\t\t\t// Restore the old height, just in case\r\n\t\t\telement.style.height = oldHeight + 'px';\r\n\r\n\t\t\treturn newHeight;\r\n\t\t}\r\n\r\n\t\treturn height;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if this instance is being used to print a PDF.\r\n\t */\r\n\tfunction isPrintingPDF() {\r\n\r\n\t\treturn ( /print-pdf/gi ).test( window.location.search );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Hides the address bar if we're on a mobile device.\r\n\t */\r\n\tfunction hideAddressBar() {\r\n\r\n\t\tif( config.hideAddressBar && isMobileDevice ) {\r\n\t\t\t// Events that should trigger the address bar to hide\r\n\t\t\twindow.addEventListener( 'load', removeAddressBar, false );\r\n\t\t\twindow.addEventListener( 'orientationchange', removeAddressBar, false );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Causes the address bar to hide on mobile devices,\r\n\t * more vertical space ftw.\r\n\t */\r\n\tfunction removeAddressBar() {\r\n\r\n\t\tsetTimeout( function() {\r\n\t\t\twindow.scrollTo( 0, 1 );\r\n\t\t}, 10 );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Dispatches an event of the specified type from the\r\n\t * reveal DOM element.\r\n\t */\r\n\tfunction dispatchEvent( type, args ) {\r\n\r\n\t\tvar event = document.createEvent( 'HTMLEvents', 1, 2 );\r\n\t\tevent.initEvent( type, true, true );\r\n\t\textend( event, args );\r\n\t\tdom.wrapper.dispatchEvent( event );\r\n\r\n\t\t// If we're in an iframe, post each reveal.js event to the\r\n\t\t// parent window. Used by the notes plugin\r\n\t\tif( config.postMessageEvents && window.parent !== window.self ) {\r\n\t\t\twindow.parent.postMessage( JSON.stringify({ namespace: 'reveal', eventName: type, state: getState() }), '*' );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Wrap all links in 3D goodness.\r\n\t */\r\n\tfunction enableRollingLinks() {\r\n\r\n\t\tif( features.transforms3d && !( 'msPerspective' in document.body.style ) ) {\r\n\t\t\tvar anchors = dom.wrapper.querySelectorAll( SLIDES_SELECTOR + ' a' );\r\n\r\n\t\t\tfor( var i = 0, len = anchors.length; i < len; i++ ) {\r\n\t\t\t\tvar anchor = anchors[i];\r\n\r\n\t\t\t\tif( anchor.textContent && !anchor.querySelector( '*' ) && ( !anchor.className || !anchor.classList.contains( anchor, 'roll' ) ) ) {\r\n\t\t\t\t\tvar span = document.createElement('span');\r\n\t\t\t\t\tspan.setAttribute('data-title', anchor.text);\r\n\t\t\t\t\tspan.innerHTML = anchor.innerHTML;\r\n\r\n\t\t\t\t\tanchor.classList.add( 'roll' );\r\n\t\t\t\t\tanchor.innerHTML = '';\r\n\t\t\t\t\tanchor.appendChild(span);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Unwrap all 3D links.\r\n\t */\r\n\tfunction disableRollingLinks() {\r\n\r\n\t\tvar anchors = dom.wrapper.querySelectorAll( SLIDES_SELECTOR + ' a.roll' );\r\n\r\n\t\tfor( var i = 0, len = anchors.length; i < len; i++ ) {\r\n\t\t\tvar anchor = anchors[i];\r\n\t\t\tvar span = anchor.querySelector( 'span' );\r\n\r\n\t\t\tif( span ) {\r\n\t\t\t\tanchor.classList.remove( 'roll' );\r\n\t\t\t\tanchor.innerHTML = span.innerHTML;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Bind preview frame links.\r\n\t */\r\n\tfunction enablePreviewLinks( selector ) {\r\n\r\n\t\tvar anchors = toArray( document.querySelectorAll( selector ? selector : 'a' ) );\r\n\r\n\t\tanchors.forEach( function( element ) {\r\n\t\t\tif( /^(http|www)/gi.test( element.getAttribute( 'href' ) ) ) {\r\n\t\t\t\telement.addEventListener( 'click', onPreviewLinkClicked, false );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Unbind preview frame links.\r\n\t */\r\n\tfunction disablePreviewLinks() {\r\n\r\n\t\tvar anchors = toArray( document.querySelectorAll( 'a' ) );\r\n\r\n\t\tanchors.forEach( function( element ) {\r\n\t\t\tif( /^(http|www)/gi.test( element.getAttribute( 'href' ) ) ) {\r\n\t\t\t\telement.removeEventListener( 'click', onPreviewLinkClicked, false );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Opens a preview window for the target URL.\r\n\t */\r\n\tfunction showPreview( url ) {\r\n\r\n\t\tcloseOverlay();\r\n\r\n\t\tdom.overlay = document.createElement( 'div' );\r\n\t\tdom.overlay.classList.add( 'overlay' );\r\n\t\tdom.overlay.classList.add( 'overlay-preview' );\r\n\t\tdom.wrapper.appendChild( dom.overlay );\r\n\r\n\t\tdom.overlay.innerHTML = [\r\n\t\t\t'<header>',\r\n\t\t\t\t'<a class=\"close\" href=\"#\"><span class=\"icon\"></span></a>',\r\n\t\t\t\t'<a class=\"external\" href=\"'+ url +'\" target=\"_blank\"><span class=\"icon\"></span></a>',\r\n\t\t\t'</header>',\r\n\t\t\t'<div class=\"spinner\"></div>',\r\n\t\t\t'<div class=\"viewport\">',\r\n\t\t\t\t'<iframe src=\"'+ url +'\"></iframe>',\r\n\t\t\t'</div>'\r\n\t\t].join('');\r\n\r\n\t\tdom.overlay.querySelector( 'iframe' ).addEventListener( 'load', function( event ) {\r\n\t\t\tdom.overlay.classList.add( 'loaded' );\r\n\t\t}, false );\r\n\r\n\t\tdom.overlay.querySelector( '.close' ).addEventListener( 'click', function( event ) {\r\n\t\t\tcloseOverlay();\r\n\t\t\tevent.preventDefault();\r\n\t\t}, false );\r\n\r\n\t\tdom.overlay.querySelector( '.external' ).addEventListener( 'click', function( event ) {\r\n\t\t\tcloseOverlay();\r\n\t\t}, false );\r\n\r\n\t\tsetTimeout( function() {\r\n\t\t\tdom.overlay.classList.add( 'visible' );\r\n\t\t}, 1 );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Opens a overlay window with help material.\r\n\t */\r\n\tfunction showHelp() {\r\n\r\n\t\tif( config.help ) {\r\n\r\n\t\t\tcloseOverlay();\r\n\r\n\t\t\tdom.overlay = document.createElement( 'div' );\r\n\t\t\tdom.overlay.classList.add( 'overlay' );\r\n\t\t\tdom.overlay.classList.add( 'overlay-help' );\r\n\t\t\tdom.wrapper.appendChild( dom.overlay );\r\n\r\n\t\t\tvar html = '<p class=\"title\">Keyboard Shortcuts</p><br/>';\r\n\r\n\t\t\thtml += '<table><th>KEY</th><th>ACTION</th>';\r\n\t\t\tfor( var key in keyboardShortcuts ) {\r\n\t\t\t\thtml += '<tr><td>' + key + '</td><td>' + keyboardShortcuts[ key ] + '</td></tr>';\r\n\t\t\t}\r\n\r\n\t\t\thtml += '</table>';\r\n\r\n\t\t\tdom.overlay.innerHTML = [\r\n\t\t\t\t'<header>',\r\n\t\t\t\t\t'<a class=\"close\" href=\"#\"><span class=\"icon\"></span></a>',\r\n\t\t\t\t'</header>',\r\n\t\t\t\t'<div class=\"viewport\">',\r\n\t\t\t\t\t'<div class=\"viewport-inner\">'+ html +'</div>',\r\n\t\t\t\t'</div>'\r\n\t\t\t].join('');\r\n\r\n\t\t\tdom.overlay.querySelector( '.close' ).addEventListener( 'click', function( event ) {\r\n\t\t\t\tcloseOverlay();\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}, false );\r\n\r\n\t\t\tsetTimeout( function() {\r\n\t\t\t\tdom.overlay.classList.add( 'visible' );\r\n\t\t\t}, 1 );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Closes any currently open overlay.\r\n\t */\r\n\tfunction closeOverlay() {\r\n\r\n\t\tif( dom.overlay ) {\r\n\t\t\tdom.overlay.parentNode.removeChild( dom.overlay );\r\n\t\t\tdom.overlay = null;\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Applies JavaScript-controlled layout rules to the\r\n\t * presentation.\r\n\t */\r\n\tfunction layout() {\r\n\r\n\t\tif( dom.wrapper && !isPrintingPDF() ) {\r\n\r\n\t\t\tvar size = getComputedSlideSize();\r\n\r\n\t\t\tvar slidePadding = 20; // TODO Dig this out of DOM\r\n\r\n\t\t\t// Layout the contents of the slides\r\n\t\t\tlayoutSlideContents( config.width, config.height, slidePadding );\r\n\r\n\t\t\tdom.slides.style.width = size.width + 'px';\r\n\t\t\tdom.slides.style.height = size.height + 'px';\r\n\r\n\t\t\t// Determine scale of content to fit within available space\r\n\t\t\tscale = Math.min( size.presentationWidth / size.width, size.presentationHeight / size.height );\r\n\r\n\t\t\t// Respect max/min scale settings\r\n\t\t\tscale = Math.max( scale, config.minScale );\r\n\t\t\tscale = Math.min( scale, config.maxScale );\r\n\r\n\t\t\t// Don't apply any scaling styles if scale is 1\r\n\t\t\tif( scale === 1 ) {\r\n\t\t\t\tdom.slides.style.zoom = '';\r\n\t\t\t\tdom.slides.style.left = '';\r\n\t\t\t\tdom.slides.style.top = '';\r\n\t\t\t\tdom.slides.style.bottom = '';\r\n\t\t\t\tdom.slides.style.right = '';\r\n\t\t\t\ttransformSlides( { layout: '' } );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Prefer zooming in desktop Chrome so that content remains crisp\r\n\t\t\t\tif( !isMobileDevice && /chrome/i.test( navigator.userAgent ) && typeof dom.slides.style.zoom !== 'undefined' ) {\r\n\t\t\t\t\tdom.slides.style.zoom = scale;\r\n\t\t\t\t\ttransformSlides( { layout: '' } );\r\n\t\t\t\t}\r\n\t\t\t\t// Apply scale transform as a fallback\r\n\t\t\t\telse {\r\n\t\t\t\t\tdom.slides.style.left = '50%';\r\n\t\t\t\t\tdom.slides.style.top = '50%';\r\n\t\t\t\t\tdom.slides.style.bottom = 'auto';\r\n\t\t\t\t\tdom.slides.style.right = 'auto';\r\n\t\t\t\t\ttransformSlides( { layout: 'translate(-50%, -50%) scale('+ scale +')' } );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Select all slides, vertical and horizontal\r\n\t\t\tvar slides = toArray( dom.wrapper.querySelectorAll( SLIDES_SELECTOR ) );\r\n\r\n\t\t\tfor( var i = 0, len = slides.length; i < len; i++ ) {\r\n\t\t\t\tvar slide = slides[ i ];\r\n\r\n\t\t\t\t// Don't bother updating invisible slides\r\n\t\t\t\tif( slide.style.display === 'none' ) {\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( config.center || slide.classList.contains( 'center' ) ) {\r\n\t\t\t\t\t// Vertical stacks are not centred since their section\r\n\t\t\t\t\t// children will be\r\n\t\t\t\t\tif( slide.classList.contains( 'stack' ) ) {\r\n\t\t\t\t\t\tslide.style.top = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tslide.style.top = Math.max( ( ( size.height - getAbsoluteHeight( slide ) ) / 2 ) - slidePadding, 0 ) + 'px';\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tslide.style.top = '';\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\tupdateProgress();\r\n\t\t\tupdateParallax();\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Applies layout logic to the contents of all slides in\r\n\t * the presentation.\r\n\t */\r\n\tfunction layoutSlideContents( width, height, padding ) {\r\n\r\n\t\t// Handle sizing of elements with the 'stretch' class\r\n\t\ttoArray( dom.slides.querySelectorAll( 'section > .stretch' ) ).forEach( function( element ) {\r\n\r\n\t\t\t// Determine how much vertical space we can use\r\n\t\t\tvar remainingHeight = getRemainingHeight( element, height );\r\n\r\n\t\t\t// Consider the aspect ratio of media elements\r\n\t\t\tif( /(img|video)/gi.test( element.nodeName ) ) {\r\n\t\t\t\tvar nw = element.naturalWidth || element.videoWidth,\r\n\t\t\t\t\tnh = element.naturalHeight || element.videoHeight;\r\n\r\n\t\t\t\tvar es = Math.min( width / nw, remainingHeight / nh );\r\n\r\n\t\t\t\telement.style.width = ( nw * es ) + 'px';\r\n\t\t\t\telement.style.height = ( nh * es ) + 'px';\r\n\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\telement.style.width = width + 'px';\r\n\t\t\t\telement.style.height = remainingHeight + 'px';\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Calculates the computed pixel size of our slides. These\r\n\t * values are based on the width and height configuration\r\n\t * options.\r\n\t */\r\n\tfunction getComputedSlideSize( presentationWidth, presentationHeight ) {\r\n\r\n\t\tvar size = {\r\n\t\t\t// Slide size\r\n\t\t\twidth: config.width,\r\n\t\t\theight: config.height,\r\n\r\n\t\t\t// Presentation size\r\n\t\t\tpresentationWidth: presentationWidth || dom.wrapper.offsetWidth,\r\n\t\t\tpresentationHeight: presentationHeight || dom.wrapper.offsetHeight\r\n\t\t};\r\n\r\n\t\t// Reduce available space by margin\r\n\t\tsize.presentationWidth -= ( size.presentationWidth * config.margin );\r\n\t\tsize.presentationHeight -= ( size.presentationHeight * config.margin );\r\n\r\n\t\t// Slide width may be a percentage of available width\r\n\t\tif( typeof size.width === 'string' && /%$/.test( size.width ) ) {\r\n\t\t\tsize.width = parseInt( size.width, 10 ) / 100 * size.presentationWidth;\r\n\t\t}\r\n\r\n\t\t// Slide height may be a percentage of available height\r\n\t\tif( typeof size.height === 'string' && /%$/.test( size.height ) ) {\r\n\t\t\tsize.height = parseInt( size.height, 10 ) / 100 * size.presentationHeight;\r\n\t\t}\r\n\r\n\t\treturn size;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Stores the vertical index of a stack so that the same\r\n\t * vertical slide can be selected when navigating to and\r\n\t * from the stack.\r\n\t *\r\n\t * @param {HTMLElement} stack The vertical stack element\r\n\t * @param {int} v Index to memorize\r\n\t */\r\n\tfunction setPreviousVerticalIndex( stack, v ) {\r\n\r\n\t\tif( typeof stack === 'object' && typeof stack.setAttribute === 'function' ) {\r\n\t\t\tstack.setAttribute( 'data-previous-indexv', v || 0 );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves the vertical index which was stored using\r\n\t * #setPreviousVerticalIndex() or 0 if no previous index\r\n\t * exists.\r\n\t *\r\n\t * @param {HTMLElement} stack The vertical stack element\r\n\t */\r\n\tfunction getPreviousVerticalIndex( stack ) {\r\n\r\n\t\tif( typeof stack === 'object' && typeof stack.setAttribute === 'function' && stack.classList.contains( 'stack' ) ) {\r\n\t\t\t// Prefer manually defined start-indexv\r\n\t\t\tvar attributeName = stack.hasAttribute( 'data-start-indexv' ) ? 'data-start-indexv' : 'data-previous-indexv';\r\n\r\n\t\t\treturn parseInt( stack.getAttribute( attributeName ) || 0, 10 );\r\n\t\t}\r\n\r\n\t\treturn 0;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Displays the overview of slides (quick nav) by scaling\r\n\t * down and arranging all slide elements.\r\n\t */\r\n\tfunction activateOverview() {\r\n\r\n\t\t// Only proceed if enabled in config\r\n\t\tif( config.overview && !isOverview() ) {\r\n\r\n\t\t\toverview = true;\r\n\r\n\t\t\tdom.wrapper.classList.add( 'overview' );\r\n\t\t\tdom.wrapper.classList.remove( 'overview-deactivating' );\r\n\r\n\t\t\tif( features.overviewTransitions ) {\r\n\t\t\t\tsetTimeout( function() {\r\n\t\t\t\t\tdom.wrapper.classList.add( 'overview-animated' );\r\n\t\t\t\t}, 1 );\r\n\t\t\t}\r\n\r\n\t\t\t// Don't auto-slide while in overview mode\r\n\t\t\tcancelAutoSlide();\r\n\r\n\t\t\t// Move the backgrounds element into the slide container to\r\n\t\t\t// that the same scaling is applied\r\n\t\t\tdom.slides.appendChild( dom.background );\r\n\r\n\t\t\t// Clicking on an overview slide navigates to it\r\n\t\t\ttoArray( dom.wrapper.querySelectorAll( SLIDES_SELECTOR ) ).forEach( function( slide ) {\r\n\t\t\t\tif( !slide.classList.contains( 'stack' ) ) {\r\n\t\t\t\t\tslide.addEventListener( 'click', onOverviewSlideClicked, true );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\tupdateSlidesVisibility();\r\n\t\t\tlayoutOverview();\r\n\t\t\tupdateOverview();\r\n\r\n\t\t\tlayout();\r\n\r\n\t\t\t// Notify observers of the overview showing\r\n\t\t\tdispatchEvent( 'overviewshown', {\r\n\t\t\t\t'indexh': indexh,\r\n\t\t\t\t'indexv': indexv,\r\n\t\t\t\t'currentSlide': currentSlide\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Uses CSS transforms to position all slides in a grid for\r\n\t * display inside of the overview mode.\r\n\t */\r\n\tfunction layoutOverview() {\r\n\r\n\t\tvar margin = 70;\r\n\t\tvar slideWidth = config.width + margin,\r\n\t\t\tslideHeight = config.height + margin;\r\n\r\n\t\t// Reverse in RTL mode\r\n\t\tif( config.rtl ) {\r\n\t\t\tslideWidth = -slideWidth;\r\n\t\t}\r\n\r\n\t\t// Layout slides\r\n\t\ttoArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ) ).forEach( function( hslide, h ) {\r\n\t\t\thslide.setAttribute( 'data-index-h', h );\r\n\t\t\ttransformElement( hslide, 'translate3d(' + ( h * slideWidth ) + 'px, 0, 0)' );\r\n\r\n\t\t\tif( hslide.classList.contains( 'stack' ) ) {\r\n\r\n\t\t\t\ttoArray( hslide.querySelectorAll( 'section' ) ).forEach( function( vslide, v ) {\r\n\t\t\t\t\tvslide.setAttribute( 'data-index-h', h );\r\n\t\t\t\t\tvslide.setAttribute( 'data-index-v', v );\r\n\r\n\t\t\t\t\ttransformElement( vslide, 'translate3d(0, ' + ( v * slideHeight ) + 'px, 0)' );\r\n\t\t\t\t} );\r\n\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\t// Layout slide backgrounds\r\n\t\ttoArray( dom.background.childNodes ).forEach( function( hbackground, h ) {\r\n\t\t\ttransformElement( hbackground, 'translate3d(' + ( h * slideWidth ) + 'px, 0, 0)' );\r\n\r\n\t\t\ttoArray( hbackground.querySelectorAll( '.slide-background' ) ).forEach( function( vbackground, v ) {\r\n\t\t\t\ttransformElement( vbackground, 'translate3d(0, ' + ( v * slideHeight ) + 'px, 0)' );\r\n\t\t\t} );\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Moves the overview viewport to the current slides.\r\n\t * Called each time the current slide changes.\r\n\t */\r\n\tfunction updateOverview() {\r\n\r\n\t\tvar margin = 70;\r\n\t\tvar slideWidth = config.width + margin,\r\n\t\t\tslideHeight = config.height + margin;\r\n\r\n\t\t// Reverse in RTL mode\r\n\t\tif( config.rtl ) {\r\n\t\t\tslideWidth = -slideWidth;\r\n\t\t}\r\n\r\n\t\ttransformSlides( {\r\n\t\t\toverview: [\r\n\t\t\t\t'translateX('+ ( -indexh * slideWidth ) +'px)',\r\n\t\t\t\t'translateY('+ ( -indexv * slideHeight ) +'px)',\r\n\t\t\t\t'translateZ('+ ( window.innerWidth < 400 ? -1000 : -2500 ) +'px)'\r\n\t\t\t].join( ' ' )\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Exits the slide overview and enters the currently\r\n\t * active slide.\r\n\t */\r\n\tfunction deactivateOverview() {\r\n\r\n\t\t// Only proceed if enabled in config\r\n\t\tif( config.overview ) {\r\n\r\n\t\t\toverview = false;\r\n\r\n\t\t\tdom.wrapper.classList.remove( 'overview' );\r\n\t\t\tdom.wrapper.classList.remove( 'overview-animated' );\r\n\r\n\t\t\t// Temporarily add a class so that transitions can do different things\r\n\t\t\t// depending on whether they are exiting/entering overview, or just\r\n\t\t\t// moving from slide to slide\r\n\t\t\tdom.wrapper.classList.add( 'overview-deactivating' );\r\n\r\n\t\t\tsetTimeout( function () {\r\n\t\t\t\tdom.wrapper.classList.remove( 'overview-deactivating' );\r\n\t\t\t}, 1 );\r\n\r\n\t\t\t// Move the background element back out\r\n\t\t\tdom.wrapper.appendChild( dom.background );\r\n\r\n\t\t\t// Clean up changes made to slides\r\n\t\t\ttoArray( dom.wrapper.querySelectorAll( SLIDES_SELECTOR ) ).forEach( function( slide ) {\r\n\t\t\t\ttransformElement( slide, '' );\r\n\r\n\t\t\t\tslide.removeEventListener( 'click', onOverviewSlideClicked, true );\r\n\t\t\t} );\r\n\r\n\t\t\t// Clean up changes made to backgrounds\r\n\t\t\ttoArray( dom.background.querySelectorAll( '.slide-background' ) ).forEach( function( background ) {\r\n\t\t\t\ttransformElement( background, '' );\r\n\t\t\t} );\r\n\r\n\t\t\ttransformSlides( { overview: '' } );\r\n\r\n\t\t\tslide( indexh, indexv );\r\n\r\n\t\t\tlayout();\r\n\r\n\t\t\tcueAutoSlide();\r\n\r\n\t\t\t// Notify observers of the overview hiding\r\n\t\t\tdispatchEvent( 'overviewhidden', {\r\n\t\t\t\t'indexh': indexh,\r\n\t\t\t\t'indexv': indexv,\r\n\t\t\t\t'currentSlide': currentSlide\r\n\t\t\t} );\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles the slide overview mode on and off.\r\n\t *\r\n\t * @param {Boolean} override Optional flag which overrides the\r\n\t * toggle logic and forcibly sets the desired state. True means\r\n\t * overview is open, false means it's closed.\r\n\t */\r\n\tfunction toggleOverview( override ) {\r\n\r\n\t\tif( typeof override === 'boolean' ) {\r\n\t\t\toverride ? activateOverview() : deactivateOverview();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tisOverview() ? deactivateOverview() : activateOverview();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the overview is currently active.\r\n\t *\r\n\t * @return {Boolean} true if the overview is active,\r\n\t * false otherwise\r\n\t */\r\n\tfunction isOverview() {\r\n\r\n\t\treturn overview;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the current or specified slide is vertical\r\n\t * (nested within another slide).\r\n\t *\r\n\t * @param {HTMLElement} slide [optional] The slide to check\r\n\t * orientation of\r\n\t */\r\n\tfunction isVerticalSlide( slide ) {\r\n\r\n\t\t// Prefer slide argument, otherwise use current slide\r\n\t\tslide = slide ? slide : currentSlide;\r\n\r\n\t\treturn slide && slide.parentNode && !!slide.parentNode.nodeName.match( /section/i );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handling the fullscreen functionality via the fullscreen API\r\n\t *\r\n\t * @see http://fullscreen.spec.whatwg.org/\r\n\t * @see https://developer.mozilla.org/en-US/docs/DOM/Using_fullscreen_mode\r\n\t */\r\n\tfunction enterFullscreen() {\r\n\r\n\t\tvar element = document.body;\r\n\r\n\t\t// Check which implementation is available\r\n\t\tvar requestMethod = element.requestFullScreen ||\r\n\t\t\t\t\t\t\telement.webkitRequestFullscreen ||\r\n\t\t\t\t\t\t\telement.webkitRequestFullScreen ||\r\n\t\t\t\t\t\t\telement.mozRequestFullScreen ||\r\n\t\t\t\t\t\t\telement.msRequestFullscreen;\r\n\r\n\t\tif( requestMethod ) {\r\n\t\t\trequestMethod.apply( element );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enters the paused mode which fades everything on screen to\r\n\t * black.\r\n\t */\r\n\tfunction pause() {\r\n\r\n\t\tif( config.pause ) {\r\n\t\t\tvar wasPaused = dom.wrapper.classList.contains( 'paused' );\r\n\r\n\t\t\tcancelAutoSlide();\r\n\t\t\tdom.wrapper.classList.add( 'paused' );\r\n\r\n\t\t\tif( wasPaused === false ) {\r\n\t\t\t\tdispatchEvent( 'paused' );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Exits from the paused mode.\r\n\t */\r\n\tfunction resume() {\r\n\r\n\t\tvar wasPaused = dom.wrapper.classList.contains( 'paused' );\r\n\t\tdom.wrapper.classList.remove( 'paused' );\r\n\r\n\t\tcueAutoSlide();\r\n\r\n\t\tif( wasPaused ) {\r\n\t\t\tdispatchEvent( 'resumed' );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles the paused mode on and off.\r\n\t */\r\n\tfunction togglePause( override ) {\r\n\r\n\t\tif( typeof override === 'boolean' ) {\r\n\t\t\toverride ? pause() : resume();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tisPaused() ? resume() : pause();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if we are currently in the paused mode.\r\n\t */\r\n\tfunction isPaused() {\r\n\r\n\t\treturn dom.wrapper.classList.contains( 'paused' );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Toggles the auto slide mode on and off.\r\n\t *\r\n\t * @param {Boolean} override Optional flag which sets the desired state.\r\n\t * True means autoplay starts, false means it stops.\r\n\t */\r\n\r\n\tfunction toggleAutoSlide( override ) {\r\n\r\n\t\tif( typeof override === 'boolean' ) {\r\n\t\t\toverride ? resumeAutoSlide() : pauseAutoSlide();\r\n\t\t}\r\n\r\n\t\telse {\r\n\t\t\tautoSlidePaused ? resumeAutoSlide() : pauseAutoSlide();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if the auto slide mode is currently on.\r\n\t */\r\n\tfunction isAutoSliding() {\r\n\r\n\t\treturn !!( autoSlide && !autoSlidePaused );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Steps from the current point in the presentation to the\r\n\t * slide which matches the specified horizontal and vertical\r\n\t * indices.\r\n\t *\r\n\t * @param {int} h Horizontal index of the target slide\r\n\t * @param {int} v Vertical index of the target slide\r\n\t * @param {int} f Optional index of a fragment within the\r\n\t * target slide to activate\r\n\t * @param {int} o Optional origin for use in multimaster environments\r\n\t */\r\n\tfunction slide( h, v, f, o ) {\r\n\r\n\t\t// Remember where we were at before\r\n\t\tpreviousSlide = currentSlide;\r\n\r\n\t\t// Query all horizontal slides in the deck\r\n\t\tvar horizontalSlides = dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR );\r\n\r\n\t\t// If no vertical index is specified and the upcoming slide is a\r\n\t\t// stack, resume at its previous vertical index\r\n\t\tif( v === undefined && !isOverview() ) {\r\n\t\t\tv = getPreviousVerticalIndex( horizontalSlides[ h ] );\r\n\t\t}\r\n\r\n\t\t// If we were on a vertical stack, remember what vertical index\r\n\t\t// it was on so we can resume at the same position when returning\r\n\t\tif( previousSlide && previousSlide.parentNode && previousSlide.parentNode.classList.contains( 'stack' ) ) {\r\n\t\t\tsetPreviousVerticalIndex( previousSlide.parentNode, indexv );\r\n\t\t}\r\n\r\n\t\t// Remember the state before this slide\r\n\t\tvar stateBefore = state.concat();\r\n\r\n\t\t// Reset the state array\r\n\t\tstate.length = 0;\r\n\r\n\t\tvar indexhBefore = indexh || 0,\r\n\t\t\tindexvBefore = indexv || 0;\r\n\r\n\t\t// Activate and transition to the new slide\r\n\t\tindexh = updateSlides( HORIZONTAL_SLIDES_SELECTOR, h === undefined ? indexh : h );\r\n\t\tindexv = updateSlides( VERTICAL_SLIDES_SELECTOR, v === undefined ? indexv : v );\r\n\r\n\t\t// Update the visibility of slides now that the indices have changed\r\n\t\tupdateSlidesVisibility();\r\n\r\n\t\tlayout();\r\n\r\n\t\t// Apply the new state\r\n\t\tstateLoop: for( var i = 0, len = state.length; i < len; i++ ) {\r\n\t\t\t// Check if this state existed on the previous slide. If it\r\n\t\t\t// did, we will avoid adding it repeatedly\r\n\t\t\tfor( var j = 0; j < stateBefore.length; j++ ) {\r\n\t\t\t\tif( stateBefore[j] === state[i] ) {\r\n\t\t\t\t\tstateBefore.splice( j, 1 );\r\n\t\t\t\t\tcontinue stateLoop;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tdocument.documentElement.classList.add( state[i] );\r\n\r\n\t\t\t// Dispatch custom event matching the state's name\r\n\t\t\tdispatchEvent( state[i] );\r\n\t\t}\r\n\r\n\t\t// Clean up the remains of the previous state\r\n\t\twhile( stateBefore.length ) {\r\n\t\t\tdocument.documentElement.classList.remove( stateBefore.pop() );\r\n\t\t}\r\n\r\n\t\t// Update the overview if it's currently active\r\n\t\tif( isOverview() ) {\r\n\t\t\tupdateOverview();\r\n\t\t}\r\n\r\n\t\t// Find the current horizontal slide and any possible vertical slides\r\n\t\t// within it\r\n\t\tvar currentHorizontalSlide = horizontalSlides[ indexh ],\r\n\t\t\tcurrentVerticalSlides = currentHorizontalSlide.querySelectorAll( 'section' );\r\n\r\n\t\t// Store references to the previous and current slides\r\n\t\tcurrentSlide = currentVerticalSlides[ indexv ] || currentHorizontalSlide;\r\n\r\n\t\t// Show fragment, if specified\r\n\t\tif( typeof f !== 'undefined' ) {\r\n\t\t\tnavigateFragment( f );\r\n\t\t}\r\n\r\n\t\t// Dispatch an event if the slide changed\r\n\t\tvar slideChanged = ( indexh !== indexhBefore || indexv !== indexvBefore );\r\n\t\tif( slideChanged ) {\r\n\t\t\tdispatchEvent( 'slidechanged', {\r\n\t\t\t\t'indexh': indexh,\r\n\t\t\t\t'indexv': indexv,\r\n\t\t\t\t'previousSlide': previousSlide,\r\n\t\t\t\t'currentSlide': currentSlide,\r\n\t\t\t\t'origin': o\r\n\t\t\t} );\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Ensure that the previous slide is never the same as the current\r\n\t\t\tpreviousSlide = null;\r\n\t\t}\r\n\r\n\t\t// Solves an edge case where the previous slide maintains the\r\n\t\t// 'present' class when navigating between adjacent vertical\r\n\t\t// stacks\r\n\t\tif( previousSlide ) {\r\n\t\t\tpreviousSlide.classList.remove( 'present' );\r\n\t\t\tpreviousSlide.setAttribute( 'aria-hidden', 'true' );\r\n\r\n\t\t\t// Reset all slides upon navigate to home\r\n\t\t\t// Issue: #285\r\n\t\t\tif ( dom.wrapper.querySelector( HOME_SLIDE_SELECTOR ).classList.contains( 'present' ) ) {\r\n\t\t\t\t// Launch async task\r\n\t\t\t\tsetTimeout( function () {\r\n\t\t\t\t\tvar slides = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR + '.stack') ), i;\r\n\t\t\t\t\tfor( i in slides ) {\r\n\t\t\t\t\t\tif( slides[i] ) {\r\n\t\t\t\t\t\t\t// Reset stack\r\n\t\t\t\t\t\t\tsetPreviousVerticalIndex( slides[i], 0 );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}, 0 );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Handle embedded content\r\n\t\tif( slideChanged || !previousSlide ) {\r\n\t\t\tstopEmbeddedContent( previousSlide );\r\n\t\t\tstartEmbeddedContent( currentSlide );\r\n\t\t}\r\n\r\n\t\t// Announce the current slide contents, for screen readers\r\n\t\tdom.statusDiv.textContent = currentSlide.textContent;\r\n\r\n\t\tupdateControls();\r\n\t\tupdateProgress();\r\n\t\tupdateBackground();\r\n\t\tupdateParallax();\r\n\t\tupdateSlideNumber();\r\n\r\n\t\t// Update the URL hash\r\n\t\twriteURL();\r\n\r\n\t\tcueAutoSlide();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Syncs the presentation with the current DOM. Useful\r\n\t * when new slides or control elements are added or when\r\n\t * the configuration has changed.\r\n\t */\r\n\tfunction sync() {\r\n\r\n\t\t// Subscribe to input\r\n\t\tremoveEventListeners();\r\n\t\taddEventListeners();\r\n\r\n\t\t// Force a layout to make sure the current config is accounted for\r\n\t\tlayout();\r\n\r\n\t\t// Reflect the current autoSlide value\r\n\t\tautoSlide = config.autoSlide;\r\n\r\n\t\t// Start auto-sliding if it's enabled\r\n\t\tcueAutoSlide();\r\n\r\n\t\t// Re-create the slide backgrounds\r\n\t\tcreateBackgrounds();\r\n\r\n\t\t// Write the current hash to the URL\r\n\t\twriteURL();\r\n\r\n\t\tsortAllFragments();\r\n\r\n\t\tupdateControls();\r\n\t\tupdateProgress();\r\n\t\tupdateBackground( true );\r\n\t\tupdateSlideNumber();\r\n\t\tupdateSlidesVisibility();\r\n\r\n\t\tformatEmbeddedContent();\r\n\t\tstartEmbeddedContent( currentSlide );\r\n\r\n\t\tif( isOverview() ) {\r\n\t\t\tlayoutOverview();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Resets all vertical slides so that only the first\r\n\t * is visible.\r\n\t */\r\n\tfunction resetVerticalSlides() {\r\n\r\n\t\tvar horizontalSlides = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ) );\r\n\t\thorizontalSlides.forEach( function( horizontalSlide ) {\r\n\r\n\t\t\tvar verticalSlides = toArray( horizontalSlide.querySelectorAll( 'section' ) );\r\n\t\t\tverticalSlides.forEach( function( verticalSlide, y ) {\r\n\r\n\t\t\t\tif( y > 0 ) {\r\n\t\t\t\t\tverticalSlide.classList.remove( 'present' );\r\n\t\t\t\t\tverticalSlide.classList.remove( 'past' );\r\n\t\t\t\t\tverticalSlide.classList.add( 'future' );\r\n\t\t\t\t\tverticalSlide.setAttribute( 'aria-hidden', 'true' );\r\n\t\t\t\t}\r\n\r\n\t\t\t} );\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Sorts and formats all of fragments in the\r\n\t * presentation.\r\n\t */\r\n\tfunction sortAllFragments() {\r\n\r\n\t\tvar horizontalSlides = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ) );\r\n\t\thorizontalSlides.forEach( function( horizontalSlide ) {\r\n\r\n\t\t\tvar verticalSlides = toArray( horizontalSlide.querySelectorAll( 'section' ) );\r\n\t\t\tverticalSlides.forEach( function( verticalSlide, y ) {\r\n\r\n\t\t\t\tsortFragments( verticalSlide.querySelectorAll( '.fragment' ) );\r\n\r\n\t\t\t} );\r\n\r\n\t\t\tif( verticalSlides.length === 0 ) sortFragments( horizontalSlide.querySelectorAll( '.fragment' ) );\r\n\r\n\t\t} );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates one dimension of slides by showing the slide\r\n\t * with the specified index.\r\n\t *\r\n\t * @param {String} selector A CSS selector that will fetch\r\n\t * the group of slides we are working with\r\n\t * @param {Number} index The index of the slide that should be\r\n\t * shown\r\n\t *\r\n\t * @return {Number} The index of the slide that is now shown,\r\n\t * might differ from the passed in index if it was out of\r\n\t * bounds.\r\n\t */\r\n\tfunction updateSlides( selector, index ) {\r\n\r\n\t\t// Select all slides and convert the NodeList result to\r\n\t\t// an array\r\n\t\tvar slides = toArray( dom.wrapper.querySelectorAll( selector ) ),\r\n\t\t\tslidesLength = slides.length;\r\n\r\n\t\tvar printMode = isPrintingPDF();\r\n\r\n\t\tif( slidesLength ) {\r\n\r\n\t\t\t// Should the index loop?\r\n\t\t\tif( config.loop ) {\r\n\t\t\t\tindex %= slidesLength;\r\n\r\n\t\t\t\tif( index < 0 ) {\r\n\t\t\t\t\tindex = slidesLength + index;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Enforce max and minimum index bounds\r\n\t\t\tindex = Math.max( Math.min( index, slidesLength - 1 ), 0 );\r\n\r\n\t\t\tfor( var i = 0; i < slidesLength; i++ ) {\r\n\t\t\t\tvar element = slides[i];\r\n\r\n\t\t\t\tvar reverse = config.rtl && !isVerticalSlide( element );\r\n\r\n\t\t\t\telement.classList.remove( 'past' );\r\n\t\t\t\telement.classList.remove( 'present' );\r\n\t\t\t\telement.classList.remove( 'future' );\r\n\r\n\t\t\t\t// http://www.w3.org/html/wg/drafts/html/master/editing.html#the-hidden-attribute\r\n\t\t\t\telement.setAttribute( 'hidden', '' );\r\n\t\t\t\telement.setAttribute( 'aria-hidden', 'true' );\r\n\r\n\t\t\t\t// If this element contains vertical slides\r\n\t\t\t\tif( element.querySelector( 'section' ) ) {\r\n\t\t\t\t\telement.classList.add( 'stack' );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If we're printing static slides, all slides are \"present\"\r\n\t\t\t\tif( printMode ) {\r\n\t\t\t\t\telement.classList.add( 'present' );\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( i < index ) {\r\n\t\t\t\t\t// Any element previous to index is given the 'past' class\r\n\t\t\t\t\telement.classList.add( reverse ? 'future' : 'past' );\r\n\r\n\t\t\t\t\tif( config.fragments ) {\r\n\t\t\t\t\t\tvar pastFragments = toArray( element.querySelectorAll( '.fragment' ) );\r\n\r\n\t\t\t\t\t\t// Show all fragments on prior slides\r\n\t\t\t\t\t\twhile( pastFragments.length ) {\r\n\t\t\t\t\t\t\tvar pastFragment = pastFragments.pop();\r\n\t\t\t\t\t\t\tpastFragment.classList.add( 'visible' );\r\n\t\t\t\t\t\t\tpastFragment.classList.remove( 'current-fragment' );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse if( i > index ) {\r\n\t\t\t\t\t// Any element subsequent to index is given the 'future' class\r\n\t\t\t\t\telement.classList.add( reverse ? 'past' : 'future' );\r\n\r\n\t\t\t\t\tif( config.fragments ) {\r\n\t\t\t\t\t\tvar futureFragments = toArray( element.querySelectorAll( '.fragment.visible' ) );\r\n\r\n\t\t\t\t\t\t// No fragments in future slides should be visible ahead of time\r\n\t\t\t\t\t\twhile( futureFragments.length ) {\r\n\t\t\t\t\t\t\tvar futureFragment = futureFragments.pop();\r\n\t\t\t\t\t\t\tfutureFragment.classList.remove( 'visible' );\r\n\t\t\t\t\t\t\tfutureFragment.classList.remove( 'current-fragment' );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Mark the current slide as present\r\n\t\t\tslides[index].classList.add( 'present' );\r\n\t\t\tslides[index].removeAttribute( 'hidden' );\r\n\t\t\tslides[index].removeAttribute( 'aria-hidden' );\r\n\r\n\t\t\t// If this slide has a state associated with it, add it\r\n\t\t\t// onto the current state of the deck\r\n\t\t\tvar slideState = slides[index].getAttribute( 'data-state' );\r\n\t\t\tif( slideState ) {\r\n\t\t\t\tstate = state.concat( slideState.split( ' ' ) );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Since there are no slides we can't be anywhere beyond the\r\n\t\t\t// zeroth index\r\n\t\t\tindex = 0;\r\n\t\t}\r\n\r\n\t\treturn index;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Optimization method; hide all slides that are far away\r\n\t * from the present slide.\r\n\t */\r\n\tfunction updateSlidesVisibility() {\r\n\r\n\t\t// Select all slides and convert the NodeList result to\r\n\t\t// an array\r\n\t\tvar horizontalSlides = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ) ),\r\n\t\t\thorizontalSlidesLength = horizontalSlides.length,\r\n\t\t\tdistanceX,\r\n\t\t\tdistanceY;\r\n\r\n\t\tif( horizontalSlidesLength && typeof indexh !== 'undefined' ) {\r\n\r\n\t\t\t// The number of steps away from the present slide that will\r\n\t\t\t// be visible\r\n\t\t\tvar viewDistance = isOverview() ? 10 : config.viewDistance;\r\n\r\n\t\t\t// Limit view distance on weaker devices\r\n\t\t\tif( isMobileDevice ) {\r\n\t\t\t\tviewDistance = isOverview() ? 6 : 2;\r\n\t\t\t}\r\n\r\n\t\t\t// All slides need to be visible when exporting to PDF\r\n\t\t\tif( isPrintingPDF() ) {\r\n\t\t\t\tviewDistance = Number.MAX_VALUE;\r\n\t\t\t}\r\n\r\n\t\t\tfor( var x = 0; x < horizontalSlidesLength; x++ ) {\r\n\t\t\t\tvar horizontalSlide = horizontalSlides[x];\r\n\r\n\t\t\t\tvar verticalSlides = toArray( horizontalSlide.querySelectorAll( 'section' ) ),\r\n\t\t\t\t\tverticalSlidesLength = verticalSlides.length;\r\n\r\n\t\t\t\t// Determine how far away this slide is from the present\r\n\t\t\t\tdistanceX = Math.abs( ( indexh || 0 ) - x ) || 0;\r\n\r\n\t\t\t\t// If the presentation is looped, distance should measure\r\n\t\t\t\t// 1 between the first and last slides\r\n\t\t\t\tif( config.loop ) {\r\n\t\t\t\t\tdistanceX = Math.abs( ( ( indexh || 0 ) - x ) % ( horizontalSlidesLength - viewDistance ) ) || 0;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Show the horizontal slide if it's within the view distance\r\n\t\t\t\tif( distanceX < viewDistance ) {\r\n\t\t\t\t\tshowSlide( horizontalSlide );\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\thideSlide( horizontalSlide );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( verticalSlidesLength ) {\r\n\r\n\t\t\t\t\tvar oy = getPreviousVerticalIndex( horizontalSlide );\r\n\r\n\t\t\t\t\tfor( var y = 0; y < verticalSlidesLength; y++ ) {\r\n\t\t\t\t\t\tvar verticalSlide = verticalSlides[y];\r\n\r\n\t\t\t\t\t\tdistanceY = x === ( indexh || 0 ) ? Math.abs( ( indexv || 0 ) - y ) : Math.abs( y - oy );\r\n\r\n\t\t\t\t\t\tif( distanceX + distanceY < viewDistance ) {\r\n\t\t\t\t\t\t\tshowSlide( verticalSlide );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\thideSlide( verticalSlide );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the progress bar to reflect the current slide.\r\n\t */\r\n\tfunction updateProgress() {\r\n\r\n\t\t// Update progress if enabled\r\n\t\tif( config.progress && dom.progressbar ) {\r\n\r\n\t\t\tdom.progressbar.style.width = getProgress() * dom.wrapper.offsetWidth + 'px';\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the slide number div to reflect the current slide.\r\n\t *\r\n\t * Slide number format can be defined as a string using the\r\n\t * following variables:\r\n\t *  h: current slide's horizontal index\r\n\t *  v: current slide's vertical index\r\n\t *  c: current slide index (flattened)\r\n\t *  t: total number of slides (flattened)\r\n\t */\r\n\tfunction updateSlideNumber() {\r\n\r\n\t\t// Update slide number if enabled\r\n\t\tif( config.slideNumber && dom.slideNumber) {\r\n\r\n\t\t\t// Default to only showing the current slide number\r\n\t\t\tvar format = 'c';\r\n\r\n\t\t\t// Check if a custom slide number format is available\r\n\t\t\tif( typeof config.slideNumber === 'string' ) {\r\n\t\t\t\tformat = config.slideNumber;\r\n\t\t\t}\r\n\r\n\t\t\tdom.slideNumber.innerHTML = format.replace( /h/g, indexh )\r\n\t\t\t\t\t\t\t\t\t\t\t\t.replace( /v/g, indexv )\r\n\t\t\t\t\t\t\t\t\t\t\t\t.replace( /c/g, getSlidePastCount() + 1 )\r\n\t\t\t\t\t\t\t\t\t\t\t\t.replace( /t/g, getTotalSlides() );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the state of all control/navigation arrows.\r\n\t */\r\n\tfunction updateControls() {\r\n\r\n\t\tvar routes = availableRoutes();\r\n\t\tvar fragments = availableFragments();\r\n\r\n\t\t// Remove the 'enabled' class from all directions\r\n\t\tdom.controlsLeft.concat( dom.controlsRight )\r\n\t\t\t\t\t\t.concat( dom.controlsUp )\r\n\t\t\t\t\t\t.concat( dom.controlsDown )\r\n\t\t\t\t\t\t.concat( dom.controlsPrev )\r\n\t\t\t\t\t\t.concat( dom.controlsNext ).forEach( function( node ) {\r\n\t\t\tnode.classList.remove( 'enabled' );\r\n\t\t\tnode.classList.remove( 'fragmented' );\r\n\t\t} );\r\n\r\n\t\t// Add the 'enabled' class to the available routes\r\n\t\tif( routes.left ) dom.controlsLeft.forEach( function( el ) { el.classList.add( 'enabled' );\t} );\r\n\t\tif( routes.right ) dom.controlsRight.forEach( function( el ) { el.classList.add( 'enabled' ); } );\r\n\t\tif( routes.up ) dom.controlsUp.forEach( function( el ) { el.classList.add( 'enabled' );\t} );\r\n\t\tif( routes.down ) dom.controlsDown.forEach( function( el ) { el.classList.add( 'enabled' ); } );\r\n\r\n\t\t// Prev/next buttons\r\n\t\tif( routes.left || routes.up ) dom.controlsPrev.forEach( function( el ) { el.classList.add( 'enabled' ); } );\r\n\t\tif( routes.right || routes.down ) dom.controlsNext.forEach( function( el ) { el.classList.add( 'enabled' ); } );\r\n\r\n\t\t// Highlight fragment directions\r\n\t\tif( currentSlide ) {\r\n\r\n\t\t\t// Always apply fragment decorator to prev/next buttons\r\n\t\t\tif( fragments.prev ) dom.controlsPrev.forEach( function( el ) { el.classList.add( 'fragmented', 'enabled' ); } );\r\n\t\t\tif( fragments.next ) dom.controlsNext.forEach( function( el ) { el.classList.add( 'fragmented', 'enabled' ); } );\r\n\r\n\t\t\t// Apply fragment decorators to directional buttons based on\r\n\t\t\t// what slide axis they are in\r\n\t\t\tif( isVerticalSlide( currentSlide ) ) {\r\n\t\t\t\tif( fragments.prev ) dom.controlsUp.forEach( function( el ) { el.classList.add( 'fragmented', 'enabled' ); } );\r\n\t\t\t\tif( fragments.next ) dom.controlsDown.forEach( function( el ) { el.classList.add( 'fragmented', 'enabled' ); } );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tif( fragments.prev ) dom.controlsLeft.forEach( function( el ) { el.classList.add( 'fragmented', 'enabled' ); } );\r\n\t\t\t\tif( fragments.next ) dom.controlsRight.forEach( function( el ) { el.classList.add( 'fragmented', 'enabled' ); } );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the background elements to reflect the current\r\n\t * slide.\r\n\t *\r\n\t * @param {Boolean} includeAll If true, the backgrounds of\r\n\t * all vertical slides (not just the present) will be updated.\r\n\t */\r\n\tfunction updateBackground( includeAll ) {\r\n\r\n\t\tvar currentBackground = null;\r\n\r\n\t\t// Reverse past/future classes when in RTL mode\r\n\t\tvar horizontalPast = config.rtl ? 'future' : 'past',\r\n\t\t\thorizontalFuture = config.rtl ? 'past' : 'future';\r\n\r\n\t\t// Update the classes of all backgrounds to match the\r\n\t\t// states of their slides (past/present/future)\r\n\t\ttoArray( dom.background.childNodes ).forEach( function( backgroundh, h ) {\r\n\r\n\t\t\tbackgroundh.classList.remove( 'past' );\r\n\t\t\tbackgroundh.classList.remove( 'present' );\r\n\t\t\tbackgroundh.classList.remove( 'future' );\r\n\r\n\t\t\tif( h < indexh ) {\r\n\t\t\t\tbackgroundh.classList.add( horizontalPast );\r\n\t\t\t}\r\n\t\t\telse if ( h > indexh ) {\r\n\t\t\t\tbackgroundh.classList.add( horizontalFuture );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tbackgroundh.classList.add( 'present' );\r\n\r\n\t\t\t\t// Store a reference to the current background element\r\n\t\t\t\tcurrentBackground = backgroundh;\r\n\t\t\t}\r\n\r\n\t\t\tif( includeAll || h === indexh ) {\r\n\t\t\t\ttoArray( backgroundh.querySelectorAll( '.slide-background' ) ).forEach( function( backgroundv, v ) {\r\n\r\n\t\t\t\t\tbackgroundv.classList.remove( 'past' );\r\n\t\t\t\t\tbackgroundv.classList.remove( 'present' );\r\n\t\t\t\t\tbackgroundv.classList.remove( 'future' );\r\n\r\n\t\t\t\t\tif( v < indexv ) {\r\n\t\t\t\t\t\tbackgroundv.classList.add( 'past' );\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if ( v > indexv ) {\r\n\t\t\t\t\t\tbackgroundv.classList.add( 'future' );\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tbackgroundv.classList.add( 'present' );\r\n\r\n\t\t\t\t\t\t// Only if this is the present horizontal and vertical slide\r\n\t\t\t\t\t\tif( h === indexh ) currentBackground = backgroundv;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t} );\r\n\r\n\t\t// Stop any currently playing video background\r\n\t\tif( previousBackground ) {\r\n\r\n\t\t\tvar previousVideo = previousBackground.querySelector( 'video' );\r\n\t\t\tif( previousVideo ) previousVideo.pause();\r\n\r\n\t\t}\r\n\r\n\t\tif( currentBackground ) {\r\n\r\n\t\t\t// Start video playback\r\n\t\t\tvar currentVideo = currentBackground.querySelector( 'video' );\r\n\t\t\tif( currentVideo ) {\r\n\t\t\t\tcurrentVideo.currentTime = 0;\r\n\t\t\t\tcurrentVideo.play();\r\n\t\t\t}\r\n\r\n\t\t\tvar backgroundImageURL = currentBackground.style.backgroundImage || '';\r\n\r\n\t\t\t// Restart GIFs (doesn't work in Firefox)\r\n\t\t\tif( /\\.gif/i.test( backgroundImageURL ) ) {\r\n\t\t\t\tcurrentBackground.style.backgroundImage = '';\r\n\t\t\t\twindow.getComputedStyle( currentBackground ).opacity;\r\n\t\t\t\tcurrentBackground.style.backgroundImage = backgroundImageURL;\r\n\t\t\t}\r\n\r\n\t\t\t// Don't transition between identical backgrounds. This\r\n\t\t\t// prevents unwanted flicker.\r\n\t\t\tvar previousBackgroundHash = previousBackground ? previousBackground.getAttribute( 'data-background-hash' ) : null;\r\n\t\t\tvar currentBackgroundHash = currentBackground.getAttribute( 'data-background-hash' );\r\n\t\t\tif( currentBackgroundHash && currentBackgroundHash === previousBackgroundHash && currentBackground !== previousBackground ) {\r\n\t\t\t\tdom.background.classList.add( 'no-transition' );\r\n\t\t\t}\r\n\r\n\t\t\tpreviousBackground = currentBackground;\r\n\r\n\t\t}\r\n\r\n\t\t// If there's a background brightness flag for this slide,\r\n\t\t// bubble it to the .reveal container\r\n\t\tif( currentSlide ) {\r\n\t\t\t[ 'has-light-background', 'has-dark-background' ].forEach( function( classToBubble ) {\r\n\t\t\t\tif( currentSlide.classList.contains( classToBubble ) ) {\r\n\t\t\t\t\tdom.wrapper.classList.add( classToBubble );\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdom.wrapper.classList.remove( classToBubble );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t\t// Allow the first background to apply without transition\r\n\t\tsetTimeout( function() {\r\n\t\t\tdom.background.classList.remove( 'no-transition' );\r\n\t\t}, 1 );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the position of the parallax background based\r\n\t * on the current slide index.\r\n\t */\r\n\tfunction updateParallax() {\r\n\r\n\t\tif( config.parallaxBackgroundImage ) {\r\n\r\n\t\t\tvar horizontalSlides = dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ),\r\n\t\t\t\tverticalSlides = dom.wrapper.querySelectorAll( VERTICAL_SLIDES_SELECTOR );\r\n\r\n\t\t\tvar backgroundSize = dom.background.style.backgroundSize.split( ' ' ),\r\n\t\t\t\tbackgroundWidth, backgroundHeight;\r\n\r\n\t\t\tif( backgroundSize.length === 1 ) {\r\n\t\t\t\tbackgroundWidth = backgroundHeight = parseInt( backgroundSize[0], 10 );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tbackgroundWidth = parseInt( backgroundSize[0], 10 );\r\n\t\t\t\tbackgroundHeight = parseInt( backgroundSize[1], 10 );\r\n\t\t\t}\r\n\r\n\t\t\tvar slideWidth = dom.background.offsetWidth,\r\n\t\t\t\thorizontalSlideCount = horizontalSlides.length,\r\n\t\t\t\thorizontalOffsetMultiplier,\r\n\t\t\t\thorizontalOffset;\r\n\r\n\t\t\tif( typeof config.parallaxBackgroundHorizontal === 'number' ) {\r\n\t\t\t\thorizontalOffsetMultiplier = config.parallaxBackgroundHorizontal;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\thorizontalOffsetMultiplier = ( backgroundWidth - slideWidth ) / ( horizontalSlideCount-1 );\r\n\t\t\t}\r\n\r\n\t\t\thorizontalOffset = horizontalOffsetMultiplier * indexh * -1;\r\n\r\n\t\t\tvar slideHeight = dom.background.offsetHeight,\r\n\t\t\t\tverticalSlideCount = verticalSlides.length,\r\n\t\t\t\tverticalOffsetMultiplier,\r\n\t\t\t\tverticalOffset;\r\n\r\n\t\t\tif( typeof config.parallaxBackgroundVertical === 'number' ) {\r\n\t\t\t\tverticalOffsetMultiplier = config.parallaxBackgroundVertical;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tverticalOffsetMultiplier = ( backgroundHeight - slideHeight ) / ( verticalSlideCount-1 );\r\n\t\t\t}\r\n\r\n\t\t\tverticalOffset = verticalSlideCount > 0 ?  verticalOffsetMultiplier * indexv * 1 : 0;\r\n\r\n\t\t\tdom.background.style.backgroundPosition = horizontalOffset + 'px ' + -verticalOffset + 'px';\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Called when the given slide is within the configured view\r\n\t * distance. Shows the slide element and loads any content\r\n\t * that is set to load lazily (data-src).\r\n\t */\r\n\tfunction showSlide( slide ) {\r\n\r\n\t\t// Show the slide element\r\n\t\tslide.style.display = 'block';\r\n\r\n\t\t// Media elements with data-src attributes\r\n\t\ttoArray( slide.querySelectorAll( 'img[data-src], video[data-src], audio[data-src]' ) ).forEach( function( element ) {\r\n\t\t\telement.setAttribute( 'src', element.getAttribute( 'data-src' ) );\r\n\t\t\telement.removeAttribute( 'data-src' );\r\n\t\t} );\r\n\r\n\t\t// Media elements with <source> children\r\n\t\ttoArray( slide.querySelectorAll( 'video, audio' ) ).forEach( function( media ) {\r\n\t\t\tvar sources = 0;\r\n\r\n\t\t\ttoArray( media.querySelectorAll( 'source[data-src]' ) ).forEach( function( source ) {\r\n\t\t\t\tsource.setAttribute( 'src', source.getAttribute( 'data-src' ) );\r\n\t\t\t\tsource.removeAttribute( 'data-src' );\r\n\t\t\t\tsources += 1;\r\n\t\t\t} );\r\n\r\n\t\t\t// If we rewrote sources for this video/audio element, we need\r\n\t\t\t// to manually tell it to load from its new origin\r\n\t\t\tif( sources > 0 ) {\r\n\t\t\t\tmedia.load();\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\r\n\t\t// Show the corresponding background element\r\n\t\tvar indices = getIndices( slide );\r\n\t\tvar background = getSlideBackground( indices.h, indices.v );\r\n\t\tif( background ) {\r\n\t\t\tbackground.style.display = 'block';\r\n\r\n\t\t\t// If the background contains media, load it\r\n\t\t\tif( background.hasAttribute( 'data-loaded' ) === false ) {\r\n\t\t\t\tbackground.setAttribute( 'data-loaded', 'true' );\r\n\r\n\t\t\t\tvar backgroundImage = slide.getAttribute( 'data-background-image' ),\r\n\t\t\t\t\tbackgroundVideo = slide.getAttribute( 'data-background-video' ),\r\n\t\t\t\t\tbackgroundVideoLoop = slide.hasAttribute( 'data-background-video-loop' ),\r\n\t\t\t\t\tbackgroundIframe = slide.getAttribute( 'data-background-iframe' );\r\n\r\n\t\t\t\t// Images\r\n\t\t\t\tif( backgroundImage ) {\r\n\t\t\t\t\tbackground.style.backgroundImage = 'url('+ backgroundImage +')';\r\n\t\t\t\t}\r\n\t\t\t\t// Videos\r\n\t\t\t\telse if ( backgroundVideo && !isSpeakerNotes() ) {\r\n\t\t\t\t\tvar video = document.createElement( 'video' );\r\n\r\n\t\t\t\t\tif( backgroundVideoLoop ) {\r\n\t\t\t\t\t\tvideo.setAttribute( 'loop', '' );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Support comma separated lists of video sources\r\n\t\t\t\t\tbackgroundVideo.split( ',' ).forEach( function( source ) {\r\n\t\t\t\t\t\tvideo.innerHTML += '<source src=\"'+ source +'\">';\r\n\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tbackground.appendChild( video );\r\n\t\t\t\t}\r\n\t\t\t\t// Iframes\r\n\t\t\t\telse if( backgroundIframe ) {\r\n\t\t\t\t\tvar iframe = document.createElement( 'iframe' );\r\n\t\t\t\t\t\tiframe.setAttribute( 'src', backgroundIframe );\r\n\t\t\t\t\t\tiframe.style.width  = '100%';\r\n\t\t\t\t\t\tiframe.style.height = '100%';\r\n\t\t\t\t\t\tiframe.style.maxHeight = '100%';\r\n\t\t\t\t\t\tiframe.style.maxWidth = '100%';\r\n\r\n\t\t\t\t\tbackground.appendChild( iframe );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Called when the given slide is moved outside of the\r\n\t * configured view distance.\r\n\t */\r\n\tfunction hideSlide( slide ) {\r\n\r\n\t\t// Hide the slide element\r\n\t\tslide.style.display = 'none';\r\n\r\n\t\t// Hide the corresponding background element\r\n\t\tvar indices = getIndices( slide );\r\n\t\tvar background = getSlideBackground( indices.h, indices.v );\r\n\t\tif( background ) {\r\n\t\t\tbackground.style.display = 'none';\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Determine what available routes there are for navigation.\r\n\t *\r\n\t * @return {Object} containing four booleans: left/right/up/down\r\n\t */\r\n\tfunction availableRoutes() {\r\n\r\n\t\tvar horizontalSlides = dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ),\r\n\t\t\tverticalSlides = dom.wrapper.querySelectorAll( VERTICAL_SLIDES_SELECTOR );\r\n\r\n\t\tvar routes = {\r\n\t\t\tleft: indexh > 0 || config.loop,\r\n\t\t\tright: indexh < horizontalSlides.length - 1 || config.loop,\r\n\t\t\tup: indexv > 0,\r\n\t\t\tdown: indexv < verticalSlides.length - 1\r\n\t\t};\r\n\r\n\t\t// reverse horizontal controls for rtl\r\n\t\tif( config.rtl ) {\r\n\t\t\tvar left = routes.left;\r\n\t\t\troutes.left = routes.right;\r\n\t\t\troutes.right = left;\r\n\t\t}\r\n\r\n\t\treturn routes;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns an object describing the available fragment\r\n\t * directions.\r\n\t *\r\n\t * @return {Object} two boolean properties: prev/next\r\n\t */\r\n\tfunction availableFragments() {\r\n\r\n\t\tif( currentSlide && config.fragments ) {\r\n\t\t\tvar fragments = currentSlide.querySelectorAll( '.fragment' );\r\n\t\t\tvar hiddenFragments = currentSlide.querySelectorAll( '.fragment:not(.visible)' );\r\n\r\n\t\t\treturn {\r\n\t\t\t\tprev: fragments.length - hiddenFragments.length > 0,\r\n\t\t\t\tnext: !!hiddenFragments.length\r\n\t\t\t};\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn { prev: false, next: false };\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Enforces origin-specific format rules for embedded media.\r\n\t */\r\n\tfunction formatEmbeddedContent() {\r\n\r\n\t\tvar _appendParamToIframeSource = function( sourceAttribute, sourceURL, param ) {\r\n\t\t\ttoArray( dom.slides.querySelectorAll( 'iframe['+ sourceAttribute +'*=\"'+ sourceURL +'\"]' ) ).forEach( function( el ) {\r\n\t\t\t\tvar src = el.getAttribute( sourceAttribute );\r\n\t\t\t\tif( src && src.indexOf( param ) === -1 ) {\r\n\t\t\t\t\tel.setAttribute( sourceAttribute, src + ( !/\\?/.test( src ) ? '?' : '&' ) + param );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t};\r\n\r\n\t\t// YouTube frames must include \"?enablejsapi=1\"\r\n\t\t_appendParamToIframeSource( 'src', 'youtube.com/embed/', 'enablejsapi=1' );\r\n\t\t_appendParamToIframeSource( 'data-src', 'youtube.com/embed/', 'enablejsapi=1' );\r\n\r\n\t\t// Vimeo frames must include \"?api=1\"\r\n\t\t_appendParamToIframeSource( 'src', 'player.vimeo.com/', 'api=1' );\r\n\t\t_appendParamToIframeSource( 'data-src', 'player.vimeo.com/', 'api=1' );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Start playback of any embedded content inside of\r\n\t * the targeted slide.\r\n\t */\r\n\tfunction startEmbeddedContent( slide ) {\r\n\r\n\t\tif( slide && !isSpeakerNotes() ) {\r\n\t\t\t// Restart GIFs\r\n\t\t\ttoArray( slide.querySelectorAll( 'img[src$=\".gif\"]' ) ).forEach( function( el ) {\r\n\t\t\t\t// Setting the same unchanged source like this was confirmed\r\n\t\t\t\t// to work in Chrome, FF & Safari\r\n\t\t\t\tel.setAttribute( 'src', el.getAttribute( 'src' ) );\r\n\t\t\t} );\r\n\r\n\t\t\t// HTML5 media elements\r\n\t\t\ttoArray( slide.querySelectorAll( 'video, audio' ) ).forEach( function( el ) {\r\n\t\t\t\tif( el.hasAttribute( 'data-autoplay' ) && typeof el.play === 'function' ) {\r\n\t\t\t\t\tel.play();\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\t// Normal iframes\r\n\t\t\ttoArray( slide.querySelectorAll( 'iframe[src]' ) ).forEach( function( el ) {\r\n\t\t\t\tstartEmbeddedIframe( { target: el } );\r\n\t\t\t} );\r\n\r\n\t\t\t// Lazy loading iframes\r\n\t\t\ttoArray( slide.querySelectorAll( 'iframe[data-src]' ) ).forEach( function( el ) {\r\n\t\t\t\tif( el.getAttribute( 'src' ) !== el.getAttribute( 'data-src' ) ) {\r\n\t\t\t\t\tel.removeEventListener( 'load', startEmbeddedIframe ); // remove first to avoid dupes\r\n\t\t\t\t\tel.addEventListener( 'load', startEmbeddedIframe );\r\n\t\t\t\t\tel.setAttribute( 'src', el.getAttribute( 'data-src' ) );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * \"Starts\" the content of an embedded iframe using the\r\n\t * postmessage API.\r\n\t */\r\n\tfunction startEmbeddedIframe( event ) {\r\n\r\n\t\tvar iframe = event.target;\r\n\r\n\t\t// YouTube postMessage API\r\n\t\tif( /youtube\\.com\\/embed\\//.test( iframe.getAttribute( 'src' ) ) && iframe.hasAttribute( 'data-autoplay' ) ) {\r\n\t\t\tiframe.contentWindow.postMessage( '{\"event\":\"command\",\"func\":\"playVideo\",\"args\":\"\"}', '*' );\r\n\t\t}\r\n\t\t// Vimeo postMessage API\r\n\t\telse if( /player\\.vimeo\\.com\\//.test( iframe.getAttribute( 'src' ) ) && iframe.hasAttribute( 'data-autoplay' ) ) {\r\n\t\t\tiframe.contentWindow.postMessage( '{\"method\":\"play\"}', '*' );\r\n\t\t}\r\n\t\t// Generic postMessage API\r\n\t\telse {\r\n\t\t\tiframe.contentWindow.postMessage( 'slide:start', '*' );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Stop playback of any embedded content inside of\r\n\t * the targeted slide.\r\n\t */\r\n\tfunction stopEmbeddedContent( slide ) {\r\n\r\n\t\tif( slide && slide.parentNode ) {\r\n\t\t\t// HTML5 media elements\r\n\t\t\ttoArray( slide.querySelectorAll( 'video, audio' ) ).forEach( function( el ) {\r\n\t\t\t\tif( !el.hasAttribute( 'data-ignore' ) && typeof el.pause === 'function' ) {\r\n\t\t\t\t\tel.pause();\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\t// Generic postMessage API for non-lazy loaded iframes\r\n\t\t\ttoArray( slide.querySelectorAll( 'iframe' ) ).forEach( function( el ) {\r\n\t\t\t\tel.contentWindow.postMessage( 'slide:stop', '*' );\r\n\t\t\t\tel.removeEventListener( 'load', startEmbeddedIframe );\r\n\t\t\t});\r\n\r\n\t\t\t// YouTube postMessage API\r\n\t\t\ttoArray( slide.querySelectorAll( 'iframe[src*=\"youtube.com/embed/\"]' ) ).forEach( function( el ) {\r\n\t\t\t\tif( !el.hasAttribute( 'data-ignore' ) && typeof el.contentWindow.postMessage === 'function' ) {\r\n\t\t\t\t\tel.contentWindow.postMessage( '{\"event\":\"command\",\"func\":\"pauseVideo\",\"args\":\"\"}', '*' );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Vimeo postMessage API\r\n\t\t\ttoArray( slide.querySelectorAll( 'iframe[src*=\"player.vimeo.com/\"]' ) ).forEach( function( el ) {\r\n\t\t\t\tif( !el.hasAttribute( 'data-ignore' ) && typeof el.contentWindow.postMessage === 'function' ) {\r\n\t\t\t\t\tel.contentWindow.postMessage( '{\"method\":\"pause\"}', '*' );\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Lazy loading iframes\r\n\t\t\ttoArray( slide.querySelectorAll( 'iframe[data-src]' ) ).forEach( function( el ) {\r\n\t\t\t\t// Only removing the src doesn't actually unload the frame\r\n\t\t\t\t// in all browsers (Firefox) so we set it to blank first\r\n\t\t\t\tel.setAttribute( 'src', 'about:blank' );\r\n\t\t\t\tel.removeAttribute( 'src' );\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the number of past slides. This can be used as a global\r\n\t * flattened index for slides.\r\n\t */\r\n\tfunction getSlidePastCount() {\r\n\r\n\t\tvar horizontalSlides = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ) );\r\n\r\n\t\t// The number of past slides\r\n\t\tvar pastCount = 0;\r\n\r\n\t\t// Step through all slides and count the past ones\r\n\t\tmainLoop: for( var i = 0; i < horizontalSlides.length; i++ ) {\r\n\r\n\t\t\tvar horizontalSlide = horizontalSlides[i];\r\n\t\t\tvar verticalSlides = toArray( horizontalSlide.querySelectorAll( 'section' ) );\r\n\r\n\t\t\tfor( var j = 0; j < verticalSlides.length; j++ ) {\r\n\r\n\t\t\t\t// Stop as soon as we arrive at the present\r\n\t\t\t\tif( verticalSlides[j].classList.contains( 'present' ) ) {\r\n\t\t\t\t\tbreak mainLoop;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpastCount++;\r\n\r\n\t\t\t}\r\n\r\n\t\t\t// Stop as soon as we arrive at the present\r\n\t\t\tif( horizontalSlide.classList.contains( 'present' ) ) {\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t// Don't count the wrapping section for vertical slides\r\n\t\t\tif( horizontalSlide.classList.contains( 'stack' ) === false ) {\r\n\t\t\t\tpastCount++;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn pastCount;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns a value ranging from 0-1 that represents\r\n\t * how far into the presentation we have navigated.\r\n\t */\r\n\tfunction getProgress() {\r\n\r\n\t\t// The number of past and total slides\r\n\t\tvar totalCount = getTotalSlides();\r\n\t\tvar pastCount = getSlidePastCount();\r\n\r\n\t\tif( currentSlide ) {\r\n\r\n\t\t\tvar allFragments = currentSlide.querySelectorAll( '.fragment' );\r\n\r\n\t\t\t// If there are fragments in the current slide those should be\r\n\t\t\t// accounted for in the progress.\r\n\t\t\tif( allFragments.length > 0 ) {\r\n\t\t\t\tvar visibleFragments = currentSlide.querySelectorAll( '.fragment.visible' );\r\n\r\n\t\t\t\t// This value represents how big a portion of the slide progress\r\n\t\t\t\t// that is made up by its fragments (0-1)\r\n\t\t\t\tvar fragmentWeight = 0.9;\r\n\r\n\t\t\t\t// Add fragment progress to the past slide count\r\n\t\t\t\tpastCount += ( visibleFragments.length / allFragments.length ) * fragmentWeight;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn pastCount / ( totalCount - 1 );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Checks if this presentation is running inside of the\r\n\t * speaker notes window.\r\n\t */\r\n\tfunction isSpeakerNotes() {\r\n\r\n\t\treturn !!window.location.search.match( /receiver/gi );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Reads the current URL (hash) and navigates accordingly.\r\n\t */\r\n\tfunction readURL() {\r\n\r\n\t\tvar hash = window.location.hash;\r\n\r\n\t\t// Attempt to parse the hash as either an index or name\r\n\t\tvar bits = hash.slice( 2 ).split( '/' ),\r\n\t\t\tname = hash.replace( /#|\\//gi, '' );\r\n\r\n\t\t// If the first bit is invalid and there is a name we can\r\n\t\t// assume that this is a named link\r\n\t\tif( isNaN( parseInt( bits[0], 10 ) ) && name.length ) {\r\n\t\t\tvar element;\r\n\r\n\t\t\t// Ensure the named link is a valid HTML ID attribute\r\n\t\t\tif( /^[a-zA-Z][\\w:.-]*$/.test( name ) ) {\r\n\t\t\t\t// Find the slide with the specified ID\r\n\t\t\t\telement = document.getElementById( name );\r\n\t\t\t}\r\n\r\n\t\t\tif( element ) {\r\n\t\t\t\t// Find the position of the named slide and navigate to it\r\n\t\t\t\tvar indices = Reveal.getIndices( element );\r\n\t\t\t\tslide( indices.h, indices.v );\r\n\t\t\t}\r\n\t\t\t// If the slide doesn't exist, navigate to the current slide\r\n\t\t\telse {\r\n\t\t\t\tslide( indexh || 0, indexv || 0 );\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Read the index components of the hash\r\n\t\t\tvar h = parseInt( bits[0], 10 ) || 0,\r\n\t\t\t\tv = parseInt( bits[1], 10 ) || 0;\r\n\r\n\t\t\tif( h !== indexh || v !== indexv ) {\r\n\t\t\t\tslide( h, v );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Updates the page URL (hash) to reflect the current\r\n\t * state.\r\n\t *\r\n\t * @param {Number} delay The time in ms to wait before\r\n\t * writing the hash\r\n\t */\r\n\tfunction writeURL( delay ) {\r\n\r\n\t\tif( config.history ) {\r\n\r\n\t\t\t// Make sure there's never more than one timeout running\r\n\t\t\tclearTimeout( writeURLTimeout );\r\n\r\n\t\t\t// If a delay is specified, timeout this call\r\n\t\t\tif( typeof delay === 'number' ) {\r\n\t\t\t\twriteURLTimeout = setTimeout( writeURL, delay );\r\n\t\t\t}\r\n\t\t\telse if( currentSlide ) {\r\n\t\t\t\tvar url = '/';\r\n\r\n\t\t\t\t// Attempt to create a named link based on the slide's ID\r\n\t\t\t\tvar id = currentSlide.getAttribute( 'id' );\r\n\t\t\t\tif( id ) {\r\n\t\t\t\t\tid = id.toLowerCase();\r\n\t\t\t\t\tid = id.replace( /[^a-zA-Z0-9\\-\\_\\:\\.]/g, '' );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If the current slide has an ID, use that as a named link\r\n\t\t\t\tif( typeof id === 'string' && id.length ) {\r\n\t\t\t\t\turl = '/' + id;\r\n\t\t\t\t}\r\n\t\t\t\t// Otherwise use the /h/v index\r\n\t\t\t\telse {\r\n\t\t\t\t\tif( indexh > 0 || indexv > 0 ) url += indexh;\r\n\t\t\t\t\tif( indexv > 0 ) url += '/' + indexv;\r\n\t\t\t\t}\r\n\r\n\t\t\t\twindow.location.hash = url;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves the h/v location of the current, or specified,\r\n\t * slide.\r\n\t *\r\n\t * @param {HTMLElement} slide If specified, the returned\r\n\t * index will be for this slide rather than the currently\r\n\t * active one\r\n\t *\r\n\t * @return {Object} { h: <int>, v: <int>, f: <int> }\r\n\t */\r\n\tfunction getIndices( slide ) {\r\n\r\n\t\t// By default, return the current indices\r\n\t\tvar h = indexh,\r\n\t\t\tv = indexv,\r\n\t\t\tf;\r\n\r\n\t\t// If a slide is specified, return the indices of that slide\r\n\t\tif( slide ) {\r\n\t\t\tvar isVertical = isVerticalSlide( slide );\r\n\t\t\tvar slideh = isVertical ? slide.parentNode : slide;\r\n\r\n\t\t\t// Select all horizontal slides\r\n\t\t\tvar horizontalSlides = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ) );\r\n\r\n\t\t\t// Now that we know which the horizontal slide is, get its index\r\n\t\t\th = Math.max( horizontalSlides.indexOf( slideh ), 0 );\r\n\r\n\t\t\t// Assume we're not vertical\r\n\t\t\tv = undefined;\r\n\r\n\t\t\t// If this is a vertical slide, grab the vertical index\r\n\t\t\tif( isVertical ) {\r\n\t\t\t\tv = Math.max( toArray( slide.parentNode.querySelectorAll( 'section' ) ).indexOf( slide ), 0 );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif( !slide && currentSlide ) {\r\n\t\t\tvar hasFragments = currentSlide.querySelectorAll( '.fragment' ).length > 0;\r\n\t\t\tif( hasFragments ) {\r\n\t\t\t\tvar currentFragment = currentSlide.querySelector( '.current-fragment' );\r\n\t\t\t\tif( currentFragment && currentFragment.hasAttribute( 'data-fragment-index' ) ) {\r\n\t\t\t\t\tf = parseInt( currentFragment.getAttribute( 'data-fragment-index' ), 10 );\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tf = currentSlide.querySelectorAll( '.fragment.visible' ).length - 1;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn { h: h, v: v, f: f };\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves the total number of slides in this presentation.\r\n\t */\r\n\tfunction getTotalSlides() {\r\n\r\n\t\treturn dom.wrapper.querySelectorAll( SLIDES_SELECTOR + ':not(.stack)' ).length;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the slide element matching the specified index.\r\n\t */\r\n\tfunction getSlide( x, y ) {\r\n\r\n\t\tvar horizontalSlide = dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR )[ x ];\r\n\t\tvar verticalSlides = horizontalSlide && horizontalSlide.querySelectorAll( 'section' );\r\n\r\n\t\tif( verticalSlides && verticalSlides.length && typeof y === 'number' ) {\r\n\t\t\treturn verticalSlides ? verticalSlides[ y ] : undefined;\r\n\t\t}\r\n\r\n\t\treturn horizontalSlide;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Returns the background element for the given slide.\r\n\t * All slides, even the ones with no background properties\r\n\t * defined, have a background element so as long as the\r\n\t * index is valid an element will be returned.\r\n\t */\r\n\tfunction getSlideBackground( x, y ) {\r\n\r\n\t\t// When printing to PDF the slide backgrounds are nested\r\n\t\t// inside of the slides\r\n\t\tif( isPrintingPDF() ) {\r\n\t\t\tvar slide = getSlide( x, y );\r\n\t\t\tif( slide ) {\r\n\t\t\t\tvar background = slide.querySelector( '.slide-background' );\r\n\t\t\t\tif( background && background.parentNode === slide ) {\r\n\t\t\t\t\treturn background;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn undefined;\r\n\t\t}\r\n\r\n\t\tvar horizontalBackground = dom.wrapper.querySelectorAll( '.backgrounds>.slide-background' )[ x ];\r\n\t\tvar verticalBackgrounds = horizontalBackground && horizontalBackground.querySelectorAll( '.slide-background' );\r\n\r\n\t\tif( verticalBackgrounds && verticalBackgrounds.length && typeof y === 'number' ) {\r\n\t\t\treturn verticalBackgrounds ? verticalBackgrounds[ y ] : undefined;\r\n\t\t}\r\n\r\n\t\treturn horizontalBackground;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Retrieves the current state of the presentation as\r\n\t * an object. This state can then be restored at any\r\n\t * time.\r\n\t */\r\n\tfunction getState() {\r\n\r\n\t\tvar indices = getIndices();\r\n\r\n\t\treturn {\r\n\t\t\tindexh: indices.h,\r\n\t\t\tindexv: indices.v,\r\n\t\t\tindexf: indices.f,\r\n\t\t\tpaused: isPaused(),\r\n\t\t\toverview: isOverview()\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Restores the presentation to the given state.\r\n\t *\r\n\t * @param {Object} state As generated by getState()\r\n\t */\r\n\tfunction setState( state ) {\r\n\r\n\t\tif( typeof state === 'object' ) {\r\n\t\t\tslide( deserialize( state.indexh ), deserialize( state.indexv ), deserialize( state.indexf ) );\r\n\r\n\t\t\tvar pausedFlag = deserialize( state.paused ),\r\n\t\t\t\toverviewFlag = deserialize( state.overview );\r\n\r\n\t\t\tif( typeof pausedFlag === 'boolean' && pausedFlag !== isPaused() ) {\r\n\t\t\t\ttogglePause( pausedFlag );\r\n\t\t\t}\r\n\r\n\t\t\tif( typeof overviewFlag === 'boolean' && overviewFlag !== isOverview() ) {\r\n\t\t\t\ttoggleOverview( overviewFlag );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Return a sorted fragments list, ordered by an increasing\r\n\t * \"data-fragment-index\" attribute.\r\n\t *\r\n\t * Fragments will be revealed in the order that they are returned by\r\n\t * this function, so you can use the index attributes to control the\r\n\t * order of fragment appearance.\r\n\t *\r\n\t * To maintain a sensible default fragment order, fragments are presumed\r\n\t * to be passed in document order. This function adds a \"fragment-index\"\r\n\t * attribute to each node if such an attribute is not already present,\r\n\t * and sets that attribute to an integer value which is the position of\r\n\t * the fragment within the fragments list.\r\n\t */\r\n\tfunction sortFragments( fragments ) {\r\n\r\n\t\tfragments = toArray( fragments );\r\n\r\n\t\tvar ordered = [],\r\n\t\t\tunordered = [],\r\n\t\t\tsorted = [];\r\n\r\n\t\t// Group ordered and unordered elements\r\n\t\tfragments.forEach( function( fragment, i ) {\r\n\t\t\tif( fragment.hasAttribute( 'data-fragment-index' ) ) {\r\n\t\t\t\tvar index = parseInt( fragment.getAttribute( 'data-fragment-index' ), 10 );\r\n\r\n\t\t\t\tif( !ordered[index] ) {\r\n\t\t\t\t\tordered[index] = [];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tordered[index].push( fragment );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tunordered.push( [ fragment ] );\r\n\t\t\t}\r\n\t\t} );\r\n\r\n\t\t// Append fragments without explicit indices in their\r\n\t\t// DOM order\r\n\t\tordered = ordered.concat( unordered );\r\n\r\n\t\t// Manually count the index up per group to ensure there\r\n\t\t// are no gaps\r\n\t\tvar index = 0;\r\n\r\n\t\t// Push all fragments in their sorted order to an array,\r\n\t\t// this flattens the groups\r\n\t\tordered.forEach( function( group ) {\r\n\t\t\tgroup.forEach( function( fragment ) {\r\n\t\t\t\tsorted.push( fragment );\r\n\t\t\t\tfragment.setAttribute( 'data-fragment-index', index );\r\n\t\t\t} );\r\n\r\n\t\t\tindex ++;\r\n\t\t} );\r\n\r\n\t\treturn sorted;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Navigate to the specified slide fragment.\r\n\t *\r\n\t * @param {Number} index The index of the fragment that\r\n\t * should be shown, -1 means all are invisible\r\n\t * @param {Number} offset Integer offset to apply to the\r\n\t * fragment index\r\n\t *\r\n\t * @return {Boolean} true if a change was made in any\r\n\t * fragments visibility as part of this call\r\n\t */\r\n\tfunction navigateFragment( index, offset ) {\r\n\r\n\t\tif( currentSlide && config.fragments ) {\r\n\r\n\t\t\tvar fragments = sortFragments( currentSlide.querySelectorAll( '.fragment' ) );\r\n\t\t\tif( fragments.length ) {\r\n\r\n\t\t\t\t// If no index is specified, find the current\r\n\t\t\t\tif( typeof index !== 'number' ) {\r\n\t\t\t\t\tvar lastVisibleFragment = sortFragments( currentSlide.querySelectorAll( '.fragment.visible' ) ).pop();\r\n\r\n\t\t\t\t\tif( lastVisibleFragment ) {\r\n\t\t\t\t\t\tindex = parseInt( lastVisibleFragment.getAttribute( 'data-fragment-index' ) || 0, 10 );\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tindex = -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If an offset is specified, apply it to the index\r\n\t\t\t\tif( typeof offset === 'number' ) {\r\n\t\t\t\t\tindex += offset;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar fragmentsShown = [],\r\n\t\t\t\t\tfragmentsHidden = [];\r\n\r\n\t\t\t\ttoArray( fragments ).forEach( function( element, i ) {\r\n\r\n\t\t\t\t\tif( element.hasAttribute( 'data-fragment-index' ) ) {\r\n\t\t\t\t\t\ti = parseInt( element.getAttribute( 'data-fragment-index' ), 10 );\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Visible fragments\r\n\t\t\t\t\tif( i <= index ) {\r\n\t\t\t\t\t\tif( !element.classList.contains( 'visible' ) ) fragmentsShown.push( element );\r\n\t\t\t\t\t\telement.classList.add( 'visible' );\r\n\t\t\t\t\t\telement.classList.remove( 'current-fragment' );\r\n\r\n\t\t\t\t\t\t// Announce the fragments one by one to the Screen Reader\r\n\t\t\t\t\t\tdom.statusDiv.textContent = element.textContent;\r\n\r\n\t\t\t\t\t\tif( i === index ) {\r\n\t\t\t\t\t\t\telement.classList.add( 'current-fragment' );\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// Hidden fragments\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tif( element.classList.contains( 'visible' ) ) fragmentsHidden.push( element );\r\n\t\t\t\t\t\telement.classList.remove( 'visible' );\r\n\t\t\t\t\t\telement.classList.remove( 'current-fragment' );\r\n\t\t\t\t\t}\r\n\r\n\r\n\t\t\t\t} );\r\n\r\n\t\t\t\tif( fragmentsHidden.length ) {\r\n\t\t\t\t\tdispatchEvent( 'fragmenthidden', { fragment: fragmentsHidden[0], fragments: fragmentsHidden } );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( fragmentsShown.length ) {\r\n\t\t\t\t\tdispatchEvent( 'fragmentshown', { fragment: fragmentsShown[0], fragments: fragmentsShown } );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tupdateControls();\r\n\t\t\t\tupdateProgress();\r\n\r\n\t\t\t\treturn !!( fragmentsShown.length || fragmentsHidden.length );\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Navigate to the next slide fragment.\r\n\t *\r\n\t * @return {Boolean} true if there was a next fragment,\r\n\t * false otherwise\r\n\t */\r\n\tfunction nextFragment() {\r\n\r\n\t\treturn navigateFragment( null, 1 );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Navigate to the previous slide fragment.\r\n\t *\r\n\t * @return {Boolean} true if there was a previous fragment,\r\n\t * false otherwise\r\n\t */\r\n\tfunction previousFragment() {\r\n\r\n\t\treturn navigateFragment( null, -1 );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Cues a new automated slide if enabled in the config.\r\n\t */\r\n\tfunction cueAutoSlide() {\r\n\r\n\t\tcancelAutoSlide();\r\n\r\n\t\tif( currentSlide ) {\r\n\r\n\t\t\tvar currentFragment = currentSlide.querySelector( '.current-fragment' );\r\n\r\n\t\t\tvar fragmentAutoSlide = currentFragment ? currentFragment.getAttribute( 'data-autoslide' ) : null;\r\n\t\t\tvar parentAutoSlide = currentSlide.parentNode ? currentSlide.parentNode.getAttribute( 'data-autoslide' ) : null;\r\n\t\t\tvar slideAutoSlide = currentSlide.getAttribute( 'data-autoslide' );\r\n\r\n\t\t\t// Pick value in the following priority order:\r\n\t\t\t// 1. Current fragment's data-autoslide\r\n\t\t\t// 2. Current slide's data-autoslide\r\n\t\t\t// 3. Parent slide's data-autoslide\r\n\t\t\t// 4. Global autoSlide setting\r\n\t\t\tif( fragmentAutoSlide ) {\r\n\t\t\t\tautoSlide = parseInt( fragmentAutoSlide, 10 );\r\n\t\t\t}\r\n\t\t\telse if( slideAutoSlide ) {\r\n\t\t\t\tautoSlide = parseInt( slideAutoSlide, 10 );\r\n\t\t\t}\r\n\t\t\telse if( parentAutoSlide ) {\r\n\t\t\t\tautoSlide = parseInt( parentAutoSlide, 10 );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tautoSlide = config.autoSlide;\r\n\t\t\t}\r\n\r\n\t\t\t// If there are media elements with data-autoplay,\r\n\t\t\t// automatically set the autoSlide duration to the\r\n\t\t\t// length of that media. Not applicable if the slide\r\n\t\t\t// is divided up into fragments.\r\n\t\t\tif( currentSlide.querySelectorAll( '.fragment' ).length === 0 ) {\r\n\t\t\t\ttoArray( currentSlide.querySelectorAll( 'video, audio' ) ).forEach( function( el ) {\r\n\t\t\t\t\tif( el.hasAttribute( 'data-autoplay' ) ) {\r\n\t\t\t\t\t\tif( autoSlide && el.duration * 1000 > autoSlide ) {\r\n\t\t\t\t\t\t\tautoSlide = ( el.duration * 1000 ) + 1000;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\t// Cue the next auto-slide if:\r\n\t\t\t// - There is an autoSlide value\r\n\t\t\t// - Auto-sliding isn't paused by the user\r\n\t\t\t// - The presentation isn't paused\r\n\t\t\t// - The overview isn't active\r\n\t\t\t// - The presentation isn't over\r\n\t\t\tif( autoSlide && !autoSlidePaused && !isPaused() && !isOverview() && ( !Reveal.isLastSlide() || availableFragments().next || config.loop === true ) ) {\r\n\t\t\t\tautoSlideTimeout = setTimeout( navigateNext, autoSlide );\r\n\t\t\t\tautoSlideStartTime = Date.now();\r\n\t\t\t}\r\n\r\n\t\t\tif( autoSlidePlayer ) {\r\n\t\t\t\tautoSlidePlayer.setPlaying( autoSlideTimeout !== -1 );\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Cancels any ongoing request to auto-slide.\r\n\t */\r\n\tfunction cancelAutoSlide() {\r\n\r\n\t\tclearTimeout( autoSlideTimeout );\r\n\t\tautoSlideTimeout = -1;\r\n\r\n\t}\r\n\r\n\tfunction pauseAutoSlide() {\r\n\r\n\t\tif( autoSlide && !autoSlidePaused ) {\r\n\t\t\tautoSlidePaused = true;\r\n\t\t\tdispatchEvent( 'autoslidepaused' );\r\n\t\t\tclearTimeout( autoSlideTimeout );\r\n\r\n\t\t\tif( autoSlidePlayer ) {\r\n\t\t\t\tautoSlidePlayer.setPlaying( false );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction resumeAutoSlide() {\r\n\r\n\t\tif( autoSlide && autoSlidePaused ) {\r\n\t\t\tautoSlidePaused = false;\r\n\t\t\tdispatchEvent( 'autoslideresumed' );\r\n\t\t\tcueAutoSlide();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction navigateLeft() {\r\n\r\n\t\t// Reverse for RTL\r\n\t\tif( config.rtl ) {\r\n\t\t\tif( ( isOverview() || nextFragment() === false ) && availableRoutes().left ) {\r\n\t\t\t\tslide( indexh + 1 );\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Normal navigation\r\n\t\telse if( ( isOverview() || previousFragment() === false ) && availableRoutes().left ) {\r\n\t\t\tslide( indexh - 1 );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction navigateRight() {\r\n\r\n\t\t// Reverse for RTL\r\n\t\tif( config.rtl ) {\r\n\t\t\tif( ( isOverview() || previousFragment() === false ) && availableRoutes().right ) {\r\n\t\t\t\tslide( indexh - 1 );\r\n\t\t\t}\r\n\t\t}\r\n\t\t// Normal navigation\r\n\t\telse if( ( isOverview() || nextFragment() === false ) && availableRoutes().right ) {\r\n\t\t\tslide( indexh + 1 );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction navigateUp() {\r\n\r\n\t\t// Prioritize hiding fragments\r\n\t\tif( ( isOverview() || previousFragment() === false ) && availableRoutes().up ) {\r\n\t\t\tslide( indexh, indexv - 1 );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\tfunction navigateDown() {\r\n\r\n\t\t// Prioritize revealing fragments\r\n\t\tif( ( isOverview() || nextFragment() === false ) && availableRoutes().down ) {\r\n\t\t\tslide( indexh, indexv + 1 );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Navigates backwards, prioritized in the following order:\r\n\t * 1) Previous fragment\r\n\t * 2) Previous vertical slide\r\n\t * 3) Previous horizontal slide\r\n\t */\r\n\tfunction navigatePrev() {\r\n\r\n\t\t// Prioritize revealing fragments\r\n\t\tif( previousFragment() === false ) {\r\n\t\t\tif( availableRoutes().up ) {\r\n\t\t\t\tnavigateUp();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// Fetch the previous horizontal slide, if there is one\r\n\t\t\t\tvar previousSlide;\r\n\r\n\t\t\t\tif( config.rtl ) {\r\n\t\t\t\t\tpreviousSlide = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR + '.future' ) ).pop();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tpreviousSlide = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR + '.past' ) ).pop();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( previousSlide ) {\r\n\t\t\t\t\tvar v = ( previousSlide.querySelectorAll( 'section' ).length - 1 ) || undefined;\r\n\t\t\t\t\tvar h = indexh - 1;\r\n\t\t\t\t\tslide( h, v );\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * The reverse of #navigatePrev().\r\n\t */\r\n\tfunction navigateNext() {\r\n\r\n\t\t// Prioritize revealing fragments\r\n\t\tif( nextFragment() === false ) {\r\n\t\t\tif( availableRoutes().down ) {\r\n\t\t\t\tnavigateDown();\r\n\t\t\t}\r\n\t\t\telse if( config.rtl ) {\r\n\t\t\t\tnavigateLeft();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnavigateRight();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// If auto-sliding is enabled we need to cue up\r\n\t\t// another timeout\r\n\t\tcueAutoSlide();\r\n\r\n\t}\r\n\r\n\r\n\t// --------------------------------------------------------------------//\r\n\t// ----------------------------- EVENTS -------------------------------//\r\n\t// --------------------------------------------------------------------//\r\n\r\n\t/**\r\n\t * Called by all event handlers that are based on user\r\n\t * input.\r\n\t */\r\n\tfunction onUserInput( event ) {\r\n\r\n\t\tif( config.autoSlideStoppable ) {\r\n\t\t\tpauseAutoSlide();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handler for the document level 'keypress' event.\r\n\t */\r\n\tfunction onDocumentKeyPress( event ) {\r\n\r\n\t\t// Check if the pressed key is question mark\r\n\t\tif( event.shiftKey && event.charCode === 63 ) {\r\n\t\t\tif( dom.overlay ) {\r\n\t\t\t\tcloseOverlay();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tshowHelp( true );\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handler for the document level 'keydown' event.\r\n\t */\r\n\tfunction onDocumentKeyDown( event ) {\r\n\r\n\t\t// If there's a condition specified and it returns false,\r\n\t\t// ignore this event\r\n\t\tif( typeof config.keyboardCondition === 'function' && config.keyboardCondition() === false ) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\r\n\t\t// Remember if auto-sliding was paused so we can toggle it\r\n\t\tvar autoSlideWasPaused = autoSlidePaused;\r\n\r\n\t\tonUserInput( event );\r\n\r\n\t\t// Check if there's a focused element that could be using\r\n\t\t// the keyboard\r\n\t\tvar activeElementIsCE = document.activeElement && document.activeElement.contentEditable !== 'inherit';\r\n\t\tvar activeElementIsInput = document.activeElement && document.activeElement.tagName && /input|textarea/i.test( document.activeElement.tagName );\r\n\r\n\t\t// Disregard the event if there's a focused element or a\r\n\t\t// keyboard modifier key is present\r\n\t\tif( activeElementIsCE || activeElementIsInput || (event.shiftKey && event.keyCode !== 32) || event.altKey || event.ctrlKey || event.metaKey ) return;\r\n\r\n\t\t// While paused only allow \"unpausing\" keyboard events (b and .)\r\n\t\tif( isPaused() && [66,190,191].indexOf( event.keyCode ) === -1 ) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar triggered = false;\r\n\r\n\t\t// 1. User defined key bindings\r\n\t\tif( typeof config.keyboard === 'object' ) {\r\n\r\n\t\t\tfor( var key in config.keyboard ) {\r\n\r\n\t\t\t\t// Check if this binding matches the pressed key\r\n\t\t\t\tif( parseInt( key, 10 ) === event.keyCode ) {\r\n\r\n\t\t\t\t\tvar value = config.keyboard[ key ];\r\n\r\n\t\t\t\t\t// Callback function\r\n\t\t\t\t\tif( typeof value === 'function' ) {\r\n\t\t\t\t\t\tvalue.apply( null, [ event ] );\r\n\t\t\t\t\t}\r\n\t\t\t\t\t// String shortcuts to reveal.js API\r\n\t\t\t\t\telse if( typeof value === 'string' && typeof Reveal[ value ] === 'function' ) {\r\n\t\t\t\t\t\tReveal[ value ].call();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttriggered = true;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// 2. System defined key bindings\r\n\t\tif( triggered === false ) {\r\n\r\n\t\t\t// Assume true and try to prove false\r\n\t\t\ttriggered = true;\r\n\r\n\t\t\tswitch( event.keyCode ) {\r\n\t\t\t\t// p, page up\r\n\t\t\t\tcase 80: case 33: navigatePrev(); break;\r\n\t\t\t\t// n, page down\r\n\t\t\t\tcase 78: case 34: navigateNext(); break;\r\n\t\t\t\t// h, left\r\n\t\t\t\tcase 72: case 37: navigateLeft(); break;\r\n\t\t\t\t// l, right\r\n\t\t\t\tcase 76: case 39: navigateRight(); break;\r\n\t\t\t\t// k, up\r\n\t\t\t\tcase 75: case 38: navigateUp(); break;\r\n\t\t\t\t// j, down\r\n\t\t\t\tcase 74: case 40: navigateDown(); break;\r\n\t\t\t\t// home\r\n\t\t\t\tcase 36: slide( 0 ); break;\r\n\t\t\t\t// end\r\n\t\t\t\tcase 35: slide( Number.MAX_VALUE ); break;\r\n\t\t\t\t// space\r\n\t\t\t\tcase 32: isOverview() ? deactivateOverview() : event.shiftKey ? navigatePrev() : navigateNext(); break;\r\n\t\t\t\t// return\r\n\t\t\t\tcase 13: isOverview() ? deactivateOverview() : triggered = false; break;\r\n\t\t\t\t// two-spot, semicolon, b, period, Logitech presenter tools \"black screen\" button\r\n\t\t\t\tcase 58: case 59: case 66: case 190: case 191: togglePause(); break;\r\n\t\t\t\t// f\r\n\t\t\t\tcase 70: enterFullscreen(); break;\r\n\t\t\t\t// a\r\n\t\t\t\tcase 65: if ( config.autoSlideStoppable ) toggleAutoSlide( autoSlideWasPaused ); break;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\ttriggered = false;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\t// If the input resulted in a triggered action we should prevent\r\n\t\t// the browsers default behavior\r\n\t\tif( triggered ) {\r\n\t\t\tevent.preventDefault && event.preventDefault();\r\n\t\t}\r\n\t\t// ESC or O key\r\n\t\telse if ( ( event.keyCode === 27 || event.keyCode === 79 ) && features.transforms3d ) {\r\n\t\t\tif( dom.overlay ) {\r\n\t\t\t\tcloseOverlay();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\ttoggleOverview();\r\n\t\t\t}\r\n\r\n\t\t\tevent.preventDefault && event.preventDefault();\r\n\t\t}\r\n\r\n\t\t// If auto-sliding is enabled we need to cue up\r\n\t\t// another timeout\r\n\t\tcueAutoSlide();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handler for the 'touchstart' event, enables support for\r\n\t * swipe and pinch gestures.\r\n\t */\r\n\tfunction onTouchStart( event ) {\r\n\r\n\t\ttouch.startX = event.touches[0].clientX;\r\n\t\ttouch.startY = event.touches[0].clientY;\r\n\t\ttouch.startCount = event.touches.length;\r\n\r\n\t\t// If there's two touches we need to memorize the distance\r\n\t\t// between those two points to detect pinching\r\n\t\tif( event.touches.length === 2 && config.overview ) {\r\n\t\t\ttouch.startSpan = distanceBetween( {\r\n\t\t\t\tx: event.touches[1].clientX,\r\n\t\t\t\ty: event.touches[1].clientY\r\n\t\t\t}, {\r\n\t\t\t\tx: touch.startX,\r\n\t\t\t\ty: touch.startY\r\n\t\t\t} );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handler for the 'touchmove' event.\r\n\t */\r\n\tfunction onTouchMove( event ) {\r\n\r\n\t\t// Each touch should only trigger one action\r\n\t\tif( !touch.captured ) {\r\n\t\t\tonUserInput( event );\r\n\r\n\t\t\tvar currentX = event.touches[0].clientX;\r\n\t\t\tvar currentY = event.touches[0].clientY;\r\n\r\n\t\t\t// If the touch started with two points and still has\r\n\t\t\t// two active touches; test for the pinch gesture\r\n\t\t\tif( event.touches.length === 2 && touch.startCount === 2 && config.overview ) {\r\n\r\n\t\t\t\t// The current distance in pixels between the two touch points\r\n\t\t\t\tvar currentSpan = distanceBetween( {\r\n\t\t\t\t\tx: event.touches[1].clientX,\r\n\t\t\t\t\ty: event.touches[1].clientY\r\n\t\t\t\t}, {\r\n\t\t\t\t\tx: touch.startX,\r\n\t\t\t\t\ty: touch.startY\r\n\t\t\t\t} );\r\n\r\n\t\t\t\t// If the span is larger than the desire amount we've got\r\n\t\t\t\t// ourselves a pinch\r\n\t\t\t\tif( Math.abs( touch.startSpan - currentSpan ) > touch.threshold ) {\r\n\t\t\t\t\ttouch.captured = true;\r\n\r\n\t\t\t\t\tif( currentSpan < touch.startSpan ) {\r\n\t\t\t\t\t\tactivateOverview();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tdeactivateOverview();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tevent.preventDefault();\r\n\r\n\t\t\t}\r\n\t\t\t// There was only one touch point, look for a swipe\r\n\t\t\telse if( event.touches.length === 1 && touch.startCount !== 2 ) {\r\n\r\n\t\t\t\tvar deltaX = currentX - touch.startX,\r\n\t\t\t\t\tdeltaY = currentY - touch.startY;\r\n\r\n\t\t\t\tif( deltaX > touch.threshold && Math.abs( deltaX ) > Math.abs( deltaY ) ) {\r\n\t\t\t\t\ttouch.captured = true;\r\n\t\t\t\t\tnavigateLeft();\r\n\t\t\t\t}\r\n\t\t\t\telse if( deltaX < -touch.threshold && Math.abs( deltaX ) > Math.abs( deltaY ) ) {\r\n\t\t\t\t\ttouch.captured = true;\r\n\t\t\t\t\tnavigateRight();\r\n\t\t\t\t}\r\n\t\t\t\telse if( deltaY > touch.threshold ) {\r\n\t\t\t\t\ttouch.captured = true;\r\n\t\t\t\t\tnavigateUp();\r\n\t\t\t\t}\r\n\t\t\t\telse if( deltaY < -touch.threshold ) {\r\n\t\t\t\t\ttouch.captured = true;\r\n\t\t\t\t\tnavigateDown();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If we're embedded, only block touch events if they have\r\n\t\t\t\t// triggered an action\r\n\t\t\t\tif( config.embedded ) {\r\n\t\t\t\t\tif( touch.captured || isVerticalSlide( currentSlide ) ) {\r\n\t\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t// Not embedded? Block them all to avoid needless tossing\r\n\t\t\t\t// around of the viewport in iOS\r\n\t\t\t\telse {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t\t// There's a bug with swiping on some Android devices unless\r\n\t\t// the default action is always prevented\r\n\t\telse if( navigator.userAgent.match( /android/gi ) ) {\r\n\t\t\tevent.preventDefault();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handler for the 'touchend' event.\r\n\t */\r\n\tfunction onTouchEnd( event ) {\r\n\r\n\t\ttouch.captured = false;\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Convert pointer down to touch start.\r\n\t */\r\n\tfunction onPointerDown( event ) {\r\n\r\n\t\tif( event.pointerType === event.MSPOINTER_TYPE_TOUCH || event.pointerType === \"touch\" ) {\r\n\t\t\tevent.touches = [{ clientX: event.clientX, clientY: event.clientY }];\r\n\t\t\tonTouchStart( event );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Convert pointer move to touch move.\r\n\t */\r\n\tfunction onPointerMove( event ) {\r\n\r\n\t\tif( event.pointerType === event.MSPOINTER_TYPE_TOUCH || event.pointerType === \"touch\" )  {\r\n\t\t\tevent.touches = [{ clientX: event.clientX, clientY: event.clientY }];\r\n\t\t\tonTouchMove( event );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Convert pointer up to touch end.\r\n\t */\r\n\tfunction onPointerUp( event ) {\r\n\r\n\t\tif( event.pointerType === event.MSPOINTER_TYPE_TOUCH || event.pointerType === \"touch\" )  {\r\n\t\t\tevent.touches = [{ clientX: event.clientX, clientY: event.clientY }];\r\n\t\t\tonTouchEnd( event );\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handles mouse wheel scrolling, throttled to avoid skipping\r\n\t * multiple slides.\r\n\t */\r\n\tfunction onDocumentMouseScroll( event ) {\r\n\r\n\t\tif( Date.now() - lastMouseWheelStep > 600 ) {\r\n\r\n\t\t\tlastMouseWheelStep = Date.now();\r\n\r\n\t\t\tvar delta = event.detail || -event.wheelDelta;\r\n\t\t\tif( delta > 0 ) {\r\n\t\t\t\tnavigateNext();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnavigatePrev();\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Clicking on the progress bar results in a navigation to the\r\n\t * closest approximate horizontal slide using this equation:\r\n\t *\r\n\t * ( clickX / presentationWidth ) * numberOfSlides\r\n\t */\r\n\tfunction onProgressClicked( event ) {\r\n\r\n\t\tonUserInput( event );\r\n\r\n\t\tevent.preventDefault();\r\n\r\n\t\tvar slidesTotal = toArray( dom.wrapper.querySelectorAll( HORIZONTAL_SLIDES_SELECTOR ) ).length;\r\n\t\tvar slideIndex = Math.floor( ( event.clientX / dom.wrapper.offsetWidth ) * slidesTotal );\r\n\r\n\t\tif( config.rtl ) {\r\n\t\t\tslideIndex = slidesTotal - slideIndex;\r\n\t\t}\r\n\r\n\t\tslide( slideIndex );\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Event handler for navigation control buttons.\r\n\t */\r\n\tfunction onNavigateLeftClicked( event ) { event.preventDefault(); onUserInput(); navigateLeft(); }\r\n\tfunction onNavigateRightClicked( event ) { event.preventDefault(); onUserInput(); navigateRight(); }\r\n\tfunction onNavigateUpClicked( event ) { event.preventDefault(); onUserInput(); navigateUp(); }\r\n\tfunction onNavigateDownClicked( event ) { event.preventDefault(); onUserInput(); navigateDown(); }\r\n\tfunction onNavigatePrevClicked( event ) { event.preventDefault(); onUserInput(); navigatePrev(); }\r\n\tfunction onNavigateNextClicked( event ) { event.preventDefault(); onUserInput(); navigateNext(); }\r\n\r\n\t/**\r\n\t * Handler for the window level 'hashchange' event.\r\n\t */\r\n\tfunction onWindowHashChange( event ) {\r\n\r\n\t\treadURL();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handler for the window level 'resize' event.\r\n\t */\r\n\tfunction onWindowResize( event ) {\r\n\r\n\t\tlayout();\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handle for the window level 'visibilitychange' event.\r\n\t */\r\n\tfunction onPageVisibilityChange( event ) {\r\n\r\n\t\tvar isHidden =  document.webkitHidden ||\r\n\t\t\t\t\t\tdocument.msHidden ||\r\n\t\t\t\t\t\tdocument.hidden;\r\n\r\n\t\t// If, after clicking a link or similar and we're coming back,\r\n\t\t// focus the document.body to ensure we can use keyboard shortcuts\r\n\t\tif( isHidden === false && document.activeElement !== document.body ) {\r\n\t\t\t// Not all elements support .blur() - SVGs among them.\r\n\t\t\tif( typeof document.activeElement.blur === 'function' ) {\r\n\t\t\t\tdocument.activeElement.blur();\r\n\t\t\t}\r\n\t\t\tdocument.body.focus();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Invoked when a slide is and we're in the overview.\r\n\t */\r\n\tfunction onOverviewSlideClicked( event ) {\r\n\r\n\t\t// TODO There's a bug here where the event listeners are not\r\n\t\t// removed after deactivating the overview.\r\n\t\tif( eventsAreBound && isOverview() ) {\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tvar element = event.target;\r\n\r\n\t\t\twhile( element && !element.nodeName.match( /section/gi ) ) {\r\n\t\t\t\telement = element.parentNode;\r\n\t\t\t}\r\n\r\n\t\t\tif( element && !element.classList.contains( 'disabled' ) ) {\r\n\r\n\t\t\t\tdeactivateOverview();\r\n\r\n\t\t\t\tif( element.nodeName.match( /section/gi ) ) {\r\n\t\t\t\t\tvar h = parseInt( element.getAttribute( 'data-index-h' ), 10 ),\r\n\t\t\t\t\t\tv = parseInt( element.getAttribute( 'data-index-v' ), 10 );\r\n\r\n\t\t\t\t\tslide( h, v );\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handles clicks on links that are set to preview in the\r\n\t * iframe overlay.\r\n\t */\r\n\tfunction onPreviewLinkClicked( event ) {\r\n\r\n\t\tif( event.currentTarget && event.currentTarget.hasAttribute( 'href' ) ) {\r\n\t\t\tvar url = event.currentTarget.getAttribute( 'href' );\r\n\t\t\tif( url ) {\r\n\t\t\t\tshowPreview( url );\r\n\t\t\t\tevent.preventDefault();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * Handles click on the auto-sliding controls element.\r\n\t */\r\n\tfunction onAutoSlidePlayerClick( event ) {\r\n\r\n\t\t// Replay\r\n\t\tif( Reveal.isLastSlide() && config.loop === false ) {\r\n\t\t\tslide( 0, 0 );\r\n\t\t\tresumeAutoSlide();\r\n\t\t}\r\n\t\t// Resume\r\n\t\telse if( autoSlidePaused ) {\r\n\t\t\tresumeAutoSlide();\r\n\t\t}\r\n\t\t// Pause\r\n\t\telse {\r\n\t\t\tpauseAutoSlide();\r\n\t\t}\r\n\r\n\t}\r\n\r\n\r\n\t// --------------------------------------------------------------------//\r\n\t// ------------------------ PLAYBACK COMPONENT ------------------------//\r\n\t// --------------------------------------------------------------------//\r\n\r\n\r\n\t/**\r\n\t * Constructor for the playback component, which displays\r\n\t * play/pause/progress controls.\r\n\t *\r\n\t * @param {HTMLElement} container The component will append\r\n\t * itself to this\r\n\t * @param {Function} progressCheck A method which will be\r\n\t * called frequently to get the current progress on a range\r\n\t * of 0-1\r\n\t */\r\n\tfunction Playback( container, progressCheck ) {\r\n\r\n\t\t// Cosmetics\r\n\t\tthis.diameter = 50;\r\n\t\tthis.thickness = 3;\r\n\r\n\t\t// Flags if we are currently playing\r\n\t\tthis.playing = false;\r\n\r\n\t\t// Current progress on a 0-1 range\r\n\t\tthis.progress = 0;\r\n\r\n\t\t// Used to loop the animation smoothly\r\n\t\tthis.progressOffset = 1;\r\n\r\n\t\tthis.container = container;\r\n\t\tthis.progressCheck = progressCheck;\r\n\r\n\t\tthis.canvas = document.createElement( 'canvas' );\r\n\t\tthis.canvas.className = 'playback';\r\n\t\tthis.canvas.width = this.diameter;\r\n\t\tthis.canvas.height = this.diameter;\r\n\t\tthis.context = this.canvas.getContext( '2d' );\r\n\r\n\t\tthis.container.appendChild( this.canvas );\r\n\r\n\t\tthis.render();\r\n\r\n\t}\r\n\r\n\tPlayback.prototype.setPlaying = function( value ) {\r\n\r\n\t\tvar wasPlaying = this.playing;\r\n\r\n\t\tthis.playing = value;\r\n\r\n\t\t// Start repainting if we weren't already\r\n\t\tif( !wasPlaying && this.playing ) {\r\n\t\t\tthis.animate();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.render();\r\n\t\t}\r\n\r\n\t};\r\n\r\n\tPlayback.prototype.animate = function() {\r\n\r\n\t\tvar progressBefore = this.progress;\r\n\r\n\t\tthis.progress = this.progressCheck();\r\n\r\n\t\t// When we loop, offset the progress so that it eases\r\n\t\t// smoothly rather than immediately resetting\r\n\t\tif( progressBefore > 0.8 && this.progress < 0.2 ) {\r\n\t\t\tthis.progressOffset = this.progress;\r\n\t\t}\r\n\r\n\t\tthis.render();\r\n\r\n\t\tif( this.playing ) {\r\n\t\t\tfeatures.requestAnimationFrameMethod.call( window, this.animate.bind( this ) );\r\n\t\t}\r\n\r\n\t};\r\n\r\n\t/**\r\n\t * Renders the current progress and playback state.\r\n\t */\r\n\tPlayback.prototype.render = function() {\r\n\r\n\t\tvar progress = this.playing ? this.progress : 0,\r\n\t\t\tradius = ( this.diameter / 2 ) - this.thickness,\r\n\t\t\tx = this.diameter / 2,\r\n\t\t\ty = this.diameter / 2,\r\n\t\t\ticonSize = 14;\r\n\r\n\t\t// Ease towards 1\r\n\t\tthis.progressOffset += ( 1 - this.progressOffset ) * 0.1;\r\n\r\n\t\tvar endAngle = ( - Math.PI / 2 ) + ( progress * ( Math.PI * 2 ) );\r\n\t\tvar startAngle = ( - Math.PI / 2 ) + ( this.progressOffset * ( Math.PI * 2 ) );\r\n\r\n\t\tthis.context.save();\r\n\t\tthis.context.clearRect( 0, 0, this.diameter, this.diameter );\r\n\r\n\t\t// Solid background color\r\n\t\tthis.context.beginPath();\r\n\t\tthis.context.arc( x, y, radius + 2, 0, Math.PI * 2, false );\r\n\t\tthis.context.fillStyle = 'rgba( 0, 0, 0, 0.4 )';\r\n\t\tthis.context.fill();\r\n\r\n\t\t// Draw progress track\r\n\t\tthis.context.beginPath();\r\n\t\tthis.context.arc( x, y, radius, 0, Math.PI * 2, false );\r\n\t\tthis.context.lineWidth = this.thickness;\r\n\t\tthis.context.strokeStyle = '#666';\r\n\t\tthis.context.stroke();\r\n\r\n\t\tif( this.playing ) {\r\n\t\t\t// Draw progress on top of track\r\n\t\t\tthis.context.beginPath();\r\n\t\t\tthis.context.arc( x, y, radius, startAngle, endAngle, false );\r\n\t\t\tthis.context.lineWidth = this.thickness;\r\n\t\t\tthis.context.strokeStyle = '#fff';\r\n\t\t\tthis.context.stroke();\r\n\t\t}\r\n\r\n\t\tthis.context.translate( x - ( iconSize / 2 ), y - ( iconSize / 2 ) );\r\n\r\n\t\t// Draw play/pause icons\r\n\t\tif( this.playing ) {\r\n\t\t\tthis.context.fillStyle = '#fff';\r\n\t\t\tthis.context.fillRect( 0, 0, iconSize / 2 - 2, iconSize );\r\n\t\t\tthis.context.fillRect( iconSize / 2 + 2, 0, iconSize / 2 - 2, iconSize );\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.context.beginPath();\r\n\t\t\tthis.context.translate( 2, 0 );\r\n\t\t\tthis.context.moveTo( 0, 0 );\r\n\t\t\tthis.context.lineTo( iconSize - 2, iconSize / 2 );\r\n\t\t\tthis.context.lineTo( 0, iconSize );\r\n\t\t\tthis.context.fillStyle = '#fff';\r\n\t\t\tthis.context.fill();\r\n\t\t}\r\n\r\n\t\tthis.context.restore();\r\n\r\n\t};\r\n\r\n\tPlayback.prototype.on = function( type, listener ) {\r\n\t\tthis.canvas.addEventListener( type, listener, false );\r\n\t};\r\n\r\n\tPlayback.prototype.off = function( type, listener ) {\r\n\t\tthis.canvas.removeEventListener( type, listener, false );\r\n\t};\r\n\r\n\tPlayback.prototype.destroy = function() {\r\n\r\n\t\tthis.playing = false;\r\n\r\n\t\tif( this.canvas.parentNode ) {\r\n\t\t\tthis.container.removeChild( this.canvas );\r\n\t\t}\r\n\r\n\t};\r\n\r\n\r\n\t// --------------------------------------------------------------------//\r\n\t// ------------------------------- API --------------------------------//\r\n\t// --------------------------------------------------------------------//\r\n\r\n\r\n\tReveal = {\r\n\t\tinitialize: initialize,\r\n\t\tconfigure: configure,\r\n\t\tsync: sync,\r\n\r\n\t\t// Navigation methods\r\n\t\tslide: slide,\r\n\t\tleft: navigateLeft,\r\n\t\tright: navigateRight,\r\n\t\tup: navigateUp,\r\n\t\tdown: navigateDown,\r\n\t\tprev: navigatePrev,\r\n\t\tnext: navigateNext,\r\n\r\n\t\t// Fragment methods\r\n\t\tnavigateFragment: navigateFragment,\r\n\t\tprevFragment: previousFragment,\r\n\t\tnextFragment: nextFragment,\r\n\r\n\t\t// Deprecated aliases\r\n\t\tnavigateTo: slide,\r\n\t\tnavigateLeft: navigateLeft,\r\n\t\tnavigateRight: navigateRight,\r\n\t\tnavigateUp: navigateUp,\r\n\t\tnavigateDown: navigateDown,\r\n\t\tnavigatePrev: navigatePrev,\r\n\t\tnavigateNext: navigateNext,\r\n\r\n\t\t// Forces an update in slide layout\r\n\t\tlayout: layout,\r\n\r\n\t\t// Returns an object with the available routes as booleans (left/right/top/bottom)\r\n\t\tavailableRoutes: availableRoutes,\r\n\r\n\t\t// Returns an object with the available fragments as booleans (prev/next)\r\n\t\tavailableFragments: availableFragments,\r\n\r\n\t\t// Toggles the overview mode on/off\r\n\t\ttoggleOverview: toggleOverview,\r\n\r\n\t\t// Toggles the \"black screen\" mode on/off\r\n\t\ttogglePause: togglePause,\r\n\r\n\t\t// Toggles the auto slide mode on/off\r\n\t\ttoggleAutoSlide: toggleAutoSlide,\r\n\r\n\t\t// State checks\r\n\t\tisOverview: isOverview,\r\n\t\tisPaused: isPaused,\r\n\t\tisAutoSliding: isAutoSliding,\r\n\r\n\t\t// Adds or removes all internal event listeners (such as keyboard)\r\n\t\taddEventListeners: addEventListeners,\r\n\t\tremoveEventListeners: removeEventListeners,\r\n\r\n\t\t// Facility for persisting and restoring the presentation state\r\n\t\tgetState: getState,\r\n\t\tsetState: setState,\r\n\r\n\t\t// Presentation progress on range of 0-1\r\n\t\tgetProgress: getProgress,\r\n\r\n\t\t// Returns the indices of the current, or specified, slide\r\n\t\tgetIndices: getIndices,\r\n\r\n\t\tgetTotalSlides: getTotalSlides,\r\n\r\n\t\t// Returns the slide element at the specified index\r\n\t\tgetSlide: getSlide,\r\n\r\n\t\t// Returns the slide background element at the specified index\r\n\t\tgetSlideBackground: getSlideBackground,\r\n\r\n\t\t// Returns the previous slide element, may be null\r\n\t\tgetPreviousSlide: function() {\r\n\t\t\treturn previousSlide;\r\n\t\t},\r\n\r\n\t\t// Returns the current slide element\r\n\t\tgetCurrentSlide: function() {\r\n\t\t\treturn currentSlide;\r\n\t\t},\r\n\r\n\t\t// Returns the current scale of the presentation content\r\n\t\tgetScale: function() {\r\n\t\t\treturn scale;\r\n\t\t},\r\n\r\n\t\t// Returns the current configuration object\r\n\t\tgetConfig: function() {\r\n\t\t\treturn config;\r\n\t\t},\r\n\r\n\t\t// Helper method, retrieves query string as a key/value hash\r\n\t\tgetQueryHash: function() {\r\n\t\t\tvar query = {};\r\n\r\n\t\t\tlocation.search.replace( /[A-Z0-9]+?=([\\w\\.%-]*)/gi, function(a) {\r\n\t\t\t\tquery[ a.split( '=' ).shift() ] = a.split( '=' ).pop();\r\n\t\t\t} );\r\n\r\n\t\t\t// Basic deserialization\r\n\t\t\tfor( var i in query ) {\r\n\t\t\t\tvar value = query[ i ];\r\n\r\n\t\t\t\tquery[ i ] = deserialize( unescape( value ) );\r\n\t\t\t}\r\n\r\n\t\t\treturn query;\r\n\t\t},\r\n\r\n\t\t// Returns true if we're currently on the first slide\r\n\t\tisFirstSlide: function() {\r\n\t\t\treturn ( indexh === 0 && indexv === 0 );\r\n\t\t},\r\n\r\n\t\t// Returns true if we're currently on the last slide\r\n\t\tisLastSlide: function() {\r\n\t\t\tif( currentSlide ) {\r\n\t\t\t\t// Does this slide has next a sibling?\r\n\t\t\t\tif( currentSlide.nextElementSibling ) return false;\r\n\r\n\t\t\t\t// If it's vertical, does its parent have a next sibling?\r\n\t\t\t\tif( isVerticalSlide( currentSlide ) && currentSlide.parentNode.nextElementSibling ) return false;\r\n\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\r\n\t\t\treturn false;\r\n\t\t},\r\n\r\n\t\t// Checks if reveal.js has been loaded and is ready for use\r\n\t\tisReady: function() {\r\n\t\t\treturn loaded;\r\n\t\t},\r\n\r\n\t\t// Forward event binding to the reveal DOM element\r\n\t\taddEventListener: function( type, listener, useCapture ) {\r\n\t\t\tif( 'addEventListener' in window ) {\r\n\t\t\t\t( dom.wrapper || document.querySelector( '.reveal' ) ).addEventListener( type, listener, useCapture );\r\n\t\t\t}\r\n\t\t},\r\n\t\tremoveEventListener: function( type, listener, useCapture ) {\r\n\t\t\tif( 'addEventListener' in window ) {\r\n\t\t\t\t( dom.wrapper || document.querySelector( '.reveal' ) ).removeEventListener( type, listener, useCapture );\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t// Programatically triggers a keyboard event\r\n\t\ttriggerKey: function( keyCode ) {\r\n\t\t\tonDocumentKeyDown( { keyCode: keyCode } );\r\n\t\t}\r\n\t};\r\n\r\n\treturn Reveal;\r\n\r\n}));\r\n\n/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/\r\nif(typeof document!==\"undefined\"&&!(\"classList\" in document.createElement(\"a\"))){(function(j){var a=\"classList\",f=\"prototype\",m=(j.HTMLElement||j.Element)[f],b=Object,k=String[f].trim||function(){return this.replace(/^\\s+|\\s+$/g,\"\")},c=Array[f].indexOf||function(q){var p=0,o=this.length;for(;p<o;p++){if(p in this&&this[p]===q){return p}}return -1},n=function(o,p){this.name=o;this.code=DOMException[o];this.message=p},g=function(p,o){if(o===\"\"){throw new n(\"SYNTAX_ERR\",\"An invalid or illegal string was specified\")}if(/\\s/.test(o)){throw new n(\"INVALID_CHARACTER_ERR\",\"String contains an invalid character\")}return c.call(p,o)},d=function(s){var r=k.call(s.className),q=r?r.split(/\\s+/):[],p=0,o=q.length;for(;p<o;p++){this.push(q[p])}this._updateClassName=function(){s.className=this.toString()}},e=d[f]=[],i=function(){return new d(this)};n[f]=Error[f];e.item=function(o){return this[o]||null};e.contains=function(o){o+=\"\";return g(this,o)!==-1};e.add=function(o){o+=\"\";if(g(this,o)===-1){this.push(o);this._updateClassName()}};e.remove=function(p){p+=\"\";var o=g(this,p);if(o!==-1){this.splice(o,1);this._updateClassName()}};e.toggle=function(o){o+=\"\";if(g(this,o)===-1){this.add(o)}else{this.remove(o)}};e.toString=function(){return this.join(\" \")};if(b.defineProperty){var l={get:i,enumerable:true,configurable:true};try{b.defineProperty(m,a,l)}catch(h){if(h.number===-2146823252){l.enumerable=false;b.defineProperty(m,a,l)}}}else{if(b[f].__defineGetter__){m.__defineGetter__(a,i)}}}(self))};\n// Custom reveal.js integration\r\n(function(){\r\n\tvar isEnabled = true;\r\n\r\n\tdocument.querySelector( '.reveal .slides' ).addEventListener( 'mousedown', function( event ) {\r\n\t\tvar modifier = ( Reveal.getConfig().zoomKey ? Reveal.getConfig().zoomKey : 'alt' ) + 'Key';\r\n\r\n\t\tvar zoomPadding = 20;\r\n\t\tvar revealScale = Reveal.getScale();\r\n\r\n\t\tif( event[ modifier ] && isEnabled ) {\r\n\t\t\tevent.preventDefault();\r\n\r\n\t\t\tvar bounds = event.target.getBoundingClientRect();\r\n\r\n\t\t\tzoom.to({\r\n\t\t\t\tx: ( bounds.left * revealScale ) - zoomPadding,\r\n\t\t\t\ty: ( bounds.top * revealScale ) - zoomPadding,\r\n\t\t\t\twidth: ( bounds.width * revealScale ) + ( zoomPadding * 2 ),\r\n\t\t\t\theight: ( bounds.height * revealScale ) + ( zoomPadding * 2 ),\r\n\t\t\t\tpan: false\r\n\t\t\t});\r\n\t\t}\r\n\t} );\r\n\r\n\tReveal.addEventListener( 'overviewshown', function() { isEnabled = false; } );\r\n\tReveal.addEventListener( 'overviewhidden', function() { isEnabled = true; } );\r\n})();\r\n\r\n/*!\r\n * zoom.js 0.3 (modified for use with reveal.js)\r\n * http://lab.hakim.se/zoom-js\r\n * MIT licensed\r\n *\r\n * Copyright (C) 2011-2014 Hakim El Hattab, http://hakim.se\r\n */\r\nvar zoom = (function(){\r\n\r\n\t// The current zoom level (scale)\r\n\tvar level = 1;\r\n\r\n\t// The current mouse position, used for panning\r\n\tvar mouseX = 0,\r\n\t\tmouseY = 0;\r\n\r\n\t// Timeout before pan is activated\r\n\tvar panEngageTimeout = -1,\r\n\t\tpanUpdateInterval = -1;\r\n\r\n\t// Check for transform support so that we can fallback otherwise\r\n\tvar supportsTransforms = \t'WebkitTransform' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'MozTransform' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'msTransform' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'OTransform' in document.body.style ||\r\n\t\t\t\t\t\t\t\t'transform' in document.body.style;\r\n\r\n\tif( supportsTransforms ) {\r\n\t\t// The easing that will be applied when we zoom in/out\r\n\t\tdocument.body.style.transition = 'transform 0.8s ease';\r\n\t\tdocument.body.style.OTransition = '-o-transform 0.8s ease';\r\n\t\tdocument.body.style.msTransition = '-ms-transform 0.8s ease';\r\n\t\tdocument.body.style.MozTransition = '-moz-transform 0.8s ease';\r\n\t\tdocument.body.style.WebkitTransition = '-webkit-transform 0.8s ease';\r\n\t}\r\n\r\n\t// Zoom out if the user hits escape\r\n\tdocument.addEventListener( 'keyup', function( event ) {\r\n\t\tif( level !== 1 && event.keyCode === 27 ) {\r\n\t\t\tzoom.out();\r\n\t\t}\r\n\t} );\r\n\r\n\t// Monitor mouse movement for panning\r\n\tdocument.addEventListener( 'mousemove', function( event ) {\r\n\t\tif( level !== 1 ) {\r\n\t\t\tmouseX = event.clientX;\r\n\t\t\tmouseY = event.clientY;\r\n\t\t}\r\n\t} );\r\n\r\n\t/**\r\n\t * Applies the CSS required to zoom in, prefers the use of CSS3\r\n\t * transforms but falls back on zoom for IE.\r\n\t *\r\n\t * @param {Object} rect\r\n\t * @param {Number} scale\r\n\t */\r\n\tfunction magnify( rect, scale ) {\r\n\r\n\t\tvar scrollOffset = getScrollOffset();\r\n\r\n\t\t// Ensure a width/height is set\r\n\t\trect.width = rect.width || 1;\r\n\t\trect.height = rect.height || 1;\r\n\r\n\t\t// Center the rect within the zoomed viewport\r\n\t\trect.x -= ( window.innerWidth - ( rect.width * scale ) ) / 2;\r\n\t\trect.y -= ( window.innerHeight - ( rect.height * scale ) ) / 2;\r\n\r\n\t\tif( supportsTransforms ) {\r\n\t\t\t// Reset\r\n\t\t\tif( scale === 1 ) {\r\n\t\t\t\tdocument.body.style.transform = '';\r\n\t\t\t\tdocument.body.style.OTransform = '';\r\n\t\t\t\tdocument.body.style.msTransform = '';\r\n\t\t\t\tdocument.body.style.MozTransform = '';\r\n\t\t\t\tdocument.body.style.WebkitTransform = '';\r\n\t\t\t}\r\n\t\t\t// Scale\r\n\t\t\telse {\r\n\t\t\t\tvar origin = scrollOffset.x +'px '+ scrollOffset.y +'px',\r\n\t\t\t\t\ttransform = 'translate('+ -rect.x +'px,'+ -rect.y +'px) scale('+ scale +')';\r\n\r\n\t\t\t\tdocument.body.style.transformOrigin = origin;\r\n\t\t\t\tdocument.body.style.OTransformOrigin = origin;\r\n\t\t\t\tdocument.body.style.msTransformOrigin = origin;\r\n\t\t\t\tdocument.body.style.MozTransformOrigin = origin;\r\n\t\t\t\tdocument.body.style.WebkitTransformOrigin = origin;\r\n\r\n\t\t\t\tdocument.body.style.transform = transform;\r\n\t\t\t\tdocument.body.style.OTransform = transform;\r\n\t\t\t\tdocument.body.style.msTransform = transform;\r\n\t\t\t\tdocument.body.style.MozTransform = transform;\r\n\t\t\t\tdocument.body.style.WebkitTransform = transform;\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\t// Reset\r\n\t\t\tif( scale === 1 ) {\r\n\t\t\t\tdocument.body.style.position = '';\r\n\t\t\t\tdocument.body.style.left = '';\r\n\t\t\t\tdocument.body.style.top = '';\r\n\t\t\t\tdocument.body.style.width = '';\r\n\t\t\t\tdocument.body.style.height = '';\r\n\t\t\t\tdocument.body.style.zoom = '';\r\n\t\t\t}\r\n\t\t\t// Scale\r\n\t\t\telse {\r\n\t\t\t\tdocument.body.style.position = 'relative';\r\n\t\t\t\tdocument.body.style.left = ( - ( scrollOffset.x + rect.x ) / scale ) + 'px';\r\n\t\t\t\tdocument.body.style.top = ( - ( scrollOffset.y + rect.y ) / scale ) + 'px';\r\n\t\t\t\tdocument.body.style.width = ( scale * 100 ) + '%';\r\n\t\t\t\tdocument.body.style.height = ( scale * 100 ) + '%';\r\n\t\t\t\tdocument.body.style.zoom = scale;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tlevel = scale;\r\n\r\n\t\tif( document.documentElement.classList ) {\r\n\t\t\tif( level !== 1 ) {\r\n\t\t\t\tdocument.documentElement.classList.add( 'zoomed' );\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tdocument.documentElement.classList.remove( 'zoomed' );\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * Pan the document when the mosue cursor approaches the edges\r\n\t * of the window.\r\n\t */\r\n\tfunction pan() {\r\n\t\tvar range = 0.12,\r\n\t\t\trangeX = window.innerWidth * range,\r\n\t\t\trangeY = window.innerHeight * range,\r\n\t\t\tscrollOffset = getScrollOffset();\r\n\r\n\t\t// Up\r\n\t\tif( mouseY < rangeY ) {\r\n\t\t\twindow.scroll( scrollOffset.x, scrollOffset.y - ( 1 - ( mouseY / rangeY ) ) * ( 14 / level ) );\r\n\t\t}\r\n\t\t// Down\r\n\t\telse if( mouseY > window.innerHeight - rangeY ) {\r\n\t\t\twindow.scroll( scrollOffset.x, scrollOffset.y + ( 1 - ( window.innerHeight - mouseY ) / rangeY ) * ( 14 / level ) );\r\n\t\t}\r\n\r\n\t\t// Left\r\n\t\tif( mouseX < rangeX ) {\r\n\t\t\twindow.scroll( scrollOffset.x - ( 1 - ( mouseX / rangeX ) ) * ( 14 / level ), scrollOffset.y );\r\n\t\t}\r\n\t\t// Right\r\n\t\telse if( mouseX > window.innerWidth - rangeX ) {\r\n\t\t\twindow.scroll( scrollOffset.x + ( 1 - ( window.innerWidth - mouseX ) / rangeX ) * ( 14 / level ), scrollOffset.y );\r\n\t\t}\r\n\t}\r\n\r\n\tfunction getScrollOffset() {\r\n\t\treturn {\r\n\t\t\tx: window.scrollX !== undefined ? window.scrollX : window.pageXOffset,\r\n\t\t\ty: window.scrollY !== undefined ? window.scrollY : window.pageYOffset\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\t/**\r\n\t\t * Zooms in on either a rectangle or HTML element.\r\n\t\t *\r\n\t\t * @param {Object} options\r\n\t\t *   - element: HTML element to zoom in on\r\n\t\t *   OR\r\n\t\t *   - x/y: coordinates in non-transformed space to zoom in on\r\n\t\t *   - width/height: the portion of the screen to zoom in on\r\n\t\t *   - scale: can be used instead of width/height to explicitly set scale\r\n\t\t */\r\n\t\tto: function( options ) {\r\n\r\n\t\t\t// Due to an implementation limitation we can't zoom in\r\n\t\t\t// to another element without zooming out first\r\n\t\t\tif( level !== 1 ) {\r\n\t\t\t\tzoom.out();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\toptions.x = options.x || 0;\r\n\t\t\t\toptions.y = options.y || 0;\r\n\r\n\t\t\t\t// If an element is set, that takes precedence\r\n\t\t\t\tif( !!options.element ) {\r\n\t\t\t\t\t// Space around the zoomed in element to leave on screen\r\n\t\t\t\t\tvar padding = 20;\r\n\t\t\t\t\tvar bounds = options.element.getBoundingClientRect();\r\n\r\n\t\t\t\t\toptions.x = bounds.left - padding;\r\n\t\t\t\t\toptions.y = bounds.top - padding;\r\n\t\t\t\t\toptions.width = bounds.width + ( padding * 2 );\r\n\t\t\t\t\toptions.height = bounds.height + ( padding * 2 );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// If width/height values are set, calculate scale from those values\r\n\t\t\t\tif( options.width !== undefined && options.height !== undefined ) {\r\n\t\t\t\t\toptions.scale = Math.max( Math.min( window.innerWidth / options.width, window.innerHeight / options.height ), 1 );\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif( options.scale > 1 ) {\r\n\t\t\t\t\toptions.x *= options.scale;\r\n\t\t\t\t\toptions.y *= options.scale;\r\n\r\n\t\t\t\t\tmagnify( options, options.scale );\r\n\r\n\t\t\t\t\tif( options.pan !== false ) {\r\n\r\n\t\t\t\t\t\t// Wait with engaging panning as it may conflict with the\r\n\t\t\t\t\t\t// zoom transition\r\n\t\t\t\t\t\tpanEngageTimeout = setTimeout( function() {\r\n\t\t\t\t\t\t\tpanUpdateInterval = setInterval( pan, 1000 / 60 );\r\n\t\t\t\t\t\t}, 800 );\r\n\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t/**\r\n\t\t * Resets the document zoom state to its default.\r\n\t\t */\r\n\t\tout: function() {\r\n\t\t\tclearTimeout( panEngageTimeout );\r\n\t\t\tclearInterval( panUpdateInterval );\r\n\r\n\t\t\tmagnify( { x: 0, y: 0 }, 1 );\r\n\r\n\t\t\tlevel = 1;\r\n\t\t},\r\n\r\n\t\t// Alias\r\n\t\tmagnify: function( options ) { this.to( options ) },\r\n\t\treset: function() { this.out() },\r\n\r\n\t\tzoomLevel: function() {\r\n\t\t\treturn level;\r\n\t\t}\r\n\t}\r\n\r\n})();\r\n\r\n\r\n\r\n\n/*!\r\n * jQuery Popup Overlay\r\n *\r\n * @version 1.6.0\r\n * @requires jQuery v1.7.1+\r\n * @link http://vast-eng.github.com/jquery-popup-overlay/\r\n */\r\n(function ($) {\r\n\r\n    var $window = $(window);\r\n    var options = {};\r\n    var zindexvalues = [];\r\n    var lastclicked = [];\r\n    var onevisible = false;\r\n    var oneormorevisible = false;\r\n    var scrollbarwidth;\r\n    var focushandler = null;\r\n    var blurhandler = null;\r\n    var escapehandler = null;\r\n    var bodymarginright = null;\r\n    var opensuffix = '_open';\r\n    var closesuffix = '_close';\r\n    var focusedelementbeforepopup = null;\r\n\r\n    var methods = {\r\n\r\n        _init: function (el) {\r\n            var $el = $(el);\r\n            var options = $el.data('popupoptions');\r\n            lastclicked[el.id] = false;\r\n            zindexvalues[el.id] = 0;\r\n\r\n            if (!$el.data('popup-initialized')) {\r\n                $el.attr('data-popup-initialized', 'true');\r\n                methods._initonce(el);\r\n            }\r\n\r\n            if (options.autoopen) {\r\n                setTimeout(function() {\r\n                    methods.show(el, 0);\r\n                }, 0);\r\n            }\r\n        },\r\n\r\n        _initonce: function (el) {\r\n            var $body = $('body');\r\n            var $wrapper;\r\n            var options = $el.data('popupoptions');\r\n            bodymarginright = parseInt($body.css('margin-right'), 10);\r\n\r\n            if (options.type == 'tooltip') {\r\n                options.background = false;\r\n                options.scrolllock = false;\r\n            }\r\n\r\n            if (options.scrolllock) {\r\n                // Calculate the browser's scrollbar width dynamically\r\n                var parent;\r\n                var child;\r\n                if (typeof scrollbarwidth === 'undefined') {\r\n                    parent = $('<div style=\"width:50px;height:50px;overflow:auto\"><div/></div>').appendTo('body');\r\n                    child = parent.children();\r\n                    scrollbarwidth = child.innerWidth() - child.height(99).innerWidth();\r\n                    parent.remove();\r\n                }\r\n            }\r\n\r\n            if (!$el.attr('id')) {\r\n                $el.attr('id', 'j-popup-' + parseInt(Math.random() * 100000000));\r\n            }\r\n\r\n            $el.addClass('popup_content');\r\n\r\n            $body.prepend(el);\r\n\r\n            $el.wrap('<div id=\"' + el.id + '_wrapper\" class=\"popup_wrapper\" />');\r\n\r\n            $wrapper = $('#' + el.id + '_wrapper');\r\n\r\n            $wrapper.css({\r\n                opacity: 0,\r\n                visibility: 'hidden',\r\n                position: 'absolute',\r\n                overflow: 'auto'\r\n            });\r\n\r\n            $el.css({\r\n                opacity: 0,\r\n                visibility: 'hidden',\r\n                display: 'inline-block'\r\n            });\r\n\r\n            if (options.setzindex && !options.autozindex) {\r\n                $wrapper.css('z-index', '2001');\r\n            }\r\n\r\n            if (!options.outline) {\r\n                $el.css('outline', 'none');\r\n            }\r\n\r\n            if (options.transition) {\r\n                $el.css('transition', options.transition);\r\n                $wrapper.css('transition', options.transition);\r\n            }\r\n\r\n            // Hide popup content from screen readers initially\r\n            $(el).attr('aria-hidden', true);\r\n\r\n            if ((options.background) && (!$('#' + el.id + '_background').length)) {\r\n\r\n                var popupbackground = '<div id=\"' + el.id + '_background\" class=\"popup_background\"></div>';\r\n\r\n                $body.prepend(popupbackground);\r\n\r\n                var $background = $('#' + el.id + '_background');\r\n\r\n                $background.css({\r\n                    opacity: 0,\r\n                    visibility: 'hidden',\r\n                    backgroundColor: options.color,\r\n                    position: 'fixed',\r\n                    top: 0,\r\n                    right: 0,\r\n                    bottom: 0,\r\n                    left: 0\r\n                });\r\n\r\n                if (options.setzindex && !options.autozindex) {\r\n                    $background.css('z-index', '2000');\r\n                }\r\n\r\n                if (options.transition) {\r\n                    $background.css('transition', options.transition);\r\n                }\r\n            }\r\n\r\n            if (options.type == 'overlay') {\r\n                $el.css({\r\n                    textAlign: 'left',\r\n                    position: 'relative',\r\n                    verticalAlign: 'middle'\r\n                });\r\n\r\n                $wrapper.css({\r\n                    position: 'fixed',\r\n                    top: 0,\r\n                    right: 0,\r\n                    left: 0,\r\n                    bottom: 0,\r\n                    textAlign: 'center'\r\n                });\r\n\r\n                // CSS vertical align helper\r\n                $wrapper.append('<div class=\"popup_align\" />');\r\n\r\n                $('.popup_align').css({\r\n                    display: 'inline-block',\r\n                    verticalAlign: 'middle',\r\n                    height: '100%'\r\n                });\r\n            }\r\n\r\n            // Add WAI ARIA role to announce dialog to screen readers\r\n            $el.attr('role', 'dialog');\r\n\r\n            var openelement =  (options.openelement) ? options.openelement : ('.' + el.id + opensuffix);\r\n\r\n            $(openelement).each(function (i, item) {\r\n                $(item).attr('data-popup-ordinal', i);\r\n\r\n                if (!$(item).attr('id')) {\r\n                    $(item).attr('id', 'open_' + parseInt((Math.random() * 100000000), 10));\r\n                }\r\n            });\r\n\r\n            // Set aria-labelledby (if aria-label or aria-labelledby is not set in html)\r\n            if (!($el.attr('aria-labelledby') || $el.attr('aria-label'))) {\r\n                $el.attr('aria-labelledby', $(openelement).attr('id'));\r\n            }\r\n\r\n            $(document).on('click', openelement, function (e) {\r\n                if (!($el.data('popup-visible'))) {\r\n                    var ord = $(this).data('popup-ordinal');\r\n\r\n                    // Show element when clicked on `open` link.\r\n                    // setTimeout is to allow `close` method to finish (for issues with multiple tooltips)\r\n                    setTimeout(function() {\r\n                        methods.show(el, ord);\r\n                    }, 0);\r\n\r\n                    e.preventDefault();\r\n                }\r\n            });\r\n\r\n            // Handler: `close` element\r\n            var closeelement = (options.closeelement) ? options.closeelement : ('.' + el.id + closesuffix);\r\n            $(document).on('click', closeelement, function (e) {\r\n                methods.hide(el);\r\n                e.preventDefault();\r\n            });\r\n\r\n            if (options.detach) {\r\n                $el.hide().detach();\r\n            } else {\r\n                $wrapper.hide();\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Show method\r\n         *\r\n         * @param {object} el - popup instance DOM node\r\n         * @param {number} ordinal - order number of an `open` element\r\n         */\r\n        show: function (el, ordinal) {\r\n            var $el = $(el);\r\n\r\n            if ($el.data('popup-visible')) return;\r\n\r\n            // Initialize if not initialized. Required for: $('#popup').popup('show')\r\n            if (!$el.data('popup-initialized')) {\r\n                methods._init(el);\r\n            }\r\n            $el.attr('data-popup-initialized', 'true');\r\n\r\n            var $body = $('body');\r\n            var options = $el.data('popupoptions');\r\n            var $wrapper = $('#' + el.id + '_wrapper');\r\n            var $background = $('#' + el.id + '_background');\r\n\r\n            // `beforeopen` callback event\r\n            callback(el, ordinal, options.beforeopen);\r\n\r\n            // Remember last clicked place\r\n            lastclicked[el.id] = ordinal;\r\n\r\n            if (options.detach) {\r\n                $wrapper.prepend(el);\r\n                $el.show();\r\n            } else {\r\n                $wrapper.show();\r\n            }\r\n\r\n            setTimeout(function() {\r\n                $wrapper.css({\r\n                    visibility: 'visible',\r\n                    opacity: 1\r\n                });\r\n\r\n                $('html').addClass('popup_visible').addClass('popup_visible_' + el.id);\r\n                $el.addClass('popup_content_visible');\r\n            }, 20);\r\n\r\n\r\n            $el.css({\r\n                'visibility': 'visible',\r\n                'opacity': 1\r\n            });\r\n\r\n            // Disable background layer scrolling when popup is opened\r\n            if (options.scrolllock) {\r\n                $body.css('overflow', 'hidden');\r\n                if ($body.height() > $window.height()) {\r\n                    $body.css('margin-right', bodymarginright + scrollbarwidth);\r\n                }\r\n            }\r\n\r\n            setTimeout(function () {\r\n                // Set event handlers\r\n                if(!onevisible) {\r\n                    if (options.keepfocus) {\r\n                        $(document).on('focusin', focushandler)\r\n                    };\r\n\r\n                    if (options.blur) {\r\n                        $(document).on('click', blurhandler);\r\n                    }\r\n\r\n                    if (options.escape) {\r\n                        $(document).on('keydown', escapehandler);\r\n                    }\r\n                }\r\n\r\n                // Set plugin state\r\n                if (!onevisible) {\r\n                    onevisible = true;\r\n                } else {\r\n                    oneormorevisible = true;\r\n                }\r\n            }, 0);\r\n\r\n            $el.data('popup-visible', true);\r\n\r\n            // Position popup\r\n            methods.reposition(el, ordinal);\r\n\r\n            // Show background\r\n            if (options.background) {\r\n                $background.css({\r\n                    'visibility': 'visible',\r\n                    'opacity': options.opacity\r\n                });\r\n\r\n                // Fix IE8 issue with background not appearing\r\n                setTimeout(function() {\r\n                    $background.css({\r\n                        'opacity': options.opacity\r\n                    });\r\n                }, 0);\r\n            }\r\n\r\n            // Remember which element had focus before opening a popup\r\n            focusedelementbeforepopup = document.activeElement;\r\n\r\n            // Handler: Keep focus inside dialog box\r\n            if (options.keepfocus) {\r\n\r\n                // Make holder div focusable\r\n                $el.attr('tabindex', -1);\r\n\r\n                // Focus popup or user specified element.\r\n                // Initial timeout of 50ms is set to give some time to popup to show after clicking on\r\n                // `open` element, and after animation is complete to prevent background scrolling.\r\n                setTimeout(function() {\r\n                    if (options.focuselement) {\r\n                        $(options.focuselement).focus();\r\n                    } else {\r\n                        $el.focus();\r\n                    }\r\n                }, options.focusdelay);\r\n\r\n                // Handler for keyboard focus\r\n                focushandler = function(event) {\r\n                    var dialog = document.getElementById(el.id);\r\n                    if (!dialog.contains(event.target)) {\r\n                        event.stopPropagation();\r\n                        dialog.focus();\r\n                    }\r\n                };\r\n            }\r\n\r\n            // Calculating maximum z-index\r\n            if (options.autozindex) {\r\n\r\n                var elements = document.getElementsByTagName('*');\r\n                var len = elements.length;\r\n                var maxzindex = 0;\r\n\r\n                for(var i=0; i<len; i++){\r\n\r\n                    var elementzindex = $(elements[i]).css('z-index');\r\n\r\n                    if(elementzindex !== 'auto'){\r\n\r\n                      elementzindex = parseInt(elementzindex);\r\n\r\n                      if(maxzindex < elementzindex){\r\n                        maxzindex = elementzindex;\r\n                      }\r\n                    }\r\n                }\r\n\r\n                zindexvalues[el.id] = maxzindex;\r\n\r\n                // Add z-index to the wrapper\r\n                if (zindexvalues[el.id] > 0) {\r\n                    $wrapper.css({\r\n                        zIndex: (zindexvalues[el.id] + 2)\r\n                    });\r\n                }\r\n\r\n                // Add z-index to the background\r\n                if (options.background) {\r\n                    if (zindexvalues[el.id] > 0) {\r\n                        $('#' + el.id + '_background').css({\r\n                            zIndex: (zindexvalues[el.id] + 1)\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n\r\n            // Handler: Hide popup if clicked outside of it\r\n            if (options.blur) {\r\n                blurhandler = function (e) {\r\n                    if (!$(e.target).parents().andSelf().is('#' + el.id)) {\r\n                        methods.hide(el);\r\n                    }\r\n                };\r\n            }\r\n\r\n            // Handler: Close popup on ESC key\r\n            if (options.escape) {\r\n                escapehandler = function (e) {\r\n                    if (e.keyCode == 27 && $el.data('popup-visible')) {\r\n                        methods.hide(el);\r\n                    }\r\n                };\r\n            }\r\n\r\n            // Hide main content from screen readers\r\n            $(options.pagecontainer).attr('aria-hidden', true);\r\n\r\n            // Reveal popup content to screen readers\r\n            $el.attr('aria-hidden', false);\r\n\r\n            $wrapper.one('transitionend', function() {\r\n                callback(el, ordinal, options.opentransitionend);\r\n            });\r\n\r\n            callback(el, ordinal, options.onopen);\r\n        },\r\n\r\n        /**\r\n         * Hide method\r\n         *\r\n         * @param {object} el - popup instance DOM node\r\n         */\r\n        hide: function (el) {\r\n\r\n            var $body = $('body');\r\n            var $el = $(el);\r\n            var options = $el.data('popupoptions');\r\n            var $wrapper = $('#' + el.id + '_wrapper');\r\n            var $background = $('#' + el.id + '_background');\r\n\r\n            $el.data('popup-visible', false);\r\n\r\n            if (oneormorevisible) {\r\n                $('html').removeClass('popup_visible_' + el.id);\r\n                oneormorevisible = false;\r\n            } else {\r\n                $('html').removeClass('popup_visible').removeClass('popup_visible_' + el.id);\r\n                onevisible = false;\r\n            }\r\n\r\n            $el.removeClass('popup_content_visible');\r\n\r\n            // Re-enable scrolling of background layer\r\n            if (options.scrolllock) {\r\n                setTimeout(function() {\r\n                    $body.css({\r\n                        overflow: 'visible',\r\n                        'margin-right': bodymarginright\r\n                    });\r\n                }, 10); // 10ms added for CSS transition in Firefox which doesn't like overflow:auto\r\n            }\r\n\r\n            // Unbind blur handler\r\n            if (options.blur) {\r\n                $(document).off('click', blurhandler);\r\n            }\r\n\r\n            if (options.keepfocus) {\r\n\r\n                // Unbind focus handler\r\n                $(document).off('focusin', focushandler);\r\n\r\n                // Focus back on saved element\r\n                setTimeout(function() {\r\n                    if ($(focusedelementbeforepopup).is(':visible')) {\r\n                        focusedelementbeforepopup.focus();\r\n                    }\r\n                }, 0);\r\n            }\r\n\r\n            // Unbind ESC key handler\r\n            if (options.escape) {\r\n                $(document).off('keydown', escapehandler);\r\n            }\r\n\r\n            // Hide popup\r\n            $wrapper.css({\r\n                'visibility': 'hidden',\r\n                'opacity': 0\r\n            });\r\n            $el.css({\r\n                'visibility': 'hidden',\r\n                'opacity': 0\r\n            });\r\n\r\n            // Hide background\r\n            if (options.background) {\r\n                $background.css({\r\n                    'visibility': 'hidden',\r\n                    'opacity': 0\r\n                });\r\n            }\r\n\r\n            // After closing CSS transition is over... (if transition is set and supported)\r\n            $el.one('transitionend', function(e) {\r\n\r\n                if (!($el.data('popup-visible'))) {\r\n                    if (options.detach) {\r\n                        $el.hide().detach();\r\n                    } else {\r\n                        $wrapper.hide();\r\n                    }\r\n                }\r\n\r\n                if (!options.notransitiondetach) {\r\n                    callback(el, lastclicked[el.id], options.closetransitionend);\r\n                }\r\n            });\r\n\r\n            if (options.notransitiondetach) {\r\n                if (options.detach) {\r\n                    $el.hide().detach();\r\n                } else {\r\n                    $wrapper.hide();\r\n                }\r\n            }\r\n\r\n            // Reveal main content to screen readers\r\n            $(options.pagecontainer).attr('aria-hidden', false);\r\n\r\n            // Hide popup content from screen readers\r\n            $el.attr('aria-hidden', true);\r\n\r\n            // `onclose` callback event\r\n            callback(el, lastclicked[el.id], options.onclose);\r\n        },\r\n\r\n        /**\r\n         * Toggle method\r\n         *\r\n         * @param {object} el - popup instance DOM node\r\n         * @param {number} ordinal - order number of an `open` element\r\n         */\r\n        toggle: function (el, ordinal) {\r\n            if ($el.data('popup-visible')) {\r\n                methods.hide(el);\r\n            } else {\r\n                setTimeout(function() {\r\n                    methods.show(el, ordinal);\r\n                }, 0);\r\n            }\r\n        },\r\n\r\n        /**\r\n         * Reposition method\r\n         *\r\n         * @param {object} el - popup instance DOM node\r\n         * @param {number} ordinal - order number of an `open` element\r\n         */\r\n        reposition: function (el, ordinal) {\r\n            var $el = $(el);\r\n            var options = $el.data('popupoptions');\r\n            var $wrapper = $('#' + el.id + '_wrapper');\r\n            var $background = $('#' + el.id + '_background');\r\n\r\n            ordinal = ordinal || 0;\r\n\r\n            // Tooltip type\r\n            if (options.type == 'tooltip') {\r\n                $wrapper.css({\r\n                    'position': 'absolute'\r\n                });\r\n                var openelement =  (options.openelement) ? options.openelement : ('.' + el.id + opensuffix);\r\n                var $elementclicked = $(openelement + '[data-popup-ordinal=\"' + ordinal + '\"]');\r\n                var linkOffset = $elementclicked.offset();\r\n\r\n                // Horizontal position for tooltip\r\n                if (options.horizontal == 'right') {\r\n                    $wrapper.css('left', linkOffset.left + $elementclicked.outerWidth() + options.offsetleft);\r\n                } else if (options.horizontal == 'leftedge') {\r\n                    $wrapper.css('left', linkOffset.left + $elementclicked.outerWidth() - $elementclicked.outerWidth() +  options.offsetleft);\r\n                } else if (options.horizontal == 'left') {\r\n                    $wrapper.css('right', $(window).width() - linkOffset.left  - options.offsetleft);\r\n                } else if (options.horizontal == 'rightedge') {\r\n                    $wrapper.css('right', $(window).width()  - linkOffset.left - $elementclicked.outerWidth() - options.offsetleft);\r\n                } else {\r\n                    $wrapper.css('left', linkOffset.left + ($elementclicked.outerWidth() / 2) - ($el.outerWidth() / 2) - parseFloat($el.css('marginLeft')) + options.offsetleft);\r\n                }\r\n\r\n                // Vertical position for tooltip\r\n                if (options.vertical == 'bottom') {\r\n                    $wrapper.css('top', linkOffset.top + $elementclicked.outerHeight() + options.offsettop);\r\n                } else if (options.vertical == 'bottomedge') {\r\n                    $wrapper.css('top', linkOffset.top + $elementclicked.outerHeight() - $el.outerHeight() + options.offsettop);\r\n                } else if (options.vertical == 'top') {\r\n                    $wrapper.css('bottom', $(window).height() - linkOffset.top - options.offsettop);\r\n                } else if (options.vertical == 'topedge') {\r\n                    $wrapper.css('bottom', $(window).height() - linkOffset.top - $el.outerHeight() - options.offsettop);\r\n                } else {\r\n                    $wrapper.css('top', linkOffset.top + ($elementclicked.outerHeight() / 2) - ($el.outerHeight() / 2) - parseFloat($el.css('marginTop')) + options.offsettop);\r\n                }\r\n\r\n            // Overlay type\r\n            } else if (options.type == 'overlay') {\r\n\r\n                // Horizontal position for overlay\r\n                if (options.horizontal) {\r\n                    $wrapper.css('text-align', options.horizontal);\r\n                } else {\r\n                    $wrapper.css('text-align', 'center');\r\n                }\r\n\r\n                // Vertical position for overlay\r\n                if (options.vertical) {\r\n                    $el.css('vertical-align', options.vertical);\r\n                } else {\r\n                    $el.css('vertical-align', 'middle');\r\n                }\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n    /**\r\n     * Callback event calls\r\n     *\r\n     * @param {object} el - popup instance DOM node\r\n     * @param {number} ordinal - order number of an `open` element\r\n     * @param {function} func - callback function\r\n     */\r\n    var callback = function (el, ordinal, func) {\r\n        var openelement =  (options.openelement) ? options.openelement : ('.' + el.id + opensuffix);\r\n        var elementclicked = $(openelement + '[data-popup-ordinal=\"' + ordinal + '\"]');\r\n        if (typeof func == 'function') {\r\n            func(elementclicked);\r\n        }\r\n    };\r\n\r\n    /**\r\n     * Plugin API\r\n     */\r\n    $.fn.popup = function (customoptions) {\r\n        return this.each(function () {\r\n\r\n            $el = $(this);\r\n\r\n            if (typeof customoptions === 'object') {  // e.g. $('#popup').popup({'color':'blue'})\r\n                var opt = $.extend({}, $.fn.popup.defaults, customoptions);\r\n                $el.data('popupoptions', opt);\r\n                options = $el.data('popupoptions');\r\n\r\n                methods._init(this);\r\n\r\n            } else if (typeof customoptions === 'string') { // e.g. $('#popup').popup('hide')\r\n                if (!($el.data('popupoptions'))) {\r\n                    $el.data('popupoptions', $.fn.popup.defaults);\r\n                    options = $el.data('popupoptions');\r\n                }\r\n\r\n                methods[customoptions].call(this, this);\r\n\r\n            } else { // e.g. $('#popup').popup()\r\n                if (!($el.data('popupoptions'))) {\r\n                    $el.data('popupoptions', $.fn.popup.defaults);\r\n                    options = $el.data('popupoptions');\r\n                }\r\n\r\n                methods._init(this);\r\n\r\n            }\r\n\r\n        });\r\n    };\r\n\r\n    $.fn.popup.defaults = {\r\n        type: 'overlay',\r\n        autoopen: false,\r\n        background: true,\r\n        color: 'black',\r\n        opacity: '0.5',\r\n        horizontal: 'center',\r\n        vertical: 'middle',\r\n        offsettop: 0,\r\n        offsetleft: 0,\r\n        escape: true,\r\n        blur: true,\r\n        setzindex: true,\r\n        autozindex: false,\r\n        scrolllock: false,\r\n        keepfocus: true,\r\n        focuselement: null,\r\n        focusdelay: 50,\r\n        outline: false,\r\n        pagecontainer: null,\r\n        detach: false,\r\n        openelement: null,\r\n        closeelement: null,\r\n        transition: null,\r\n        notransitiondetach: false,\r\n        beforeopen: function(){},\r\n        onclose: function(){},\r\n        onopen: function(){},\r\n        opentransitionend: function(){},\r\n        closetransitionend: function(){}\r\n    };\r\n\r\n})(jQuery);\n/*!\r\n * jQuery Cookie Plugin v1.4.1\r\n * https://github.com/carhartl/jquery-cookie\r\n *\r\n * Copyright 2013 Klaus Hartl\r\n * Released under the MIT license\r\n */\r\n(function (factory) {\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\t// AMD\r\n\t\tdefine(['jquery'], factory);\r\n\t} else if (typeof exports === 'object') {\r\n\t\t// CommonJS\r\n\t\tfactory(require('jquery'));\r\n\t} else {\r\n\t\t// Browser globals\r\n\t\tfactory(jQuery);\r\n\t}\r\n}(function ($) {\r\n\r\n\tvar pluses = /\\+/g;\r\n\r\n\tfunction encode(s) {\r\n\t\treturn config.raw ? s : encodeURIComponent(s);\r\n\t}\r\n\r\n\tfunction decode(s) {\r\n\t\treturn config.raw ? s : decodeURIComponent(s);\r\n\t}\r\n\r\n\tfunction stringifyCookieValue(value) {\r\n\t\treturn encode(config.json ? JSON.stringify(value) : String(value));\r\n\t}\r\n\r\n\tfunction parseCookieValue(s) {\r\n\t\tif (s.indexOf('\"') === 0) {\r\n\t\t\t// This is a quoted cookie as according to RFC2068, unescape...\r\n\t\t\ts = s.slice(1, -1).replace(/\\\\\"/g, '\"').replace(/\\\\\\\\/g, '\\\\');\r\n\t\t}\r\n\r\n\t\ttry {\r\n\t\t\t// Replace server-side written pluses with spaces.\r\n\t\t\t// If we can't decode the cookie, ignore it, it's unusable.\r\n\t\t\t// If we can't parse the cookie, ignore it, it's unusable.\r\n\t\t\ts = decodeURIComponent(s.replace(pluses, ' '));\r\n\t\t\treturn config.json ? JSON.parse(s) : s;\r\n\t\t} catch(e) {}\r\n\t}\r\n\r\n\tfunction read(s, converter) {\r\n\t\tvar value = config.raw ? s : parseCookieValue(s);\r\n\t\treturn $.isFunction(converter) ? converter(value) : value;\r\n\t}\r\n\r\n\tvar config = $.cookie = function (key, value, options) {\r\n\r\n\t\t// Write\r\n\r\n\t\tif (value !== undefined && !$.isFunction(value)) {\r\n\t\t\toptions = $.extend({}, config.defaults, options);\r\n\r\n\t\t\tif (typeof options.expires === 'number') {\r\n\t\t\t\tvar days = options.expires, t = options.expires = new Date();\r\n\t\t\t\tt.setTime(+t + days * 864e+5);\r\n\t\t\t}\r\n\r\n\t\t\treturn (document.cookie = [\r\n\t\t\t\tencode(key), '=', stringifyCookieValue(value),\r\n\t\t\t\toptions.expires ? '; expires=' + options.expires.toUTCString() : '', // use expires attribute, max-age is not supported by IE\r\n\t\t\t\toptions.path    ? '; path=' + options.path : '',\r\n\t\t\t\toptions.domain  ? '; domain=' + options.domain : '',\r\n\t\t\t\toptions.secure  ? '; secure' : ''\r\n\t\t\t].join(''));\r\n\t\t}\r\n\r\n\t\t// Read\r\n\r\n\t\tvar result = key ? undefined : {};\r\n\r\n\t\t// To prevent the for loop in the first place assign an empty array\r\n\t\t// in case there are no cookies at all. Also prevents odd result when\r\n\t\t// calling $.cookie().\r\n\t\tvar cookies = document.cookie ? document.cookie.split('; ') : [];\r\n\r\n\t\tfor (var i = 0, l = cookies.length; i < l; i++) {\r\n\t\t\tvar parts = cookies[i].split('=');\r\n\t\t\tvar name = decode(parts.shift());\r\n\t\t\tvar cookie = parts.join('=');\r\n\r\n\t\t\tif (key && key === name) {\r\n\t\t\t\t// If second argument (value) is a function it's a converter...\r\n\t\t\t\tresult = read(cookie, value);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\r\n\t\t\t// Prevent storing a cookie that we couldn't decode.\r\n\t\t\tif (!key && (cookie = read(cookie)) !== undefined) {\r\n\t\t\t\tresult[name] = cookie;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn result;\r\n\t};\r\n\r\n\tconfig.defaults = {};\r\n\r\n\t$.removeCookie = function (key, options) {\r\n\t\tif ($.cookie(key) === undefined) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t// Must not alter options, thus extending a fresh object...\r\n\t\t$.cookie(key, '', $.extend({}, options, { expires: -1 }));\r\n\t\treturn !$.cookie(key);\r\n\t};\r\n\r\n}));\r\n\n/*!\r\n *         ,/\r\n *       ,'/\r\n *     ,' /\r\n *   ,'  /_____,\r\n * .'____    ,'\r\n *      /  ,'\r\n *     / ,'\r\n *    /,'\r\n *   /'\r\n *\r\n * Selectric ϟ v1.9.6 (Mar 24 2016) - http://lcdsantos.github.io/jQuery-Selectric/\r\n *\r\n * Copyright (c) 2016 Leonardo Santos; MIT License\r\n *\r\n */\r\n\r\n(function(factory) {\r\n  /* istanbul ignore next */\r\n  if (typeof define === 'function' && define.amd) {\r\n    define(['jquery'], factory);\r\n  } else if (typeof module === 'object' && module.exports) {\r\n    // Node/CommonJS\r\n    module.exports = function( root, jQuery ) {\r\n      if ( jQuery === undefined ) {\r\n        if ( typeof window !== 'undefined' ) {\r\n          jQuery = require('jquery');\r\n        }\r\n        else {\r\n          jQuery = require('jquery')(root);\r\n        }\r\n      }\r\n      factory(jQuery);\r\n      return jQuery;\r\n    };\r\n  } else {\r\n    // Browser globals\r\n    factory(jQuery);\r\n  }\r\n}(function($) {\r\n\r\n  'use strict';\r\n\r\n  var pluginName = 'selectric',\r\n      classList = 'Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive Above Scroll Group GroupLabel',\r\n      bindSufix = '.sl',\r\n      defaults = {\r\n        onChange: function(elm) { $(elm).change(); },\r\n        maxHeight: 300,\r\n        keySearchTimeout: 500,\r\n        arrowButtonMarkup: '<b class=\"button\">&#x25be;</b>',\r\n        disableOnMobile: true,\r\n        openOnHover: false,\r\n        hoverIntentTimeout: 500,\r\n        expandToItemText: false,\r\n        responsive: false,\r\n        preventWindowScroll: true,\r\n        inheritOriginalWidth: false,\r\n        allowWrap: true,\r\n        customClass: {\r\n          prefix: pluginName,\r\n          camelCase: false\r\n        },\r\n        optionsItemBuilder: '{text}', // function(itemData, element, index)\r\n        labelBuilder: '{text}' // function(currItem)\r\n      },\r\n      hooks = {\r\n        add: function(callbackName, hookName, fn) {\r\n          if ( !this[callbackName] )\r\n            this[callbackName] = {};\r\n\r\n          this[callbackName][hookName] = fn;\r\n        },\r\n        remove: function(callbackName, hookName) {\r\n          delete this[callbackName][hookName];\r\n        }\r\n      },\r\n      _utils = {\r\n        // Replace diacritics\r\n        replaceDiacritics: function(s) {\r\n          // /[\\340-\\346]/g, // a\r\n          // /[\\350-\\353]/g, // e\r\n          // /[\\354-\\357]/g, // i\r\n          // /[\\362-\\370]/g, // o\r\n          // /[\\371-\\374]/g, // u\r\n          // /[\\361]/g,      // n\r\n          // /[\\347]/g,      // c\r\n          // /[\\377]/g       // y\r\n          var d = '40-46 50-53 54-57 62-70 71-74 61 47 77'.replace(/\\d+/g, '\\\\3$&').split(' '),\r\n              k = d.length;\r\n\r\n          while (k--)\r\n            s = s.toLowerCase().replace(RegExp('[' + d[k] + ']', 'g'), 'aeiouncy'.charAt(k));\r\n\r\n          return s;\r\n        },\r\n        // https://gist.github.com/atesgoral/984375\r\n        format: function(f) {var a=arguments;return(\"\"+f).replace(/{(\\d+|(\\w+))}/g,function(s,i,p) {return p&&a[1]?a[1][p]:a[i]})},\r\n        nextEnabledItem: function(selectItems, selected) {\r\n          while ( selectItems[ selected = (selected + 1) % selectItems.length ].disabled ) {}\r\n          return selected;\r\n        },\r\n        previousEnabledItem: function(selectItems, selected) {\r\n          while ( selectItems[ selected = (selected > 0 ? selected : selectItems.length) - 1 ].disabled ) {}\r\n          return selected;\r\n        },\r\n        toDash: function(str) {\r\n          return str.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\r\n        },\r\n        triggerCallback: function(fn, scope) {\r\n          var elm = scope.element,\r\n              func = scope.options['on' + fn];\r\n\r\n          if ( $.isFunction(func) )\r\n            func.call(elm, elm, scope);\r\n\r\n          if ( hooks[fn] ) {\r\n            $.each(hooks[fn], function() {\r\n              this.call(elm, elm, scope);\r\n            });\r\n          }\r\n\r\n          $(elm).trigger(pluginName + '-' + _utils.toDash(fn), scope);\r\n        }\r\n      },\r\n      $doc = $(document),\r\n      $win = $(window),\r\n      Selectric = function(element, opts) {\r\n        var _this = this,\r\n            $original = $(element),\r\n            $input, $items, $itemsScroll, $wrapper, $label, $outerWrapper, $li,\r\n            isOpen = false,\r\n            isEnabled = false,\r\n            selected,\r\n            currValue,\r\n            itemsHeight,\r\n            itemsInnerHeight,\r\n            finalWidth,\r\n            optionsLength,\r\n            eventTriggers,\r\n            isMobile = /android|ip(hone|od|ad)/i.test(navigator.userAgent),\r\n            tabindex = $original.prop('tabindex'),\r\n            labelBuilder;\r\n\r\n        function _init(opts) {\r\n          _this.options = $.extend(true, {}, defaults, _this.options, opts);\r\n          _this.classes = {};\r\n          _this.element = element;\r\n\r\n          _utils.triggerCallback('BeforeInit', _this);\r\n\r\n          // Disable on mobile browsers\r\n          if ( _this.options.disableOnMobile && isMobile ) {\r\n            _this.disableOnMobile = true;\r\n            return;\r\n          }\r\n\r\n          // Preserve data\r\n          _destroy(true);\r\n\r\n          // Generate classNames for elements\r\n          var customClass   = _this.options.customClass,\r\n              postfixes     = classList.split(' '),\r\n              originalWidth = $original.width();\r\n\r\n          $.each(postfixes, function(i, currClass) {\r\n            var c = customClass.prefix + currClass;\r\n            _this.classes[currClass.toLowerCase()] = customClass.camelCase ? c : _utils.toDash(c);\r\n          });\r\n\r\n          $input        = $('<input/>', { 'class': _this.classes.input, 'readonly': isMobile });\r\n          $items        = $('<div/>',   { 'class': _this.classes.items, 'tabindex': -1 });\r\n          $itemsScroll  = $('<div/>',   { 'class': _this.classes.scroll });\r\n          $wrapper      = $('<div/>',   { 'class': customClass.prefix, 'html': _this.options.arrowButtonMarkup });\r\n          $label        = $('<p class=\"label\"/>');\r\n          $outerWrapper = $original.wrap('<div>').parent().append($wrapper.prepend($label), $items, $input);\r\n\r\n          eventTriggers = {\r\n            open    : _open,\r\n            close   : _close,\r\n            destroy : _destroy,\r\n            refresh : _refresh,\r\n            init    : _init\r\n          };\r\n\r\n          $original.on(eventTriggers).wrap('<div class=\"' + _this.classes.hideselect + '\">');\r\n          $.extend(_this, eventTriggers);\r\n\r\n          labelBuilder = _this.options.labelBuilder;\r\n\r\n          if ( _this.options.inheritOriginalWidth && originalWidth > 0 )\r\n            $outerWrapper.width(originalWidth);\r\n\r\n          _populate();\r\n        }\r\n\r\n        // Generate options markup and event binds\r\n        function _populate() {\r\n          _this.items = [];\r\n\r\n          var $options = $original.children(),\r\n              _$li = '<ul>',\r\n              $justOptions = $original.find('option'),\r\n              selectedIndex = $justOptions.index($justOptions.filter(':selected')),\r\n              currIndex = 0;\r\n\r\n          currValue = (selected = ~selectedIndex ? selectedIndex : 0);\r\n\r\n          if ( optionsLength = $options.length ) {\r\n            // Build options markup\r\n            $options.each(function() {\r\n              var $elm = $(this);\r\n\r\n              if ( $elm.is('optgroup') ) {\r\n                var groupDisabled = $elm.prop('disabled'),\r\n                    $children = $elm.children();\r\n\r\n                _$li += _utils.format('<ul class=\"{1}\"><li class=\"{2}\">{3}</li>',\r\n                  $.trim([_this.classes.group, groupDisabled ? 'disabled' : '', $elm.prop('class')].join(' ')),\r\n                  _this.classes.grouplabel,\r\n                  $elm.prop('label')\r\n                );\r\n\r\n                if ( groupDisabled ) {\r\n                  $children.prop('disabled', true);\r\n                }\r\n\r\n                $children.each(buildOption);\r\n\r\n                _$li += '</ul>';\r\n              } else {\r\n                buildOption.call($elm);\r\n              }\r\n\r\n              function buildOption() {\r\n                var $elm = $(this),\r\n                    optionText = $elm.html(),\r\n                    selectDisabled = $elm.prop('disabled'),\r\n                    itemBuilder = _this.options.optionsItemBuilder;\r\n\r\n                _this.items[currIndex] = {\r\n                  element  : $elm,\r\n                  value    : $elm.val(),\r\n                  text     : optionText,\r\n                  slug     : _utils.replaceDiacritics(optionText),\r\n                  disabled : selectDisabled\r\n                };\r\n\r\n                _$li += _utils.format('<li data-index=\"{1}\" class=\"{2}\">{3}</li>',\r\n                  currIndex,\r\n                  $.trim([currIndex == currValue ? 'selected' : '', currIndex == optionsLength - 1 ? 'last' : '', selectDisabled ? 'disabled' : ''].join(' ')),\r\n                  $.isFunction(itemBuilder) ? itemBuilder(_this.items[currIndex], $elm, currIndex) : _utils.format(itemBuilder, _this.items[currIndex])\r\n                );\r\n\r\n                currIndex++;\r\n              }\r\n            });\r\n\r\n            $items.append( $itemsScroll.html(_$li + '</ul>') );\r\n\r\n            $label.html(\r\n              $.isFunction(labelBuilder) ? labelBuilder(_this.items[currValue]) : _utils.format(labelBuilder, _this.items[currValue])\r\n            )\r\n          }\r\n\r\n          $wrapper.add($original).add($outerWrapper).add($input).off(bindSufix);\r\n\r\n          $outerWrapper.prop('class', [\r\n            _this.classes.wrapper,\r\n            $original.prop('class').replace(/\\S+/g, _this.options.customClass.prefix + '-$&'),\r\n            _this.options.responsive ? _this.classes.responsive : ''\r\n          ].join(' '));\r\n\r\n          if ( !$original.prop('disabled') ) {\r\n            isEnabled = true;\r\n\r\n            // Not disabled, so... Removing disabled class and bind hover\r\n            $outerWrapper.removeClass(_this.classes.disabled).on('mouseenter' + bindSufix + ' mouseleave' + bindSufix, function(e) {\r\n              $(this).toggleClass(_this.classes.hover);\r\n\r\n              // Delay close effect when openOnHover is true\r\n              if ( _this.options.openOnHover ) {\r\n                clearTimeout(_this.closeTimer);\r\n                e.type == 'mouseleave' ? _this.closeTimer = setTimeout(_close, _this.options.hoverIntentTimeout) : _open();\r\n              }\r\n            });\r\n\r\n            // Toggle open/close\r\n            $wrapper.on('click' + bindSufix, function(e) {\r\n              isOpen ? _close() : _open(e);\r\n            });\r\n\r\n            $input\r\n              .prop({\r\n                tabindex: tabindex,\r\n                disabled: false\r\n              })\r\n              .on('keypress' + bindSufix, _handleSystemKeys)\r\n              .on('keydown' + bindSufix, function(e) {\r\n                _handleSystemKeys(e);\r\n\r\n                // Clear search\r\n                clearTimeout(_this.resetStr);\r\n                _this.resetStr = setTimeout(function() {\r\n                  $input.val('');\r\n                }, _this.options.keySearchTimeout);\r\n\r\n                var key = e.keyCode || e.which;\r\n\r\n                // If it's a directional key\r\n                // 37 => Left\r\n                // 38 => Up\r\n                // 39 => Right\r\n                // 40 => Down\r\n                if ( key > 36 && key < 41 ) {\r\n                  if ( !_this.options.allowWrap ) {\r\n                    if ( (key < 39 && selected == 0) || (key > 38 && (selected + 1) == _this.items.length) ) {\r\n                      return;\r\n                    }\r\n                  }\r\n\r\n                  _select(_utils[(key < 39 ? 'previous' : 'next') + 'EnabledItem'](_this.items, selected));\r\n                }\r\n              })\r\n              .on('focusin' + bindSufix, function(e) {\r\n                isOpen || _open(e);\r\n              })\r\n              .on('oninput' in $input[0] ? 'input' : 'keyup', function() {\r\n                if ( $input.val().length ) {\r\n                  // Search in select options\r\n                  $.each(_this.items, function(i, elm) {\r\n                    if ( RegExp('^' + $input.val(), 'i').test(elm.slug) && !elm.disabled ) {\r\n                      _select(i);\r\n                      return false;\r\n                    }\r\n                  });\r\n                }\r\n              });\r\n\r\n            $original.prop('tabindex', false);\r\n\r\n            // Remove styles from items box\r\n            // Fix incorrect height when refreshed is triggered with fewer options\r\n            $li = $('li', $items.removeAttr('style')).on({\r\n              // Prevent <input> blur on Chrome\r\n              mousedown: function(e) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n              },\r\n              click: function() {\r\n                // The second parameter is to close the box after click\r\n                _select($(this).data('index'), true);\r\n\r\n                // Chrome doesn't close options box if select is wrapped with a label\r\n                // We need to 'return false' to avoid that\r\n                return false;\r\n              }\r\n            }).filter('[data-index]');\r\n          } else {\r\n            $outerWrapper.addClass(_this.classes.disabled);\r\n            $input.prop('disabled', true);\r\n          }\r\n\r\n          _utils.triggerCallback('Init', _this);\r\n        }\r\n\r\n        function _refresh() {\r\n          _utils.triggerCallback('Refresh', _this);\r\n          _populate();\r\n        }\r\n\r\n        // Behavior when system keys is pressed\r\n        function _handleSystemKeys(e) {\r\n          var key = e.keyCode || e.which;\r\n\r\n          if ( key == 13 ) {\r\n            e.preventDefault();\r\n          }\r\n\r\n          // Tab / Enter / ESC\r\n          if ( /^(9|13|27)$/.test(key) ) {\r\n            e.stopPropagation();\r\n            _select(selected, true);\r\n          }\r\n        }\r\n\r\n        // Set options box width/height\r\n        function _calculateOptionsDimensions() {\r\n          // Calculate options box height\r\n          // Set a temporary class on the hidden parent of the element\r\n          var hiddenChildren = $items.closest(':visible').children(':hidden').addClass(_this.classes.tempshow),\r\n              maxHeight = _this.options.maxHeight,\r\n              itemsWidth = $items.outerWidth(),\r\n              wrapperWidth = $wrapper.outerWidth() - (itemsWidth - $items.width());\r\n\r\n          // Set the dimensions, minimum is wrapper width, expand for long items if option is true\r\n          if ( !_this.options.expandToItemText || wrapperWidth > itemsWidth )\r\n            finalWidth = wrapperWidth;\r\n          else {\r\n            // Make sure the scrollbar width is included\r\n            $items.css('overflow', 'scroll');\r\n\r\n            // Set a really long width for $outerWrapper\r\n            $outerWrapper.width(9e4);\r\n            finalWidth = $items.width();\r\n            // Set scroll bar to auto\r\n            $items.css('overflow', '');\r\n            $outerWrapper.width('');\r\n          }\r\n\r\n          $items.width(finalWidth).height() > maxHeight && $items.height(maxHeight);\r\n\r\n          // Remove the temporary class\r\n          hiddenChildren.removeClass(_this.classes.tempshow);\r\n        }\r\n\r\n        // Open the select options box\r\n        function _open(e) {\r\n          _utils.triggerCallback('BeforeOpen', _this);\r\n\r\n          if ( e ) {\r\n            e.preventDefault();\r\n            e.stopPropagation();\r\n          }\r\n\r\n          if ( isEnabled ) {\r\n            _calculateOptionsDimensions();\r\n\r\n            // Find any other opened instances of select and close it\r\n            $('.' + _this.classes.hideselect, '.' + _this.classes.open).children()[pluginName]('close');\r\n\r\n            isOpen = true;\r\n            itemsHeight = $items.outerHeight();\r\n            itemsInnerHeight = $items.height();\r\n\r\n            // Toggle options box visibility\r\n            $outerWrapper.addClass(_this.classes.open);\r\n\r\n            // Give dummy input focus\r\n            $input.val('');\r\n            e && e.type !== 'focusin' && $input.focus();\r\n\r\n            $doc.on('click' + bindSufix, _close).on('scroll' + bindSufix, _isInViewport);\r\n            _isInViewport();\r\n\r\n            // Prevent window scroll when using mouse wheel inside items box\r\n            if ( _this.options.preventWindowScroll ) {\r\n              $doc.on('mousewheel' + bindSufix + ' DOMMouseScroll' + bindSufix, '.' + _this.classes.scroll, function(e) {\r\n                var orgEvent = e.originalEvent,\r\n                    scrollTop = $(this).scrollTop(),\r\n                    deltaY = 0;\r\n\r\n                if ( 'detail'      in orgEvent ) { deltaY = orgEvent.detail * -1; }\r\n                if ( 'wheelDelta'  in orgEvent ) { deltaY = orgEvent.wheelDelta;  }\r\n                if ( 'wheelDeltaY' in orgEvent ) { deltaY = orgEvent.wheelDeltaY; }\r\n                if ( 'deltaY'      in orgEvent ) { deltaY = orgEvent.deltaY * -1; }\r\n\r\n                if ( scrollTop == (this.scrollHeight - itemsInnerHeight) && deltaY < 0 || scrollTop == 0 && deltaY > 0 ) {\r\n                  e.preventDefault();\r\n                }\r\n              });\r\n            }\r\n\r\n            _detectItemVisibility(selected);\r\n\r\n            _utils.triggerCallback('Open', _this);\r\n          }\r\n        }\r\n\r\n        // Detect is the options box is inside the window\r\n        function _isInViewport() {\r\n          var scrollTop = $win.scrollTop();\r\n          var winHeight = $win.height();\r\n          var uiPosX = $outerWrapper.offset().top;\r\n          var uiHeight = $outerWrapper.outerHeight();\r\n\r\n          var fitsDown = (uiPosX + uiHeight + itemsHeight) <= (scrollTop + winHeight);\r\n          var fitsAbove = (uiPosX - itemsHeight) > scrollTop;\r\n\r\n          // If it does not fit below, only render it\r\n          // above it fit's there.\r\n          // It's acceptable that the user needs to\r\n          // scroll the viewport to see the cut off UI\r\n          var renderAbove = !fitsDown && fitsAbove;\r\n\r\n          $outerWrapper.toggleClass(_this.classes.above, renderAbove);\r\n        }\r\n\r\n        // Close the select options box\r\n        function _close() {\r\n          _utils.triggerCallback('BeforeClose', _this);\r\n\r\n          if ( currValue != selected ) {\r\n            _utils.triggerCallback('BeforeChange', _this);\r\n\r\n            var text = _this.items[selected].text;\r\n\r\n            // Apply changed value to original select\r\n            $original\r\n              .prop('selectedIndex', currValue = selected)\r\n              .data('value', text);\r\n\r\n            // Change label text\r\n            $label.html(\r\n              $.isFunction(labelBuilder) ? labelBuilder(_this.items[selected]) : _utils.format(labelBuilder, _this.items[selected])\r\n            )\r\n\r\n            _utils.triggerCallback('Change', _this);\r\n          }\r\n\r\n          // Remove custom events on document\r\n          $doc.off(bindSufix);\r\n\r\n          // Remove visible class to hide options box\r\n          $outerWrapper.removeClass(_this.classes.open);\r\n\r\n          isOpen = false;\r\n\r\n          _utils.triggerCallback('Close', _this);\r\n        }\r\n\r\n        // Select option\r\n        function _select(index, close) {\r\n          // Parameter index is required\r\n          if ( index == undefined ) {\r\n            return;\r\n          }\r\n\r\n          // If element is disabled, can't select it\r\n          if ( !_this.items[index].disabled ) {\r\n            // If 'close' is false (default), the options box won't close after\r\n            // each selected item, this is necessary for keyboard navigation\r\n            $li\r\n              .removeClass('selected')\r\n              .eq(selected = index)\r\n              .addClass('selected');\r\n\r\n            _detectItemVisibility(index);\r\n            close && _close();\r\n          }\r\n        }\r\n\r\n        // Detect if currently selected option is visible and scroll the options box to show it\r\n        function _detectItemVisibility(index) {\r\n          var liHeight = $li.eq(index).outerHeight(),\r\n              liTop = $li[index].offsetTop,\r\n              itemsScrollTop = $itemsScroll.scrollTop(),\r\n              scrollT = liTop + liHeight * 2;\r\n\r\n          $itemsScroll.scrollTop(\r\n            scrollT > itemsScrollTop + itemsHeight ? scrollT - itemsHeight :\r\n              liTop - liHeight < itemsScrollTop ? liTop - liHeight :\r\n                itemsScrollTop\r\n          );\r\n        }\r\n\r\n        // Unbind and remove\r\n        function _destroy(preserveData) {\r\n          if ( isEnabled ) {\r\n            $items.add($wrapper).add($input).remove();\r\n            !preserveData && $original.removeData(pluginName).removeData('value');\r\n            $original.prop('tabindex', tabindex).off(bindSufix).off(eventTriggers).unwrap().unwrap();\r\n            isEnabled = false;\r\n          }\r\n        }\r\n\r\n        _init(opts);\r\n      };\r\n\r\n  // A really lightweight plugin wrapper around the constructor,\r\n  // preventing against multiple instantiations\r\n  $.fn[pluginName] = function(args) {\r\n    return this.each(function() {\r\n      var data = $.data(this, pluginName);\r\n\r\n      if ( data && !data.disableOnMobile )\r\n        (''+args === args && data[args]) ? data[args]() : data.init(args);\r\n      else\r\n        $.data(this, pluginName, new Selectric(this, args));\r\n    });\r\n  };\r\n\r\n  $.fn[pluginName].hooks = hooks;\r\n\r\n}));\n/*!\r\n * iCheck v1.0.2, http://git.io/arlzeA\r\n * ===================================\r\n * Powerful jQuery and Zepto plugin for checkboxes and radio buttons customization\r\n *\r\n * (c) 2013 Damir Sultanov, http://fronteed.com\r\n * MIT Licensed\r\n */\r\n\r\n(function($) {\r\n\r\n  // Cached vars\r\n  var _iCheck = 'iCheck',\r\n    _iCheckHelper = _iCheck + '-helper',\r\n    _checkbox = 'checkbox',\r\n    _radio = 'radio',\r\n    _checked = 'checked',\r\n    _unchecked = 'un' + _checked,\r\n    _disabled = 'disabled',a\r\n    _determinate = 'determinate',\r\n    _indeterminate = 'in' + _determinate,\r\n    _update = 'update',\r\n    _type = 'type',\r\n    _click = 'click',\r\n    _touch = 'touchbegin.i touchend.i',\r\n    _add = 'addClass',\r\n    _remove = 'removeClass',\r\n    _callback = 'trigger',\r\n    _label = 'label',\r\n    _cursor = 'cursor',\r\n    _mobile = /ipad|iphone|ipod|android|blackberry|windows phone|opera mini|silk/i.test(navigator.userAgent);\r\n\r\n  // Plugin init\r\n  $.fn[_iCheck] = function(options, fire) {\r\n\r\n    // Walker\r\n    var handle = 'input[type=\"' + _checkbox + '\"], input[type=\"' + _radio + '\"]',\r\n      stack = $(),\r\n      walker = function(object) {\r\n        object.each(function() {\r\n          var self = $(this);\r\n\r\n          if (self.is(handle)) {\r\n            stack = stack.add(self);\r\n          } else {\r\n            stack = stack.add(self.find(handle));\r\n          }\r\n        });\r\n      };\r\n\r\n    // Check if we should operate with some method\r\n    if (/^(check|uncheck|toggle|indeterminate|determinate|disable|enable|update|destroy)$/i.test(options)) {\r\n\r\n      // Normalize method's name\r\n      options = options.toLowerCase();\r\n\r\n      // Find checkboxes and radio buttons\r\n      walker(this);\r\n\r\n      return stack.each(function() {\r\n        var self = $(this);\r\n\r\n        if (options == 'destroy') {\r\n          tidy(self, 'ifDestroyed');\r\n        } else {\r\n          operate(self, true, options);\r\n        }\r\n\r\n        // Fire method's callback\r\n        if ($.isFunction(fire)) {\r\n          fire();\r\n        }\r\n      });\r\n\r\n    // Customization\r\n    } else if (typeof options == 'object' || !options) {\r\n\r\n      // Check if any options were passed\r\n      var settings = $.extend({\r\n          checkedClass: _checked,\r\n          disabledClass: _disabled,\r\n          indeterminateClass: _indeterminate,\r\n          labelHover: true\r\n        }, options),\r\n\r\n        selector = settings.handle,\r\n        hoverClass = settings.hoverClass || 'hover',\r\n        focusClass = settings.focusClass || 'focus',\r\n        activeClass = settings.activeClass || 'active',\r\n        labelHover = !!settings.labelHover,\r\n        labelHoverClass = settings.labelHoverClass || 'hover',\r\n\r\n        // Setup clickable area\r\n        area = ('' + settings.increaseArea).replace('%', '') | 0;\r\n\r\n      // Selector limit\r\n      if (selector == _checkbox || selector == _radio) {\r\n        handle = 'input[type=\"' + selector + '\"]';\r\n      }\r\n\r\n      // Clickable area limit\r\n      if (area < -50) {\r\n        area = -50;\r\n      }\r\n\r\n      // Walk around the selector\r\n      walker(this);\r\n\r\n      return stack.each(function() {\r\n        var self = $(this);\r\n\r\n        // If already customized\r\n        tidy(self);\r\n\r\n        var node = this,\r\n          id = node.id,\r\n\r\n          // Layer styles\r\n          offset = -area + '%',\r\n          size = 100 + (area * 2) + '%',\r\n          layer = {\r\n            position: 'absolute',\r\n            top: offset,\r\n            left: offset,\r\n            display: 'block',\r\n            width: size,\r\n            height: size,\r\n            margin: 0,\r\n            padding: 0,\r\n            background: '#fff',\r\n            border: 0,\r\n            opacity: 0\r\n          },\r\n\r\n          // Choose how to hide input\r\n          hide = _mobile ? {\r\n            position: 'absolute',\r\n            visibility: 'hidden'\r\n          } : area ? layer : {\r\n            position: 'absolute',\r\n            opacity: 0\r\n          },\r\n\r\n          // Get proper class\r\n          className = node[_type] == _checkbox ? settings.checkboxClass || 'i' + _checkbox : settings.radioClass || 'i' + _radio,\r\n\r\n          // Find assigned labels\r\n          label = $(_label + '[for=\"' + id + '\"]').add(self.closest(_label)),\r\n\r\n          // Check ARIA option\r\n          aria = !!settings.aria,\r\n\r\n          // Set ARIA placeholder\r\n          ariaID = _iCheck + '-' + Math.random().toString(36).substr(2,6),\r\n\r\n          // Parent & helper\r\n          parent = '<div class=\"' + className + '\" ' + (aria ? 'role=\"' + node[_type] + '\" ' : ''),\r\n          helper;\r\n\r\n        // Set ARIA \"labelledby\"\r\n        if (aria) {\r\n          label.each(function() {\r\n            parent += 'aria-labelledby=\"';\r\n\r\n            if (this.id) {\r\n              parent += this.id;\r\n            } else {\r\n              this.id = ariaID;\r\n              parent += ariaID;\r\n            }\r\n\r\n            parent += '\"';\r\n          });\r\n        }\r\n\r\n        // Wrap input\r\n        parent = self.wrap(parent + '/>')[_callback]('ifCreated').parent().append(settings.insert);\r\n\r\n        // Layer addition\r\n        helper = $('<ins class=\"' + _iCheckHelper + '\"/>').css(layer).appendTo(parent);\r\n\r\n        // Finalize customization\r\n        self.data(_iCheck, {o: settings, s: self.attr('style')}).css(hide);\r\n        !!settings.inheritClass && parent[_add](node.className || '');\r\n        !!settings.inheritID && id && parent.attr('id', _iCheck + '-' + id);\r\n        parent.css('position') == 'static' && parent.css('position', 'relative');\r\n        operate(self, true, _update);\r\n\r\n        // Label events\r\n        if (label.length) {\r\n          label.on(_click + '.i mouseover.i mouseout.i ' + _touch, function(event) {\r\n            var type = event[_type],\r\n              item = $(this);\r\n\r\n            // Do nothing if input is disabled\r\n            if (!node[_disabled]) {\r\n\r\n              // Click\r\n              if (type == _click) {\r\n                if ($(event.target).is('a')) {\r\n                  return;\r\n                }\r\n                operate(self, false, true);\r\n\r\n              // Hover state\r\n              } else if (labelHover) {\r\n\r\n                // mouseout|touchend\r\n                if (/ut|nd/.test(type)) {\r\n                  parent[_remove](hoverClass);\r\n                  item[_remove](labelHoverClass);\r\n                } else {\r\n                  parent[_add](hoverClass);\r\n                  item[_add](labelHoverClass);\r\n                }\r\n              }\r\n\r\n              if (_mobile) {\r\n                event.stopPropagation();\r\n              } else {\r\n                return false;\r\n              }\r\n            }\r\n          });\r\n        }\r\n\r\n        // Input events\r\n        self.on(_click + '.i focus.i blur.i keyup.i keydown.i keypress.i', function(event) {\r\n          var type = event[_type],\r\n            key = event.keyCode;\r\n\r\n          // Click\r\n          if (type == _click) {\r\n            return false;\r\n\r\n          // Keydown\r\n          } else if (type == 'keydown' && key == 32) {\r\n            if (!(node[_type] == _radio && node[_checked])) {\r\n              if (node[_checked]) {\r\n                off(self, _checked);\r\n              } else {\r\n                on(self, _checked);\r\n              }\r\n            }\r\n\r\n            return false;\r\n\r\n          // Keyup\r\n          } else if (type == 'keyup' && node[_type] == _radio) {\r\n            !node[_checked] && on(self, _checked);\r\n\r\n          // Focus/blur\r\n          } else if (/us|ur/.test(type)) {\r\n            parent[type == 'blur' ? _remove : _add](focusClass);\r\n          }\r\n        });\r\n\r\n        // Helper events\r\n        helper.on(_click + ' mousedown mouseup mouseover mouseout ' + _touch, function(event) {\r\n          var type = event[_type],\r\n\r\n            // mousedown|mouseup\r\n            toggle = /wn|up/.test(type) ? activeClass : hoverClass;\r\n\r\n          // Do nothing if input is disabled\r\n          if (!node[_disabled]) {\r\n\r\n            // Click\r\n            if (type == _click) {\r\n              operate(self, false, true);\r\n\r\n            // Active and hover states\r\n            } else {\r\n\r\n              // State is on\r\n              if (/wn|er|in/.test(type)) {\r\n\r\n                // mousedown|mouseover|touchbegin\r\n                parent[_add](toggle);\r\n\r\n              // State is off\r\n              } else {\r\n                parent[_remove](toggle + ' ' + activeClass);\r\n              }\r\n\r\n              // Label hover\r\n              if (label.length && labelHover && toggle == hoverClass) {\r\n\r\n                // mouseout|touchend\r\n                label[/ut|nd/.test(type) ? _remove : _add](labelHoverClass);\r\n              }\r\n            }\r\n\r\n            if (_mobile) {\r\n              event.stopPropagation();\r\n            } else {\r\n              return false;\r\n            }\r\n          }\r\n        });\r\n      });\r\n    } else {\r\n      return this;\r\n    }\r\n  };\r\n\r\n  // Do something with inputs\r\n  function operate(input, direct, method) {\r\n    var node = input[0],\r\n      state = /er/.test(method) ? _indeterminate : /bl/.test(method) ? _disabled : _checked,\r\n      active = method == _update ? {\r\n        checked: node[_checked],\r\n        disabled: node[_disabled],\r\n        indeterminate: input.attr(_indeterminate) == 'true' || input.attr(_determinate) == 'false'\r\n      } : node[state];\r\n\r\n    // Check, disable or indeterminate\r\n    if (/^(ch|di|in)/.test(method) && !active) {\r\n      on(input, state);\r\n\r\n    // Uncheck, enable or determinate\r\n    } else if (/^(un|en|de)/.test(method) && active) {\r\n      off(input, state);\r\n\r\n    // Update\r\n    } else if (method == _update) {\r\n\r\n      // Handle states\r\n      for (var each in active) {\r\n        if (active[each]) {\r\n          on(input, each, true);\r\n        } else {\r\n          off(input, each, true);\r\n        }\r\n      }\r\n\r\n    } else if (!direct || method == 'toggle') {\r\n\r\n      // Helper or label was clicked\r\n      if (!direct) {\r\n        input[_callback]('ifClicked');\r\n      }\r\n\r\n      // Toggle checked state\r\n      if (active) {\r\n        if (node[_type] !== _radio) {\r\n          off(input, state);\r\n        }\r\n      } else {\r\n        on(input, state);\r\n      }\r\n    }\r\n  }\r\n\r\n  // Add checked, disabled or indeterminate state\r\n  function on(input, state, keep) {\r\n    var node = input[0],\r\n      parent = input.parent(),\r\n      checked = state == _checked,\r\n      indeterminate = state == _indeterminate,\r\n      disabled = state == _disabled,\r\n      callback = indeterminate ? _determinate : checked ? _unchecked : 'enabled',\r\n      regular = option(input, callback + capitalize(node[_type])),\r\n      specific = option(input, state + capitalize(node[_type]));\r\n\r\n    // Prevent unnecessary actions\r\n    if (node[state] !== true) {\r\n\r\n      // Toggle assigned radio buttons\r\n      if (!keep && state == _checked && node[_type] == _radio && node.name) {\r\n        var form = input.closest('form'),\r\n          inputs = 'input[name=\"' + node.name + '\"]';\r\n\r\n        inputs = form.length ? form.find(inputs) : $(inputs);\r\n\r\n        inputs.each(function() {\r\n          if (this !== node && $(this).data(_iCheck)) {\r\n            off($(this), state);\r\n          }\r\n        });\r\n      }\r\n\r\n      // Indeterminate state\r\n      if (indeterminate) {\r\n\r\n        // Add indeterminate state\r\n        node[state] = true;\r\n\r\n        // Remove checked state\r\n        if (node[_checked]) {\r\n          off(input, _checked, 'force');\r\n        }\r\n\r\n      // Checked or disabled state\r\n      } else {\r\n\r\n        // Add checked or disabled state\r\n        if (!keep) {\r\n          node[state] = true;\r\n        }\r\n\r\n        // Remove indeterminate state\r\n        if (checked && node[_indeterminate]) {\r\n          off(input, _indeterminate, false);\r\n        }\r\n      }\r\n\r\n      // Trigger callbacks\r\n      callbacks(input, checked, state, keep);\r\n    }\r\n\r\n    // Add proper cursor\r\n    if (node[_disabled] && !!option(input, _cursor, true)) {\r\n      parent.find('.' + _iCheckHelper).css(_cursor, 'default');\r\n    }\r\n\r\n    // Add state class\r\n    parent[_add](specific || option(input, state) || '');\r\n\r\n    // Set ARIA attribute\r\n    if (!!parent.attr('role') && !indeterminate) {\r\n      parent.attr('aria-' + (disabled ? _disabled : _checked), 'true');\r\n    }\r\n\r\n    // Remove regular state class\r\n    parent[_remove](regular || option(input, callback) || '');\r\n  }\r\n\r\n  // Remove checked, disabled or indeterminate state\r\n  function off(input, state, keep) {\r\n    var node = input[0],\r\n      parent = input.parent(),\r\n      checked = state == _checked,\r\n      indeterminate = state == _indeterminate,\r\n      disabled = state == _disabled,\r\n      callback = indeterminate ? _determinate : checked ? _unchecked : 'enabled',\r\n      regular = option(input, callback + capitalize(node[_type])),\r\n      specific = option(input, state + capitalize(node[_type]));\r\n\r\n    // Prevent unnecessary actions\r\n    if (node[state] !== false) {\r\n\r\n      // Toggle state\r\n      if (indeterminate || !keep || keep == 'force') {\r\n        node[state] = false;\r\n      }\r\n\r\n      // Trigger callbacks\r\n      callbacks(input, checked, callback, keep);\r\n    }\r\n\r\n    // Add proper cursor\r\n    if (!node[_disabled] && !!option(input, _cursor, true)) {\r\n      parent.find('.' + _iCheckHelper).css(_cursor, 'pointer');\r\n    }\r\n\r\n    // Remove state class\r\n    parent[_remove](specific || option(input, state) || '');\r\n\r\n    // Set ARIA attribute\r\n    if (!!parent.attr('role') && !indeterminate) {\r\n      parent.attr('aria-' + (disabled ? _disabled : _checked), 'false');\r\n    }\r\n\r\n    // Add regular state class\r\n    parent[_add](regular || option(input, callback) || '');\r\n  }\r\n\r\n  // Remove all traces\r\n  function tidy(input, callback) {\r\n    if (input.data(_iCheck)) {\r\n\r\n      // Remove everything except input\r\n      input.parent().html(input.attr('style', input.data(_iCheck).s || ''));\r\n\r\n      // Callback\r\n      if (callback) {\r\n        input[_callback](callback);\r\n      }\r\n\r\n      // Unbind events\r\n      input.off('.i').unwrap();\r\n      $(_label + '[for=\"' + input[0].id + '\"]').add(input.closest(_label)).off('.i');\r\n    }\r\n  }\r\n\r\n  // Get some option\r\n  function option(input, state, regular) {\r\n    if (input.data(_iCheck)) {\r\n      return input.data(_iCheck).o[state + (regular ? '' : 'Class')];\r\n    }\r\n  }\r\n\r\n  // Capitalize some string\r\n  function capitalize(string) {\r\n    return string.charAt(0).toUpperCase() + string.slice(1);\r\n  }\r\n\r\n  // Executable handlers\r\n  function callbacks(input, checked, callback, keep) {\r\n    if (!keep) {\r\n      if (checked) {\r\n        input[_callback]('ifToggled');\r\n      }\r\n\r\n      input[_callback]('ifChanged')[_callback]('if' + capitalize(callback));\r\n    }\r\n  }\r\n})(window.jQuery || window.Zepto);\r\n\n/**\r\n * Debounce and throttle function's decorator plugin 1.0.5\r\n *\r\n * Copyright (c) 2009 Filatov Dmitry (alpha@zforms.ru)\r\n * Dual licensed under the MIT and GPL licenses:\r\n * http://www.opensource.org/licenses/mit-license.php\r\n * http://www.gnu.org/licenses/gpl.html\r\n *\r\n */\r\n\r\n(function($) {\r\n\r\n$.extend({\r\n\r\n\tdebounce : function(fn, timeout, invokeAsap, ctx) {\r\n\r\n\t\tif(arguments.length == 3 && typeof invokeAsap != 'boolean') {\r\n\t\t\tctx = invokeAsap;\r\n\t\t\tinvokeAsap = false;\r\n\t\t}\r\n\r\n\t\tvar timer;\r\n\r\n\t\treturn function() {\r\n\r\n\t\t\tvar args = arguments;\r\n\t\t\tctx = ctx || this;\r\n\r\n\t\t\tinvokeAsap && !timer && fn.apply(ctx, args);\r\n\r\n\t\t\tclearTimeout(timer);\r\n\r\n\t\t\ttimer = setTimeout(function() {\r\n\t\t\t\tinvokeAsap || fn.apply(ctx, args);\r\n\t\t\t\ttimer = null;\r\n\t\t\t}, timeout);\r\n\r\n\t\t};\r\n\r\n\t},\r\n\r\n\tthrottle : function(fn, timeout, ctx) {\r\n\r\n\t\tvar timer, args, needInvoke;\r\n\r\n\t\treturn function() {\r\n\r\n\t\t\targs = arguments;\r\n\t\t\tneedInvoke = true;\r\n\t\t\tctx = ctx || this;\r\n\r\n\t\t\ttimer || (function() {\r\n\t\t\t\tif(needInvoke) {\r\n\t\t\t\t\tfn.apply(ctx, args);\r\n\t\t\t\t\tneedInvoke = false;\r\n\t\t\t\t\ttimer = setTimeout(arguments.callee, timeout);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\ttimer = null;\r\n\t\t\t\t}\r\n\t\t\t})();\r\n\r\n\t\t};\r\n\r\n\t}\r\n\r\n});\r\n\r\n})(jQuery);\n(function($) {\r\n  var START_EVENT = 'mousedown touchstart MSPointerDown pointerdown'\r\n    , END_EVENT   = 'mouseup touchend MSPointerUp pointerup'\r\n    , MOVE_EVENT  = 'mousemove touchmove MSPointerMove pointermove scroll'\r\n\r\n  function translate(el, x, y) {\r\n    vendorify('transform', el, 'translate(' + x + 'px, ' + y + 'px)')\r\n  }\r\n\r\n  function transition(el, val) {\r\n    vendorify('transition', el, val)\r\n  }\r\n\r\n  function getTouchPageX(e) {\r\n    e = e.originalEvent || e\r\n    return window.event && window.event.changedTouches && event.changedTouches[0].pageX || e.pageX\r\n  }\r\n\r\n  function getTouchPageY(e) {\r\n    e = e.originalEvent || e\r\n    return window.event && window.event.changedTouches && event.changedTouches[0].pageY || e.pageY\r\n  }\r\n\r\n  function vendorify(property, el, val) {\r\n    property = property.toLowerCase()\r\n    var titleCased = property.charAt(0).toUpperCase() + property.substr(1)\r\n    var vendorPrefixes = ['webkit', 'Moz', 'ms', 'O']\r\n    var properties = vendorPrefixes.map(function(prefix) {\r\n      return prefix + titleCased\r\n    }).concat('transform')\r\n    for (var i = 0, len = properties.length; i < len; ++i) {\r\n      if (properties[i] in el.style) {\r\n        if (val !== undefined) el.style[properties[i]] = val\r\n        else return el.style[properties[i]]\r\n        break\r\n      }\r\n    }\r\n  }\r\n\r\n  var eventProperties = [\r\n    'altKey', 'bubbles', 'button', 'cancelable', 'charCode', 'clientX',\r\n    'clientY', 'ctrlKey', 'currentTarget', 'data', 'detail', 'eventPhase',\r\n    'metaKey', 'offsetX', 'offsetY', 'originalTarget', 'pageX', 'pageY',\r\n    'relatedTarget', 'screenX', 'screenY', 'shiftKey', 'target', 'view',\r\n    'which'\r\n  ]\r\n  function trigger(el, name, originalEvent, arg) {\r\n    if (!el[0]) return\r\n\r\n    originalEvent = originalEvent.originalEvent || originalEvent\r\n    var props = {}\r\n    eventProperties.forEach(function(prop) {\r\n      props[prop] = originalEvent[prop]\r\n    })\r\n    props.currentTarget = props.target = el[0]\r\n\r\n    var win = (el[0].ownerDocument.defaultView || el[0].ownerDocument.parentWindow)\r\n    var $ = win.Zepto || win.jQuery\r\n\r\n    var e = $.Event(name, props)\r\n    $(el[0]).trigger(e, arg)\r\n    return e\r\n  }\r\n\r\n  var nextId = 0\r\n  var Dragging = function() {\r\n    this.eventHandler = $('<div />')\r\n    this.parent = this.el = this.handle = null\r\n    this.origin = { x: 0, y: 0, transition: null, translate: null, offset: { x: 0, y: 0 } }\r\n    this.lastEntered = this.currentTarget = null\r\n    this.lastX = this.lastY = this.lastDirection = null\r\n    this.originalCss = {}\r\n    this.windows = [window]\r\n\r\n    var placeholder\r\n    Object.defineProperty(this, 'placeholder', {\r\n      get: function() { return placeholder },\r\n      set: function(val) {\r\n        if (placeholder === val) return\r\n        if (placeholder) placeholder.remove()\r\n        placeholder = val\r\n      }\r\n    })\r\n  }\r\n\r\n  Dragging.prototype.on = function() {\r\n    this.eventHandler.on.apply(this.eventHandler, Array.prototype.slice.call(arguments))\r\n    return this\r\n  }\r\n\r\n  Dragging.prototype.off = function() {\r\n    this.eventHandler.off.apply(this.eventHandler, Array.prototype.slice.call(arguments))\r\n    return this\r\n  }\r\n\r\n  Dragging.prototype.start = function(parent, el, e, handle) {\r\n    this.parent = parent\r\n    this.el = el\r\n    this.handle = handle\r\n    var el = this.handle || this.el\r\n    this.origin.x = getTouchPageX(e)\r\n    this.origin.y = getTouchPageY(e)\r\n    this.origin.transform  = vendorify('transform', this.el[0])\r\n    this.origin.transition = vendorify('transition', this.el[0])\r\n    var rect = this.el[0].getBoundingClientRect()\r\n    this.origin.offset.x = rect.left + (window.scrollX || window.pageXOffset) - this.origin.x\r\n    this.origin.offset.y = rect.top + (window.scrollY || window.pageYOffset) - this.origin.y\r\n    this.origin.scrollX = (window.scrollX || window.pageXOffset)\r\n    this.origin.scrollY = (window.scrollY || window.pageYOffset)\r\n    // the draged element is going to stick right under the cursor\r\n    // setting the css property `pointer-events` to `none` will let\r\n    // the pointer events fire on the elements underneath the helper\r\n    el[0].style.pointerEvents = 'none'\r\n    this.windows.forEach(function(win) {\r\n      $(win).on(MOVE_EVENT, $.proxy(this.move, this))\r\n      $(win).on(END_EVENT, $.proxy(this.stop, this))\r\n    }, this)\r\n    transition(el[0], '')\r\n    trigger(this.eventHandler, 'dragging:start', e)\r\n    return this.el\r\n  }\r\n\r\n  Dragging.prototype.stop = function(e) {\r\n    var dropEvent = null\r\n    var revert = true\r\n    if (this.last) {\r\n      var last = this.last\r\n      this.last = null\r\n      dropEvent = trigger($(last), 'dragging:drop', e)\r\n      revert = !dropEvent.isDefaultPrevented()\r\n    }\r\n\r\n    if (!this.el) {\r\n      return\r\n    }\r\n\r\n    for (var prop in this.originalCss) {\r\n      this.el.css(prop, this.originalCss[prop])\r\n      delete this.originalCss[prop]\r\n    }\r\n\r\n    trigger(this.eventHandler, 'dragging:stop', e, this.el)\r\n    this.placeholder = null\r\n    if (!this.handle) {\r\n      this.adjustPlacement(e)\r\n    }\r\n\r\n    var el = this.el\r\n    if (this.handle) {\r\n      this.handle.remove()\r\n    }\r\n\r\n    setTimeout((function(el, origin) {\r\n      transition(el[0], 'all 0.25s ease-in-out 0s')\r\n      vendorify('transform', el[0], origin.transform || '')\r\n      setTimeout(transition.bind(null, el[0], origin.transition || ''), 250)\r\n      el[0].style.pointerEvents = ''\r\n    }).bind(null, el, this.origin))\r\n\r\n    this.windows.forEach(function(win) {\r\n      $(win).off(MOVE_EVENT, this.move)\r\n      $(win).off(END_EVENT, this.stop)\r\n    }, this)\r\n    this.parent = this.el = this.handle = null\r\n  }\r\n\r\n  Dragging.prototype.move = function(e) {\r\n    if (!this.el) return\r\n\r\n    var doc = this.el[0].ownerDocument\r\n    var win = doc.defaultView || doc.parentWindow\r\n\r\n    if (e.type !== 'scroll') {\r\n      var pageX = getTouchPageX(e)\r\n      var pageY = getTouchPageY(e)\r\n\r\n      if (e.view !== win && e.view.frameElement) {\r\n        pageX += e.view.frameElement.offsetLeft\r\n        pageY += e.view.frameElement.offsetTop\r\n      }\r\n\r\n      var clientX = e.clientX || (e.originalEvent && e.originalEvent.clientX) || window.event && window.event.touches && window.event.touches[0].clientX || 0\r\n        , clientY = e.clientY || (e.originalEvent && e.originalEvent.clientY) || window.event && window.event.touches && window.event.touches[0].clientY || 0\r\n\r\n      var doc = this.el[0].ownerDocument\r\n      var over\r\n      if (!isOldIE) {\r\n        over = e.view.document.elementFromPoint(clientX, clientY)\r\n      } else {\r\n        over = e.view.document.msElementsFromPoint(clientX, clientY)\r\n        over = over[0] === this.el[0] ? over[1] : over[0]\r\n      }\r\n\r\n      var deltaX = this.lastX - pageX\r\n      var deltaY = this.lastY - pageY\r\n      var direction = deltaY > 0 && 'up' || deltaY < 0 && 'down'\r\n                   || deltaX > 0 && 'up'|| deltaX < 0 && 'down'\r\n                   || this.lastDirection\r\n      if (!dragging.currentTarget) {\r\n        this.setCurrent(over)\r\n      }\r\n\r\n      if (this.currentTarget) {\r\n        if (over !== this.last && this.lastEntered !== this.currentTarget) {\r\n          trigger($(this.lastEntered), 'dragging:leave', e)\r\n          trigger($(this.currentTarget), 'dragging:enter', e)\r\n          this.lastEntered = this.currentTarget\r\n        } else if (direction !== this.lastDirection) {\r\n          trigger($(this.currentTarget), 'dragging:diverted', e)\r\n        }\r\n      }\r\n\r\n      this.last = over\r\n      this.currentTarget = null\r\n      this.lastDirection = direction\r\n      this.lastX = pageX\r\n      this.lastY = pageY\r\n      this.origin.scrollX = (window.scrollX || window.pageXOffset)\r\n      this.origin.scrollY = (window.scrollY || window.pageYOffset)\r\n    } else {\r\n      var pageX = this.lastX + ((window.scrollX || window.pageXOffset) - this.origin.scrollX)\r\n        , pageY = this.lastY + ((window.scrollY || window.pageYOffset) - this.origin.scrollY)\r\n    }\r\n\r\n    // border scrolling only for root window\r\n    if (e.view !== win && e.view && e.view.frameElement) {\r\n      var bottom = (pageY - (window.scrollY || window.pageYOffset) - window.innerHeight) * -1\r\n      var bottomReached = document.documentElement.offsetHeight < (window.scrollY || window.pageYOffset) + window.innerHeight\r\n      if (bottom <= 10 && !bottomReached) {\r\n        setTimeout(function() { window.scrollBy(0, 5) }, 50)\r\n      }\r\n\r\n      var top = (pageY - (window.scrollY || window.pageYOffset))\r\n      var topReached = (window.scrollY || window.pageYOffset) <= 0\r\n      if (top <= 10 && !topReached) {\r\n        setTimeout(function() { window.scrollBy(0, -5) }, 50)\r\n      }\r\n    }\r\n\r\n    var deltaX = pageX - this.origin.x\r\n      , deltaY = pageY - this.origin.y\r\n    var el = this.handle || this.el\r\n\r\n    translate(el[0], deltaX, deltaY)\r\n  }\r\n\r\n  Dragging.prototype.setCurrent = function(target) {\r\n    this.currentTarget = target\r\n  }\r\n\r\n  Dragging.prototype.css = function(prop, val) {\r\n    if (!this.el) return\r\n    this.originalCss[prop] = this.el.css(prop)\r\n    this.el.css(prop, val)\r\n  }\r\n\r\n  Dragging.prototype.adjustPlacement = function(e) {\r\n    var el = this.handle && this.handle[0] || this.el[0]\r\n    translate(el, 0, 0)\r\n    var rect = el.getBoundingClientRect()\r\n    this.origin.x = rect.left + (window.scrollX || window.pageXOffset) - this.origin.offset.x\r\n    this.origin.y = rect.top + (window.scrollY || window.pageYOffset) - this.origin.offset.y\r\n    var pageX  = getTouchPageX(e) || this.lastX\r\n      , pageY  = getTouchPageY(e) || this.lastY\r\n      , deltaX = pageX - this.origin.x\r\n      , deltaY = pageY - this.origin.y\r\n    translate(el, deltaX, deltaY)\r\n  }\r\n\r\n  var dragging\r\n  try {\r\n    if (parent.$ && parent.$.dragging) {\r\n      dragging = parent.$.dragging\r\n      dragging.windows.push(window)\r\n    }\r\n  } catch (e) {}\r\n\r\n  dragging = $.dragging = dragging || new Dragging()\r\n\r\n  // from https://github.com/rkusa/selector-observer\r\n  var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver\r\n  function matches(el, selector) {\r\n    var fn = el.matches || el.matchesSelector || el.msMatchesSelector || el.mozMatchesSelector || el.webkitMatchesSelector || el.oMatchesSelector\r\n    return fn ? fn.call(el, selector) : false\r\n  }\r\n  function toArr(nodeList) {\r\n    return Array.prototype.slice.call(nodeList)\r\n  }\r\n\r\n  // polyfill for IE < 11\r\n  var isOldIE = false\r\n  if (typeof MutationObserver === 'undefined') {\r\n    MutationObserver = function(callback) {\r\n      this.targets = []\r\n      this.onAdded = function(e) {\r\n        callback([{ addedNodes: [e.target], removedNodes: [] }])\r\n      }\r\n      this.onRemoved = function(e) {\r\n        callback([{ addedNodes: [], removedNodes: [e.target] }])\r\n      }\r\n    }\r\n\r\n    MutationObserver.prototype.observe = function(target) {\r\n      target.addEventListener('DOMNodeInserted', this.onAdded)\r\n      target.addEventListener('DOMNodeRemoved', this.onRemoved)\r\n      this.targets.push(target)\r\n    }\r\n\r\n    MutationObserver.prototype.disconnect = function() {\r\n      var target\r\n      while (target = this.targets.shift()) {\r\n        target.removeEventListener('DOMNodeInserted', this.onAdded)\r\n        target.removeEventListener('DOMNodeRemoved', this.onRemoved)\r\n      }\r\n    }\r\n\r\n    isOldIE = !!~navigator.appName.indexOf('Internet Explorer')\r\n  }\r\n\r\n  var SelectorObserver = function(targets, selector, onAdded, onRemoved) {\r\n    var self     = this\r\n    this.targets = targets instanceof NodeList\r\n                     ? Array.prototype.slice.call(targets)\r\n                     : [targets]\r\n\r\n    // support selectors starting with the childs only selector `>`\r\n    var childsOnly = selector[0] === '>'\r\n    var search = childsOnly ? selector.substr(1) : selector\r\n    var initialized = false\r\n\r\n    function query(nodes, deep) {\r\n      var result = []\r\n\r\n      toArr(nodes).forEach(function(node) {\r\n        //ignore non-element nodes\r\n        if (node.nodeType !== 1) return;\r\n\r\n        // if looking for childs only, the node's parentNode\r\n        // should be one of our targets\r\n        if (childsOnly && self.targets.indexOf(node.parentNode) === -1) {\r\n          return\r\n        }\r\n\r\n        // test if the node itself matches the selector\r\n        if (matches(node, search)) {\r\n          result.push(node)\r\n        }\r\n\r\n        if (childsOnly || !deep) {\r\n          return\r\n        }\r\n\r\n        toArr(node.querySelectorAll(selector)).forEach(function(node) {\r\n          result.push(node)\r\n        })\r\n      })\r\n\r\n      return result\r\n    }\r\n\r\n    function apply(nodes, deep, callback) {\r\n      if (!callback) {\r\n        return\r\n      }\r\n\r\n      // flatten\r\n      query(nodes, deep)\r\n      // filter unique nodes\r\n      .filter(function(node, i, self) {\r\n        return self.indexOf(node) === i\r\n      })\r\n      // execute callback\r\n      .forEach(function(node) {\r\n        callback.call(node)\r\n      })\r\n    }\r\n\r\n    var timeout      = null\r\n    var addedNodes   = []\r\n    var removedNodes = []\r\n\r\n    function handle() {\r\n      self.disconnect()\r\n\r\n      // filter moved elements (removed and re-added)\r\n      for (var i = 0, len = removedNodes.length; i < len; ++i) {\r\n        var index = addedNodes.indexOf(removedNodes[i])\r\n        if (index > -1) {\r\n          addedNodes.splice(index, 1)\r\n          removedNodes.splice(i--, 1)\r\n        }\r\n      }\r\n\r\n      //                ↓ IE workarounds ...\r\n      apply(addedNodes, !(initialized && isOldIE), onAdded)\r\n      apply(removedNodes, true, onRemoved)\r\n\r\n      addedNodes.length   = 0\r\n      removedNodes.length = 0\r\n\r\n      self.observe()\r\n    }\r\n\r\n    this.observer = new MutationObserver(function(mutations) {\r\n      mutations.forEach(function(mutation) {\r\n        addedNodes.push.apply(addedNodes, mutation.addedNodes)\r\n        removedNodes.push.apply(removedNodes, mutation.removedNodes)\r\n      })\r\n\r\n      // IE < 10 fix: wait a cycle to gather all mutations\r\n      if (timeout) {\r\n        clearTimeout(timeout)\r\n      }\r\n      timeout = setTimeout(handle)\r\n    })\r\n\r\n    // call onAdded for existing elements\r\n    if (onAdded) {\r\n      this.targets.forEach(function(target) {\r\n        apply(target.children, true, onAdded)\r\n      })\r\n    }\r\n\r\n    initialized = true\r\n\r\n    this.observe()\r\n  }\r\n\r\n  SelectorObserver.prototype.disconnect = function() {\r\n    this.observer.disconnect()\r\n  }\r\n\r\n  SelectorObserver.prototype.observe = function() {\r\n    var self = this\r\n    this.targets.forEach(function(target) {\r\n      self.observer.observe(target, { childList: true, subtree: true })\r\n    })\r\n  }\r\n\r\n  var Draggable = function(element, opts) {\r\n    this.id     = nextId++\r\n    this.el     = $(element)\r\n    this.opts   = opts\r\n    this.cancel = opts.handle !== false\r\n  }\r\n\r\n  Draggable.prototype.create = function() {\r\n    this.el\r\n    .on(START_EVENT, $.proxy(this.start, this))\r\n    .css('touch-action', 'double-tap-zoom')\r\n    .css('-ms-touch-action', 'double-tap-zoom')\r\n\r\n    dragging.on('dragging:stop', $.proxy(this.reset, this))\r\n\r\n    var self = this\r\n    setTimeout(function() {\r\n      self.el.trigger('draggable:create', self)\r\n    })\r\n  }\r\n\r\n  Draggable.prototype.destroy = function() {\r\n    this.el.off(START_EVENT, this.start)\r\n\r\n    // Todo: Fix Zepto Bug\r\n    dragging.off('dragging:stop', this.reset)\r\n  }\r\n\r\n  Draggable.prototype.enable = function() {\r\n    this.opts.disabled = false\r\n  }\r\n\r\n  Draggable.prototype.disable = function() {\r\n    this.opts.disabled = true\r\n  }\r\n\r\n  Draggable.prototype.start = function(e) {\r\n    if (this.opts.disabled) {\r\n      return false\r\n    }\r\n\r\n    // only start on left mouse button\r\n    if (e.type === 'mousedown' && e.which !== 1) {\r\n      return false\r\n    }\r\n\r\n    e = e.originalEvent || e // zepto <> jquery compatibility\r\n\r\n    if (this.opts.cancel) {\r\n      var target = $(e.target)\r\n      while (target[0] !== this.el[0]) {\r\n        if (target.is(this.opts.cancel)) return\r\n        target = target.parent()\r\n      }\r\n    }\r\n\r\n    if (this.opts.handle) {\r\n      var target = $(e.target), isHandle = false\r\n      while (target[0] !== this.el[0]) {\r\n        if (target.is(this.opts.handle)) {\r\n          isHandle = true\r\n          break\r\n        }\r\n        target = target.parent()\r\n      }\r\n      if (!isHandle) return\r\n    }\r\n\r\n    // prevent text selection\r\n    e.preventDefault()\r\n\r\n    var el = this.el, helper\r\n    if (this.opts.clone) {\r\n      if (typeof this.opts.clone === 'function') {\r\n        helper = this.opts.clone.call(this.el)\r\n      } else {\r\n        helper = this.el.clone()\r\n        if (this.opts.cloneClass) {\r\n          helper.addClass(this.opts.cloneClass)\r\n        }\r\n      }\r\n      var position = this.el.position()\r\n      helper.css('position', 'absolute')\r\n            .css('left', position.left).css('top', position.top)\r\n            .width(this.el.width()).height(this.el.height())\r\n      helper.insertAfter(this.el)\r\n    }\r\n\r\n    dragging.start(this, this.el, e, helper)\r\n\r\n    trigger(this.el, 'draggable:start', e, { item: dragging.el })\r\n  }\r\n\r\n  Draggable.prototype.reset = function(e, last) {\r\n    if (last === this.el[0]) {\r\n      trigger(this.el, 'draggable:stop', e, { item: dragging.el })\r\n    }\r\n  }\r\n\r\n  var Droppable = function(element, opts) {\r\n    this.id            = nextId++\r\n    this.el            = $(element)\r\n    this.opts          = opts\r\n    this.accept        = false\r\n  }\r\n\r\n  Droppable.prototype.create = function() {\r\n    this.el\r\n    .on('dragging:enter', $.proxy(this.enter, this))\r\n    .on('dragging:leave', $.proxy(this.leave, this))\r\n    .on('dragging:drop',  $.proxy(this.drop, this))\r\n\r\n    dragging\r\n    .on('dragging:start', $.proxy(this.activate, this))\r\n    .on('dragging:stop',  $.proxy(this.reset, this))\r\n\r\n    var self = this\r\n    setTimeout(function() {\r\n      self.el.trigger('droppable:create', self)\r\n    })\r\n  }\r\n\r\n  Droppable.prototype.destroy = function() {\r\n    this.el\r\n    .off('dragging:enter', this.enter)\r\n    .off('dragging:leave', this.leave)\r\n    .off('dragging:drop',  this.drop)\r\n\r\n    // Todo: Fix Zepto Bug\r\n    // dragging\r\n    // .off('dragging:start', this.activate)\r\n    // .off('dragging:stop',  this.reset)\r\n  }\r\n\r\n  Droppable.prototype.enable = function() {\r\n    this.opts.disabled = false\r\n  }\r\n\r\n  Droppable.prototype.disable = function() {\r\n    this.opts.disabled = true\r\n  }\r\n\r\n  Droppable.prototype.activate = function(e) {\r\n    this.accept = dragging.parent.opts.connectWith && this.el.is(dragging.parent.opts.connectWith)\r\n\r\n    if (!this.accept) {\r\n      var accept = this.opts.accept === '*'\r\n                || (typeof this.opts.accept === 'function' ? this.opts.accept.call(this.el[0], dragging.el)\r\n                                                           : dragging.el.is(this.opts.accept))\r\n      if (this.opts.scope !== 'default') {\r\n        this.accept = dragging.parent.opts.scope === this.opts.scope\r\n        if (!this.accept && this.opts.accept !== '*') this.accept = accept\r\n      } else this.accept = accept\r\n    }\r\n\r\n    if (!this.accept) return\r\n    if (this.opts.activeClass)\r\n      this.el.addClass(this.opts.activeClass)\r\n\r\n    trigger(this.el, 'droppable:activate', e, { item: dragging.el })\r\n  }\r\n\r\n  Droppable.prototype.reset = function(e) {\r\n    if (!this.accept) return\r\n    if (this.opts.activeClass) this.el.removeClass(this.opts.activeClass)\r\n    if (this.opts.hoverClass)  this.el.removeClass(this.opts.hoverClass)\r\n\r\n    trigger(this.el, 'droppable:deactivate', e, { item: dragging.el })\r\n  }\r\n\r\n  Droppable.prototype.enter = function(e) {\r\n    if (this.opts.disabled) return false\r\n\r\n    e.stopPropagation()\r\n\r\n    // hide placeholder, if set (e.g. enter the droppable after\r\n    // entering a sortable)\r\n    if (dragging.placeholder) dragging.placeholder.hide()\r\n\r\n    if (!this.accept) return\r\n\r\n    if (this.opts.hoverClass) {\r\n      this.el.addClass(this.opts.hoverClass)\r\n    }\r\n\r\n    trigger(this.el, 'droppable:over', e, { item: dragging.el })\r\n  }\r\n\r\n  Droppable.prototype.leave = function(e) {\r\n    if (this.opts.disabled) return false\r\n    // e.stopPropagation()\r\n\r\n    if (this.opts.hoverClass && this.accept) {\r\n      this.el.removeClass(this.opts.hoverClass)\r\n    }\r\n\r\n    trigger(this.el, 'droppable:out', e, { item: dragging.el })\r\n  }\r\n\r\n  Droppable.prototype.drop = function(e) {\r\n    if (this.opts.disabled || !this.accept) return false\r\n\r\n    if (!dragging.el) return\r\n\r\n    var el = dragging.el\r\n    var handler = typeof this.opts.receiveHandler === 'function' && this.opts.receiveHandler\r\n    var evtObj = { item: el }\r\n    var clone = null\r\n    if (dragging.handle) {\r\n      evtObj.helper = dragging.handle\r\n      if (!handler) {\r\n        clone = evtObj.clone = dragging.el.clone()\r\n      }\r\n    }\r\n\r\n    var drop = trigger(this.el, 'droppable:drop', e, evtObj)\r\n\r\n    if (!drop.isDefaultPrevented()) {\r\n      if (handler) {\r\n        handler.call(this.el, evtObj)\r\n      } else {\r\n        $(this.el).append(clone || dragging.el)\r\n      }\r\n    }\r\n  }\r\n\r\n  var Sortable = function(element, opts) {\r\n    this.id   = nextId++\r\n    this.el   = element\r\n    this.opts = opts\r\n\r\n    var tag = this.opts.placeholderTag\r\n    if (!tag) {\r\n      try {\r\n        tag = this.el.find(this.opts.items)[0].tagName\r\n      } catch(e) {\r\n        tag = /^ul|ol$/i.test(this.el[0].tagName) ? 'li' : 'div'\r\n      }\r\n    }\r\n\r\n    this.placeholder = $('<' + tag + ' id=\"__ph' + this.id + '\" class=\"' + this.opts.placeholder + '\" />')\r\n\r\n    this.accept = this.index = this.direction = null\r\n  }\r\n\r\n  Sortable.prototype.create = function() {\r\n    this.el\r\n    .on(START_EVENT,         this.opts.items, $.proxy(this.start, this))\r\n    .on('dragging:enter',    this.opts.items, $.proxy(this.enter, this))\r\n    .on('dragging:diverted', this.opts.items, $.proxy(this.diverted, this))\r\n    .on('dragging:drop',     this.opts.items, $.proxy(this.drop, this))\r\n\r\n    $(this.el).find(this.opts.items)\r\n    .css('touch-action', 'double-tap-zoom')\r\n    .css('-ms-touch-action', 'double-tap-zoom')\r\n\r\n    this.el\r\n    .on('dragging:enter',    $.proxy(this.enter, this))\r\n    .on('dragging:diverted', $.proxy(this.diverted, this))\r\n    .on('dragging:drop',     $.proxy(this.drop, this))\r\n\r\n    dragging\r\n    .on('dragging:start', $.proxy(this.activate, this))\r\n    .on('dragging:stop',  $.proxy(this.reset, this))\r\n\r\n    var self = this\r\n    setTimeout(function() {\r\n      self.el.trigger('sortable:create', self)\r\n    })\r\n\r\n    this.observer = new SelectorObserver(this.el[0], this.opts.items, function() {\r\n    }, function() {\r\n      if (this === self.placeholder[0] || (dragging.el && this === dragging.el[0])) {\r\n        return\r\n      }\r\n      var item = $(this)\r\n      item.css('touch-action', 'double-tap-zoom')\r\n          .css('-ms-touch-action', 'double-tap-zoom')\r\n      self.el.trigger('sortable:change', { item: item })\r\n      self.el.trigger('sortable:update', { item: item, index: -1 })\r\n    })\r\n  }\r\n\r\n  Sortable.prototype.destroy = function() {\r\n    this.el\r\n    .off(START_EVENT,         this.opts.items, this.start)\r\n    .off('dragging:enter',    this.opts.items, this.enter)\r\n    .off('dragging:diverted', this.opts.items, this.diverted)\r\n    .off('dragging:drop',     this.opts.items, this.drop)\r\n\r\n    this.el\r\n    .off('dragging:enter',    this.enter)\r\n    .off('dragging:diverted', this.diverted)\r\n    .off('dragging:drop',     this.drop)\r\n\r\n    // Todo: Fix Zepto Bug\r\n    // dragging\r\n    // .off('dragging:start', this.activate)\r\n    // .off('dragging:stop',  this.reset)\r\n\r\n    this.observer.disconnect()\r\n  }\r\n\r\n  Sortable.prototype.enable = function() {\r\n    this.opts.disabled = false\r\n  }\r\n\r\n  Sortable.prototype.disable = function() {\r\n    this.opts.disabled = true\r\n  }\r\n\r\n  Sortable.prototype.activate = function(e) {\r\n    this.isEmpty = this.el.find(this.opts.items).length === 0\r\n\r\n    this.accept = dragging.parent.id === this.id\r\n\r\n    if (!this.accept && dragging.parent.opts.connectWith) {\r\n      this.accept = this.el.is(dragging.parent.opts.connectWith)\r\n    }\r\n\r\n    if (!this.accept) return\r\n\r\n    this.accept = dragging.parent.id === this.id\r\n      || this.opts.accept === '*'\r\n      || (typeof this.opts.accept === 'function'\r\n        ? this.opts.accept.call(this.el[0], dragging.el)\r\n        : dragging.el.is(this.opts.accept))\r\n\r\n    if (!this.accept) return\r\n\r\n    if (this.opts.activeClass)\r\n      this.el.addClass(this.opts.activeClass)\r\n\r\n    trigger(this.el, 'sortable:activate', e, { item: dragging.el })\r\n  }\r\n\r\n  Sortable.prototype.reset = function(e) {\r\n    if (!this.accept) return\r\n    if (this.opts.activeClass) {\r\n      this.el.removeClass(this.opts.activeClass)\r\n    }\r\n\r\n    trigger(this.el, 'sortable:deactivate', e, { item: dragging.el })\r\n\r\n    if (this.index !== null) {\r\n      trigger(this.el, 'sortable:beforeStop', e, { item: dragging.el })\r\n      trigger(this.el, 'sortable:stop', e, { item: dragging.el })\r\n      this.index = null\r\n    }\r\n  }\r\n\r\n  Sortable.prototype.indexOf = function(el) {\r\n    return this.el.find(this.opts.items + ', #' + this.placeholder.attr('id')).index(el)\r\n  }\r\n\r\n  Sortable.prototype.start = function(e) {\r\n    if (this.opts.disabled || dragging.el) {\r\n      return\r\n    }\r\n\r\n    // only start on left mouse button\r\n    if (e.type === 'mousedown' && e.which !== 1) {\r\n      return false\r\n    }\r\n\r\n    if (this.opts.cancel) {\r\n      var target = $(e.target)\r\n      while (target[0] !== this.el[0]) {\r\n        if (target.is(this.opts.cancel)) return\r\n        target = target.parent()\r\n      }\r\n    }\r\n\r\n    if (this.opts.handle) {\r\n      var target = $(e.target), isHandle = false\r\n      while (target[0] !== this.el[0]) {\r\n        if (target.is(this.opts.handle)) {\r\n          isHandle = true\r\n          break\r\n        }\r\n        target = target.parent()\r\n      }\r\n      if (!isHandle) return\r\n    }\r\n\r\n    e.stopPropagation()\r\n    e.preventDefault() // prevent text selection\r\n\r\n    // use e.currentTarget instead of e.target because we want the target\r\n    // the event is bound to, not the target (child) the event is triggered from\r\n    dragging.start(this, $(e.currentTarget), e)\r\n\r\n    this.index = this.indexOf(dragging.el)\r\n\r\n    dragging.el.before(dragging.placeholder = this.placeholder.show())\r\n\r\n    // if dragging an item that belongs to the current list, hide it while\r\n    // it is being dragged\r\n    if (this.index !== null) {\r\n      // zepto <> jquery compatibility\r\n      var height = dragging.el.outerHeight ? dragging.el.outerHeight() : dragging.el.height()\r\n      dragging.css('margin-bottom', -height)\r\n    }\r\n\r\n    if (this.opts.forcePlaceholderSize) {\r\n      this.placeholder.height(parseFloat(dragging.el.css('height')))\r\n      this.placeholder.width(parseFloat(dragging.el.css('width')))\r\n    }\r\n\r\n    dragging.adjustPlacement(e)\r\n\r\n    trigger(this.el, 'sortable:start', e, { item: dragging.el })\r\n  }\r\n\r\n  Sortable.prototype.enter = function(e) {\r\n    if (!this.accept || this.opts.disabled) return\r\n\r\n    e.stopPropagation()\r\n\r\n    // stop if event is fired on the placeholder\r\n    var child = e.currentTarget, isContainer = child === this.el[0]\r\n    if (child === this.placeholder[0]) return\r\n    child = $(child)\r\n\r\n    // the container fallback is only necessary for empty sortables\r\n    if (isContainer && !this.isEmpty && this.placeholder.parent().length) {\r\n      return\r\n    }\r\n\r\n    dragging.placeholder = this.placeholder\r\n\r\n    if (this.opts.forcePlaceholderSize) {\r\n      this.placeholder.height(parseFloat(dragging.el.css('height')))\r\n      this.placeholder.width(parseFloat(dragging.el.css('width')))\r\n    }\r\n\r\n    if (!isContainer) {\r\n      this.diverted(e)\r\n    } else {\r\n      this.el.append(this.placeholder)\r\n      this.el.trigger('sortable:change', { item: dragging.el })\r\n    }\r\n  }\r\n\r\n  Sortable.prototype.diverted = function(e) {\r\n    if (!this.accept || this.opts.disabled) return\r\n    e.stopPropagation()\r\n\r\n    var child = $(e.currentTarget), isContainer = child[0] === this.el[0]\r\n    if (isContainer) return\r\n\r\n    // insert the placeholder according to the dragging direction\r\n    dragging.placeholder = this.placeholder\r\n    this.direction = this.indexOf(this.placeholder.show()) < this.indexOf(child) ? 'down' : 'up'\r\n    child[this.direction === 'down' ? 'after' : 'before'](this.placeholder)\r\n    dragging.adjustPlacement(e)\r\n\r\n    this.el.trigger('sortable:change', { item: dragging.el })\r\n  }\r\n\r\n  Sortable.prototype.drop = function(e) {\r\n    if (!this.accept || this.opts.disabled) return\r\n\r\n    e.stopPropagation()\r\n    e.preventDefault()\r\n\r\n    if (!dragging.el) return\r\n    if (!this.placeholder.parent().length) return\r\n\r\n    trigger(this.el, 'sortable:beforeStop', e, { item: dragging.el })\r\n\r\n    this.observer.disconnect()\r\n\r\n    var newIndex = this.indexOf(this.placeholder)\r\n    if (newIndex > this.index) {\r\n      newIndex--\r\n    }\r\n\r\n    var handler\r\n\r\n    // dropped element belongs to another list\r\n    if (this.index === null) {\r\n      handler = this.opts.receiveHandler\r\n    }\r\n    // dopped element belongs to the same list\r\n    else {\r\n      // updatePosition cause backwards-compatibility\r\n      handler = this.opts.updateHandler || this.opts.updatePosition\r\n    }\r\n\r\n    var el = dragging.el\r\n    if (typeof handler === 'function') {\r\n      handler.call(this.el, { item: dragging.el, index: newIndex })\r\n    } else {\r\n      if (dragging.handle) {\r\n        el = dragging.el.clone()\r\n      }\r\n      el.insertBefore(this.placeholder)\r\n    }\r\n\r\n    // if the dropped element belongs to another list, trigger the receive event\r\n    if (this.index === null) {\r\n      trigger(this.el, 'sortable:receive', e, { item: el })\r\n    }\r\n\r\n    // if the index changed, trigger the update event\r\n    if (newIndex !== this.index) {\r\n      this.el.trigger('sortable:update', { item: el, index: newIndex })\r\n    }\r\n\r\n    trigger(this.el, 'sortable:stop', e, { item: el })\r\n    this.index = null\r\n    this.observer.observe()\r\n\r\n    dragging.stop(e)\r\n  }\r\n\r\n  Sortable.prototype.toArray = function(opts) {\r\n    if (!opts) opts = {}\r\n    var attr = opts.attribute || 'id', attrs = []\r\n    this.el.find(this.opts.items).each(function() {\r\n      attrs.push($(this).prop(attr))\r\n    })\r\n    return attrs\r\n  }\r\n\r\n  function generic(constructor, identifier, defaults) {\r\n    return function(opts, name, value) {\r\n      var result = []\r\n      this.each(function() {\r\n        var instance = $(this).data(identifier)\r\n        if (typeof opts === 'string') {\r\n          if (typeof instance === 'undefined')\r\n            throw new Error(identifier + ' not defined')\r\n          switch (opts) {\r\n          case 'enable':  instance.enable();  break\r\n          case 'disable': instance.disable(); break\r\n          case 'destroy':\r\n            instance.destroy()\r\n            $(this).removeData(identifier)\r\n            break\r\n          case 'option':\r\n            // set\r\n            if (value !== undefined)\r\n              instance.opts[name] = value\r\n            else if (typeof name === 'object')\r\n              instance.opts = $.extend(instance.opts, name)\r\n            // get\r\n            else if (name)\r\n              result.push(instance.opts[name])\r\n            else\r\n              result.push(instance.opts)\r\n            break\r\n          // case 'serialize':\r\n          //   if (identifier !== 'sortable') return\r\n          //   result.push(instance.serialize())\r\n          //   break\r\n          case 'toArray':\r\n            if (identifier !== 'sortable') return\r\n            result.push(instance.toArray(name))\r\n            break\r\n          }\r\n        } else {\r\n          if (instance) {\r\n            $.extend(instance.opts, opts) // merge options\r\n            return this\r\n          }\r\n          instance = new constructor($(this), $.extend({}, defaults, opts))\r\n          instance.create()\r\n          $(this).data(identifier, instance)\r\n        }\r\n      })\r\n\r\n      if (result.length)\r\n        return result.length === 1 ? result[0] : result\r\n      else\r\n        return this\r\n    }\r\n  }\r\n\r\n  $.fn.draggable = generic(Draggable, 'draggable', {\r\n    cancel: 'input, textarea, button, select, option',\r\n    connectWith: false,\r\n    cursor: 'auto',\r\n    disabled: false,\r\n    handle: false,\r\n    initialized: false,\r\n    clone: false,\r\n    cloneClass: '',\r\n    scope: 'default'\r\n  })\r\n\r\n  $.fn.droppable = generic(Droppable, 'droppable', {\r\n    accept: '*',\r\n    activeClass: '',\r\n    disabled: false,\r\n    hoverClass: '',\r\n    initialized: false,\r\n    scope: 'default',\r\n    receiveHandler: null\r\n  })\r\n\r\n  $.fn.sortable = generic(Sortable, 'sortable', {\r\n    accept: '*',\r\n    activeClass: '',\r\n    cancel: 'input, textarea, button, select, option',\r\n    connectWith: false,\r\n    disabled: false,\r\n    forcePlaceholderSize: false,\r\n    handle: false,\r\n    initialized: false,\r\n    items: 'li, div',\r\n    placeholder: 'placeholder',\r\n    placeholderTag: null,\r\n    updateHandler: null,\r\n    receiveHandler: null\r\n  })\r\n})(window.Zepto || window.jQuery);\r\n\n/* build: `node build.js modules=ALL exclude=gestures,json minifier=uglifyjs` */\r\n/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */\r\n\r\nvar fabric = fabric || { version: \"1.5.0\" };\r\nif (typeof exports !== 'undefined') {\r\n  exports.fabric = fabric;\r\n}\r\n\r\nif (typeof document !== 'undefined' && typeof window !== 'undefined') {\r\n  fabric.document = document;\r\n  fabric.window = window;\r\n  // ensure globality even if entire library were function wrapped (as in Meteor.js packaging system)\r\n  window.fabric = fabric;\r\n}\r\nelse {\r\n  // assume we're running under node.js when document/window are not present\r\n  fabric.document = require(\"jsdom\")\r\n    .jsdom(\"<!DOCTYPE html><html><head></head><body></body></html>\");\r\n\r\n  if (fabric.document.createWindow) {\r\n    fabric.window = fabric.document.createWindow();\r\n  } else {\r\n    fabric.window = fabric.document.parentWindow;\r\n  }\r\n}\r\n\r\n/**\r\n * True when in environment that supports touch events\r\n * @type boolean\r\n */\r\nfabric.isTouchSupported = \"ontouchstart\" in fabric.document.documentElement;\r\n\r\n/**\r\n * True when in environment that's probably Node.js\r\n * @type boolean\r\n */\r\nfabric.isLikelyNode = typeof Buffer !== 'undefined' &&\r\n                      typeof window === 'undefined';\r\n\r\n/* _FROM_SVG_START_ */\r\n/**\r\n * Attributes parsed from all SVG elements\r\n * @type array\r\n */\r\nfabric.SHARED_ATTRIBUTES = [\r\n  \"display\",\r\n  \"transform\",\r\n  \"fill\", \"fill-opacity\", \"fill-rule\",\r\n  \"opacity\",\r\n  \"stroke\", \"stroke-dasharray\", \"stroke-linecap\",\r\n  \"stroke-linejoin\", \"stroke-miterlimit\",\r\n  \"stroke-opacity\", \"stroke-width\"\r\n];\r\n/* _FROM_SVG_END_ */\r\n\r\n/**\r\n * Pixel per Inch as a default value set to 96. Can be changed for more realistic conversion.\r\n */\r\nfabric.DPI = 96;\r\nfabric.reNum = '(?:[-+]?(?:\\\\d+|\\\\d*\\\\.\\\\d+)(?:e[-+]?\\\\d+)?)';\r\n\r\n\r\n(function() {\r\n\r\n  /**\r\n   * @private\r\n   * @param {String} eventName\r\n   * @param {Function} handler\r\n   */\r\n  function _removeEventListener(eventName, handler) {\r\n    if (!this.__eventListeners[eventName]) {\r\n      return;\r\n    }\r\n\r\n    if (handler) {\r\n      fabric.util.removeFromArray(this.__eventListeners[eventName], handler);\r\n    }\r\n    else {\r\n      this.__eventListeners[eventName].length = 0;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Observes specified event\r\n   * @deprecated `observe` deprecated since 0.8.34 (use `on` instead)\r\n   * @memberOf fabric.Observable\r\n   * @alias on\r\n   * @param {String|Object} eventName Event name (eg. 'after:render') or object with key/value pairs (eg. {'after:render': handler, 'selection:cleared': handler})\r\n   * @param {Function} handler Function that receives a notification when an event of the specified type occurs\r\n   * @return {Self} thisArg\r\n   * @chainable\r\n   */\r\n  function observe(eventName, handler) {\r\n    if (!this.__eventListeners) {\r\n      this.__eventListeners = { };\r\n    }\r\n    // one object with key/value pairs was passed\r\n    if (arguments.length === 1) {\r\n      for (var prop in eventName) {\r\n        this.on(prop, eventName[prop]);\r\n      }\r\n    }\r\n    else {\r\n      if (!this.__eventListeners[eventName]) {\r\n        this.__eventListeners[eventName] = [ ];\r\n      }\r\n      this.__eventListeners[eventName].push(handler);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Stops event observing for a particular event handler. Calling this method\r\n   * without arguments removes all handlers for all events\r\n   * @deprecated `stopObserving` deprecated since 0.8.34 (use `off` instead)\r\n   * @memberOf fabric.Observable\r\n   * @alias off\r\n   * @param {String|Object} eventName Event name (eg. 'after:render') or object with key/value pairs (eg. {'after:render': handler, 'selection:cleared': handler})\r\n   * @param {Function} handler Function to be deleted from EventListeners\r\n   * @return {Self} thisArg\r\n   * @chainable\r\n   */\r\n  function stopObserving(eventName, handler) {\r\n    if (!this.__eventListeners) {\r\n      return;\r\n    }\r\n\r\n    // remove all key/value pairs (event name -> event handler)\r\n    if (arguments.length === 0) {\r\n      this.__eventListeners = { };\r\n    }\r\n    // one object with key/value pairs was passed\r\n    else if (arguments.length === 1 && typeof arguments[0] === 'object') {\r\n      for (var prop in eventName) {\r\n        _removeEventListener.call(this, prop, eventName[prop]);\r\n      }\r\n    }\r\n    else {\r\n      _removeEventListener.call(this, eventName, handler);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * Fires event with an optional options object\r\n   * @deprecated `fire` deprecated since 1.0.7 (use `trigger` instead)\r\n   * @memberOf fabric.Observable\r\n   * @alias trigger\r\n   * @param {String} eventName Event name to fire\r\n   * @param {Object} [options] Options object\r\n   * @return {Self} thisArg\r\n   * @chainable\r\n   */\r\n  function fire(eventName, options) {\r\n    if (!this.__eventListeners) {\r\n      return;\r\n    }\r\n\r\n    var listenersForEvent = this.__eventListeners[eventName];\r\n    if (!listenersForEvent) {\r\n      return;\r\n    }\r\n\r\n    for (var i = 0, len = listenersForEvent.length; i < len; i++) {\r\n      // avoiding try/catch for perf. reasons\r\n      listenersForEvent[i].call(this, options || { });\r\n    }\r\n    return this;\r\n  }\r\n\r\n  /**\r\n   * @namespace fabric.Observable\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#events}\r\n   * @see {@link http://fabricjs.com/events/|Events demo}\r\n   */\r\n  fabric.Observable = {\r\n    observe: observe,\r\n    stopObserving: stopObserving,\r\n    fire: fire,\r\n\r\n    on: observe,\r\n    off: stopObserving,\r\n    trigger: fire\r\n  };\r\n})();\r\n\r\n\r\n/**\r\n * @namespace fabric.Collection\r\n */\r\nfabric.Collection = {\r\n\r\n  /**\r\n   * Adds objects to collection, then renders canvas (if `renderOnAddRemove` is not `false`)\r\n   * Objects should be instances of (or inherit from) fabric.Object\r\n   * @param {...fabric.Object} object Zero or more fabric instances\r\n   * @return {Self} thisArg\r\n   */\r\n  add: function () {\r\n    this._objects.push.apply(this._objects, arguments);\r\n    for (var i = 0, length = arguments.length; i < length; i++) {\r\n      this._onObjectAdded(arguments[i]);\r\n    }\r\n    this.renderOnAddRemove && this.renderAll();\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Inserts an object into collection at specified index, then renders canvas (if `renderOnAddRemove` is not `false`)\r\n   * An object should be an instance of (or inherit from) fabric.Object\r\n   * @param {Object} object Object to insert\r\n   * @param {Number} index Index to insert object at\r\n   * @param {Boolean} nonSplicing When `true`, no splicing (shifting) of objects occurs\r\n   * @return {Self} thisArg\r\n   * @chainable\r\n   */\r\n  insertAt: function (object, index, nonSplicing) {\r\n    var objects = this.getObjects();\r\n    if (nonSplicing) {\r\n      objects[index] = object;\r\n    }\r\n    else {\r\n      objects.splice(index, 0, object);\r\n    }\r\n    this._onObjectAdded(object);\r\n    this.renderOnAddRemove && this.renderAll();\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Removes objects from a collection, then renders canvas (if `renderOnAddRemove` is not `false`)\r\n   * @param {...fabric.Object} object Zero or more fabric instances\r\n   * @return {Self} thisArg\r\n   * @chainable\r\n   */\r\n  remove: function() {\r\n    var objects = this.getObjects(),\r\n        index;\r\n\r\n    for (var i = 0, length = arguments.length; i < length; i++) {\r\n      index = objects.indexOf(arguments[i]);\r\n\r\n      // only call onObjectRemoved if an object was actually removed\r\n      if (index !== -1) {\r\n        objects.splice(index, 1);\r\n        this._onObjectRemoved(arguments[i]);\r\n      }\r\n    }\r\n\r\n    this.renderOnAddRemove && this.renderAll();\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Executes given function for each object in this group\r\n   * @param {Function} callback\r\n   *                   Callback invoked with current object as first argument,\r\n   *                   index - as second and an array of all objects - as third.\r\n   *                   Iteration happens in reverse order (for performance reasons).\r\n   *                   Callback is invoked in a context of Global Object (e.g. `window`)\r\n   *                   when no `context` argument is given\r\n   *\r\n   * @param {Object} context Context (aka thisObject)\r\n   * @return {Self} thisArg\r\n   */\r\n  forEachObject: function(callback, context) {\r\n    var objects = this.getObjects(),\r\n        i = objects.length;\r\n    while (i--) {\r\n      callback.call(context, objects[i], i, objects);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Returns an array of children objects of this instance\r\n   * Type parameter introduced in 1.3.10\r\n   * @param {String} [type] When specified, only objects of this type are returned\r\n   * @return {Array}\r\n   */\r\n  getObjects: function(type) {\r\n    if (typeof type === 'undefined') {\r\n      return this._objects;\r\n    }\r\n    return this._objects.filter(function(o) {\r\n      return o.type === type;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Returns object at specified index\r\n   * @param {Number} index\r\n   * @return {Self} thisArg\r\n   */\r\n  item: function (index) {\r\n    return this.getObjects()[index];\r\n  },\r\n\r\n  /**\r\n   * Returns true if collection contains no objects\r\n   * @return {Boolean} true if collection is empty\r\n   */\r\n  isEmpty: function () {\r\n    return this.getObjects().length === 0;\r\n  },\r\n\r\n  /**\r\n   * Returns a size of a collection (i.e: length of an array containing its objects)\r\n   * @return {Number} Collection size\r\n   */\r\n  size: function() {\r\n    return this.getObjects().length;\r\n  },\r\n\r\n  /**\r\n   * Returns true if collection contains an object\r\n   * @param {Object} object Object to check against\r\n   * @return {Boolean} `true` if collection contains an object\r\n   */\r\n  contains: function(object) {\r\n    return this.getObjects().indexOf(object) > -1;\r\n  },\r\n\r\n  /**\r\n   * Returns number representation of a collection complexity\r\n   * @return {Number} complexity\r\n   */\r\n  complexity: function () {\r\n    return this.getObjects().reduce(function (memo, current) {\r\n      memo += current.complexity ? current.complexity() : 0;\r\n      return memo;\r\n    }, 0);\r\n  }\r\n};\r\n\r\n\r\n(function(global) {\r\n\r\n  var sqrt = Math.sqrt,\r\n      atan2 = Math.atan2,\r\n      PiBy180 = Math.PI / 180;\r\n\r\n  /**\r\n   * @namespace fabric.util\r\n   */\r\n  fabric.util = {\r\n\r\n    /**\r\n     * Removes value from an array.\r\n     * Presence of value (and its position in an array) is determined via `Array.prototype.indexOf`\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Array} array\r\n     * @param {Any} value\r\n     * @return {Array} original array\r\n     */\r\n    removeFromArray: function(array, value) {\r\n      var idx = array.indexOf(value);\r\n      if (idx !== -1) {\r\n        array.splice(idx, 1);\r\n      }\r\n      return array;\r\n    },\r\n\r\n    /**\r\n     * Returns random number between 2 specified ones.\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Number} min lower limit\r\n     * @param {Number} max upper limit\r\n     * @return {Number} random value (between min and max)\r\n     */\r\n    getRandomInt: function(min, max) {\r\n      return Math.floor(Math.random() * (max - min + 1)) + min;\r\n    },\r\n\r\n    /**\r\n     * Transforms degrees to radians.\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Number} degrees value in degrees\r\n     * @return {Number} value in radians\r\n     */\r\n    degreesToRadians: function(degrees) {\r\n      return degrees * PiBy180;\r\n    },\r\n\r\n    /**\r\n     * Transforms radians to degrees.\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Number} radians value in radians\r\n     * @return {Number} value in degrees\r\n     */\r\n    radiansToDegrees: function(radians) {\r\n      return radians / PiBy180;\r\n    },\r\n\r\n    /**\r\n     * Rotates `point` around `origin` with `radians`\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {fabric.Point} point The point to rotate\r\n     * @param {fabric.Point} origin The origin of the rotation\r\n     * @param {Number} radians The radians of the angle for the rotation\r\n     * @return {fabric.Point} The new rotated point\r\n     */\r\n    rotatePoint: function(point, origin, radians) {\r\n      var sin = Math.sin(radians),\r\n          cos = Math.cos(radians);\r\n\r\n      point.subtractEquals(origin);\r\n\r\n      var rx = point.x * cos - point.y * sin,\r\n          ry = point.x * sin + point.y * cos;\r\n\r\n      return new fabric.Point(rx, ry).addEquals(origin);\r\n    },\r\n\r\n    /**\r\n     * Apply transform t to point p\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param  {fabric.Point} p The point to transform\r\n     * @param  {Array} t The transform\r\n     * @param  {Boolean} [ignoreOffset] Indicates that the offset should not be applied\r\n     * @return {fabric.Point} The transformed point\r\n     */\r\n    transformPoint: function(p, t, ignoreOffset) {\r\n      if (ignoreOffset) {\r\n        return new fabric.Point(\r\n          t[0] * p.x + t[2] * p.y,\r\n          t[1] * p.x + t[3] * p.y\r\n        );\r\n      }\r\n      return new fabric.Point(\r\n        t[0] * p.x + t[2] * p.y + t[4],\r\n        t[1] * p.x + t[3] * p.y + t[5]\r\n      );\r\n    },\r\n\r\n    /**\r\n     * Invert transformation t\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Array} t The transform\r\n     * @return {Array} The inverted transform\r\n     */\r\n    invertTransform: function(t) {\r\n      var r = t.slice(),\r\n          a = 1 / (t[0] * t[3] - t[1] * t[2]);\r\n      r = [a * t[3], -a * t[1], -a * t[2], a * t[0], 0, 0];\r\n      var o = fabric.util.transformPoint({ x: t[4], y: t[5] }, r);\r\n      r[4] = -o.x;\r\n      r[5] = -o.y;\r\n      return r;\r\n    },\r\n\r\n    /**\r\n     * A wrapper around Number#toFixed, which contrary to native method returns number, not string.\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Number|String} number number to operate on\r\n     * @param {Number} fractionDigits number of fraction digits to \"leave\"\r\n     * @return {Number}\r\n     */\r\n    toFixed: function(number, fractionDigits) {\r\n      return parseFloat(Number(number).toFixed(fractionDigits));\r\n    },\r\n\r\n    /**\r\n     * Converts from attribute value to pixel value if applicable.\r\n     * Returns converted pixels or original value not converted.\r\n     * @param {Number|String} value number to operate on\r\n     * @return {Number|String}\r\n     */\r\n    parseUnit: function(value, fontSize) {\r\n      var unit = /\\D{0,2}$/.exec(value),\r\n          number = parseFloat(value);\r\n      if (!fontSize) {\r\n        fontSize = fabric.Text.DEFAULT_SVG_FONT_SIZE;\r\n      }\r\n      switch (unit[0]) {\r\n        case 'mm':\r\n          return number * fabric.DPI / 25.4;\r\n\r\n        case 'cm':\r\n          return number * fabric.DPI / 2.54;\r\n\r\n        case 'in':\r\n          return number * fabric.DPI;\r\n\r\n        case 'pt':\r\n          return number * fabric.DPI / 72; // or * 4 / 3\r\n\r\n        case 'pc':\r\n          return number * fabric.DPI / 72 * 12; // or * 16\r\n\r\n        case 'em':\r\n          return number * fontSize;\r\n\r\n        default:\r\n          return number;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Function which always returns `false`.\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @return {Boolean}\r\n     */\r\n    falseFunction: function() {\r\n      return false;\r\n    },\r\n\r\n    /**\r\n      * Returns klass \"Class\" object of given namespace\r\n      * @memberOf fabric.util\r\n      * @param {String} type Type of object (eg. 'circle')\r\n      * @param {String} namespace Namespace to get klass \"Class\" object from\r\n      * @return {Object} klass \"Class\"\r\n      */\r\n    getKlass: function(type, namespace) {\r\n      // capitalize first letter only\r\n      type = fabric.util.string.camelize(type.charAt(0).toUpperCase() + type.slice(1));\r\n      return fabric.util.resolveNamespace(namespace)[type];\r\n    },\r\n\r\n    /**\r\n     * Returns object of given namespace\r\n     * @memberOf fabric.util\r\n     * @param {String} namespace Namespace string e.g. 'fabric.Image.filter' or 'fabric'\r\n     * @return {Object} Object for given namespace (default fabric)\r\n     */\r\n    resolveNamespace: function(namespace) {\r\n      if (!namespace) {\r\n        return fabric;\r\n      }\r\n\r\n      var parts = namespace.split('.'),\r\n          len = parts.length,\r\n          obj = global || fabric.window;\r\n\r\n      for (var i = 0; i < len; ++i) {\r\n        obj = obj[parts[i]];\r\n      }\r\n\r\n      return obj;\r\n    },\r\n\r\n    /**\r\n     * Loads image element from given url and passes it to a callback\r\n     * @memberOf fabric.util\r\n     * @param {String} url URL representing an image\r\n     * @param {Function} callback Callback; invoked with loaded image\r\n     * @param {Any} [context] Context to invoke callback in\r\n     * @param {Object} [crossOrigin] crossOrigin value to set image element to\r\n     */\r\n    loadImage: function(url, callback, context, crossOrigin) {\r\n      if (!url) {\r\n        callback && callback.call(context, url);\r\n        return;\r\n      }\r\n\r\n      var img = fabric.util.createImage();\r\n\r\n      /** @ignore */\r\n      img.onload = function () {\r\n        callback && callback.call(context, img);\r\n        img = img.onload = img.onerror = null;\r\n      };\r\n\r\n      /** @ignore */\r\n      img.onerror = function() {\r\n        fabric.log('Error loading ' + img.src);\r\n        callback && callback.call(context, null, true);\r\n        img = img.onload = img.onerror = null;\r\n      };\r\n\r\n      // data-urls appear to be buggy with crossOrigin\r\n      // https://github.com/kangax/fabric.js/commit/d0abb90f1cd5c5ef9d2a94d3fb21a22330da3e0a#commitcomment-4513767\r\n      // see https://code.google.com/p/chromium/issues/detail?id=315152\r\n      //     https://bugzilla.mozilla.org/show_bug.cgi?id=935069\r\n      if (url.indexOf('data') !== 0 && typeof crossOrigin !== 'undefined') {\r\n        img.crossOrigin = crossOrigin;\r\n      }\r\n\r\n      img.src = url;\r\n    },\r\n\r\n    /**\r\n     * Creates corresponding fabric instances from their object representations\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Array} objects Objects to enliven\r\n     * @param {Function} callback Callback to invoke when all objects are created\r\n     * @param {String} namespace Namespace to get klass \"Class\" object from\r\n     * @param {Function} reviver Method for further parsing of object elements,\r\n     * called after each fabric object created.\r\n     */\r\n    enlivenObjects: function(objects, callback, namespace, reviver) {\r\n      objects = objects || [ ];\r\n\r\n      function onLoaded() {\r\n        if (++numLoadedObjects === numTotalObjects) {\r\n          callback && callback(enlivenedObjects);\r\n        }\r\n      }\r\n\r\n      var enlivenedObjects = [ ],\r\n          numLoadedObjects = 0,\r\n          numTotalObjects = objects.length;\r\n\r\n      if (!numTotalObjects) {\r\n        callback && callback(enlivenedObjects);\r\n        return;\r\n      }\r\n\r\n      objects.forEach(function (o, index) {\r\n        // if sparse array\r\n        if (!o || !o.type) {\r\n          onLoaded();\r\n          return;\r\n        }\r\n        var klass = fabric.util.getKlass(o.type, namespace);\r\n        if (klass.async) {\r\n          klass.fromObject(o, function (obj, error) {\r\n            if (!error) {\r\n              enlivenedObjects[index] = obj;\r\n              reviver && reviver(o, enlivenedObjects[index]);\r\n            }\r\n            onLoaded();\r\n          });\r\n        }\r\n        else {\r\n          enlivenedObjects[index] = klass.fromObject(o);\r\n          reviver && reviver(o, enlivenedObjects[index]);\r\n          onLoaded();\r\n        }\r\n      });\r\n    },\r\n\r\n    /**\r\n     * Groups SVG elements (usually those retrieved from SVG document)\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Array} elements SVG elements to group\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Object|fabric.PathGroup}\r\n     */\r\n    groupSVGElements: function(elements, options, path) {\r\n      var object;\r\n\r\n      object = new fabric.PathGroup(elements, options);\r\n\r\n      if (typeof path !== 'undefined') {\r\n        object.setSourcePath(path);\r\n      }\r\n      return object;\r\n    },\r\n\r\n    /**\r\n     * Populates an object with properties of another object\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Object} source Source object\r\n     * @param {Object} destination Destination object\r\n     * @return {Array} properties Propertie names to include\r\n     */\r\n    populateWithProperties: function(source, destination, properties) {\r\n      if (properties && Object.prototype.toString.call(properties) === '[object Array]') {\r\n        for (var i = 0, len = properties.length; i < len; i++) {\r\n          if (properties[i] in source) {\r\n            destination[properties[i]] = source[properties[i]];\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Draws a dashed line between two points\r\n     *\r\n     * This method is used to draw dashed line around selection area.\r\n     * See <a href=\"http://stackoverflow.com/questions/4576724/dotted-stroke-in-canvas\">dotted stroke in canvas</a>\r\n     *\r\n     * @param {CanvasRenderingContext2D} ctx context\r\n     * @param {Number} x  start x coordinate\r\n     * @param {Number} y start y coordinate\r\n     * @param {Number} x2 end x coordinate\r\n     * @param {Number} y2 end y coordinate\r\n     * @param {Array} da dash array pattern\r\n     */\r\n    drawDashedLine: function(ctx, x, y, x2, y2, da) {\r\n      var dx = x2 - x,\r\n          dy = y2 - y,\r\n          len = sqrt(dx * dx + dy * dy),\r\n          rot = atan2(dy, dx),\r\n          dc = da.length,\r\n          di = 0,\r\n          draw = true;\r\n\r\n      ctx.save();\r\n      ctx.translate(x, y);\r\n      ctx.moveTo(0, 0);\r\n      ctx.rotate(rot);\r\n\r\n      x = 0;\r\n      while (len > x) {\r\n        x += da[di++ % dc];\r\n        if (x > len) {\r\n          x = len;\r\n        }\r\n        ctx[draw ? 'lineTo' : 'moveTo'](x, 0);\r\n        draw = !draw;\r\n      }\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Creates canvas element and initializes it via excanvas if necessary\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {CanvasElement} [canvasEl] optional canvas element to initialize;\r\n     * when not given, element is created implicitly\r\n     * @return {CanvasElement} initialized canvas element\r\n     */\r\n    createCanvasElement: function(canvasEl) {\r\n      canvasEl || (canvasEl = fabric.document.createElement('canvas'));\r\n      //jscs:disable requireCamelCaseOrUpperCaseIdentifiers\r\n      if (!canvasEl.getContext && typeof G_vmlCanvasManager !== 'undefined') {\r\n        G_vmlCanvasManager.initElement(canvasEl);\r\n      }\r\n      //jscs:enable requireCamelCaseOrUpperCaseIdentifiers\r\n      return canvasEl;\r\n    },\r\n\r\n    /**\r\n     * Creates image element (works on client and node)\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @return {HTMLImageElement} HTML image element\r\n     */\r\n    createImage: function() {\r\n      return fabric.isLikelyNode\r\n        ? new (require('canvas').Image)()\r\n        : fabric.document.createElement('img');\r\n    },\r\n\r\n    /**\r\n     * Creates accessors (getXXX, setXXX) for a \"class\", based on \"stateProperties\" array\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {Object} klass \"Class\" to create accessors for\r\n     */\r\n    createAccessors: function(klass) {\r\n      var proto = klass.prototype;\r\n\r\n      for (var i = proto.stateProperties.length; i--; ) {\r\n\r\n        var propName = proto.stateProperties[i],\r\n            capitalizedPropName = propName.charAt(0).toUpperCase() + propName.slice(1),\r\n            setterName = 'set' + capitalizedPropName,\r\n            getterName = 'get' + capitalizedPropName;\r\n\r\n        // using `new Function` for better introspection\r\n        if (!proto[getterName]) {\r\n          proto[getterName] = (function(property) {\r\n            return new Function('return this.get(\"' + property + '\")');\r\n          })(propName);\r\n        }\r\n        if (!proto[setterName]) {\r\n          proto[setterName] = (function(property) {\r\n            return new Function('value', 'return this.set(\"' + property + '\", value)');\r\n          })(propName);\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param {fabric.Object} receiver Object implementing `clipTo` method\r\n     * @param {CanvasRenderingContext2D} ctx Context to clip\r\n     */\r\n    clipContext: function(receiver, ctx) {\r\n      ctx.save();\r\n      ctx.beginPath();\r\n      receiver.clipTo(ctx);\r\n      ctx.clip();\r\n    },\r\n\r\n    /**\r\n     * Multiply matrix A by matrix B to nest transformations\r\n     * @static\r\n     * @memberOf fabric.util\r\n     * @param  {Array} a First transformMatrix\r\n     * @param  {Array} b Second transformMatrix\r\n     * @return {Array} The product of the two transform matrices\r\n     */\r\n    multiplyTransformMatrices: function(a, b) {\r\n      // Matrix multiply a * b\r\n      return [\r\n        a[0] * b[0] + a[2] * b[1],\r\n        a[1] * b[0] + a[3] * b[1],\r\n        a[0] * b[2] + a[2] * b[3],\r\n        a[1] * b[2] + a[3] * b[3],\r\n        a[0] * b[4] + a[2] * b[5] + a[4],\r\n        a[1] * b[4] + a[3] * b[5] + a[5]\r\n      ];\r\n    },\r\n\r\n    /**\r\n     * Returns string representation of function body\r\n     * @param {Function} fn Function to get body of\r\n     * @return {String} Function body\r\n     */\r\n    getFunctionBody: function(fn) {\r\n      return (String(fn).match(/function[^{]*\\{([\\s\\S]*)\\}/) || {})[1];\r\n    },\r\n\r\n    /**\r\n     * Returns true if context has transparent pixel\r\n     * at specified location (taking tolerance into account)\r\n     * @param {CanvasRenderingContext2D} ctx context\r\n     * @param {Number} x x coordinate\r\n     * @param {Number} y y coordinate\r\n     * @param {Number} tolerance Tolerance\r\n     */\r\n    isTransparent: function(ctx, x, y, tolerance) {\r\n\r\n      // If tolerance is > 0 adjust start coords to take into account.\r\n      // If moves off Canvas fix to 0\r\n      if (tolerance > 0) {\r\n        if (x > tolerance) {\r\n          x -= tolerance;\r\n        }\r\n        else {\r\n          x = 0;\r\n        }\r\n        if (y > tolerance) {\r\n          y -= tolerance;\r\n        }\r\n        else {\r\n          y = 0;\r\n        }\r\n      }\r\n\r\n      var _isTransparent = true,\r\n          imageData = ctx.getImageData(x, y, (tolerance * 2) || 1, (tolerance * 2) || 1);\r\n\r\n      // Split image data - for tolerance > 1, pixelDataSize = 4;\r\n      for (var i = 3, l = imageData.data.length; i < l; i += 4) {\r\n        var temp = imageData.data[i];\r\n        _isTransparent = temp <= 0;\r\n        if (_isTransparent === false) {\r\n          break; // Stop if colour found\r\n        }\r\n      }\r\n\r\n      imageData = null;\r\n\r\n      return _isTransparent;\r\n    }\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function() {\r\n\r\n  var arcToSegmentsCache = { },\r\n      segmentToBezierCache = { },\r\n      boundsOfCurveCache = { },\r\n      _join = Array.prototype.join;\r\n\r\n  /* Adapted from http://dxr.mozilla.org/mozilla-central/source/content/svg/content/src/nsSVGPathDataParser.cpp\r\n   * by Andrea Bogazzi code is under MPL. if you don't have a copy of the license you can take it here\r\n   * http://mozilla.org/MPL/2.0/\r\n   */\r\n  function arcToSegments(toX, toY, rx, ry, large, sweep, rotateX) {\r\n    var argsString = _join.call(arguments);\r\n    if (arcToSegmentsCache[argsString]) {\r\n      return arcToSegmentsCache[argsString];\r\n    }\r\n\r\n    var PI = Math.PI, th = rotateX * PI / 180,\r\n        sinTh = Math.sin(th),\r\n        cosTh = Math.cos(th),\r\n        fromX = 0, fromY = 0;\r\n\r\n    rx = Math.abs(rx);\r\n    ry = Math.abs(ry);\r\n\r\n    var px = -cosTh * toX * 0.5 - sinTh * toY * 0.5,\r\n        py = -cosTh * toY * 0.5 + sinTh * toX * 0.5,\r\n        rx2 = rx * rx, ry2 = ry * ry, py2 = py * py, px2 = px * px,\r\n        pl = rx2 * ry2 - rx2 * py2 - ry2 * px2,\r\n        root = 0;\r\n\r\n    if (pl < 0) {\r\n      var s = Math.sqrt(1 - pl/(rx2 * ry2));\r\n      rx *= s;\r\n      ry *= s;\r\n    }\r\n    else {\r\n      root = (large === sweep ? -1.0 : 1.0) *\r\n              Math.sqrt( pl /(rx2 * py2 + ry2 * px2));\r\n    }\r\n\r\n    var cx = root * rx * py / ry,\r\n        cy = -root * ry * px / rx,\r\n        cx1 = cosTh * cx - sinTh * cy + toX * 0.5,\r\n        cy1 = sinTh * cx + cosTh * cy + toY * 0.5,\r\n        mTheta = calcVectorAngle(1, 0, (px - cx) / rx, (py - cy) / ry),\r\n        dtheta = calcVectorAngle((px - cx) / rx, (py - cy) / ry, (-px - cx) / rx, (-py - cy) / ry);\r\n\r\n    if (sweep === 0 && dtheta > 0) {\r\n      dtheta -= 2 * PI;\r\n    }\r\n    else if (sweep === 1 && dtheta < 0) {\r\n      dtheta += 2 * PI;\r\n    }\r\n\r\n    // Convert into cubic bezier segments <= 90deg\r\n    var segments = Math.ceil(Math.abs(dtheta / PI * 2)),\r\n        result = [], mDelta = dtheta / segments,\r\n        mT = 8 / 3 * Math.sin(mDelta / 4) * Math.sin(mDelta / 4) / Math.sin(mDelta / 2),\r\n        th3 = mTheta + mDelta;\r\n\r\n    for (var i = 0; i < segments; i++) {\r\n      result[i] = segmentToBezier(mTheta, th3, cosTh, sinTh, rx, ry, cx1, cy1, mT, fromX, fromY);\r\n      fromX = result[i][4];\r\n      fromY = result[i][5];\r\n      mTheta = th3;\r\n      th3 += mDelta;\r\n    }\r\n    arcToSegmentsCache[argsString] = result;\r\n    return result;\r\n  }\r\n\r\n  function segmentToBezier(th2, th3, cosTh, sinTh, rx, ry, cx1, cy1, mT, fromX, fromY) {\r\n    var argsString2 = _join.call(arguments);\r\n    if (segmentToBezierCache[argsString2]) {\r\n      return segmentToBezierCache[argsString2];\r\n    }\r\n\r\n    var costh2 = Math.cos(th2),\r\n        sinth2 = Math.sin(th2),\r\n        costh3 = Math.cos(th3),\r\n        sinth3 = Math.sin(th3),\r\n        toX = cosTh * rx * costh3 - sinTh * ry * sinth3 + cx1,\r\n        toY = sinTh * rx * costh3 + cosTh * ry * sinth3 + cy1,\r\n        cp1X = fromX + mT * ( - cosTh * rx * sinth2 - sinTh * ry * costh2),\r\n        cp1Y = fromY + mT * ( - sinTh * rx * sinth2 + cosTh * ry * costh2),\r\n        cp2X = toX + mT * ( cosTh * rx * sinth3 + sinTh * ry * costh3),\r\n        cp2Y = toY + mT * ( sinTh * rx * sinth3 - cosTh * ry * costh3);\r\n\r\n    segmentToBezierCache[argsString2] = [\r\n      cp1X, cp1Y,\r\n      cp2X, cp2Y,\r\n      toX, toY\r\n    ];\r\n    return segmentToBezierCache[argsString2];\r\n  }\r\n\r\n  /*\r\n  * Private\r\n  */\r\n  function calcVectorAngle(ux, uy, vx, vy) {\r\n    var ta = Math.atan2(uy, ux),\r\n        tb = Math.atan2(vy, vx);\r\n    if (tb >= ta) {\r\n      return tb - ta;\r\n    }\r\n    else {\r\n      return 2 * Math.PI - (ta - tb);\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Draws arc\r\n   * @param {CanvasRenderingContext2D} ctx\r\n   * @param {Number} fx\r\n   * @param {Number} fy\r\n   * @param {Array} coords\r\n   */\r\n  fabric.util.drawArc = function(ctx, fx, fy, coords) {\r\n    var rx = coords[0],\r\n        ry = coords[1],\r\n        rot = coords[2],\r\n        large = coords[3],\r\n        sweep = coords[4],\r\n        tx = coords[5],\r\n        ty = coords[6],\r\n        segs = [[ ], [ ], [ ], [ ]],\r\n        segsNorm = arcToSegments(tx - fx, ty - fy, rx, ry, large, sweep, rot);\r\n\r\n    for (var i = 0, len = segsNorm.length; i < len; i++) {\r\n      segs[i][0] = segsNorm[i][0] + fx;\r\n      segs[i][1] = segsNorm[i][1] + fy;\r\n      segs[i][2] = segsNorm[i][2] + fx;\r\n      segs[i][3] = segsNorm[i][3] + fy;\r\n      segs[i][4] = segsNorm[i][4] + fx;\r\n      segs[i][5] = segsNorm[i][5] + fy;\r\n      ctx.bezierCurveTo.apply(ctx, segs[i]);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Calculate bounding box of a elliptic-arc\r\n   * @param {Number} fx start point of arc\r\n   * @param {Number} fy\r\n   * @param {Number} rx horizontal radius\r\n   * @param {Number} ry vertical radius\r\n   * @param {Number} rot angle of horizontal axe\r\n   * @param {Number} large 1 or 0, whatever the arc is the big or the small on the 2 points\r\n   * @param {Number} sweep 1 or 0, 1 clockwise or counterclockwise direction\r\n   * @param {Number} tx end point of arc\r\n   * @param {Number} ty\r\n   */\r\n  fabric.util.getBoundsOfArc = function(fx, fy, rx, ry, rot, large, sweep, tx, ty) {\r\n\r\n    var fromX = 0, fromY = 0, bound = [ ], bounds = [ ],\r\n    segs = arcToSegments(tx - fx, ty - fy, rx, ry, large, sweep, rot),\r\n    boundCopy = [[ ], [ ]];\r\n\r\n    for (var i = 0, len = segs.length; i < len; i++) {\r\n      bound = getBoundsOfCurve(fromX, fromY, segs[i][0], segs[i][1], segs[i][2], segs[i][3], segs[i][4], segs[i][5]);\r\n      boundCopy[0].x = bound[0].x + fx;\r\n      boundCopy[0].y = bound[0].y + fy;\r\n      boundCopy[1].x = bound[1].x + fx;\r\n      boundCopy[1].y = bound[1].y + fy;\r\n      bounds.push(boundCopy[0]);\r\n      bounds.push(boundCopy[1]);\r\n      fromX = segs[i][4];\r\n      fromY = segs[i][5];\r\n    }\r\n    return bounds;\r\n  };\r\n\r\n  /**\r\n   * Calculate bounding box of a beziercurve\r\n   * @param {Number} x0 starting point\r\n   * @param {Number} y0\r\n   * @param {Number} x1 first control point\r\n   * @param {Number} y1\r\n   * @param {Number} x2 secondo control point\r\n   * @param {Number} y2\r\n   * @param {Number} x3 end of beizer\r\n   * @param {Number} y3\r\n   */\r\n  // taken from http://jsbin.com/ivomiq/56/edit  no credits available for that.\r\n  function getBoundsOfCurve(x0, y0, x1, y1, x2, y2, x3, y3) {\r\n    var argsString = _join.call(arguments);\r\n    if (boundsOfCurveCache[argsString]) {\r\n      return boundsOfCurveCache[argsString];\r\n    }\r\n\r\n    var sqrt = Math.sqrt,\r\n        min = Math.min, max = Math.max,\r\n        abs = Math.abs, tvalues = [ ],\r\n        bounds = [[ ], [ ]],\r\n        a, b, c, t, t1, t2, b2ac, sqrtb2ac;\r\n\r\n    b = 6 * x0 - 12 * x1 + 6 * x2;\r\n    a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\r\n    c = 3 * x1 - 3 * x0;\r\n\r\n    for (var i = 0; i < 2; ++i) {\r\n      if (i > 0) {\r\n        b = 6 * y0 - 12 * y1 + 6 * y2;\r\n        a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\r\n        c = 3 * y1 - 3 * y0;\r\n      }\r\n\r\n      if (abs(a) < 1e-12) {\r\n        if (abs(b) < 1e-12) {\r\n          continue;\r\n        }\r\n        t = -c / b;\r\n        if (0 < t && t < 1) {\r\n          tvalues.push(t);\r\n        }\r\n        continue;\r\n      }\r\n      b2ac = b * b - 4 * c * a;\r\n      if (b2ac < 0) {\r\n        continue;\r\n      }\r\n      sqrtb2ac = sqrt(b2ac);\r\n      t1 = (-b + sqrtb2ac) / (2 * a);\r\n      if (0 < t1 && t1 < 1) {\r\n        tvalues.push(t1);\r\n      }\r\n      t2 = (-b - sqrtb2ac) / (2 * a);\r\n      if (0 < t2 && t2 < 1) {\r\n        tvalues.push(t2);\r\n      }\r\n    }\r\n\r\n    var x, y, j = tvalues.length, jlen = j, mt;\r\n    while (j--) {\r\n      t = tvalues[j];\r\n      mt = 1 - t;\r\n      x = (mt * mt * mt * x0) + (3 * mt * mt * t * x1) + (3 * mt * t * t * x2) + (t * t * t * x3);\r\n      bounds[0][j] = x;\r\n\r\n      y = (mt * mt * mt * y0) + (3 * mt * mt * t * y1) + (3 * mt * t * t * y2) + (t * t * t * y3);\r\n      bounds[1][j] = y;\r\n    }\r\n\r\n    bounds[0][jlen] = x0;\r\n    bounds[1][jlen] = y0;\r\n    bounds[0][jlen + 1] = x3;\r\n    bounds[1][jlen + 1] = y3;\r\n    var result = [\r\n      {\r\n        x: min.apply(null, bounds[0]),\r\n        y: min.apply(null, bounds[1])\r\n      },\r\n      {\r\n        x: max.apply(null, bounds[0]),\r\n        y: max.apply(null, bounds[1])\r\n      }\r\n    ];\r\n    boundsOfCurveCache[argsString] = result;\r\n    return result;\r\n  }\r\n\r\n  fabric.util.getBoundsOfCurve = getBoundsOfCurve;\r\n\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  var slice = Array.prototype.slice;\r\n\r\n  /* _ES5_COMPAT_START_ */\r\n\r\n  if (!Array.prototype.indexOf) {\r\n    /**\r\n     * Finds index of an element in an array\r\n     * @param {Any} searchElement\r\n     * @param {Number} [fromIndex]\r\n     * @return {Number}\r\n     */\r\n    Array.prototype.indexOf = function (searchElement /*, fromIndex */ ) {\r\n      if (this === void 0 || this === null) {\r\n        throw new TypeError();\r\n      }\r\n      var t = Object(this), len = t.length >>> 0;\r\n      if (len === 0) {\r\n        return -1;\r\n      }\r\n      var n = 0;\r\n      if (arguments.length > 0) {\r\n        n = Number(arguments[1]);\r\n        if (n !== n) { // shortcut for verifying if it's NaN\r\n          n = 0;\r\n        }\r\n        else if (n !== 0 && n !== Number.POSITIVE_INFINITY && n !== Number.NEGATIVE_INFINITY) {\r\n          n = (n > 0 || -1) * Math.floor(Math.abs(n));\r\n        }\r\n      }\r\n      if (n >= len) {\r\n        return -1;\r\n      }\r\n      var k = n >= 0 ? n : Math.max(len - Math.abs(n), 0);\r\n      for (; k < len; k++) {\r\n        if (k in t && t[k] === searchElement) {\r\n          return k;\r\n        }\r\n      }\r\n      return -1;\r\n    };\r\n  }\r\n\r\n  if (!Array.prototype.forEach) {\r\n    /**\r\n     * Iterates an array, invoking callback for each element\r\n     * @param {Function} fn Callback to invoke for each element\r\n     * @param {Object} [context] Context to invoke callback in\r\n     * @return {Array}\r\n     */\r\n    Array.prototype.forEach = function(fn, context) {\r\n      for (var i = 0, len = this.length >>> 0; i < len; i++) {\r\n        if (i in this) {\r\n          fn.call(context, this[i], i, this);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  if (!Array.prototype.map) {\r\n    /**\r\n     * Returns a result of iterating over an array, invoking callback for each element\r\n     * @param {Function} fn Callback to invoke for each element\r\n     * @param {Object} [context] Context to invoke callback in\r\n     * @return {Array}\r\n     */\r\n    Array.prototype.map = function(fn, context) {\r\n      var result = [ ];\r\n      for (var i = 0, len = this.length >>> 0; i < len; i++) {\r\n        if (i in this) {\r\n          result[i] = fn.call(context, this[i], i, this);\r\n        }\r\n      }\r\n      return result;\r\n    };\r\n  }\r\n\r\n  if (!Array.prototype.every) {\r\n    /**\r\n     * Returns true if a callback returns truthy value for all elements in an array\r\n     * @param {Function} fn Callback to invoke for each element\r\n     * @param {Object} [context] Context to invoke callback in\r\n     * @return {Boolean}\r\n     */\r\n    Array.prototype.every = function(fn, context) {\r\n      for (var i = 0, len = this.length >>> 0; i < len; i++) {\r\n        if (i in this && !fn.call(context, this[i], i, this)) {\r\n          return false;\r\n        }\r\n      }\r\n      return true;\r\n    };\r\n  }\r\n\r\n  if (!Array.prototype.some) {\r\n    /**\r\n     * Returns true if a callback returns truthy value for at least one element in an array\r\n     * @param {Function} fn Callback to invoke for each element\r\n     * @param {Object} [context] Context to invoke callback in\r\n     * @return {Boolean}\r\n     */\r\n    Array.prototype.some = function(fn, context) {\r\n      for (var i = 0, len = this.length >>> 0; i < len; i++) {\r\n        if (i in this && fn.call(context, this[i], i, this)) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    };\r\n  }\r\n\r\n  if (!Array.prototype.filter) {\r\n    /**\r\n     * Returns the result of iterating over elements in an array\r\n     * @param {Function} fn Callback to invoke for each element\r\n     * @param {Object} [context] Context to invoke callback in\r\n     * @return {Array}\r\n     */\r\n    Array.prototype.filter = function(fn, context) {\r\n      var result = [ ], val;\r\n      for (var i = 0, len = this.length >>> 0; i < len; i++) {\r\n        if (i in this) {\r\n          val = this[i]; // in case fn mutates this\r\n          if (fn.call(context, val, i, this)) {\r\n            result.push(val);\r\n          }\r\n        }\r\n      }\r\n      return result;\r\n    };\r\n  }\r\n\r\n  if (!Array.prototype.reduce) {\r\n    /**\r\n     * Returns \"folded\" (reduced) result of iterating over elements in an array\r\n     * @param {Function} fn Callback to invoke for each element\r\n     * @param {Object} [initial] Object to use as the first argument to the first call of the callback\r\n     * @return {Any}\r\n     */\r\n    Array.prototype.reduce = function(fn /*, initial*/) {\r\n      var len = this.length >>> 0,\r\n          i = 0,\r\n          rv;\r\n\r\n      if (arguments.length > 1) {\r\n        rv = arguments[1];\r\n      }\r\n      else {\r\n        do {\r\n          if (i in this) {\r\n            rv = this[i++];\r\n            break;\r\n          }\r\n          // if array contains no values, no initial value to return\r\n          if (++i >= len) {\r\n            throw new TypeError();\r\n          }\r\n        }\r\n        while (true);\r\n      }\r\n      for (; i < len; i++) {\r\n        if (i in this) {\r\n          rv = fn.call(null, rv, this[i], i, this);\r\n        }\r\n      }\r\n      return rv;\r\n    };\r\n  }\r\n\r\n  /* _ES5_COMPAT_END_ */\r\n\r\n  /**\r\n   * Invokes method on all items in a given array\r\n   * @memberOf fabric.util.array\r\n   * @param {Array} array Array to iterate over\r\n   * @param {String} method Name of a method to invoke\r\n   * @return {Array}\r\n   */\r\n  function invoke(array, method) {\r\n    var args = slice.call(arguments, 2), result = [ ];\r\n    for (var i = 0, len = array.length; i < len; i++) {\r\n      result[i] = args.length ? array[i][method].apply(array[i], args) : array[i][method].call(array[i]);\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * Finds maximum value in array (not necessarily \"first\" one)\r\n   * @memberOf fabric.util.array\r\n   * @param {Array} array Array to iterate over\r\n   * @param {String} byProperty\r\n   * @return {Any}\r\n   */\r\n  function max(array, byProperty) {\r\n    return find(array, byProperty, function(value1, value2) {\r\n      return value1 >= value2;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Finds minimum value in array (not necessarily \"first\" one)\r\n   * @memberOf fabric.util.array\r\n   * @param {Array} array Array to iterate over\r\n   * @param {String} byProperty\r\n   * @return {Any}\r\n   */\r\n  function min(array, byProperty) {\r\n    return find(array, byProperty, function(value1, value2) {\r\n      return value1 < value2;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function find(array, byProperty, condition) {\r\n    if (!array || array.length === 0) {\r\n      return;\r\n    }\r\n\r\n    var i = array.length - 1,\r\n        result = byProperty ? array[i][byProperty] : array[i];\r\n    if (byProperty) {\r\n      while (i--) {\r\n        if (condition(array[i][byProperty], result)) {\r\n          result = array[i][byProperty];\r\n        }\r\n      }\r\n    }\r\n    else {\r\n      while (i--) {\r\n        if (condition(array[i], result)) {\r\n          result = array[i];\r\n        }\r\n      }\r\n    }\r\n    return result;\r\n  }\r\n\r\n  /**\r\n   * @namespace fabric.util.array\r\n   */\r\n  fabric.util.array = {\r\n    invoke: invoke,\r\n    min: min,\r\n    max: max\r\n  };\r\n\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  /**\r\n   * Copies all enumerable properties of one object to another\r\n   * @memberOf fabric.util.object\r\n   * @param {Object} destination Where to copy to\r\n   * @param {Object} source Where to copy from\r\n   * @return {Object}\r\n   */\r\n  function extend(destination, source) {\r\n    // JScript DontEnum bug is not taken care of\r\n    for (var property in source) {\r\n      destination[property] = source[property];\r\n    }\r\n    return destination;\r\n  }\r\n\r\n  /**\r\n   * Creates an empty object and copies all enumerable properties of another object to it\r\n   * @memberOf fabric.util.object\r\n   * @param {Object} object Object to clone\r\n   * @return {Object}\r\n   */\r\n  function clone(object) {\r\n    return extend({ }, object);\r\n  }\r\n\r\n  /** @namespace fabric.util.object */\r\n  fabric.util.object = {\r\n    extend: extend,\r\n    clone: clone\r\n  };\r\n\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  /* _ES5_COMPAT_START_ */\r\n  if (!String.prototype.trim) {\r\n    /**\r\n     * Trims a string (removing whitespace from the beginning and the end)\r\n     * @function external:String#trim\r\n     * @see <a href=\"https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/String/Trim\">String#trim on MDN</a>\r\n     */\r\n    String.prototype.trim = function () {\r\n      // this trim is not fully ES3 or ES5 compliant, but it should cover most cases for now\r\n      return this.replace(/^[\\s\\xA0]+/, '').replace(/[\\s\\xA0]+$/, '');\r\n    };\r\n  }\r\n  /* _ES5_COMPAT_END_ */\r\n\r\n  /**\r\n   * Camelizes a string\r\n   * @memberOf fabric.util.string\r\n   * @param {String} string String to camelize\r\n   * @return {String} Camelized version of a string\r\n   */\r\n  function camelize(string) {\r\n    return string.replace(/-+(.)?/g, function(match, character) {\r\n      return character ? character.toUpperCase() : '';\r\n    });\r\n  }\r\n\r\n  /**\r\n   * Capitalizes a string\r\n   * @memberOf fabric.util.string\r\n   * @param {String} string String to capitalize\r\n   * @param {Boolean} [firstLetterOnly] If true only first letter is capitalized\r\n   * and other letters stay untouched, if false first letter is capitalized\r\n   * and other letters are converted to lowercase.\r\n   * @return {String} Capitalized version of a string\r\n   */\r\n  function capitalize(string, firstLetterOnly) {\r\n    return string.charAt(0).toUpperCase() +\r\n      (firstLetterOnly ? string.slice(1) : string.slice(1).toLowerCase());\r\n  }\r\n\r\n  /**\r\n   * Escapes XML in a string\r\n   * @memberOf fabric.util.string\r\n   * @param {String} string String to escape\r\n   * @return {String} Escaped version of a string\r\n   */\r\n  function escapeXml(string) {\r\n    return string.replace(/&/g, '&amp;')\r\n       .replace(/\"/g, '&quot;')\r\n       .replace(/'/g, '&apos;')\r\n       .replace(/</g, '&lt;')\r\n       .replace(/>/g, '&gt;');\r\n  }\r\n\r\n  /**\r\n   * String utilities\r\n   * @namespace fabric.util.string\r\n   */\r\n  fabric.util.string = {\r\n    camelize: camelize,\r\n    capitalize: capitalize,\r\n    escapeXml: escapeXml\r\n  };\r\n}());\r\n\r\n\r\n/* _ES5_COMPAT_START_ */\r\n(function() {\r\n\r\n  var slice = Array.prototype.slice,\r\n      apply = Function.prototype.apply,\r\n      Dummy = function() { };\r\n\r\n  if (!Function.prototype.bind) {\r\n    /**\r\n     * Cross-browser approximation of ES5 Function.prototype.bind (not fully spec conforming)\r\n     * @see <a href=\"https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Function/bind\">Function#bind on MDN</a>\r\n     * @param {Object} thisArg Object to bind function to\r\n     * @param {Any[]} [...] Values to pass to a bound function\r\n     * @return {Function}\r\n     */\r\n    Function.prototype.bind = function(thisArg) {\r\n      var _this = this, args = slice.call(arguments, 1), bound;\r\n      if (args.length) {\r\n        bound = function() {\r\n          return apply.call(_this, this instanceof Dummy ? this : thisArg, args.concat(slice.call(arguments)));\r\n        };\r\n      }\r\n      else {\r\n        /** @ignore */\r\n        bound = function() {\r\n          return apply.call(_this, this instanceof Dummy ? this : thisArg, arguments);\r\n        };\r\n      }\r\n      Dummy.prototype = this.prototype;\r\n      bound.prototype = new Dummy();\r\n\r\n      return bound;\r\n    };\r\n  }\r\n\r\n})();\r\n/* _ES5_COMPAT_END_ */\r\n\r\n\r\n(function() {\r\n\r\n  var slice = Array.prototype.slice, emptyFunction = function() { },\r\n\r\n      IS_DONTENUM_BUGGY = (function() {\r\n        for (var p in { toString: 1 }) {\r\n          if (p === 'toString') {\r\n            return false;\r\n          }\r\n        }\r\n        return true;\r\n      })(),\r\n\r\n      /** @ignore */\r\n      addMethods = function(klass, source, parent) {\r\n        for (var property in source) {\r\n\r\n          if (property in klass.prototype &&\r\n              typeof klass.prototype[property] === 'function' &&\r\n              (source[property] + '').indexOf('callSuper') > -1) {\r\n\r\n            klass.prototype[property] = (function(property) {\r\n              return function() {\r\n\r\n                var superclass = this.constructor.superclass;\r\n                this.constructor.superclass = parent;\r\n                var returnValue = source[property].apply(this, arguments);\r\n                this.constructor.superclass = superclass;\r\n\r\n                if (property !== 'initialize') {\r\n                  return returnValue;\r\n                }\r\n              };\r\n            })(property);\r\n          }\r\n          else {\r\n            klass.prototype[property] = source[property];\r\n          }\r\n\r\n          if (IS_DONTENUM_BUGGY) {\r\n            if (source.toString !== Object.prototype.toString) {\r\n              klass.prototype.toString = source.toString;\r\n            }\r\n            if (source.valueOf !== Object.prototype.valueOf) {\r\n              klass.prototype.valueOf = source.valueOf;\r\n            }\r\n          }\r\n        }\r\n      };\r\n\r\n  function Subclass() { }\r\n\r\n  function callSuper(methodName) {\r\n    var fn = this.constructor.superclass.prototype[methodName];\r\n    return (arguments.length > 1)\r\n      ? fn.apply(this, slice.call(arguments, 1))\r\n      : fn.call(this);\r\n  }\r\n\r\n  /**\r\n   * Helper for creation of \"classes\".\r\n   * @memberOf fabric.util\r\n   * @param {Function} [parent] optional \"Class\" to inherit from\r\n   * @param {Object} [properties] Properties shared by all instances of this class\r\n   *                  (be careful modifying objects defined here as this would affect all instances)\r\n   */\r\n  function createClass() {\r\n    var parent = null,\r\n        properties = slice.call(arguments, 0);\r\n\r\n    if (typeof properties[0] === 'function') {\r\n      parent = properties.shift();\r\n    }\r\n    function klass() {\r\n      this.initialize.apply(this, arguments);\r\n    }\r\n\r\n    klass.superclass = parent;\r\n    klass.subclasses = [ ];\r\n\r\n    if (parent) {\r\n      Subclass.prototype = parent.prototype;\r\n      klass.prototype = new Subclass();\r\n      parent.subclasses.push(klass);\r\n    }\r\n    for (var i = 0, length = properties.length; i < length; i++) {\r\n      addMethods(klass, properties[i], parent);\r\n    }\r\n    if (!klass.prototype.initialize) {\r\n      klass.prototype.initialize = emptyFunction;\r\n    }\r\n    klass.prototype.constructor = klass;\r\n    klass.prototype.callSuper = callSuper;\r\n    return klass;\r\n  }\r\n\r\n  fabric.util.createClass = createClass;\r\n})();\r\n\r\n\r\n(function () {\r\n\r\n  var unknown = 'unknown';\r\n\r\n  /* EVENT HANDLING */\r\n\r\n  function areHostMethods(object) {\r\n    var methodNames = Array.prototype.slice.call(arguments, 1),\r\n        t, i, len = methodNames.length;\r\n    for (i = 0; i < len; i++) {\r\n      t = typeof object[methodNames[i]];\r\n      if (!(/^(?:function|object|unknown)$/).test(t)) {\r\n        return false;\r\n      }\r\n    }\r\n    return true;\r\n  }\r\n\r\n  /** @ignore */\r\n  var getElement,\r\n      setElement,\r\n      getUniqueId = (function () {\r\n        var uid = 0;\r\n        return function (element) {\r\n          return element.__uniqueID || (element.__uniqueID = 'uniqueID__' + uid++);\r\n        };\r\n      })();\r\n\r\n  (function () {\r\n    var elements = { };\r\n    /** @ignore */\r\n    getElement = function (uid) {\r\n      return elements[uid];\r\n    };\r\n    /** @ignore */\r\n    setElement = function (uid, element) {\r\n      elements[uid] = element;\r\n    };\r\n  })();\r\n\r\n  function createListener(uid, handler) {\r\n    return {\r\n      handler: handler,\r\n      wrappedHandler: createWrappedHandler(uid, handler)\r\n    };\r\n  }\r\n\r\n  function createWrappedHandler(uid, handler) {\r\n    return function (e) {\r\n      handler.call(getElement(uid), e || fabric.window.event);\r\n    };\r\n  }\r\n\r\n  function createDispatcher(uid, eventName) {\r\n    return function (e) {\r\n      if (handlers[uid] && handlers[uid][eventName]) {\r\n        var handlersForEvent = handlers[uid][eventName];\r\n        for (var i = 0, len = handlersForEvent.length; i < len; i++) {\r\n          handlersForEvent[i].call(this, e || fabric.window.event);\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  var shouldUseAddListenerRemoveListener = (\r\n        areHostMethods(fabric.document.documentElement, 'addEventListener', 'removeEventListener') &&\r\n        areHostMethods(fabric.window, 'addEventListener', 'removeEventListener')),\r\n\r\n      shouldUseAttachEventDetachEvent = (\r\n        areHostMethods(fabric.document.documentElement, 'attachEvent', 'detachEvent') &&\r\n        areHostMethods(fabric.window, 'attachEvent', 'detachEvent')),\r\n\r\n      // IE branch\r\n      listeners = { },\r\n\r\n      // DOM L0 branch\r\n      handlers = { },\r\n\r\n      addListener, removeListener;\r\n\r\n  if (shouldUseAddListenerRemoveListener) {\r\n    /** @ignore */\r\n    addListener = function (element, eventName, handler) {\r\n      element.addEventListener(eventName, handler, false);\r\n    };\r\n    /** @ignore */\r\n    removeListener = function (element, eventName, handler) {\r\n      element.removeEventListener(eventName, handler, false);\r\n    };\r\n  }\r\n\r\n  else if (shouldUseAttachEventDetachEvent) {\r\n    /** @ignore */\r\n    addListener = function (element, eventName, handler) {\r\n      var uid = getUniqueId(element);\r\n      setElement(uid, element);\r\n      if (!listeners[uid]) {\r\n        listeners[uid] = { };\r\n      }\r\n      if (!listeners[uid][eventName]) {\r\n        listeners[uid][eventName] = [ ];\r\n\r\n      }\r\n      var listener = createListener(uid, handler);\r\n      listeners[uid][eventName].push(listener);\r\n      element.attachEvent('on' + eventName, listener.wrappedHandler);\r\n    };\r\n    /** @ignore */\r\n    removeListener = function (element, eventName, handler) {\r\n      var uid = getUniqueId(element), listener;\r\n      if (listeners[uid] && listeners[uid][eventName]) {\r\n        for (var i = 0, len = listeners[uid][eventName].length; i < len; i++) {\r\n          listener = listeners[uid][eventName][i];\r\n          if (listener && listener.handler === handler) {\r\n            element.detachEvent('on' + eventName, listener.wrappedHandler);\r\n            listeners[uid][eventName][i] = null;\r\n          }\r\n        }\r\n      }\r\n    };\r\n  }\r\n  else {\r\n    /** @ignore */\r\n    addListener = function (element, eventName, handler) {\r\n      var uid = getUniqueId(element);\r\n      if (!handlers[uid]) {\r\n        handlers[uid] = { };\r\n      }\r\n      if (!handlers[uid][eventName]) {\r\n        handlers[uid][eventName] = [ ];\r\n        var existingHandler = element['on' + eventName];\r\n        if (existingHandler) {\r\n          handlers[uid][eventName].push(existingHandler);\r\n        }\r\n        element['on' + eventName] = createDispatcher(uid, eventName);\r\n      }\r\n      handlers[uid][eventName].push(handler);\r\n    };\r\n    /** @ignore */\r\n    removeListener = function (element, eventName, handler) {\r\n      var uid = getUniqueId(element);\r\n      if (handlers[uid] && handlers[uid][eventName]) {\r\n        var handlersForEvent = handlers[uid][eventName];\r\n        for (var i = 0, len = handlersForEvent.length; i < len; i++) {\r\n          if (handlersForEvent[i] === handler) {\r\n            handlersForEvent.splice(i, 1);\r\n          }\r\n        }\r\n      }\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Adds an event listener to an element\r\n   * @function\r\n   * @memberOf fabric.util\r\n   * @param {HTMLElement} element\r\n   * @param {String} eventName\r\n   * @param {Function} handler\r\n   */\r\n  fabric.util.addListener = addListener;\r\n\r\n  /**\r\n   * Removes an event listener from an element\r\n   * @function\r\n   * @memberOf fabric.util\r\n   * @param {HTMLElement} element\r\n   * @param {String} eventName\r\n   * @param {Function} handler\r\n   */\r\n  fabric.util.removeListener = removeListener;\r\n\r\n  /**\r\n   * Cross-browser wrapper for getting event's coordinates\r\n   * @memberOf fabric.util\r\n   * @param {Event} event Event object\r\n   * @param {HTMLCanvasElement} upperCanvasEl &lt;canvas> element on which object selection is drawn\r\n   */\r\n  function getPointer(event, upperCanvasEl) {\r\n    event || (event = fabric.window.event);\r\n\r\n    var element = event.target ||\r\n                  (typeof event.srcElement !== unknown ? event.srcElement : null),\r\n\r\n        scroll = fabric.util.getScrollLeftTop(element, upperCanvasEl);\r\n\r\n    return {\r\n      x: pointerX(event) + scroll.left,\r\n      y: pointerY(event) + scroll.top\r\n    };\r\n  }\r\n\r\n  var pointerX = function(event) {\r\n    // looks like in IE (<9) clientX at certain point (apparently when mouseup fires on VML element)\r\n    // is represented as COM object, with all the consequences, like \"unknown\" type and error on [[Get]]\r\n    // need to investigate later\r\n    return (typeof event.clientX !== unknown ? event.clientX : 0);\r\n  },\r\n\r\n  pointerY = function(event) {\r\n    return (typeof event.clientY !== unknown ? event.clientY : 0);\r\n  };\r\n\r\n  function _getPointer(event, pageProp, clientProp) {\r\n    var touchProp = event.type === 'touchend' ? 'changedTouches' : 'touches';\r\n\r\n    return (event[touchProp] && event[touchProp][0]\r\n      ? (event[touchProp][0][pageProp] - (event[touchProp][0][pageProp] - event[touchProp][0][clientProp]))\r\n        || event[clientProp]\r\n      : event[clientProp]);\r\n  }\r\n\r\n  if (fabric.isTouchSupported) {\r\n    pointerX = function(event) {\r\n      return _getPointer(event, 'pageX', 'clientX');\r\n    };\r\n    pointerY = function(event) {\r\n      return _getPointer(event, 'pageY', 'clientY');\r\n    };\r\n  }\r\n\r\n  fabric.util.getPointer = getPointer;\r\n\r\n  fabric.util.object.extend(fabric.util, fabric.Observable);\r\n\r\n})();\r\n\r\n\r\n(function () {\r\n\r\n  /**\r\n   * Cross-browser wrapper for setting element's style\r\n   * @memberOf fabric.util\r\n   * @param {HTMLElement} element\r\n   * @param {Object} styles\r\n   * @return {HTMLElement} Element that was passed as a first argument\r\n   */\r\n  function setStyle(element, styles) {\r\n    var elementStyle = element.style;\r\n    if (!elementStyle) {\r\n      return element;\r\n    }\r\n    if (typeof styles === 'string') {\r\n      element.style.cssText += ';' + styles;\r\n      return styles.indexOf('opacity') > -1\r\n        ? setOpacity(element, styles.match(/opacity:\\s*(\\d?\\.?\\d*)/)[1])\r\n        : element;\r\n    }\r\n    for (var property in styles) {\r\n      if (property === 'opacity') {\r\n        setOpacity(element, styles[property]);\r\n      }\r\n      else {\r\n        var normalizedProperty = (property === 'float' || property === 'cssFloat')\r\n          ? (typeof elementStyle.styleFloat === 'undefined' ? 'cssFloat' : 'styleFloat')\r\n          : property;\r\n        elementStyle[normalizedProperty] = styles[property];\r\n      }\r\n    }\r\n    return element;\r\n  }\r\n\r\n  var parseEl = fabric.document.createElement('div'),\r\n      supportsOpacity = typeof parseEl.style.opacity === 'string',\r\n      supportsFilters = typeof parseEl.style.filter === 'string',\r\n      reOpacity = /alpha\\s*\\(\\s*opacity\\s*=\\s*([^\\)]+)\\)/,\r\n\r\n      /** @ignore */\r\n      setOpacity = function (element) { return element; };\r\n\r\n  if (supportsOpacity) {\r\n    /** @ignore */\r\n    setOpacity = function(element, value) {\r\n      element.style.opacity = value;\r\n      return element;\r\n    };\r\n  }\r\n  else if (supportsFilters) {\r\n    /** @ignore */\r\n    setOpacity = function(element, value) {\r\n      var es = element.style;\r\n      if (element.currentStyle && !element.currentStyle.hasLayout) {\r\n        es.zoom = 1;\r\n      }\r\n      if (reOpacity.test(es.filter)) {\r\n        value = value >= 0.9999 ? '' : ('alpha(opacity=' + (value * 100) + ')');\r\n        es.filter = es.filter.replace(reOpacity, value);\r\n      }\r\n      else {\r\n        es.filter += ' alpha(opacity=' + (value * 100) + ')';\r\n      }\r\n      return element;\r\n    };\r\n  }\r\n\r\n  fabric.util.setStyle = setStyle;\r\n\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  var _slice = Array.prototype.slice;\r\n\r\n  /**\r\n   * Takes id and returns an element with that id (if one exists in a document)\r\n   * @memberOf fabric.util\r\n   * @param {String|HTMLElement} id\r\n   * @return {HTMLElement|null}\r\n   */\r\n  function getById(id) {\r\n    return typeof id === 'string' ? fabric.document.getElementById(id) : id;\r\n  }\r\n\r\n  var sliceCanConvertNodelists,\r\n      /**\r\n       * Converts an array-like object (e.g. arguments or NodeList) to an array\r\n       * @memberOf fabric.util\r\n       * @param {Object} arrayLike\r\n       * @return {Array}\r\n       */\r\n      toArray = function(arrayLike) {\r\n        return _slice.call(arrayLike, 0);\r\n      };\r\n\r\n  try {\r\n    sliceCanConvertNodelists = toArray(fabric.document.childNodes) instanceof Array;\r\n  }\r\n  catch (err) { }\r\n\r\n  if (!sliceCanConvertNodelists) {\r\n    toArray = function(arrayLike) {\r\n      var arr = new Array(arrayLike.length), i = arrayLike.length;\r\n      while (i--) {\r\n        arr[i] = arrayLike[i];\r\n      }\r\n      return arr;\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Creates specified element with specified attributes\r\n   * @memberOf fabric.util\r\n   * @param {String} tagName Type of an element to create\r\n   * @param {Object} [attributes] Attributes to set on an element\r\n   * @return {HTMLElement} Newly created element\r\n   */\r\n  function makeElement(tagName, attributes) {\r\n    var el = fabric.document.createElement(tagName);\r\n    for (var prop in attributes) {\r\n      if (prop === 'class') {\r\n        el.className = attributes[prop];\r\n      }\r\n      else if (prop === 'for') {\r\n        el.htmlFor = attributes[prop];\r\n      }\r\n      else {\r\n        el.setAttribute(prop, attributes[prop]);\r\n      }\r\n    }\r\n    return el;\r\n  }\r\n\r\n  /**\r\n   * Adds class to an element\r\n   * @memberOf fabric.util\r\n   * @param {HTMLElement} element Element to add class to\r\n   * @param {String} className Class to add to an element\r\n   */\r\n  function addClass(element, className) {\r\n    if (element && (' ' + element.className + ' ').indexOf(' ' + className + ' ') === -1) {\r\n      element.className += (element.className ? ' ' : '') + className;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Wraps element with another element\r\n   * @memberOf fabric.util\r\n   * @param {HTMLElement} element Element to wrap\r\n   * @param {HTMLElement|String} wrapper Element to wrap with\r\n   * @param {Object} [attributes] Attributes to set on a wrapper\r\n   * @return {HTMLElement} wrapper\r\n   */\r\n  function wrapElement(element, wrapper, attributes) {\r\n    if (typeof wrapper === 'string') {\r\n      wrapper = makeElement(wrapper, attributes);\r\n    }\r\n    if (element.parentNode) {\r\n      element.parentNode.replaceChild(wrapper, element);\r\n    }\r\n    wrapper.appendChild(element);\r\n    return wrapper;\r\n  }\r\n\r\n  /**\r\n   * Returns element scroll offsets\r\n   * @memberOf fabric.util\r\n   * @param {HTMLElement} element Element to operate on\r\n   * @param {HTMLElement} upperCanvasEl Upper canvas element\r\n   * @return {Object} Object with left/top values\r\n   */\r\n  function getScrollLeftTop(element, upperCanvasEl) {\r\n\r\n    var firstFixedAncestor,\r\n        origElement,\r\n        left = 0,\r\n        top = 0,\r\n        docElement = fabric.document.documentElement,\r\n        body = fabric.document.body || {\r\n          scrollLeft: 0, scrollTop: 0\r\n        };\r\n\r\n    origElement = element;\r\n\r\n    while (element && element.parentNode && !firstFixedAncestor) {\r\n\r\n      element = element.parentNode;\r\n\r\n      if (element.nodeType === 1 &&\r\n          fabric.util.getElementStyle(element, 'position') === 'fixed') {\r\n        firstFixedAncestor = element;\r\n      }\r\n\r\n      if (element.nodeType === 1 &&\r\n          origElement !== upperCanvasEl &&\r\n          fabric.util.getElementStyle(element, 'position') === 'absolute') {\r\n        left = 0;\r\n        top = 0;\r\n      }\r\n      else if (element === fabric.document) {\r\n        left = body.scrollLeft || docElement.scrollLeft || 0;\r\n        top = body.scrollTop ||  docElement.scrollTop || 0;\r\n      }\r\n      else {\r\n        left += element.scrollLeft || 0;\r\n        top += element.scrollTop || 0;\r\n      }\r\n    }\r\n\r\n    return { left: left, top: top };\r\n  }\r\n\r\n  /**\r\n   * Returns offset for a given element\r\n   * @function\r\n   * @memberOf fabric.util\r\n   * @param {HTMLElement} element Element to get offset for\r\n   * @return {Object} Object with \"left\" and \"top\" properties\r\n   */\r\n  function getElementOffset(element) {\r\n    var docElem,\r\n        doc = element && element.ownerDocument,\r\n        box = { left: 0, top: 0 },\r\n        offset = { left: 0, top: 0 },\r\n        scrollLeftTop,\r\n        offsetAttributes = {\r\n          borderLeftWidth: 'left',\r\n          borderTopWidth:  'top',\r\n          paddingLeft:     'left',\r\n          paddingTop:      'top'\r\n        };\r\n\r\n    if (!doc) {\r\n      return { left: 0, top: 0 };\r\n    }\r\n\r\n    for (var attr in offsetAttributes) {\r\n      offset[offsetAttributes[attr]] += parseInt(getElementStyle(element, attr), 10) || 0;\r\n    }\r\n\r\n    docElem = doc.documentElement;\r\n    if ( typeof element.getBoundingClientRect !== 'undefined' ) {\r\n      box = element.getBoundingClientRect();\r\n    }\r\n\r\n    scrollLeftTop = fabric.util.getScrollLeftTop(element, null);\r\n\r\n    return {\r\n      left: box.left + scrollLeftTop.left - (docElem.clientLeft || 0) + offset.left,\r\n      top: box.top + scrollLeftTop.top - (docElem.clientTop || 0)  + offset.top\r\n    };\r\n  }\r\n\r\n  /**\r\n  * Returns style attribute value of a given element\r\n  * @memberOf fabric.util\r\n  * @param {HTMLElement} element Element to get style attribute for\r\n  * @param {String} attr Style attribute to get for element\r\n  * @return {String} Style attribute value of the given element.\r\n  */\r\n  var getElementStyle;\r\n  if (fabric.document.defaultView && fabric.document.defaultView.getComputedStyle) {\r\n    getElementStyle = function(element, attr) {\r\n      var style = fabric.document.defaultView.getComputedStyle(element, null);\r\n      return style ? style[attr] : undefined;\r\n    };\r\n  }\r\n  else {\r\n    getElementStyle = function(element, attr) {\r\n      var value = element.style[attr];\r\n      if (!value && element.currentStyle) {\r\n        value = element.currentStyle[attr];\r\n      }\r\n      return value;\r\n    };\r\n  }\r\n\r\n  (function () {\r\n    var style = fabric.document.documentElement.style,\r\n        selectProp = 'userSelect' in style\r\n          ? 'userSelect'\r\n          : 'MozUserSelect' in style\r\n            ? 'MozUserSelect'\r\n            : 'WebkitUserSelect' in style\r\n              ? 'WebkitUserSelect'\r\n              : 'KhtmlUserSelect' in style\r\n                ? 'KhtmlUserSelect'\r\n                : '';\r\n\r\n    /**\r\n     * Makes element unselectable\r\n     * @memberOf fabric.util\r\n     * @param {HTMLElement} element Element to make unselectable\r\n     * @return {HTMLElement} Element that was passed in\r\n     */\r\n    function makeElementUnselectable(element) {\r\n      if (typeof element.onselectstart !== 'undefined') {\r\n        element.onselectstart = fabric.util.falseFunction;\r\n      }\r\n      if (selectProp) {\r\n        element.style[selectProp] = 'none';\r\n      }\r\n      else if (typeof element.unselectable === 'string') {\r\n        element.unselectable = 'on';\r\n      }\r\n      return element;\r\n    }\r\n\r\n    /**\r\n     * Makes element selectable\r\n     * @memberOf fabric.util\r\n     * @param {HTMLElement} element Element to make selectable\r\n     * @return {HTMLElement} Element that was passed in\r\n     */\r\n    function makeElementSelectable(element) {\r\n      if (typeof element.onselectstart !== 'undefined') {\r\n        element.onselectstart = null;\r\n      }\r\n      if (selectProp) {\r\n        element.style[selectProp] = '';\r\n      }\r\n      else if (typeof element.unselectable === 'string') {\r\n        element.unselectable = '';\r\n      }\r\n      return element;\r\n    }\r\n\r\n    fabric.util.makeElementUnselectable = makeElementUnselectable;\r\n    fabric.util.makeElementSelectable = makeElementSelectable;\r\n  })();\r\n\r\n  (function() {\r\n\r\n    /**\r\n     * Inserts a script element with a given url into a document; invokes callback, when that script is finished loading\r\n     * @memberOf fabric.util\r\n     * @param {String} url URL of a script to load\r\n     * @param {Function} callback Callback to execute when script is finished loading\r\n     */\r\n    function getScript(url, callback) {\r\n      var headEl = fabric.document.getElementsByTagName('head')[0],\r\n          scriptEl = fabric.document.createElement('script'),\r\n          loading = true;\r\n\r\n      /** @ignore */\r\n      scriptEl.onload = /** @ignore */ scriptEl.onreadystatechange = function(e) {\r\n        if (loading) {\r\n          if (typeof this.readyState === 'string' &&\r\n              this.readyState !== 'loaded' &&\r\n              this.readyState !== 'complete') {\r\n            return;\r\n          }\r\n          loading = false;\r\n          callback(e || fabric.window.event);\r\n          scriptEl = scriptEl.onload = scriptEl.onreadystatechange = null;\r\n        }\r\n      };\r\n      scriptEl.src = url;\r\n      headEl.appendChild(scriptEl);\r\n      // causes issue in Opera\r\n      // headEl.removeChild(scriptEl);\r\n    }\r\n\r\n    fabric.util.getScript = getScript;\r\n  })();\r\n\r\n  fabric.util.getById = getById;\r\n  fabric.util.toArray = toArray;\r\n  fabric.util.makeElement = makeElement;\r\n  fabric.util.addClass = addClass;\r\n  fabric.util.wrapElement = wrapElement;\r\n  fabric.util.getScrollLeftTop = getScrollLeftTop;\r\n  fabric.util.getElementOffset = getElementOffset;\r\n  fabric.util.getElementStyle = getElementStyle;\r\n\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  function addParamToUrl(url, param) {\r\n    return url + (/\\?/.test(url) ? '&' : '?') + param;\r\n  }\r\n\r\n  var makeXHR = (function() {\r\n    var factories = [\r\n      function() { return new ActiveXObject('Microsoft.XMLHTTP'); },\r\n      function() { return new ActiveXObject('Msxml2.XMLHTTP'); },\r\n      function() { return new ActiveXObject('Msxml2.XMLHTTP.3.0'); },\r\n      function() { return new XMLHttpRequest(); }\r\n    ];\r\n    for (var i = factories.length; i--; ) {\r\n      try {\r\n        var req = factories[i]();\r\n        if (req) {\r\n          return factories[i];\r\n        }\r\n      }\r\n      catch (err) { }\r\n    }\r\n  })();\r\n\r\n  function emptyFn() { }\r\n\r\n  /**\r\n   * Cross-browser abstraction for sending XMLHttpRequest\r\n   * @memberOf fabric.util\r\n   * @param {String} url URL to send XMLHttpRequest to\r\n   * @param {Object} [options] Options object\r\n   * @param {String} [options.method=\"GET\"]\r\n   * @param {Function} options.onComplete Callback to invoke when request is completed\r\n   * @return {XMLHttpRequest} request\r\n   */\r\n  function request(url, options) {\r\n\r\n    options || (options = { });\r\n\r\n    var method = options.method ? options.method.toUpperCase() : 'GET',\r\n        onComplete = options.onComplete || function() { },\r\n        xhr = makeXHR(),\r\n        body;\r\n\r\n    /** @ignore */\r\n    xhr.onreadystatechange = function() {\r\n      if (xhr.readyState === 4) {\r\n        onComplete(xhr);\r\n        xhr.onreadystatechange = emptyFn;\r\n      }\r\n    };\r\n\r\n    if (method === 'GET') {\r\n      body = null;\r\n      if (typeof options.parameters === 'string') {\r\n        url = addParamToUrl(url, options.parameters);\r\n      }\r\n    }\r\n\r\n    xhr.open(method, url, true);\r\n\r\n    if (method === 'POST' || method === 'PUT') {\r\n      xhr.setRequestHeader('Content-Type', 'application/x-www-form-urlencoded');\r\n    }\r\n\r\n    xhr.send(body);\r\n    return xhr;\r\n  }\r\n\r\n  fabric.util.request = request;\r\n})();\r\n\r\n\r\n/**\r\n * Wrapper around `console.log` (when available)\r\n * @param {Any} [values] Values to log\r\n */\r\nfabric.log = function() { };\r\n\r\n/**\r\n * Wrapper around `console.warn` (when available)\r\n * @param {Any} [values] Values to log as a warning\r\n */\r\nfabric.warn = function() { };\r\n\r\nif (typeof console !== 'undefined') {\r\n\r\n  ['log', 'warn'].forEach(function(methodName) {\r\n\r\n    if (typeof console[methodName] !== 'undefined' &&\r\n        typeof console[methodName].apply === 'function') {\r\n\r\n      fabric[methodName] = function() {\r\n        return console[methodName].apply(console, arguments);\r\n      };\r\n    }\r\n  });\r\n}\r\n\r\n\r\n(function() {\r\n\r\n  /**\r\n   * Changes value from one to another within certain period of time, invoking callbacks as value is being changed.\r\n   * @memberOf fabric.util\r\n   * @param {Object} [options] Animation options\r\n   * @param {Function} [options.onChange] Callback; invoked on every value change\r\n   * @param {Function} [options.onComplete] Callback; invoked when value change is completed\r\n   * @param {Number} [options.startValue=0] Starting value\r\n   * @param {Number} [options.endValue=100] Ending value\r\n   * @param {Number} [options.byValue=100] Value to modify the property by\r\n   * @param {Function} [options.easing] Easing function\r\n   * @param {Number} [options.duration=500] Duration of change (in ms)\r\n   */\r\n  function animate(options) {\r\n\r\n    requestAnimFrame(function(timestamp) {\r\n      options || (options = { });\r\n\r\n      var start = timestamp || +new Date(),\r\n          duration = options.duration || 500,\r\n          finish = start + duration, time,\r\n          onChange = options.onChange || function() { },\r\n          abort = options.abort || function() { return false; },\r\n          easing = options.easing || function(t, b, c, d) {return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;},\r\n          startValue = 'startValue' in options ? options.startValue : 0,\r\n          endValue = 'endValue' in options ? options.endValue : 100,\r\n          byValue = options.byValue || endValue - startValue;\r\n\r\n      options.onStart && options.onStart();\r\n\r\n      (function tick(ticktime) {\r\n        time = ticktime || +new Date();\r\n        var currentTime = time > finish ? duration : (time - start);\r\n        if (abort()) {\r\n          options.onComplete && options.onComplete();\r\n          return;\r\n        }\r\n        onChange(easing(currentTime, startValue, byValue, duration));\r\n        if (time > finish) {\r\n          options.onComplete && options.onComplete();\r\n          return;\r\n        }\r\n        requestAnimFrame(tick);\r\n      })(start);\r\n    });\r\n\r\n  }\r\n\r\n  var _requestAnimFrame = fabric.window.requestAnimationFrame       ||\r\n                          fabric.window.webkitRequestAnimationFrame ||\r\n                          fabric.window.mozRequestAnimationFrame    ||\r\n                          fabric.window.oRequestAnimationFrame      ||\r\n                          fabric.window.msRequestAnimationFrame     ||\r\n                          function(callback) {\r\n                            fabric.window.setTimeout(callback, 1000 / 60);\r\n                          };\r\n  /**\r\n    * requestAnimationFrame polyfill based on http://paulirish.com/2011/requestanimationframe-for-smart-animating/\r\n    * In order to get a precise start time, `requestAnimFrame` should be called as an entry into the method\r\n    * @memberOf fabric.util\r\n    * @param {Function} callback Callback to invoke\r\n    * @param {DOMElement} element optional Element to associate with animation\r\n    */\r\n  function requestAnimFrame() {\r\n    return _requestAnimFrame.apply(fabric.window, arguments);\r\n  }\r\n\r\n  fabric.util.animate = animate;\r\n  fabric.util.requestAnimFrame = requestAnimFrame;\r\n\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  function normalize(a, c, p, s) {\r\n    if (a < Math.abs(c)) {\r\n      a = c;\r\n      s = p / 4;\r\n    }\r\n    else {\r\n      s = p / (2 * Math.PI) * Math.asin(c / a);\r\n    }\r\n    return { a: a, c: c, p: p, s: s };\r\n  }\r\n\r\n  function elastic(opts, t, d) {\r\n    return opts.a *\r\n      Math.pow(2, 10 * (t -= 1)) *\r\n      Math.sin( (t * d - opts.s) * (2 * Math.PI) / opts.p );\r\n  }\r\n\r\n  /**\r\n   * Cubic easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutCubic(t, b, c, d) {\r\n    return c * ((t = t / d - 1) * t * t + 1) + b;\r\n  }\r\n\r\n  /**\r\n   * Cubic easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutCubic(t, b, c, d) {\r\n    t /= d/2;\r\n    if (t < 1) {\r\n      return c / 2 * t * t * t + b;\r\n    }\r\n    return c / 2 * ((t -= 2) * t * t + 2) + b;\r\n  }\r\n\r\n  /**\r\n   * Quartic easing in\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInQuart(t, b, c, d) {\r\n    return c * (t /= d) * t * t * t + b;\r\n  }\r\n\r\n  /**\r\n   * Quartic easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutQuart(t, b, c, d) {\r\n    return -c * ((t = t / d - 1) * t * t * t - 1) + b;\r\n  }\r\n\r\n  /**\r\n   * Quartic easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutQuart(t, b, c, d) {\r\n    t /= d / 2;\r\n    if (t < 1) {\r\n      return c / 2 * t * t * t * t + b;\r\n    }\r\n    return -c / 2 * ((t -= 2) * t * t * t - 2) + b;\r\n  }\r\n\r\n  /**\r\n   * Quintic easing in\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInQuint(t, b, c, d) {\r\n    return c * (t /= d) * t * t * t * t + b;\r\n  }\r\n\r\n  /**\r\n   * Quintic easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutQuint(t, b, c, d) {\r\n    return c * ((t = t / d - 1) * t * t * t * t + 1) + b;\r\n  }\r\n\r\n  /**\r\n   * Quintic easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutQuint(t, b, c, d) {\r\n    t /= d / 2;\r\n    if (t < 1) {\r\n      return c / 2 * t * t * t * t * t + b;\r\n    }\r\n    return c / 2 * ((t -= 2) * t * t * t * t + 2) + b;\r\n  }\r\n\r\n  /**\r\n   * Sinusoidal easing in\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInSine(t, b, c, d) {\r\n    return -c * Math.cos(t / d * (Math.PI / 2)) + c + b;\r\n  }\r\n\r\n  /**\r\n   * Sinusoidal easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutSine(t, b, c, d) {\r\n    return c * Math.sin(t / d * (Math.PI / 2)) + b;\r\n  }\r\n\r\n  /**\r\n   * Sinusoidal easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutSine(t, b, c, d) {\r\n    return -c / 2 * (Math.cos(Math.PI * t / d) - 1) + b;\r\n  }\r\n\r\n  /**\r\n   * Exponential easing in\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInExpo(t, b, c, d) {\r\n    return (t === 0) ? b : c * Math.pow(2, 10 * (t / d - 1)) + b;\r\n  }\r\n\r\n  /**\r\n   * Exponential easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutExpo(t, b, c, d) {\r\n    return (t === d) ? b + c : c * (-Math.pow(2, -10 * t / d) + 1) + b;\r\n  }\r\n\r\n  /**\r\n   * Exponential easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutExpo(t, b, c, d) {\r\n    if (t === 0) {\r\n      return b;\r\n    }\r\n    if (t === d) {\r\n      return b + c;\r\n    }\r\n    t /= d / 2;\r\n    if (t < 1) {\r\n      return c / 2 * Math.pow(2, 10 * (t - 1)) + b;\r\n    }\r\n    return c / 2 * (-Math.pow(2, -10 * --t) + 2) + b;\r\n  }\r\n\r\n  /**\r\n   * Circular easing in\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInCirc(t, b, c, d) {\r\n    return -c * (Math.sqrt(1 - (t /= d) * t) - 1) + b;\r\n  }\r\n\r\n  /**\r\n   * Circular easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutCirc(t, b, c, d) {\r\n    return c * Math.sqrt(1 - (t = t / d - 1) * t) + b;\r\n  }\r\n\r\n  /**\r\n   * Circular easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutCirc(t, b, c, d) {\r\n    t /= d / 2;\r\n    if (t < 1) {\r\n      return -c / 2 * (Math.sqrt(1 - t * t) - 1) + b;\r\n    }\r\n    return c / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + b;\r\n  }\r\n\r\n  /**\r\n   * Elastic easing in\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInElastic(t, b, c, d) {\r\n    var s = 1.70158, p = 0, a = c;\r\n    if (t === 0) {\r\n      return b;\r\n    }\r\n    t /= d;\r\n    if (t === 1) {\r\n      return b + c;\r\n    }\r\n    if (!p) {\r\n      p = d * 0.3;\r\n    }\r\n    var opts = normalize(a, c, p, s);\r\n    return -elastic(opts, t, d) + b;\r\n  }\r\n\r\n  /**\r\n   * Elastic easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutElastic(t, b, c, d) {\r\n    var s = 1.70158, p = 0, a = c;\r\n    if (t === 0) {\r\n      return b;\r\n    }\r\n    t /= d;\r\n    if (t === 1) {\r\n      return b + c;\r\n    }\r\n    if (!p) {\r\n      p = d * 0.3;\r\n    }\r\n    var opts = normalize(a, c, p, s);\r\n    return opts.a * Math.pow(2, -10 * t) * Math.sin((t * d - opts.s) * (2 * Math.PI) / opts.p ) + opts.c + b;\r\n  }\r\n\r\n  /**\r\n   * Elastic easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutElastic(t, b, c, d) {\r\n    var s = 1.70158, p = 0, a = c;\r\n    if (t === 0) {\r\n      return b;\r\n    }\r\n    t /= d / 2;\r\n    if (t === 2) {\r\n      return b + c;\r\n    }\r\n    if (!p) {\r\n      p = d * (0.3 * 1.5);\r\n    }\r\n    var opts = normalize(a, c, p, s);\r\n    if (t < 1) {\r\n      return -0.5 * elastic(opts, t, d) + b;\r\n    }\r\n    return opts.a * Math.pow(2, -10 * (t -= 1)) *\r\n      Math.sin((t * d - opts.s) * (2 * Math.PI) / opts.p ) * 0.5 + opts.c + b;\r\n  }\r\n\r\n  /**\r\n   * Backwards easing in\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInBack(t, b, c, d, s) {\r\n    if (s === undefined) {\r\n      s = 1.70158;\r\n    }\r\n    return c * (t /= d) * t * ((s + 1) * t - s) + b;\r\n  }\r\n\r\n  /**\r\n   * Backwards easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutBack(t, b, c, d, s) {\r\n    if (s === undefined) {\r\n      s = 1.70158;\r\n    }\r\n    return c * ((t = t / d - 1) * t * ((s + 1) * t + s) + 1) + b;\r\n  }\r\n\r\n  /**\r\n   * Backwards easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutBack(t, b, c, d, s) {\r\n    if (s === undefined) {\r\n      s = 1.70158;\r\n    }\r\n    t /= d / 2;\r\n    if (t < 1) {\r\n      return c / 2 * (t * t * (((s *= (1.525)) + 1) * t - s)) + b;\r\n    }\r\n    return c / 2 * ((t -= 2) * t * (((s *= (1.525)) + 1) * t + s) + 2) + b;\r\n  }\r\n\r\n  /**\r\n   * Bouncing easing in\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInBounce(t, b, c, d) {\r\n    return c - easeOutBounce (d - t, 0, c, d) + b;\r\n  }\r\n\r\n  /**\r\n   * Bouncing easing out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeOutBounce(t, b, c, d) {\r\n    if ((t /= d) < (1 / 2.75)) {\r\n      return c * (7.5625 * t * t) + b;\r\n    }\r\n    else if (t < (2/2.75)) {\r\n      return c * (7.5625 * (t -= (1.5 / 2.75)) * t + 0.75) + b;\r\n    }\r\n    else if (t < (2.5/2.75)) {\r\n      return c * (7.5625 * (t -= (2.25 / 2.75)) * t + 0.9375) + b;\r\n    }\r\n    else {\r\n      return c * (7.5625 * (t -= (2.625 / 2.75)) * t + 0.984375) + b;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Bouncing easing in and out\r\n   * @memberOf fabric.util.ease\r\n   */\r\n  function easeInOutBounce(t, b, c, d) {\r\n    if (t < d / 2) {\r\n      return easeInBounce (t * 2, 0, c, d) * 0.5 + b;\r\n    }\r\n    return easeOutBounce(t * 2 - d, 0, c, d) * 0.5 + c * 0.5 + b;\r\n  }\r\n\r\n  /**\r\n   * Easing functions\r\n   * See <a href=\"http://gizma.com/easing/\">Easing Equations by Robert Penner</a>\r\n   * @namespace fabric.util.ease\r\n   */\r\n  fabric.util.ease = {\r\n\r\n    /**\r\n     * Quadratic easing in\r\n     * @memberOf fabric.util.ease\r\n     */\r\n    easeInQuad: function(t, b, c, d) {\r\n      return c * (t /= d) * t + b;\r\n    },\r\n\r\n    /**\r\n     * Quadratic easing out\r\n     * @memberOf fabric.util.ease\r\n     */\r\n    easeOutQuad: function(t, b, c, d) {\r\n      return -c * (t /= d) * (t - 2) + b;\r\n    },\r\n\r\n    /**\r\n     * Quadratic easing in and out\r\n     * @memberOf fabric.util.ease\r\n     */\r\n    easeInOutQuad: function(t, b, c, d) {\r\n      t /= (d / 2);\r\n      if (t < 1) {\r\n        return c / 2 * t * t + b;\r\n      }\r\n      return -c / 2 * ((--t) * (t - 2) - 1) + b;\r\n    },\r\n\r\n    /**\r\n     * Cubic easing in\r\n     * @memberOf fabric.util.ease\r\n     */\r\n    easeInCubic: function(t, b, c, d) {\r\n      return c * (t /= d) * t * t + b;\r\n    },\r\n\r\n    easeOutCubic: easeOutCubic,\r\n    easeInOutCubic: easeInOutCubic,\r\n    easeInQuart: easeInQuart,\r\n    easeOutQuart: easeOutQuart,\r\n    easeInOutQuart: easeInOutQuart,\r\n    easeInQuint: easeInQuint,\r\n    easeOutQuint: easeOutQuint,\r\n    easeInOutQuint: easeInOutQuint,\r\n    easeInSine: easeInSine,\r\n    easeOutSine: easeOutSine,\r\n    easeInOutSine: easeInOutSine,\r\n    easeInExpo: easeInExpo,\r\n    easeOutExpo: easeOutExpo,\r\n    easeInOutExpo: easeInOutExpo,\r\n    easeInCirc: easeInCirc,\r\n    easeOutCirc: easeOutCirc,\r\n    easeInOutCirc: easeInOutCirc,\r\n    easeInElastic: easeInElastic,\r\n    easeOutElastic: easeOutElastic,\r\n    easeInOutElastic: easeInOutElastic,\r\n    easeInBack: easeInBack,\r\n    easeOutBack: easeOutBack,\r\n    easeInOutBack: easeInOutBack,\r\n    easeInBounce: easeInBounce,\r\n    easeOutBounce: easeOutBounce,\r\n    easeInOutBounce: easeInOutBounce\r\n  };\r\n\r\n}());\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  /**\r\n   * @name fabric\r\n   * @namespace\r\n   */\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend,\r\n      capitalize = fabric.util.string.capitalize,\r\n      clone = fabric.util.object.clone,\r\n      toFixed = fabric.util.toFixed,\r\n      parseUnit = fabric.util.parseUnit,\r\n      multiplyTransformMatrices = fabric.util.multiplyTransformMatrices,\r\n\r\n      attributesMap = {\r\n        cx:                   'left',\r\n        x:                    'left',\r\n        r:                    'radius',\r\n        cy:                   'top',\r\n        y:                    'top',\r\n        display:              'visible',\r\n        visibility:           'visible',\r\n        transform:            'transformMatrix',\r\n        'fill-opacity':       'fillOpacity',\r\n        'fill-rule':          'fillRule',\r\n        'font-family':        'fontFamily',\r\n        'font-size':          'fontSize',\r\n        'font-style':         'fontStyle',\r\n        'font-weight':        'fontWeight',\r\n        'stroke-dasharray':   'strokeDashArray',\r\n        'stroke-linecap':     'strokeLineCap',\r\n        'stroke-linejoin':    'strokeLineJoin',\r\n        'stroke-miterlimit':  'strokeMiterLimit',\r\n        'stroke-opacity':     'strokeOpacity',\r\n        'stroke-width':       'strokeWidth',\r\n        'text-decoration':    'textDecoration',\r\n        'text-anchor':        'originX'\r\n      },\r\n\r\n      colorAttributes = {\r\n        stroke: 'strokeOpacity',\r\n        fill:   'fillOpacity'\r\n      };\r\n\r\n  fabric.cssRules = { };\r\n  fabric.gradientDefs = { };\r\n\r\n  function normalizeAttr(attr) {\r\n    // transform attribute names\r\n    if (attr in attributesMap) {\r\n      return attributesMap[attr];\r\n    }\r\n    return attr;\r\n  }\r\n\r\n  function normalizeValue(attr, value, parentAttributes, fontSize) {\r\n    var isArray = Object.prototype.toString.call(value) === '[object Array]',\r\n        parsed;\r\n\r\n    if ((attr === 'fill' || attr === 'stroke') && value === 'none') {\r\n      value = '';\r\n    }\r\n    else if (attr === 'strokeDashArray') {\r\n      value = value.replace(/,/g, ' ').split(/\\s+/).map(function(n) {\r\n        return parseFloat(n);\r\n      });\r\n    }\r\n    else if (attr === 'transformMatrix') {\r\n      if (parentAttributes && parentAttributes.transformMatrix) {\r\n        value = multiplyTransformMatrices(\r\n          parentAttributes.transformMatrix, fabric.parseTransformAttribute(value));\r\n      }\r\n      else {\r\n        value = fabric.parseTransformAttribute(value);\r\n      }\r\n    }\r\n    else if (attr === 'visible') {\r\n      value = (value === 'none' || value === 'hidden') ? false : true;\r\n      // display=none on parent element always takes precedence over child element\r\n      if (parentAttributes && parentAttributes.visible === false) {\r\n        value = false;\r\n      }\r\n    }\r\n    else if (attr === 'originX' /* text-anchor */) {\r\n      value = value === 'start' ? 'left' : value === 'end' ? 'right' : 'center';\r\n    }\r\n    else {\r\n      parsed = isArray ? value.map(parseUnit) : parseUnit(value, fontSize);\r\n    }\r\n\r\n    return (!isArray && isNaN(parsed) ? value : parsed);\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   * @param {Object} attributes Array of attributes to parse\r\n   */\r\n  function _setStrokeFillOpacity(attributes) {\r\n    for (var attr in colorAttributes) {\r\n\r\n      if (!attributes[attr] || typeof attributes[colorAttributes[attr]] === 'undefined') {\r\n        continue;\r\n      }\r\n\r\n      if (attributes[attr].indexOf('url(') === 0) {\r\n        continue;\r\n      }\r\n\r\n      var color = new fabric.Color(attributes[attr]);\r\n      attributes[attr] = color.setAlpha(toFixed(color.getAlpha() * attributes[colorAttributes[attr]], 2)).toRgba();\r\n    }\r\n    return attributes;\r\n  }\r\n\r\n  /**\r\n   * Parses \"transform\" attribute, returning an array of values\r\n   * @static\r\n   * @function\r\n   * @memberOf fabric\r\n   * @param {String} attributeValue String containing attribute value\r\n   * @return {Array} Array of 6 elements representing transformation matrix\r\n   */\r\n  fabric.parseTransformAttribute = (function() {\r\n    function rotateMatrix(matrix, args) {\r\n      var angle = args[0];\r\n\r\n      matrix[0] = Math.cos(angle);\r\n      matrix[1] = Math.sin(angle);\r\n      matrix[2] = -Math.sin(angle);\r\n      matrix[3] = Math.cos(angle);\r\n    }\r\n\r\n    function scaleMatrix(matrix, args) {\r\n      var multiplierX = args[0],\r\n          multiplierY = (args.length === 2) ? args[1] : args[0];\r\n\r\n      matrix[0] = multiplierX;\r\n      matrix[3] = multiplierY;\r\n    }\r\n\r\n    function skewXMatrix(matrix, args) {\r\n      matrix[2] = Math.tan(fabric.util.degreesToRadians(args[0]));\r\n    }\r\n\r\n    function skewYMatrix(matrix, args) {\r\n      matrix[1] = Math.tan(fabric.util.degreesToRadians(args[0]));\r\n    }\r\n\r\n    function translateMatrix(matrix, args) {\r\n      matrix[4] = args[0];\r\n      if (args.length === 2) {\r\n        matrix[5] = args[1];\r\n      }\r\n    }\r\n\r\n    // identity matrix\r\n    var iMatrix = [\r\n          1, // a\r\n          0, // b\r\n          0, // c\r\n          1, // d\r\n          0, // e\r\n          0  // f\r\n        ],\r\n\r\n        // == begin transform regexp\r\n        number = fabric.reNum,\r\n\r\n        commaWsp = '(?:\\\\s+,?\\\\s*|,\\\\s*)',\r\n\r\n        skewX = '(?:(skewX)\\\\s*\\\\(\\\\s*(' + number + ')\\\\s*\\\\))',\r\n\r\n        skewY = '(?:(skewY)\\\\s*\\\\(\\\\s*(' + number + ')\\\\s*\\\\))',\r\n\r\n        rotate = '(?:(rotate)\\\\s*\\\\(\\\\s*(' + number + ')(?:' +\r\n                    commaWsp + '(' + number + ')' +\r\n                    commaWsp + '(' + number + '))?\\\\s*\\\\))',\r\n\r\n        scale = '(?:(scale)\\\\s*\\\\(\\\\s*(' + number + ')(?:' +\r\n                    commaWsp + '(' + number + '))?\\\\s*\\\\))',\r\n\r\n        translate = '(?:(translate)\\\\s*\\\\(\\\\s*(' + number + ')(?:' +\r\n                    commaWsp + '(' + number + '))?\\\\s*\\\\))',\r\n\r\n        matrix = '(?:(matrix)\\\\s*\\\\(\\\\s*' +\r\n                  '(' + number + ')' + commaWsp +\r\n                  '(' + number + ')' + commaWsp +\r\n                  '(' + number + ')' + commaWsp +\r\n                  '(' + number + ')' + commaWsp +\r\n                  '(' + number + ')' + commaWsp +\r\n                  '(' + number + ')' +\r\n                  '\\\\s*\\\\))',\r\n\r\n        transform = '(?:' +\r\n                    matrix + '|' +\r\n                    translate + '|' +\r\n                    scale + '|' +\r\n                    rotate + '|' +\r\n                    skewX + '|' +\r\n                    skewY +\r\n                    ')',\r\n\r\n        transforms = '(?:' + transform + '(?:' + commaWsp + transform + ')*' + ')',\r\n\r\n        transformList = '^\\\\s*(?:' + transforms + '?)\\\\s*$',\r\n\r\n        // http://www.w3.org/TR/SVG/coords.html#TransformAttribute\r\n        reTransformList = new RegExp(transformList),\r\n        // == end transform regexp\r\n\r\n        reTransform = new RegExp(transform, 'g');\r\n\r\n    return function(attributeValue) {\r\n\r\n      // start with identity matrix\r\n      var matrix = iMatrix.concat(),\r\n          matrices = [ ];\r\n\r\n      // return if no argument was given or\r\n      // an argument does not match transform attribute regexp\r\n      if (!attributeValue || (attributeValue && !reTransformList.test(attributeValue))) {\r\n        return matrix;\r\n      }\r\n\r\n      attributeValue.replace(reTransform, function(match) {\r\n\r\n        var m = new RegExp(transform).exec(match).filter(function (match) {\r\n              return (match !== '' && match != null);\r\n            }),\r\n            operation = m[1],\r\n            args = m.slice(2).map(parseFloat);\r\n\r\n        switch (operation) {\r\n          case 'translate':\r\n            translateMatrix(matrix, args);\r\n            break;\r\n          case 'rotate':\r\n            args[0] = fabric.util.degreesToRadians(args[0]);\r\n            rotateMatrix(matrix, args);\r\n            break;\r\n          case 'scale':\r\n            scaleMatrix(matrix, args);\r\n            break;\r\n          case 'skewX':\r\n            skewXMatrix(matrix, args);\r\n            break;\r\n          case 'skewY':\r\n            skewYMatrix(matrix, args);\r\n            break;\r\n          case 'matrix':\r\n            matrix = args;\r\n            break;\r\n        }\r\n\r\n        // snapshot current matrix into matrices array\r\n        matrices.push(matrix.concat());\r\n        // reset\r\n        matrix = iMatrix.concat();\r\n      });\r\n\r\n      var combinedMatrix = matrices[0];\r\n      while (matrices.length > 1) {\r\n        matrices.shift();\r\n        combinedMatrix = fabric.util.multiplyTransformMatrices(combinedMatrix, matrices[0]);\r\n      }\r\n      return combinedMatrix;\r\n    };\r\n  })();\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function parseStyleString(style, oStyle) {\r\n    var attr, value;\r\n    style.replace(/;$/, '').split(';').forEach(function (chunk) {\r\n      var pair = chunk.split(':');\r\n\r\n      attr = normalizeAttr(pair[0].trim().toLowerCase());\r\n      value = normalizeValue(attr, pair[1].trim());\r\n\r\n      oStyle[attr] = value;\r\n    });\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function parseStyleObject(style, oStyle) {\r\n    var attr, value;\r\n    for (var prop in style) {\r\n      if (typeof style[prop] === 'undefined') {\r\n        continue;\r\n      }\r\n\r\n      attr = normalizeAttr(prop.toLowerCase());\r\n      value = normalizeValue(attr, style[prop]);\r\n\r\n      oStyle[attr] = value;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function getGlobalStylesForElement(element, svgUid) {\r\n    var styles = { };\r\n    for (var rule in fabric.cssRules[svgUid]) {\r\n      if (elementMatchesRule(element, rule.split(' '))) {\r\n        for (var property in fabric.cssRules[svgUid][rule]) {\r\n          styles[property] = fabric.cssRules[svgUid][rule][property];\r\n        }\r\n      }\r\n    }\r\n    return styles;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function elementMatchesRule(element, selectors) {\r\n    var firstMatching, parentMatching = true;\r\n    //start from rightmost selector.\r\n    firstMatching = selectorMatches(element, selectors.pop());\r\n    if (firstMatching && selectors.length) {\r\n      parentMatching = doesSomeParentMatch(element, selectors);\r\n    }\r\n    return firstMatching && parentMatching && (selectors.length === 0);\r\n  }\r\n\r\n  function doesSomeParentMatch(element, selectors) {\r\n    var selector, parentMatching = true;\r\n    while (element.parentNode && element.parentNode.nodeType === 1 && selectors.length) {\r\n      if (parentMatching) {\r\n        selector = selectors.pop();\r\n      }\r\n      element = element.parentNode;\r\n      parentMatching = selectorMatches(element, selector);\r\n    }\r\n    return selectors.length === 0;\r\n  }\r\n  /**\r\n   * @private\r\n   */\r\n  function selectorMatches(element, selector) {\r\n    var nodeName = element.nodeName,\r\n        classNames = element.getAttribute('class'),\r\n        id = element.getAttribute('id'), matcher;\r\n    // i check if a selector matches slicing away part from it.\r\n    // if i get empty string i should match\r\n    matcher = new RegExp('^' + nodeName, 'i');\r\n    selector = selector.replace(matcher, '');\r\n    if (id && selector.length) {\r\n      matcher = new RegExp('#' + id + '(?![a-zA-Z\\\\-]+)', 'i');\r\n      selector = selector.replace(matcher, '');\r\n    }\r\n    if (classNames && selector.length) {\r\n      classNames = classNames.split(' ');\r\n      for (var i = classNames.length; i--;) {\r\n        matcher = new RegExp('\\\\.' + classNames[i] + '(?![a-zA-Z\\\\-]+)', 'i');\r\n        selector = selector.replace(matcher, '');\r\n      }\r\n    }\r\n    return selector.length === 0;\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function parseUseDirectives(doc) {\r\n    var nodelist = doc.getElementsByTagName('use');\r\n    while (nodelist.length) {\r\n      var el = nodelist[0],\r\n          xlink = el.getAttribute('xlink:href').substr(1),\r\n          x = el.getAttribute('x') || 0,\r\n          y = el.getAttribute('y') || 0,\r\n          el2 = doc.getElementById(xlink).cloneNode(true),\r\n          currentTrans = (el2.getAttribute('transform') || '') + ' translate(' + x + ', ' + y + ')',\r\n          parentNode;\r\n\r\n      for (var j = 0, attrs = el.attributes, l = attrs.length; j < l; j++) {\r\n        var attr = attrs.item(j);\r\n        if (attr.nodeName === 'x' || attr.nodeName === 'y' || attr.nodeName === 'xlink:href') {\r\n          continue;\r\n        }\r\n\r\n        if (attr.nodeName === 'transform') {\r\n          currentTrans = attr.nodeValue + ' ' + currentTrans;\r\n        }\r\n        else {\r\n          el2.setAttribute(attr.nodeName, attr.nodeValue);\r\n        }\r\n      }\r\n\r\n      el2.setAttribute('transform', currentTrans);\r\n      el2.setAttribute('instantiated_by_use', '1');\r\n      el2.removeAttribute('id');\r\n      parentNode = el.parentNode;\r\n      parentNode.replaceChild(el2, el);\r\n    }\r\n  }\r\n\r\n  // http://www.w3.org/TR/SVG/coords.html#ViewBoxAttribute\r\n  // matches, e.g.: +14.56e-12, etc.\r\n  var reViewBoxAttrValue = new RegExp(\r\n    '^' +\r\n    '\\\\s*(' + fabric.reNum + '+)\\\\s*,?' +\r\n    '\\\\s*(' + fabric.reNum + '+)\\\\s*,?' +\r\n    '\\\\s*(' + fabric.reNum + '+)\\\\s*,?' +\r\n    '\\\\s*(' + fabric.reNum + '+)\\\\s*' +\r\n    '$'\r\n  );\r\n\r\n  /**\r\n   * Add a <g> element that envelop all child elements and makes the viewbox transformMatrix descend on all elements\r\n   */\r\n  function addVBTransform(element, widthAttr, heightAttr) {\r\n\r\n    var viewBoxAttr = element.getAttribute('viewBox'),\r\n        scaleX = 1,\r\n        scaleY = 1,\r\n        minX = 0,\r\n        minY = 0,\r\n        viewBoxWidth, viewBoxHeight, matrix, el;\r\n\r\n    if (viewBoxAttr && (viewBoxAttr = viewBoxAttr.match(reViewBoxAttrValue))) {\r\n      minX = -parseFloat(viewBoxAttr[1]),\r\n      minY = -parseFloat(viewBoxAttr[2]),\r\n      viewBoxWidth = parseFloat(viewBoxAttr[3]),\r\n      viewBoxHeight = parseFloat(viewBoxAttr[4]);\r\n    }\r\n    else {\r\n      return;\r\n    }\r\n    if (widthAttr && widthAttr !== viewBoxWidth) {\r\n      scaleX = widthAttr / viewBoxWidth;\r\n    }\r\n    if (heightAttr && heightAttr !== viewBoxHeight) {\r\n      scaleY = heightAttr / viewBoxHeight;\r\n    }\r\n\r\n    // default is to preserve aspect ratio\r\n    // preserveAspectRatio attribute to be implemented\r\n    scaleY = scaleX = (scaleX > scaleY ? scaleY : scaleX);\r\n\r\n    if (!(scaleX !== 1 || scaleY !== 1 || minX !== 0 || minY !== 0)) {\r\n      return;\r\n    }\r\n    matrix = ' matrix(' + scaleX +\r\n                  ' 0' +\r\n                  ' 0 ' +\r\n                  scaleY + ' ' +\r\n                  (minX * scaleX) + ' ' +\r\n                  (minY * scaleY) + ') ';\r\n\r\n    if (element.tagName === 'svg') {\r\n      el = element.ownerDocument.createElement('g');\r\n      while (element.firstChild != null) {\r\n        el.appendChild(element.firstChild);\r\n      }\r\n      element.appendChild(el);\r\n    }\r\n    else {\r\n      el = element;\r\n      matrix = el.getAttribute('transform') + matrix;\r\n    }\r\n\r\n    el.setAttribute('transform', matrix);\r\n  }\r\n\r\n  /**\r\n   * Parses an SVG document, converts it to an array of corresponding fabric.* instances and passes them to a callback\r\n   * @static\r\n   * @function\r\n   * @memberOf fabric\r\n   * @param {SVGDocument} doc SVG document to parse\r\n   * @param {Function} callback Callback to call when parsing is finished; It's being passed an array of elements (parsed from a document).\r\n   * @param {Function} [reviver] Method for further parsing of SVG elements, called after each fabric object created.\r\n   */\r\n  fabric.parseSVGDocument = (function() {\r\n\r\n    var reAllowedSVGTagNames = /^(path|circle|polygon|polyline|ellipse|rect|line|image|text)$/,\r\n        reViewBoxTagNames = /^(symbol|image|marker|pattern|view)$/;\r\n\r\n    function hasAncestorWithNodeName(element, nodeName) {\r\n      while (element && (element = element.parentNode)) {\r\n        if (nodeName.test(element.nodeName) && !element.getAttribute('instantiated_by_use')) {\r\n          return true;\r\n        }\r\n      }\r\n      return false;\r\n    }\r\n\r\n    return function(doc, callback, reviver) {\r\n      if (!doc) {\r\n        return;\r\n      }\r\n\r\n      parseUseDirectives(doc);\r\n\r\n      var startTime = new Date(),\r\n          svgUid =  fabric.Object.__uid++,\r\n          widthAttr, heightAttr, toBeParsed = false;\r\n\r\n      if (doc.getAttribute('width') && doc.getAttribute('width') !== '100%') {\r\n        widthAttr = parseUnit(doc.getAttribute('width'));\r\n      }\r\n      if (doc.getAttribute('height') && doc.getAttribute('height') !== '100%') {\r\n        heightAttr = parseUnit(doc.getAttribute('height'));\r\n      }\r\n\r\n      if (!widthAttr || !heightAttr) {\r\n        var viewBoxAttr = doc.getAttribute('viewBox');\r\n        if (viewBoxAttr && (viewBoxAttr = viewBoxAttr.match(reViewBoxAttrValue))) {\r\n          widthAttr = parseFloat(viewBoxAttr[3]),\r\n          heightAttr = parseFloat(viewBoxAttr[4]);\r\n        }\r\n        else {\r\n          toBeParsed = true;\r\n        }\r\n      }\r\n\r\n      addVBTransform(doc, widthAttr, heightAttr);\r\n\r\n      var descendants = fabric.util.toArray(doc.getElementsByTagName('*'));\r\n\r\n      if (descendants.length === 0 && fabric.isLikelyNode) {\r\n        // we're likely in node, where \"o3-xml\" library fails to gEBTN(\"*\")\r\n        // https://github.com/ajaxorg/node-o3-xml/issues/21\r\n        descendants = doc.selectNodes('//*[name(.)!=\"svg\"]');\r\n        var arr = [ ];\r\n        for (var i = 0, len = descendants.length; i < len; i++) {\r\n          arr[i] = descendants[i];\r\n        }\r\n        descendants = arr;\r\n      }\r\n\r\n      var elements = descendants.filter(function(el) {\r\n        reViewBoxTagNames.test(el.tagName) && addVBTransform(el, 0, 0);\r\n        return reAllowedSVGTagNames.test(el.tagName) &&\r\n              !hasAncestorWithNodeName(el, /^(?:pattern|defs|symbol)$/); // http://www.w3.org/TR/SVG/struct.html#DefsElement\r\n      });\r\n\r\n      if (!elements || (elements && !elements.length)) {\r\n        callback && callback([], {});\r\n        return;\r\n      }\r\n\r\n      var options = {\r\n        width: widthAttr,\r\n        height: heightAttr,\r\n        svgUid: svgUid,\r\n        toBeParsed: toBeParsed\r\n      };\r\n\r\n      fabric.gradientDefs[svgUid] = fabric.getGradientDefs(doc);\r\n      fabric.cssRules[svgUid] = fabric.getCSSRules(doc);\r\n      // Precedence of rules:   style > class > attribute\r\n      fabric.parseElements(elements, function(instances) {\r\n        fabric.documentParsingTime = new Date() - startTime;\r\n        if (callback) {\r\n          callback(instances, options);\r\n        }\r\n      }, clone(options), reviver);\r\n    };\r\n  })();\r\n\r\n  /**\r\n   * Used for caching SVG documents (loaded via `fabric.Canvas#loadSVGFromURL`)\r\n   * @namespace\r\n   */\r\n  var svgCache = {\r\n\r\n    /**\r\n    * @param {String} name\r\n    * @param {Function} callback\r\n    */\r\n    has: function (name, callback) {\r\n      callback(false);\r\n    },\r\n\r\n    get: function () {\r\n      /* NOOP */\r\n    },\r\n\r\n    set: function () {\r\n      /* NOOP */\r\n    }\r\n  };\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function _enlivenCachedObject(cachedObject) {\r\n\r\n    var objects = cachedObject.objects,\r\n        options = cachedObject.options;\r\n\r\n    objects = objects.map(function (o) {\r\n      return fabric[capitalize(o.type)].fromObject(o);\r\n    });\r\n\r\n    return ({ objects: objects, options: options });\r\n  }\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function _createSVGPattern(markup, canvas, property) {\r\n    if (canvas[property] && canvas[property].toSVG) {\r\n      markup.push(\r\n        '<pattern x=\"0\" y=\"0\" id=\"', property, 'Pattern\" ',\r\n          'width=\"', canvas[property].source.width,\r\n          '\" height=\"', canvas[property].source.height,\r\n          '\" patternUnits=\"userSpaceOnUse\">',\r\n        '<image x=\"0\" y=\"0\" ',\r\n        'width=\"', canvas[property].source.width,\r\n        '\" height=\"', canvas[property].source.height,\r\n        '\" xlink:href=\"', canvas[property].source.src,\r\n        '\"></image></pattern>'\r\n      );\r\n    }\r\n  }\r\n\r\n  var reFontDeclaration = new RegExp(\r\n    '(normal|italic)?\\\\s*(normal|small-caps)?\\\\s*' +\r\n    '(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\\\s*(' +\r\n      fabric.reNum +\r\n    '(?:px|cm|mm|em|pt|pc|in)*)(?:\\\\/(normal|' + fabric.reNum + '))?\\\\s+(.*)');\r\n\r\n  extend(fabric, {\r\n    /**\r\n     * Parses a short font declaration, building adding its properties to a style object\r\n     * @static\r\n     * @function\r\n     * @memberOf fabric\r\n     * @param {String} value font declaration\r\n     * @param {Object} oStyle definition\r\n     */\r\n    parseFontDeclaration: function(value, oStyle) {\r\n      var match = value.match(reFontDeclaration);\r\n\r\n      if (!match) {\r\n        return;\r\n      }\r\n      var fontStyle = match[1],\r\n          // font variant is not used\r\n          // fontVariant = match[2],\r\n          fontWeight = match[3],\r\n          fontSize = match[4],\r\n          lineHeight = match[5],\r\n          fontFamily = match[6];\r\n\r\n      if (fontStyle) {\r\n        oStyle.fontStyle = fontStyle;\r\n      }\r\n      if (fontWeight) {\r\n        oStyle.fontWeight = isNaN(parseFloat(fontWeight)) ? fontWeight : parseFloat(fontWeight);\r\n      }\r\n      if (fontSize) {\r\n        oStyle.fontSize = parseUnit(fontSize);\r\n      }\r\n      if (fontFamily) {\r\n        oStyle.fontFamily = fontFamily;\r\n      }\r\n      if (lineHeight) {\r\n        oStyle.lineHeight = lineHeight === 'normal' ? 1 : lineHeight;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Parses an SVG document, returning all of the gradient declarations found in it\r\n     * @static\r\n     * @function\r\n     * @memberOf fabric\r\n     * @param {SVGDocument} doc SVG document to parse\r\n     * @return {Object} Gradient definitions; key corresponds to element id, value -- to gradient definition element\r\n     */\r\n    getGradientDefs: function(doc) {\r\n      var linearGradientEls = doc.getElementsByTagName('linearGradient'),\r\n          radialGradientEls = doc.getElementsByTagName('radialGradient'),\r\n          el, i, j = 0, id, xlink, elList = [ ],\r\n          gradientDefs = { }, idsToXlinkMap = { };\r\n\r\n      elList.length = linearGradientEls.length + radialGradientEls.length;\r\n      i = linearGradientEls.length;\r\n      while (i--) {\r\n        elList[j++] = linearGradientEls[i];\r\n      }\r\n      i = radialGradientEls.length;\r\n      while (i--) {\r\n        elList[j++] = radialGradientEls[i];\r\n      }\r\n\r\n      while (j--) {\r\n        el = elList[j];\r\n        xlink = el.getAttribute('xlink:href');\r\n        id = el.getAttribute('id');\r\n        if (xlink) {\r\n          idsToXlinkMap[id] = xlink.substr(1);\r\n        }\r\n        gradientDefs[id] = el;\r\n      }\r\n\r\n      for (id in idsToXlinkMap) {\r\n        var el2 = gradientDefs[idsToXlinkMap[id]].cloneNode(true);\r\n        el = gradientDefs[id];\r\n        while (el2.firstChild) {\r\n          el.appendChild(el2.firstChild);\r\n        }\r\n      }\r\n      return gradientDefs;\r\n    },\r\n\r\n    /**\r\n     * Returns an object of attributes' name/value, given element and an array of attribute names;\r\n     * Parses parent \"g\" nodes recursively upwards.\r\n     * @static\r\n     * @memberOf fabric\r\n     * @param {DOMElement} element Element to parse\r\n     * @param {Array} attributes Array of attributes to parse\r\n     * @return {Object} object containing parsed attributes' names/values\r\n     */\r\n    parseAttributes: function(element, attributes, svgUid) {\r\n\r\n      if (!element) {\r\n        return;\r\n      }\r\n\r\n      var value,\r\n          parentAttributes = { },\r\n          fontSize;\r\n\r\n      if (typeof svgUid === 'undefined') {\r\n        svgUid = element.getAttribute('svgUid');\r\n      }\r\n      // if there's a parent container (`g` or `a` or `symbol` node), parse its attributes recursively upwards\r\n      if (element.parentNode && /^symbol|[g|a]$/i.test(element.parentNode.nodeName)) {\r\n        parentAttributes = fabric.parseAttributes(element.parentNode, attributes, svgUid);\r\n      }\r\n      fontSize = (parentAttributes && parentAttributes.fontSize ) ||\r\n                 element.getAttribute('font-size') || fabric.Text.DEFAULT_SVG_FONT_SIZE;\r\n\r\n      var ownAttributes = attributes.reduce(function(memo, attr) {\r\n        value = element.getAttribute(attr);\r\n        if (value) {\r\n          attr = normalizeAttr(attr);\r\n          value = normalizeValue(attr, value, parentAttributes, fontSize);\r\n\r\n          memo[attr] = value;\r\n        }\r\n        return memo;\r\n      }, { });\r\n\r\n      // add values parsed from style, which take precedence over attributes\r\n      // (see: http://www.w3.org/TR/SVG/styling.html#UsingPresentationAttributes)\r\n      ownAttributes = extend(ownAttributes,\r\n        extend(getGlobalStylesForElement(element, svgUid), fabric.parseStyleAttribute(element)));\r\n      if (ownAttributes.font) {\r\n        fabric.parseFontDeclaration(ownAttributes.font, ownAttributes);\r\n      }\r\n      return _setStrokeFillOpacity(extend(parentAttributes, ownAttributes));\r\n    },\r\n\r\n    /**\r\n     * Transforms an array of svg elements to corresponding fabric.* instances\r\n     * @static\r\n     * @memberOf fabric\r\n     * @param {Array} elements Array of elements to parse\r\n     * @param {Function} callback Being passed an array of fabric instances (transformed from SVG elements)\r\n     * @param {Object} [options] Options object\r\n     * @param {Function} [reviver] Method for further parsing of SVG elements, called after each fabric object created.\r\n     */\r\n    parseElements: function(elements, callback, options, reviver) {\r\n      new fabric.ElementsParser(elements, callback, options, reviver).parse();\r\n    },\r\n\r\n    /**\r\n     * Parses \"style\" attribute, retuning an object with values\r\n     * @static\r\n     * @memberOf fabric\r\n     * @param {SVGElement} element Element to parse\r\n     * @return {Object} Objects with values parsed from style attribute of an element\r\n     */\r\n    parseStyleAttribute: function(element) {\r\n      var oStyle = { },\r\n          style = element.getAttribute('style');\r\n\r\n      if (!style) {\r\n        return oStyle;\r\n      }\r\n\r\n      if (typeof style === 'string') {\r\n        parseStyleString(style, oStyle);\r\n      }\r\n      else {\r\n        parseStyleObject(style, oStyle);\r\n      }\r\n\r\n      return oStyle;\r\n    },\r\n\r\n    /**\r\n     * Parses \"points\" attribute, returning an array of values\r\n     * @static\r\n     * @memberOf fabric\r\n     * @param {String} points points attribute string\r\n     * @return {Array} array of points\r\n     */\r\n    parsePointsAttribute: function(points) {\r\n\r\n      // points attribute is required and must not be empty\r\n      if (!points) {\r\n        return null;\r\n      }\r\n\r\n      // replace commas with whitespace and remove bookending whitespace\r\n      points = points.replace(/,/g, ' ').trim();\r\n\r\n      points = points.split(/\\s+/);\r\n      var parsedPoints = [ ], i, len;\r\n\r\n      i = 0;\r\n      len = points.length;\r\n      for (; i < len; i+=2) {\r\n        parsedPoints.push({\r\n          x: parseFloat(points[i]),\r\n          y: parseFloat(points[i + 1])\r\n        });\r\n      }\r\n\r\n      // odd number of points is an error\r\n      // if (parsedPoints.length % 2 !== 0) {\r\n      //   return null;\r\n      // }\r\n\r\n      return parsedPoints;\r\n    },\r\n\r\n    /**\r\n     * Returns CSS rules for a given SVG document\r\n     * @static\r\n     * @function\r\n     * @memberOf fabric\r\n     * @param {SVGDocument} doc SVG document to parse\r\n     * @return {Object} CSS rules of this document\r\n     */\r\n    getCSSRules: function(doc) {\r\n      var styles = doc.getElementsByTagName('style'),\r\n          allRules = { }, rules;\r\n\r\n      // very crude parsing of style contents\r\n      for (var i = 0, len = styles.length; i < len; i++) {\r\n        var styleContents = styles[i].textContent;\r\n\r\n        // remove comments\r\n        styleContents = styleContents.replace(/\\/\\*[\\s\\S]*?\\*\\//g, '');\r\n        if (styleContents.trim() === '') {\r\n          continue;\r\n        }\r\n        rules = styleContents.match(/[^{]*\\{[\\s\\S]*?\\}/g);\r\n        rules = rules.map(function(rule) { return rule.trim(); });\r\n\r\n        rules.forEach(function(rule) {\r\n\r\n          var match = rule.match(/([\\s\\S]*?)\\s*\\{([^}]*)\\}/),\r\n          ruleObj = { }, declaration = match[2].trim(),\r\n          propertyValuePairs = declaration.replace(/;$/, '').split(/\\s*;\\s*/);\r\n\r\n          for (var i = 0, len = propertyValuePairs.length; i < len; i++) {\r\n            var pair = propertyValuePairs[i].split(/\\s*:\\s*/),\r\n                property = normalizeAttr(pair[0]),\r\n                value = normalizeValue(property, pair[1], pair[0]);\r\n            ruleObj[property] = value;\r\n          }\r\n          rule = match[1];\r\n          rule.split(',').forEach(function(_rule) {\r\n            _rule = _rule.replace(/^svg/i, '').trim();\r\n            if (_rule === '') {\r\n              return;\r\n            }\r\n            allRules[_rule] = fabric.util.object.clone(ruleObj);\r\n          });\r\n        });\r\n      }\r\n      return allRules;\r\n    },\r\n\r\n    /**\r\n     * Takes url corresponding to an SVG document, and parses it into a set of fabric objects. Note that SVG is fetched via XMLHttpRequest, so it needs to conform to SOP (Same Origin Policy)\r\n     * @memberof fabric\r\n     * @param {String} url\r\n     * @param {Function} callback\r\n     * @param {Function} [reviver] Method for further parsing of SVG elements, called after each fabric object created.\r\n     */\r\n    loadSVGFromURL: function(url, callback, reviver) {\r\n\r\n      url = url.replace(/^\\n\\s*/, '').trim();\r\n      svgCache.has(url, function (hasUrl) {\r\n        if (hasUrl) {\r\n          svgCache.get(url, function (value) {\r\n            var enlivedRecord = _enlivenCachedObject(value);\r\n            callback(enlivedRecord.objects, enlivedRecord.options);\r\n          });\r\n        }\r\n        else {\r\n          new fabric.util.request(url, {\r\n            method: 'get',\r\n            onComplete: onComplete\r\n          });\r\n        }\r\n      });\r\n\r\n      function onComplete(r) {\r\n\r\n        var xml = r.responseXML;\r\n        if (xml && !xml.documentElement && fabric.window.ActiveXObject && r.responseText) {\r\n          xml = new ActiveXObject('Microsoft.XMLDOM');\r\n          xml.async = 'false';\r\n          //IE chokes on DOCTYPE\r\n          xml.loadXML(r.responseText.replace(/<!DOCTYPE[\\s\\S]*?(\\[[\\s\\S]*\\])*?>/i, ''));\r\n        }\r\n        if (!xml || !xml.documentElement) {\r\n          return;\r\n        }\r\n\r\n        fabric.parseSVGDocument(xml.documentElement, function (results, options) {\r\n          svgCache.set(url, {\r\n            objects: fabric.util.array.invoke(results, 'toObject'),\r\n            options: options\r\n          });\r\n          callback(results, options);\r\n        }, reviver);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Takes string corresponding to an SVG document, and parses it into a set of fabric objects\r\n     * @memberof fabric\r\n     * @param {String} string\r\n     * @param {Function} callback\r\n     * @param {Function} [reviver] Method for further parsing of SVG elements, called after each fabric object created.\r\n     */\r\n    loadSVGFromString: function(string, callback, reviver) {\r\n      string = string.trim();\r\n      var doc;\r\n      if (typeof DOMParser !== 'undefined') {\r\n        var parser = new DOMParser();\r\n        if (parser && parser.parseFromString) {\r\n          doc = parser.parseFromString(string, 'text/xml');\r\n        }\r\n      }\r\n      else if (fabric.window.ActiveXObject) {\r\n        doc = new ActiveXObject('Microsoft.XMLDOM');\r\n        doc.async = 'false';\r\n        // IE chokes on DOCTYPE\r\n        doc.loadXML(string.replace(/<!DOCTYPE[\\s\\S]*?(\\[[\\s\\S]*\\])*?>/i, ''));\r\n      }\r\n\r\n      fabric.parseSVGDocument(doc.documentElement, function (results, options) {\r\n        callback(results, options);\r\n      }, reviver);\r\n    },\r\n\r\n    /**\r\n     * Creates markup containing SVG font faces\r\n     * @param {Array} objects Array of fabric objects\r\n     * @return {String}\r\n     */\r\n    createSVGFontFacesMarkup: function(objects) {\r\n      var markup = '';\r\n\r\n      for (var i = 0, len = objects.length; i < len; i++) {\r\n        if (objects[i].type !== 'text' || !objects[i].path) {\r\n          continue;\r\n        }\r\n\r\n        markup += [\r\n          //jscs:disable validateIndentation\r\n          '@font-face {',\r\n            'font-family: ', objects[i].fontFamily, '; ',\r\n            'src: url(\\'', objects[i].path, '\\')',\r\n          '}'\r\n          //jscs:enable validateIndentation\r\n        ].join('');\r\n      }\r\n\r\n      if (markup) {\r\n        markup = [\r\n          //jscs:disable validateIndentation\r\n          '<style type=\"text/css\">',\r\n            '<![CDATA[',\r\n              markup,\r\n            ']]>',\r\n          '</style>'\r\n          //jscs:enable validateIndentation\r\n        ].join('');\r\n      }\r\n\r\n      return markup;\r\n    },\r\n\r\n    /**\r\n     * Creates markup containing SVG referenced elements like patterns, gradients etc.\r\n     * @param {fabric.Canvas} canvas instance of fabric.Canvas\r\n     * @return {String}\r\n     */\r\n    createSVGRefElementsMarkup: function(canvas) {\r\n      var markup = [ ];\r\n\r\n      _createSVGPattern(markup, canvas, 'backgroundColor');\r\n      _createSVGPattern(markup, canvas, 'overlayColor');\r\n\r\n      return markup.join('');\r\n    }\r\n  });\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\nfabric.ElementsParser = function(elements, callback, options, reviver) {\r\n  this.elements = elements;\r\n  this.callback = callback;\r\n  this.options = options;\r\n  this.reviver = reviver;\r\n  this.svgUid = (options && options.svgUid) || 0;\r\n};\r\n\r\nfabric.ElementsParser.prototype.parse = function() {\r\n  this.instances = new Array(this.elements.length);\r\n  this.numElements = this.elements.length;\r\n\r\n  this.createObjects();\r\n};\r\n\r\nfabric.ElementsParser.prototype.createObjects = function() {\r\n  for (var i = 0, len = this.elements.length; i < len; i++) {\r\n    this.elements[i].setAttribute('svgUid', this.svgUid);\r\n    (function(_this, i) {\r\n      setTimeout(function() {\r\n        _this.createObject(_this.elements[i], i);\r\n      }, 0);\r\n    })(this, i);\r\n  }\r\n};\r\n\r\nfabric.ElementsParser.prototype.createObject = function(el, index) {\r\n  var klass = fabric[fabric.util.string.capitalize(el.tagName)];\r\n  if (klass && klass.fromElement) {\r\n    try {\r\n      this._createObject(klass, el, index);\r\n    }\r\n    catch (err) {\r\n      fabric.log(err);\r\n    }\r\n  }\r\n  else {\r\n    this.checkIfDone();\r\n  }\r\n};\r\n\r\nfabric.ElementsParser.prototype._createObject = function(klass, el, index) {\r\n  if (klass.async) {\r\n    klass.fromElement(el, this.createCallback(index, el), this.options);\r\n  }\r\n  else {\r\n    var obj = klass.fromElement(el, this.options);\r\n    this.resolveGradient(obj, 'fill');\r\n    this.resolveGradient(obj, 'stroke');\r\n    this.reviver && this.reviver(el, obj);\r\n    this.instances[index] = obj;\r\n    this.checkIfDone();\r\n  }\r\n};\r\n\r\nfabric.ElementsParser.prototype.createCallback = function(index, el) {\r\n  var _this = this;\r\n  return function(obj) {\r\n    _this.resolveGradient(obj, 'fill');\r\n    _this.resolveGradient(obj, 'stroke');\r\n    _this.reviver && _this.reviver(el, obj);\r\n    _this.instances[index] = obj;\r\n    _this.checkIfDone();\r\n  };\r\n};\r\n\r\nfabric.ElementsParser.prototype.resolveGradient = function(obj, property) {\r\n\r\n  var instanceFillValue = obj.get(property);\r\n  if (!(/^url\\(/).test(instanceFillValue)) {\r\n    return;\r\n  }\r\n  var gradientId = instanceFillValue.slice(5, instanceFillValue.length - 1);\r\n  if (fabric.gradientDefs[this.svgUid][gradientId]) {\r\n    obj.set(property,\r\n      fabric.Gradient.fromElement(fabric.gradientDefs[this.svgUid][gradientId], obj));\r\n  }\r\n};\r\n\r\nfabric.ElementsParser.prototype.checkIfDone = function() {\r\n  if (--this.numElements === 0) {\r\n    this.instances = this.instances.filter(function(el) {\r\n      return el != null;\r\n    });\r\n    this.callback(this.instances);\r\n  }\r\n};\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  /* Adaptation of work of Kevin Lindsey (kevin@kevlindev.com) */\r\n\r\n  var fabric = global.fabric || (global.fabric = { });\r\n\r\n  if (fabric.Point) {\r\n    fabric.warn('fabric.Point is already defined');\r\n    return;\r\n  }\r\n\r\n  fabric.Point = Point;\r\n\r\n  /**\r\n   * Point class\r\n   * @class fabric.Point\r\n   * @memberOf fabric\r\n   * @constructor\r\n   * @param {Number} x\r\n   * @param {Number} y\r\n   * @return {fabric.Point} thisArg\r\n   */\r\n  function Point(x, y) {\r\n    this.x = x;\r\n    this.y = y;\r\n  }\r\n\r\n  Point.prototype = /** @lends fabric.Point.prototype */ {\r\n\r\n    constructor: Point,\r\n\r\n    /**\r\n     * Adds another point to this one and returns another one\r\n     * @param {fabric.Point} that\r\n     * @return {fabric.Point} new Point instance with added values\r\n     */\r\n    add: function (that) {\r\n      return new Point(this.x + that.x, this.y + that.y);\r\n    },\r\n\r\n    /**\r\n     * Adds another point to this one\r\n     * @param {fabric.Point} that\r\n     * @return {fabric.Point} thisArg\r\n     */\r\n    addEquals: function (that) {\r\n      this.x += that.x;\r\n      this.y += that.y;\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Adds value to this point and returns a new one\r\n     * @param {Number} scalar\r\n     * @return {fabric.Point} new Point with added value\r\n     */\r\n    scalarAdd: function (scalar) {\r\n      return new Point(this.x + scalar, this.y + scalar);\r\n    },\r\n\r\n    /**\r\n     * Adds value to this point\r\n     * @param {Number} scalar\r\n     * @return {fabric.Point} thisArg\r\n     */\r\n    scalarAddEquals: function (scalar) {\r\n      this.x += scalar;\r\n      this.y += scalar;\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Subtracts another point from this point and returns a new one\r\n     * @param {fabric.Point} that\r\n     * @return {fabric.Point} new Point object with subtracted values\r\n     */\r\n    subtract: function (that) {\r\n      return new Point(this.x - that.x, this.y - that.y);\r\n    },\r\n\r\n    /**\r\n     * Subtracts another point from this point\r\n     * @param {fabric.Point} that\r\n     * @return {fabric.Point} thisArg\r\n     */\r\n    subtractEquals: function (that) {\r\n      this.x -= that.x;\r\n      this.y -= that.y;\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Subtracts value from this point and returns a new one\r\n     * @param {Number} scalar\r\n     * @return {fabric.Point}\r\n     */\r\n    scalarSubtract: function (scalar) {\r\n      return new Point(this.x - scalar, this.y - scalar);\r\n    },\r\n\r\n    /**\r\n     * Subtracts value from this point\r\n     * @param {Number} scalar\r\n     * @return {fabric.Point} thisArg\r\n     */\r\n    scalarSubtractEquals: function (scalar) {\r\n      this.x -= scalar;\r\n      this.y -= scalar;\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Miltiplies this point by a value and returns a new one\r\n     * @param {Number} scalar\r\n     * @return {fabric.Point}\r\n     */\r\n    multiply: function (scalar) {\r\n      return new Point(this.x * scalar, this.y * scalar);\r\n    },\r\n\r\n    /**\r\n     * Miltiplies this point by a value\r\n     * @param {Number} scalar\r\n     * @return {fabric.Point} thisArg\r\n     */\r\n    multiplyEquals: function (scalar) {\r\n      this.x *= scalar;\r\n      this.y *= scalar;\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Divides this point by a value and returns a new one\r\n     * @param {Number} scalar\r\n     * @return {fabric.Point}\r\n     */\r\n    divide: function (scalar) {\r\n      return new Point(this.x / scalar, this.y / scalar);\r\n    },\r\n\r\n    /**\r\n     * Divides this point by a value\r\n     * @param {Number} scalar\r\n     * @return {fabric.Point} thisArg\r\n     */\r\n    divideEquals: function (scalar) {\r\n      this.x /= scalar;\r\n      this.y /= scalar;\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns true if this point is equal to another one\r\n     * @param {fabric.Point} that\r\n     * @return {Boolean}\r\n     */\r\n    eq: function (that) {\r\n      return (this.x === that.x && this.y === that.y);\r\n    },\r\n\r\n    /**\r\n     * Returns true if this point is less than another one\r\n     * @param {fabric.Point} that\r\n     * @return {Boolean}\r\n     */\r\n    lt: function (that) {\r\n      return (this.x < that.x && this.y < that.y);\r\n    },\r\n\r\n    /**\r\n     * Returns true if this point is less than or equal to another one\r\n     * @param {fabric.Point} that\r\n     * @return {Boolean}\r\n     */\r\n    lte: function (that) {\r\n      return (this.x <= that.x && this.y <= that.y);\r\n    },\r\n\r\n    /**\r\n\r\n     * Returns true if this point is greater another one\r\n     * @param {fabric.Point} that\r\n     * @return {Boolean}\r\n     */\r\n    gt: function (that) {\r\n      return (this.x > that.x && this.y > that.y);\r\n    },\r\n\r\n    /**\r\n     * Returns true if this point is greater than or equal to another one\r\n     * @param {fabric.Point} that\r\n     * @return {Boolean}\r\n     */\r\n    gte: function (that) {\r\n      return (this.x >= that.x && this.y >= that.y);\r\n    },\r\n\r\n    /**\r\n     * Returns new point which is the result of linear interpolation with this one and another one\r\n     * @param {fabric.Point} that\r\n     * @param {Number} t\r\n     * @return {fabric.Point}\r\n     */\r\n    lerp: function (that, t) {\r\n      return new Point(this.x + (that.x - this.x) * t, this.y + (that.y - this.y) * t);\r\n    },\r\n\r\n    /**\r\n     * Returns distance from this point and another one\r\n     * @param {fabric.Point} that\r\n     * @return {Number}\r\n     */\r\n    distanceFrom: function (that) {\r\n      var dx = this.x - that.x,\r\n          dy = this.y - that.y;\r\n      return Math.sqrt(dx * dx + dy * dy);\r\n    },\r\n\r\n    /**\r\n     * Returns the point between this point and another one\r\n     * @param {fabric.Point} that\r\n     * @return {fabric.Point}\r\n     */\r\n    midPointFrom: function (that) {\r\n      return new Point(this.x + (that.x - this.x)/2, this.y + (that.y - this.y)/2);\r\n    },\r\n\r\n    /**\r\n     * Returns a new point which is the min of this and another one\r\n     * @param {fabric.Point} that\r\n     * @return {fabric.Point}\r\n     */\r\n    min: function (that) {\r\n      return new Point(Math.min(this.x, that.x), Math.min(this.y, that.y));\r\n    },\r\n\r\n    /**\r\n     * Returns a new point which is the max of this and another one\r\n     * @param {fabric.Point} that\r\n     * @return {fabric.Point}\r\n     */\r\n    max: function (that) {\r\n      return new Point(Math.max(this.x, that.x), Math.max(this.y, that.y));\r\n    },\r\n\r\n    /**\r\n     * Returns string representation of this point\r\n     * @return {String}\r\n     */\r\n    toString: function () {\r\n      return this.x + ',' + this.y;\r\n    },\r\n\r\n    /**\r\n     * Sets x/y of this point\r\n     * @param {Number} x\r\n     * @param {Number} y\r\n     */\r\n    setXY: function (x, y) {\r\n      this.x = x;\r\n      this.y = y;\r\n    },\r\n\r\n    /**\r\n     * Sets x/y of this point from another point\r\n     * @param {fabric.Point} that\r\n     */\r\n    setFromPoint: function (that) {\r\n      this.x = that.x;\r\n      this.y = that.y;\r\n    },\r\n\r\n    /**\r\n     * Swaps x/y of this point and another point\r\n     * @param {fabric.Point} that\r\n     */\r\n    swap: function (that) {\r\n      var x = this.x,\r\n          y = this.y;\r\n      this.x = that.x;\r\n      this.y = that.y;\r\n      that.x = x;\r\n      that.y = y;\r\n    }\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  /* Adaptation of work of Kevin Lindsey (kevin@kevlindev.com) */\r\n  var fabric = global.fabric || (global.fabric = { });\r\n\r\n  if (fabric.Intersection) {\r\n    fabric.warn('fabric.Intersection is already defined');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Intersection class\r\n   * @class fabric.Intersection\r\n   * @memberOf fabric\r\n   * @constructor\r\n   */\r\n  function Intersection(status) {\r\n    this.status = status;\r\n    this.points = [];\r\n  }\r\n\r\n  fabric.Intersection = Intersection;\r\n\r\n  fabric.Intersection.prototype = /** @lends fabric.Intersection.prototype */ {\r\n\r\n    /**\r\n     * Appends a point to intersection\r\n     * @param {fabric.Point} point\r\n     */\r\n    appendPoint: function (point) {\r\n      this.points.push(point);\r\n    },\r\n\r\n    /**\r\n     * Appends points to intersection\r\n     * @param {Array} points\r\n     */\r\n    appendPoints: function (points) {\r\n      this.points = this.points.concat(points);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Checks if one line intersects another\r\n   * @static\r\n   * @param {fabric.Point} a1\r\n   * @param {fabric.Point} a2\r\n   * @param {fabric.Point} b1\r\n   * @param {fabric.Point} b2\r\n   * @return {fabric.Intersection}\r\n   */\r\n  fabric.Intersection.intersectLineLine = function (a1, a2, b1, b2) {\r\n    var result,\r\n        uaT = (b2.x - b1.x) * (a1.y - b1.y) - (b2.y - b1.y) * (a1.x - b1.x),\r\n        ubT = (a2.x - a1.x) * (a1.y - b1.y) - (a2.y - a1.y) * (a1.x - b1.x),\r\n        uB = (b2.y - b1.y) * (a2.x - a1.x) - (b2.x - b1.x) * (a2.y - a1.y);\r\n    if (uB !== 0) {\r\n      var ua = uaT / uB,\r\n          ub = ubT / uB;\r\n      if (0 <= ua && ua <= 1 && 0 <= ub && ub <= 1) {\r\n        result = new Intersection('Intersection');\r\n        result.points.push(new fabric.Point(a1.x + ua * (a2.x - a1.x), a1.y + ua * (a2.y - a1.y)));\r\n      }\r\n      else {\r\n        result = new Intersection();\r\n      }\r\n    }\r\n    else {\r\n      if (uaT === 0 || ubT === 0) {\r\n        result = new Intersection('Coincident');\r\n      }\r\n      else {\r\n        result = new Intersection('Parallel');\r\n      }\r\n    }\r\n    return result;\r\n  };\r\n\r\n  /**\r\n   * Checks if line intersects polygon\r\n   * @static\r\n   * @param {fabric.Point} a1\r\n   * @param {fabric.Point} a2\r\n   * @param {Array} points\r\n   * @return {fabric.Intersection}\r\n   */\r\n  fabric.Intersection.intersectLinePolygon = function(a1, a2, points) {\r\n    var result = new Intersection(),\r\n        length = points.length;\r\n\r\n    for (var i = 0; i < length; i++) {\r\n      var b1 = points[i],\r\n          b2 = points[(i + 1) % length],\r\n          inter = Intersection.intersectLineLine(a1, a2, b1, b2);\r\n\r\n      result.appendPoints(inter.points);\r\n    }\r\n    if (result.points.length > 0) {\r\n      result.status = 'Intersection';\r\n    }\r\n    return result;\r\n  };\r\n\r\n  /**\r\n   * Checks if polygon intersects another polygon\r\n   * @static\r\n   * @param {Array} points1\r\n   * @param {Array} points2\r\n   * @return {fabric.Intersection}\r\n   */\r\n  fabric.Intersection.intersectPolygonPolygon = function (points1, points2) {\r\n    var result = new Intersection(),\r\n        length = points1.length;\r\n\r\n    for (var i = 0; i < length; i++) {\r\n      var a1 = points1[i],\r\n          a2 = points1[(i + 1) % length],\r\n          inter = Intersection.intersectLinePolygon(a1, a2, points2);\r\n\r\n      result.appendPoints(inter.points);\r\n    }\r\n    if (result.points.length > 0) {\r\n      result.status = 'Intersection';\r\n    }\r\n    return result;\r\n  };\r\n\r\n  /**\r\n   * Checks if polygon intersects rectangle\r\n   * @static\r\n   * @param {Array} points\r\n   * @param {Number} r1\r\n   * @param {Number} r2\r\n   * @return {fabric.Intersection}\r\n   */\r\n  fabric.Intersection.intersectPolygonRectangle = function (points, r1, r2) {\r\n    var min = r1.min(r2),\r\n        max = r1.max(r2),\r\n        topRight = new fabric.Point(max.x, min.y),\r\n        bottomLeft = new fabric.Point(min.x, max.y),\r\n        inter1 = Intersection.intersectLinePolygon(min, topRight, points),\r\n        inter2 = Intersection.intersectLinePolygon(topRight, max, points),\r\n        inter3 = Intersection.intersectLinePolygon(max, bottomLeft, points),\r\n        inter4 = Intersection.intersectLinePolygon(bottomLeft, min, points),\r\n        result = new Intersection();\r\n\r\n    result.appendPoints(inter1.points);\r\n    result.appendPoints(inter2.points);\r\n    result.appendPoints(inter3.points);\r\n    result.appendPoints(inter4.points);\r\n\r\n    if (result.points.length > 0) {\r\n      result.status = 'Intersection';\r\n    }\r\n    return result;\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { });\r\n\r\n  if (fabric.Color) {\r\n    fabric.warn('fabric.Color is already defined.');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Color class\r\n   * The purpose of {@link fabric.Color} is to abstract and encapsulate common color operations;\r\n   * {@link fabric.Color} is a constructor and creates instances of {@link fabric.Color} objects.\r\n   *\r\n   * @class fabric.Color\r\n   * @param {String} color optional in hex or rgb(a) format\r\n   * @return {fabric.Color} thisArg\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#colors}\r\n   */\r\n  function Color(color) {\r\n    if (!color) {\r\n      this.setSource([0, 0, 0, 1]);\r\n    }\r\n    else {\r\n      this._tryParsingColor(color);\r\n    }\r\n  }\r\n\r\n  fabric.Color = Color;\r\n\r\n  fabric.Color.prototype = /** @lends fabric.Color.prototype */ {\r\n\r\n    /**\r\n     * @private\r\n     * @param {String|Array} color Color value to parse\r\n     */\r\n    _tryParsingColor: function(color) {\r\n      var source;\r\n\r\n      if (color in Color.colorNameMap) {\r\n        color = Color.colorNameMap[color];\r\n      }\r\n\r\n      if (color === 'transparent') {\r\n        this.setSource([255, 255, 255, 0]);\r\n        return;\r\n      }\r\n\r\n      source = Color.sourceFromHex(color);\r\n\r\n      if (!source) {\r\n        source = Color.sourceFromRgb(color);\r\n      }\r\n      if (!source) {\r\n        source = Color.sourceFromHsl(color);\r\n      }\r\n      if (source) {\r\n        this.setSource(source);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Adapted from <a href=\"https://rawgithub.com/mjijackson/mjijackson.github.com/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.html\">https://github.com/mjijackson</a>\r\n     * @private\r\n     * @param {Number} r Red color value\r\n     * @param {Number} g Green color value\r\n     * @param {Number} b Blue color value\r\n     * @return {Array} Hsl color\r\n     */\r\n    _rgbToHsl: function(r, g, b) {\r\n      r /= 255, g /= 255, b /= 255;\r\n\r\n      var h, s, l,\r\n          max = fabric.util.array.max([r, g, b]),\r\n          min = fabric.util.array.min([r, g, b]);\r\n\r\n      l = (max + min) / 2;\r\n\r\n      if (max === min) {\r\n        h = s = 0; // achromatic\r\n      }\r\n      else {\r\n        var d = max - min;\r\n        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\r\n        switch (max) {\r\n          case r:\r\n            h = (g - b) / d + (g < b ? 6 : 0);\r\n            break;\r\n          case g:\r\n            h = (b - r) / d + 2;\r\n            break;\r\n          case b:\r\n            h = (r - g) / d + 4;\r\n            break;\r\n        }\r\n        h /= 6;\r\n      }\r\n\r\n      return [\r\n        Math.round(h * 360),\r\n        Math.round(s * 100),\r\n        Math.round(l * 100)\r\n      ];\r\n    },\r\n\r\n    /**\r\n     * Returns source of this color (where source is an array representation; ex: [200, 200, 100, 1])\r\n     * @return {Array}\r\n     */\r\n    getSource: function() {\r\n      return this._source;\r\n    },\r\n\r\n    /**\r\n     * Sets source of this color (where source is an array representation; ex: [200, 200, 100, 1])\r\n     * @param {Array} source\r\n     */\r\n    setSource: function(source) {\r\n      this._source = source;\r\n    },\r\n\r\n    /**\r\n     * Returns color represenation in RGB format\r\n     * @return {String} ex: rgb(0-255,0-255,0-255)\r\n     */\r\n    toRgb: function() {\r\n      var source = this.getSource();\r\n      return 'rgb(' + source[0] + ',' + source[1] + ',' + source[2] + ')';\r\n    },\r\n\r\n    /**\r\n     * Returns color represenation in RGBA format\r\n     * @return {String} ex: rgba(0-255,0-255,0-255,0-1)\r\n     */\r\n    toRgba: function() {\r\n      var source = this.getSource();\r\n      return 'rgba(' + source[0] + ',' + source[1] + ',' + source[2] + ',' + source[3] + ')';\r\n    },\r\n\r\n    /**\r\n     * Returns color represenation in HSL format\r\n     * @return {String} ex: hsl(0-360,0%-100%,0%-100%)\r\n     */\r\n    toHsl: function() {\r\n      var source = this.getSource(),\r\n          hsl = this._rgbToHsl(source[0], source[1], source[2]);\r\n\r\n      return 'hsl(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%)';\r\n    },\r\n\r\n    /**\r\n     * Returns color represenation in HSLA format\r\n     * @return {String} ex: hsla(0-360,0%-100%,0%-100%,0-1)\r\n     */\r\n    toHsla: function() {\r\n      var source = this.getSource(),\r\n          hsl = this._rgbToHsl(source[0], source[1], source[2]);\r\n\r\n      return 'hsla(' + hsl[0] + ',' + hsl[1] + '%,' + hsl[2] + '%,' + source[3] + ')';\r\n    },\r\n\r\n    /**\r\n     * Returns color represenation in HEX format\r\n     * @return {String} ex: FF5555\r\n     */\r\n    toHex: function() {\r\n      var source = this.getSource(), r, g, b;\r\n\r\n      r = source[0].toString(16);\r\n      r = (r.length === 1) ? ('0' + r) : r;\r\n\r\n      g = source[1].toString(16);\r\n      g = (g.length === 1) ? ('0' + g) : g;\r\n\r\n      b = source[2].toString(16);\r\n      b = (b.length === 1) ? ('0' + b) : b;\r\n\r\n      return r.toUpperCase() + g.toUpperCase() + b.toUpperCase();\r\n    },\r\n\r\n    /**\r\n     * Gets value of alpha channel for this color\r\n     * @return {Number} 0-1\r\n     */\r\n    getAlpha: function() {\r\n      return this.getSource()[3];\r\n    },\r\n\r\n    /**\r\n     * Sets value of alpha channel for this color\r\n     * @param {Number} alpha Alpha value 0-1\r\n     * @return {fabric.Color} thisArg\r\n     */\r\n    setAlpha: function(alpha) {\r\n      var source = this.getSource();\r\n      source[3] = alpha;\r\n      this.setSource(source);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Transforms color to its grayscale representation\r\n     * @return {fabric.Color} thisArg\r\n     */\r\n    toGrayscale: function() {\r\n      var source = this.getSource(),\r\n          average = parseInt((source[0] * 0.3 + source[1] * 0.59 + source[2] * 0.11).toFixed(0), 10),\r\n          currentAlpha = source[3];\r\n      this.setSource([average, average, average, currentAlpha]);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Transforms color to its black and white representation\r\n     * @param {Number} threshold\r\n     * @return {fabric.Color} thisArg\r\n     */\r\n    toBlackWhite: function(threshold) {\r\n      var source = this.getSource(),\r\n          average = (source[0] * 0.3 + source[1] * 0.59 + source[2] * 0.11).toFixed(0),\r\n          currentAlpha = source[3];\r\n\r\n      threshold = threshold || 127;\r\n\r\n      average = (Number(average) < Number(threshold)) ? 0 : 255;\r\n      this.setSource([average, average, average, currentAlpha]);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Overlays color with another color\r\n     * @param {String|fabric.Color} otherColor\r\n     * @return {fabric.Color} thisArg\r\n     */\r\n    overlayWith: function(otherColor) {\r\n      if (!(otherColor instanceof Color)) {\r\n        otherColor = new Color(otherColor);\r\n      }\r\n\r\n      var result = [],\r\n          alpha = this.getAlpha(),\r\n          otherAlpha = 0.5,\r\n          source = this.getSource(),\r\n          otherSource = otherColor.getSource();\r\n\r\n      for (var i = 0; i < 3; i++) {\r\n        result.push(Math.round((source[i] * (1 - otherAlpha)) + (otherSource[i] * otherAlpha)));\r\n      }\r\n\r\n      result[3] = alpha;\r\n      this.setSource(result);\r\n      return this;\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Regex matching color in RGB or RGBA formats (ex: rgb(0, 0, 0), rgba(255, 100, 10, 0.5), rgba( 255 , 100 , 10 , 0.5 ), rgb(1,1,1), rgba(100%, 60%, 10%, 0.5))\r\n   * @static\r\n   * @field\r\n   * @memberOf fabric.Color\r\n   */\r\n  fabric.Color.reRGBa = /^rgba?\\(\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*,\\s*(\\d{1,3}(?:\\.\\d+)?\\%?)\\s*(?:\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*)?\\)$/;\r\n\r\n  /**\r\n   * Regex matching color in HSL or HSLA formats (ex: hsl(200, 80%, 10%), hsla(300, 50%, 80%, 0.5), hsla( 300 , 50% , 80% , 0.5 ))\r\n   * @static\r\n   * @field\r\n   * @memberOf fabric.Color\r\n   */\r\n  fabric.Color.reHSLa = /^hsla?\\(\\s*(\\d{1,3})\\s*,\\s*(\\d{1,3}\\%)\\s*,\\s*(\\d{1,3}\\%)\\s*(?:\\s*,\\s*(\\d+(?:\\.\\d+)?)\\s*)?\\)$/;\r\n\r\n  /**\r\n   * Regex matching color in HEX format (ex: #FF5555, 010155, aff)\r\n   * @static\r\n   * @field\r\n   * @memberOf fabric.Color\r\n   */\r\n  fabric.Color.reHex = /^#?([0-9a-f]{6}|[0-9a-f]{3})$/i;\r\n\r\n  /**\r\n   * Map of the 17 basic color names with HEX code\r\n   * @static\r\n   * @field\r\n   * @memberOf fabric.Color\r\n   * @see: http://www.w3.org/TR/CSS2/syndata.html#color-units\r\n   */\r\n  fabric.Color.colorNameMap = {\r\n    aqua:    '#00FFFF',\r\n    black:   '#000000',\r\n    blue:    '#0000FF',\r\n    fuchsia: '#FF00FF',\r\n    gray:    '#808080',\r\n    green:   '#008000',\r\n    lime:    '#00FF00',\r\n    maroon:  '#800000',\r\n    navy:    '#000080',\r\n    olive:   '#808000',\r\n    orange:  '#FFA500',\r\n    purple:  '#800080',\r\n    red:     '#FF0000',\r\n    silver:  '#C0C0C0',\r\n    teal:    '#008080',\r\n    white:   '#FFFFFF',\r\n    yellow:  '#FFFF00'\r\n  };\r\n\r\n  /**\r\n   * @private\r\n   * @param {Number} p\r\n   * @param {Number} q\r\n   * @param {Number} t\r\n   * @return {Number}\r\n   */\r\n  function hue2rgb(p, q, t) {\r\n    if (t < 0) {\r\n      t += 1;\r\n    }\r\n    if (t > 1) {\r\n      t -= 1;\r\n    }\r\n    if (t < 1/6) {\r\n      return p + (q - p) * 6 * t;\r\n    }\r\n    if (t < 1/2) {\r\n      return q;\r\n    }\r\n    if (t < 2/3) {\r\n      return p + (q - p) * (2/3 - t) * 6;\r\n    }\r\n    return p;\r\n  }\r\n\r\n  /**\r\n   * Returns new color object, when given a color in RGB format\r\n   * @memberOf fabric.Color\r\n   * @param {String} color Color value ex: rgb(0-255,0-255,0-255)\r\n   * @return {fabric.Color}\r\n   */\r\n  fabric.Color.fromRgb = function(color) {\r\n    return Color.fromSource(Color.sourceFromRgb(color));\r\n  };\r\n\r\n  /**\r\n   * Returns array represenatation (ex: [100, 100, 200, 1]) of a color that's in RGB or RGBA format\r\n   * @memberOf fabric.Color\r\n   * @param {String} color Color value ex: rgb(0-255,0-255,0-255), rgb(0%-100%,0%-100%,0%-100%)\r\n   * @return {Array} source\r\n   */\r\n  fabric.Color.sourceFromRgb = function(color) {\r\n    var match = color.match(Color.reRGBa);\r\n    if (match) {\r\n      var r = parseInt(match[1], 10) / (/%$/.test(match[1]) ? 100 : 1) * (/%$/.test(match[1]) ? 255 : 1),\r\n          g = parseInt(match[2], 10) / (/%$/.test(match[2]) ? 100 : 1) * (/%$/.test(match[2]) ? 255 : 1),\r\n          b = parseInt(match[3], 10) / (/%$/.test(match[3]) ? 100 : 1) * (/%$/.test(match[3]) ? 255 : 1);\r\n\r\n      return [\r\n        parseInt(r, 10),\r\n        parseInt(g, 10),\r\n        parseInt(b, 10),\r\n        match[4] ? parseFloat(match[4]) : 1\r\n      ];\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Returns new color object, when given a color in RGBA format\r\n   * @static\r\n   * @function\r\n   * @memberOf fabric.Color\r\n   * @param {String} color\r\n   * @return {fabric.Color}\r\n   */\r\n  fabric.Color.fromRgba = Color.fromRgb;\r\n\r\n  /**\r\n   * Returns new color object, when given a color in HSL format\r\n   * @param {String} color Color value ex: hsl(0-260,0%-100%,0%-100%)\r\n   * @memberOf fabric.Color\r\n   * @return {fabric.Color}\r\n   */\r\n  fabric.Color.fromHsl = function(color) {\r\n    return Color.fromSource(Color.sourceFromHsl(color));\r\n  };\r\n\r\n  /**\r\n   * Returns array represenatation (ex: [100, 100, 200, 1]) of a color that's in HSL or HSLA format.\r\n   * Adapted from <a href=\"https://rawgithub.com/mjijackson/mjijackson.github.com/master/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript.html\">https://github.com/mjijackson</a>\r\n   * @memberOf fabric.Color\r\n   * @param {String} color Color value ex: hsl(0-360,0%-100%,0%-100%) or hsla(0-360,0%-100%,0%-100%, 0-1)\r\n   * @return {Array} source\r\n   * @see http://http://www.w3.org/TR/css3-color/#hsl-color\r\n   */\r\n  fabric.Color.sourceFromHsl = function(color) {\r\n    var match = color.match(Color.reHSLa);\r\n    if (!match) {\r\n      return;\r\n    }\r\n\r\n    var h = (((parseFloat(match[1]) % 360) + 360) % 360) / 360,\r\n        s = parseFloat(match[2]) / (/%$/.test(match[2]) ? 100 : 1),\r\n        l = parseFloat(match[3]) / (/%$/.test(match[3]) ? 100 : 1),\r\n        r, g, b;\r\n\r\n    if (s === 0) {\r\n      r = g = b = l;\r\n    }\r\n    else {\r\n      var q = l <= 0.5 ? l * (s + 1) : l + s - l * s,\r\n          p = l * 2 - q;\r\n\r\n      r = hue2rgb(p, q, h + 1/3);\r\n      g = hue2rgb(p, q, h);\r\n      b = hue2rgb(p, q, h - 1/3);\r\n    }\r\n\r\n    return [\r\n      Math.round(r * 255),\r\n      Math.round(g * 255),\r\n      Math.round(b * 255),\r\n      match[4] ? parseFloat(match[4]) : 1\r\n    ];\r\n  };\r\n\r\n  /**\r\n   * Returns new color object, when given a color in HSLA format\r\n   * @static\r\n   * @function\r\n   * @memberOf fabric.Color\r\n   * @param {String} color\r\n   * @return {fabric.Color}\r\n   */\r\n  fabric.Color.fromHsla = Color.fromHsl;\r\n\r\n  /**\r\n   * Returns new color object, when given a color in HEX format\r\n   * @static\r\n   * @memberOf fabric.Color\r\n   * @param {String} color Color value ex: FF5555\r\n   * @return {fabric.Color}\r\n   */\r\n  fabric.Color.fromHex = function(color) {\r\n    return Color.fromSource(Color.sourceFromHex(color));\r\n  };\r\n\r\n  /**\r\n   * Returns array represenatation (ex: [100, 100, 200, 1]) of a color that's in HEX format\r\n   * @static\r\n   * @memberOf fabric.Color\r\n   * @param {String} color ex: FF5555\r\n   * @return {Array} source\r\n   */\r\n  fabric.Color.sourceFromHex = function(color) {\r\n    if (color.match(Color.reHex)) {\r\n      var value = color.slice(color.indexOf('#') + 1),\r\n          isShortNotation = (value.length === 3),\r\n          r = isShortNotation ? (value.charAt(0) + value.charAt(0)) : value.substring(0, 2),\r\n          g = isShortNotation ? (value.charAt(1) + value.charAt(1)) : value.substring(2, 4),\r\n          b = isShortNotation ? (value.charAt(2) + value.charAt(2)) : value.substring(4, 6);\r\n\r\n      return [\r\n        parseInt(r, 16),\r\n        parseInt(g, 16),\r\n        parseInt(b, 16),\r\n        1\r\n      ];\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Returns new color object, when given color in array representation (ex: [200, 100, 100, 0.5])\r\n   * @static\r\n   * @memberOf fabric.Color\r\n   * @param {Array} source\r\n   * @return {fabric.Color}\r\n   */\r\n  fabric.Color.fromSource = function(source) {\r\n    var oColor = new Color();\r\n    oColor.setSource(source);\r\n    return oColor;\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function() {\r\n\r\n  /* _FROM_SVG_START_ */\r\n  function getColorStop(el) {\r\n    var style = el.getAttribute('style'),\r\n        offset = el.getAttribute('offset'),\r\n        color, colorAlpha, opacity;\r\n\r\n    // convert percents to absolute values\r\n    offset = parseFloat(offset) / (/%$/.test(offset) ? 100 : 1);\r\n    offset = offset < 0 ? 0 : offset > 1 ? 1 : offset;\r\n    if (style) {\r\n      var keyValuePairs = style.split(/\\s*;\\s*/);\r\n\r\n      if (keyValuePairs[keyValuePairs.length - 1] === '') {\r\n        keyValuePairs.pop();\r\n      }\r\n\r\n      for (var i = keyValuePairs.length; i--; ) {\r\n\r\n        var split = keyValuePairs[i].split(/\\s*:\\s*/),\r\n            key = split[0].trim(),\r\n            value = split[1].trim();\r\n\r\n        if (key === 'stop-color') {\r\n          color = value;\r\n        }\r\n        else if (key === 'stop-opacity') {\r\n          opacity = value;\r\n        }\r\n      }\r\n    }\r\n\r\n    if (!color) {\r\n      color = el.getAttribute('stop-color') || 'rgb(0,0,0)';\r\n    }\r\n    if (!opacity) {\r\n      opacity = el.getAttribute('stop-opacity');\r\n    }\r\n\r\n    color = new fabric.Color(color);\r\n    colorAlpha = color.getAlpha();\r\n    opacity = isNaN(parseFloat(opacity)) ? 1 : parseFloat(opacity);\r\n    opacity *= colorAlpha;\r\n\r\n    return {\r\n      offset: offset,\r\n      color: color.toRgb(),\r\n      opacity: opacity\r\n    };\r\n  }\r\n\r\n  function getLinearCoords(el) {\r\n    return {\r\n      x1: el.getAttribute('x1') || 0,\r\n      y1: el.getAttribute('y1') || 0,\r\n      x2: el.getAttribute('x2') || '100%',\r\n      y2: el.getAttribute('y2') || 0\r\n    };\r\n  }\r\n\r\n  function getRadialCoords(el) {\r\n    return {\r\n      x1: el.getAttribute('fx') || el.getAttribute('cx') || '50%',\r\n      y1: el.getAttribute('fy') || el.getAttribute('cy') || '50%',\r\n      r1: 0,\r\n      x2: el.getAttribute('cx') || '50%',\r\n      y2: el.getAttribute('cy') || '50%',\r\n      r2: el.getAttribute('r') || '50%'\r\n    };\r\n  }\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Gradient class\r\n   * @class fabric.Gradient\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#gradients}\r\n   * @see {@link fabric.Gradient#initialize} for constructor definition\r\n   */\r\n  fabric.Gradient = fabric.util.createClass(/** @lends fabric.Gradient.prototype */ {\r\n\r\n    /**\r\n     * Horizontal offset for aligning gradients coming from SVG when outside pathgroups\r\n     * @type Number\r\n     * @default 0\r\n     */\r\n    offsetX: 0,\r\n\r\n    /**\r\n     * Vertical offset for aligning gradients coming from SVG when outside pathgroups\r\n     * @type Number\r\n     * @default 0\r\n     */\r\n    offsetY: 0,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Object} [options] Options object with type, coords, gradientUnits and colorStops\r\n     * @return {fabric.Gradient} thisArg\r\n     */\r\n    initialize: function(options) {\r\n      options || (options = { });\r\n\r\n      var coords = { };\r\n\r\n      this.id = fabric.Object.__uid++;\r\n      this.type = options.type || 'linear';\r\n\r\n      coords = {\r\n        x1: options.coords.x1 || 0,\r\n        y1: options.coords.y1 || 0,\r\n        x2: options.coords.x2 || 0,\r\n        y2: options.coords.y2 || 0\r\n      };\r\n\r\n      if (this.type === 'radial') {\r\n        coords.r1 = options.coords.r1 || 0;\r\n        coords.r2 = options.coords.r2 || 0;\r\n      }\r\n      this.coords = coords;\r\n      this.colorStops = options.colorStops.slice();\r\n      if (options.gradientTransform) {\r\n        this.gradientTransform = options.gradientTransform;\r\n      }\r\n      this.offsetX = options.offsetX || this.offsetX;\r\n      this.offsetY = options.offsetY || this.offsetY;\r\n    },\r\n\r\n    /**\r\n     * Adds another colorStop\r\n     * @param {Object} colorStop Object with offset and color\r\n     * @return {fabric.Gradient} thisArg\r\n     */\r\n    addColorStop: function(colorStop) {\r\n      for (var position in colorStop) {\r\n        var color = new fabric.Color(colorStop[position]);\r\n        this.colorStops.push({\r\n          offset: position,\r\n          color: color.toRgb(),\r\n          opacity: color.getAlpha()\r\n        });\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of a gradient\r\n     * @return {Object}\r\n     */\r\n    toObject: function() {\r\n      return {\r\n        type: this.type,\r\n        coords: this.coords,\r\n        colorStops: this.colorStops,\r\n        offsetX: this.offsetX,\r\n        offsetY: this.offsetY\r\n      };\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns SVG representation of an gradient\r\n     * @param {Object} object Object to create a gradient for\r\n     * @param {Boolean} normalize Whether coords should be normalized\r\n     * @return {String} SVG representation of an gradient (linear/radial)\r\n     */\r\n    toSVG: function(object) {\r\n      var coords = fabric.util.object.clone(this.coords),\r\n          markup, commonAttributes;\r\n\r\n      // colorStops must be sorted ascending\r\n      this.colorStops.sort(function(a, b) {\r\n        return a.offset - b.offset;\r\n      });\r\n\r\n      if (!(object.group && object.group.type === 'path-group')) {\r\n        for (var prop in coords) {\r\n          if (prop === 'x1' || prop === 'x2' || prop === 'r2') {\r\n            coords[prop] += this.offsetX - object.width / 2;\r\n          }\r\n          else if (prop === 'y1' || prop === 'y2') {\r\n            coords[prop] += this.offsetY - object.height / 2;\r\n          }\r\n        }\r\n      }\r\n\r\n      commonAttributes = 'id=\"SVGID_' + this.id +\r\n                     '\" gradientUnits=\"userSpaceOnUse\"';\r\n      if (this.gradientTransform) {\r\n        commonAttributes += ' gradientTransform=\"matrix(' + this.gradientTransform.join(' ') + ')\" ';\r\n      }\r\n      if (this.type === 'linear') {\r\n        markup = [\r\n          //jscs:disable validateIndentation\r\n          '<linearGradient ',\r\n            commonAttributes,\r\n            ' x1=\"', coords.x1,\r\n            '\" y1=\"', coords.y1,\r\n            '\" x2=\"', coords.x2,\r\n            '\" y2=\"', coords.y2,\r\n          '\">\\n'\r\n          //jscs:enable validateIndentation\r\n        ];\r\n      }\r\n      else if (this.type === 'radial') {\r\n        markup = [\r\n          //jscs:disable validateIndentation\r\n          '<radialGradient ',\r\n            commonAttributes,\r\n            ' cx=\"', coords.x2,\r\n            '\" cy=\"', coords.y2,\r\n            '\" r=\"', coords.r2,\r\n            '\" fx=\"', coords.x1,\r\n            '\" fy=\"', coords.y1,\r\n          '\">\\n'\r\n          //jscs:enable validateIndentation\r\n        ];\r\n      }\r\n\r\n      for (var i = 0; i < this.colorStops.length; i++) {\r\n        markup.push(\r\n          //jscs:disable validateIndentation\r\n          '<stop ',\r\n            'offset=\"', (this.colorStops[i].offset * 100) + '%',\r\n            '\" style=\"stop-color:', this.colorStops[i].color,\r\n            (this.colorStops[i].opacity != null ? ';stop-opacity: ' + this.colorStops[i].opacity : ';'),\r\n          '\"/>\\n'\r\n          //jscs:enable validateIndentation\r\n        );\r\n      }\r\n\r\n      markup.push((this.type === 'linear' ? '</linearGradient>\\n' : '</radialGradient>\\n'));\r\n\r\n      return markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns an instance of CanvasGradient\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @return {CanvasGradient}\r\n     */\r\n    toLive: function(ctx, object) {\r\n      var gradient, prop, coords = fabric.util.object.clone(this.coords);\r\n\r\n      if (!this.type) {\r\n        return;\r\n      }\r\n\r\n      if (object.group && object.group.type === 'path-group') {\r\n        for (prop in coords) {\r\n          if (prop === 'x1' || prop === 'x2') {\r\n            coords[prop] += -this.offsetX + object.width / 2;\r\n          }\r\n          else if (prop === 'y1' || prop === 'y2') {\r\n            coords[prop] += -this.offsetY + object.height / 2;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (object.type === 'text' || object.type === 'i-text') {\r\n        for (prop in coords) {\r\n          if (prop === 'x1' || prop === 'x2') {\r\n            coords[prop] -= object.width / 2;\r\n          }\r\n          else if (prop === 'y1' || prop === 'y2') {\r\n            coords[prop] -= object.height / 2;\r\n          }\r\n        }\r\n      }\r\n\r\n      if (this.type === 'linear') {\r\n        gradient = ctx.createLinearGradient(\r\n          coords.x1, coords.y1, coords.x2, coords.y2);\r\n      }\r\n      else if (this.type === 'radial') {\r\n        gradient = ctx.createRadialGradient(\r\n          coords.x1, coords.y1, coords.r1, coords.x2, coords.y2, coords.r2);\r\n      }\r\n\r\n      for (var i = 0, len = this.colorStops.length; i < len; i++) {\r\n        var color = this.colorStops[i].color,\r\n            opacity = this.colorStops[i].opacity,\r\n            offset = this.colorStops[i].offset;\r\n\r\n        if (typeof opacity !== 'undefined') {\r\n          color = new fabric.Color(color).setAlpha(opacity).toRgba();\r\n        }\r\n        gradient.addColorStop(parseFloat(offset), color);\r\n      }\r\n\r\n      return gradient;\r\n    }\r\n  });\r\n\r\n  fabric.util.object.extend(fabric.Gradient, {\r\n\r\n    /* _FROM_SVG_START_ */\r\n    /**\r\n     * Returns {@link fabric.Gradient} instance from an SVG element\r\n     * @static\r\n     * @memberof fabric.Gradient\r\n     * @param {SVGGradientElement} el SVG gradient element\r\n     * @param {fabric.Object} instance\r\n     * @return {fabric.Gradient} Gradient instance\r\n     * @see http://www.w3.org/TR/SVG/pservers.html#LinearGradientElement\r\n     * @see http://www.w3.org/TR/SVG/pservers.html#RadialGradientElement\r\n     */\r\n    fromElement: function(el, instance) {\r\n\r\n      /**\r\n       *  @example:\r\n       *\r\n       *  <linearGradient id=\"linearGrad1\">\r\n       *    <stop offset=\"0%\" stop-color=\"white\"/>\r\n       *    <stop offset=\"100%\" stop-color=\"black\"/>\r\n       *  </linearGradient>\r\n       *\r\n       *  OR\r\n       *\r\n       *  <linearGradient id=\"linearGrad2\">\r\n       *    <stop offset=\"0\" style=\"stop-color:rgb(255,255,255)\"/>\r\n       *    <stop offset=\"1\" style=\"stop-color:rgb(0,0,0)\"/>\r\n       *  </linearGradient>\r\n       *\r\n       *  OR\r\n       *\r\n       *  <radialGradient id=\"radialGrad1\">\r\n       *    <stop offset=\"0%\" stop-color=\"white\" stop-opacity=\"1\" />\r\n       *    <stop offset=\"50%\" stop-color=\"black\" stop-opacity=\"0.5\" />\r\n       *    <stop offset=\"100%\" stop-color=\"white\" stop-opacity=\"1\" />\r\n       *  </radialGradient>\r\n       *\r\n       *  OR\r\n       *\r\n       *  <radialGradient id=\"radialGrad2\">\r\n       *    <stop offset=\"0\" stop-color=\"rgb(255,255,255)\" />\r\n       *    <stop offset=\"0.5\" stop-color=\"rgb(0,0,0)\" />\r\n       *    <stop offset=\"1\" stop-color=\"rgb(255,255,255)\" />\r\n       *  </radialGradient>\r\n       *\r\n       */\r\n\r\n      var colorStopEls = el.getElementsByTagName('stop'),\r\n          type = (el.nodeName === 'linearGradient' ? 'linear' : 'radial'),\r\n          gradientUnits = el.getAttribute('gradientUnits') || 'objectBoundingBox',\r\n          gradientTransform = el.getAttribute('gradientTransform'),\r\n          colorStops = [],\r\n          coords = { }, ellipseMatrix;\r\n\r\n      if (type === 'linear') {\r\n        coords = getLinearCoords(el);\r\n      }\r\n      else if (type === 'radial') {\r\n        coords = getRadialCoords(el);\r\n      }\r\n\r\n      for (var i = colorStopEls.length; i--; ) {\r\n        colorStops.push(getColorStop(colorStopEls[i]));\r\n      }\r\n\r\n      ellipseMatrix = _convertPercentUnitsToValues(instance, coords, gradientUnits);\r\n\r\n      var gradient = new fabric.Gradient({\r\n        type: type,\r\n        coords: coords,\r\n        colorStops: colorStops,\r\n        offsetX: -instance.left,\r\n        offsetY: -instance.top\r\n      });\r\n\r\n      if (gradientTransform || ellipseMatrix !== '') {\r\n        gradient.gradientTransform = fabric.parseTransformAttribute((gradientTransform || '') + ellipseMatrix);\r\n      }\r\n      return gradient;\r\n    },\r\n    /* _FROM_SVG_END_ */\r\n\r\n    /**\r\n     * Returns {@link fabric.Gradient} instance from its object representation\r\n     * @static\r\n     * @memberof fabric.Gradient\r\n     * @param {Object} obj\r\n     * @param {Object} [options] Options object\r\n     */\r\n    forObject: function(obj, options) {\r\n      options || (options = { });\r\n      _convertPercentUnitsToValues(obj, options.coords, 'userSpaceOnUse');\r\n      return new fabric.Gradient(options);\r\n    }\r\n  });\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function _convertPercentUnitsToValues(object, options, gradientUnits) {\r\n    var propValue, addFactor = 0, multFactor = 1, ellipseMatrix = '';\r\n    for (var prop in options) {\r\n      propValue = parseFloat(options[prop], 10);\r\n      if (typeof options[prop] === 'string' && /^\\d+%$/.test(options[prop])) {\r\n        multFactor = 0.01;\r\n      }\r\n      else {\r\n        multFactor = 1;\r\n      }\r\n      if (prop === 'x1' || prop === 'x2' || prop === 'r2') {\r\n        multFactor *= gradientUnits === 'objectBoundingBox' ? object.width : 1;\r\n        addFactor = gradientUnits === 'objectBoundingBox' ? object.left || 0 : 0;\r\n      }\r\n      else if (prop === 'y1' || prop === 'y2') {\r\n        multFactor *= gradientUnits === 'objectBoundingBox' ? object.height : 1;\r\n        addFactor = gradientUnits === 'objectBoundingBox' ? object.top || 0 : 0;\r\n      }\r\n      options[prop] = propValue * multFactor + addFactor;\r\n    }\r\n    if (object.type === 'ellipse' &&\r\n        options.r2 !== null &&\r\n        gradientUnits === 'objectBoundingBox' &&\r\n        object.rx !== object.ry) {\r\n\r\n      var scaleFactor = object.ry/object.rx;\r\n      ellipseMatrix = ' scale(1, ' + scaleFactor + ')';\r\n      if (options.y1) {\r\n        options.y1 /= scaleFactor;\r\n      }\r\n      if (options.y2) {\r\n        options.y2 /= scaleFactor;\r\n      }\r\n    }\r\n    return ellipseMatrix;\r\n  }\r\n})();\r\n\r\n\r\n/**\r\n * Pattern class\r\n * @class fabric.Pattern\r\n * @see {@link http://fabricjs.com/patterns/|Pattern demo}\r\n * @see {@link http://fabricjs.com/dynamic-patterns/|DynamicPattern demo}\r\n * @see {@link fabric.Pattern#initialize} for constructor definition\r\n */\r\nfabric.Pattern = fabric.util.createClass(/** @lends fabric.Pattern.prototype */ {\r\n\r\n  /**\r\n   * Repeat property of a pattern (one of repeat, repeat-x, repeat-y or no-repeat)\r\n   * @type String\r\n   * @default\r\n   */\r\n  repeat: 'repeat',\r\n\r\n  /**\r\n   * Pattern horizontal offset from object's left/top corner\r\n   * @type Number\r\n   * @default\r\n   */\r\n  offsetX: 0,\r\n\r\n  /**\r\n   * Pattern vertical offset from object's left/top corner\r\n   * @type Number\r\n   * @default\r\n   */\r\n  offsetY: 0,\r\n\r\n  /**\r\n   * Constructor\r\n   * @param {Object} [options] Options object\r\n   * @return {fabric.Pattern} thisArg\r\n   */\r\n  initialize: function(options) {\r\n    options || (options = { });\r\n\r\n    this.id = fabric.Object.__uid++;\r\n\r\n    if (options.source) {\r\n      if (typeof options.source === 'string') {\r\n        // function string\r\n        if (typeof fabric.util.getFunctionBody(options.source) !== 'undefined') {\r\n          this.source = new Function(fabric.util.getFunctionBody(options.source));\r\n        }\r\n        else {\r\n          // img src string\r\n          var _this = this;\r\n          this.source = fabric.util.createImage();\r\n          fabric.util.loadImage(options.source, function(img) {\r\n            _this.source = img;\r\n          });\r\n        }\r\n      }\r\n      else {\r\n        // img element\r\n        this.source = options.source;\r\n      }\r\n    }\r\n    if (options.repeat) {\r\n      this.repeat = options.repeat;\r\n    }\r\n    if (options.offsetX) {\r\n      this.offsetX = options.offsetX;\r\n    }\r\n    if (options.offsetY) {\r\n      this.offsetY = options.offsetY;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Returns object representation of a pattern\r\n   * @return {Object} Object representation of a pattern instance\r\n   */\r\n  toObject: function() {\r\n\r\n    var source;\r\n\r\n    // callback\r\n    if (typeof this.source === 'function') {\r\n      source = String(this.source);\r\n    }\r\n    // <img> element\r\n    else if (typeof this.source.src === 'string') {\r\n      source = this.source.src;\r\n    }\r\n\r\n    return {\r\n      source: source,\r\n      repeat: this.repeat,\r\n      offsetX: this.offsetX,\r\n      offsetY: this.offsetY\r\n    };\r\n  },\r\n\r\n  /* _TO_SVG_START_ */\r\n  /**\r\n   * Returns SVG representation of a pattern\r\n   * @param {fabric.Object} object\r\n   * @return {String} SVG representation of a pattern\r\n   */\r\n  toSVG: function(object) {\r\n    var patternSource = typeof this.source === 'function' ? this.source() : this.source,\r\n        patternWidth = patternSource.width / object.getWidth(),\r\n        patternHeight = patternSource.height / object.getHeight(),\r\n        patternOffsetX = this.offsetX / object.getWidth(),\r\n        patternOffsetY = this.offsetY / object.getHeight(),\r\n        patternImgSrc = '';\r\n    if (this.repeat === 'repeat-x' || this.repeat === 'no-repeat') {\r\n      patternHeight = 1;\r\n    }\r\n    if (this.repeat === 'repeat-y' || this.repeat === 'no-repeat') {\r\n      patternWidth = 1;\r\n    }\r\n    if (patternSource.src) {\r\n      patternImgSrc = patternSource.src;\r\n    }\r\n    else if (patternSource.toDataURL) {\r\n      patternImgSrc = patternSource.toDataURL();\r\n    }\r\n\r\n    return '<pattern id=\"SVGID_' + this.id +\r\n                  '\" x=\"' + patternOffsetX +\r\n                  '\" y=\"' + patternOffsetY +\r\n                  '\" width=\"' + patternWidth +\r\n                  '\" height=\"' + patternHeight + '\">\\n' +\r\n             '<image x=\"0\" y=\"0\"' +\r\n                    ' width=\"' + patternSource.width +\r\n                    '\" height=\"' + patternSource.height +\r\n                    '\" xlink:href=\"' + patternImgSrc +\r\n             '\"></image>\\n' +\r\n           '</pattern>\\n';\r\n  },\r\n  /* _TO_SVG_END_ */\r\n\r\n  /**\r\n   * Returns an instance of CanvasPattern\r\n   * @param {CanvasRenderingContext2D} ctx Context to create pattern\r\n   * @return {CanvasPattern}\r\n   */\r\n  toLive: function(ctx) {\r\n    var source = typeof this.source === 'function'\r\n      ? this.source()\r\n      : this.source;\r\n\r\n    // if the image failed to load, return, and allow rest to continue loading\r\n    if (!source) {\r\n      return '';\r\n    }\r\n\r\n    // if an image\r\n    if (typeof source.src !== 'undefined') {\r\n      if (!source.complete) {\r\n        return '';\r\n      }\r\n      if (source.naturalWidth === 0 || source.naturalHeight === 0) {\r\n        return '';\r\n      }\r\n    }\r\n    return ctx.createPattern(source, this.repeat);\r\n  }\r\n});\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      toFixed = fabric.util.toFixed;\r\n\r\n  if (fabric.Shadow) {\r\n    fabric.warn('fabric.Shadow is already defined.');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Shadow class\r\n   * @class fabric.Shadow\r\n   * @see {@link http://fabricjs.com/shadows/|Shadow demo}\r\n   * @see {@link fabric.Shadow#initialize} for constructor definition\r\n   */\r\n  fabric.Shadow = fabric.util.createClass(/** @lends fabric.Shadow.prototype */ {\r\n\r\n    /**\r\n     * Shadow color\r\n     * @type String\r\n     * @default\r\n     */\r\n    color: 'rgb(0,0,0)',\r\n\r\n    /**\r\n     * Shadow blur\r\n     * @type Number\r\n     */\r\n    blur: 0,\r\n\r\n    /**\r\n     * Shadow horizontal offset\r\n     * @type Number\r\n     * @default\r\n     */\r\n    offsetX: 0,\r\n\r\n    /**\r\n     * Shadow vertical offset\r\n     * @type Number\r\n     * @default\r\n     */\r\n    offsetY: 0,\r\n\r\n    /**\r\n     * Whether the shadow should affect stroke operations\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    affectStroke: false,\r\n\r\n    /**\r\n     * Indicates whether toObject should include default values\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    includeDefaultValues: true,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Object|String} [options] Options object with any of color, blur, offsetX, offsetX properties or string (e.g. \"rgba(0,0,0,0.2) 2px 2px 10px, \"2px 2px 10px rgba(0,0,0,0.2)\")\r\n     * @return {fabric.Shadow} thisArg\r\n     */\r\n    initialize: function(options) {\r\n\r\n      if (typeof options === 'string') {\r\n        options = this._parseShadow(options);\r\n      }\r\n\r\n      for (var prop in options) {\r\n        this[prop] = options[prop];\r\n      }\r\n\r\n      this.id = fabric.Object.__uid++;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} shadow Shadow value to parse\r\n     * @return {Object} Shadow object with color, offsetX, offsetY and blur\r\n     */\r\n    _parseShadow: function(shadow) {\r\n      var shadowStr = shadow.trim(),\r\n          offsetsAndBlur = fabric.Shadow.reOffsetsAndBlur.exec(shadowStr) || [ ],\r\n          color = shadowStr.replace(fabric.Shadow.reOffsetsAndBlur, '') || 'rgb(0,0,0)';\r\n\r\n      return {\r\n        color: color.trim(),\r\n        offsetX: parseInt(offsetsAndBlur[1], 10) || 0,\r\n        offsetY: parseInt(offsetsAndBlur[2], 10) || 0,\r\n        blur: parseInt(offsetsAndBlur[3], 10) || 0\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Returns a string representation of an instance\r\n     * @see http://www.w3.org/TR/css-text-decor-3/#text-shadow\r\n     * @return {String} Returns CSS3 text-shadow declaration\r\n     */\r\n    toString: function() {\r\n      return [this.offsetX, this.offsetY, this.blur, this.color].join('px ');\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns SVG representation of a shadow\r\n     * @param {fabric.Object} object\r\n     * @return {String} SVG representation of a shadow\r\n     */\r\n    toSVG: function(object) {\r\n      var mode = 'SourceAlpha', fBoxX = 40, fBoxY = 40;\r\n\r\n      if (object && (object.fill === this.color || object.stroke === this.color)) {\r\n        mode = 'SourceGraphic';\r\n      }\r\n\r\n      if (object.width && object.height) {\r\n        //http://www.w3.org/TR/SVG/filters.html#FilterEffectsRegion\r\n        // we add some extra space to filter box to contain the blur ( 20 )\r\n        fBoxX = toFixed(Math.abs(this.offsetX / object.getWidth()), 2) * 100 + 20;\r\n        fBoxY = toFixed(Math.abs(this.offsetY / object.getHeight()), 2) * 100 + 20;\r\n      }\r\n\r\n      return (\r\n        '<filter id=\"SVGID_' + this.id + '\" y=\"-' + fBoxY + '%\" height=\"' + (100 + 2 * fBoxY) + '%\" ' +\r\n          'x=\"-' + fBoxX + '%\" width=\"' + (100 + 2 * fBoxX) + '%\" ' + '>\\n' +\r\n          '\\t<feGaussianBlur in=\"' + mode + '\" stdDeviation=\"' +\r\n            toFixed(this.blur ? this.blur / 2 : 0, 3) +\r\n          '\" result=\"blurOut\"></feGaussianBlur>\\n' +\r\n          '\\t<feColorMatrix result=\"matrixOut\" in=\"blurOut\" type=\"matrix\" ' +\r\n          'values=\"1 0 0 0 0 0 1 0 0 0 0 0 1 0 0 0 0 0 0.30 0\" ></feColorMatrix >\\n' +\r\n          '\\t<feOffset dx=\"' + this.offsetX + '\" dy=\"' + this.offsetY + '\"></feOffset>\\n' +\r\n          '\\t<feMerge>\\n' +\r\n            '\\t\\t<feMergeNode></feMergeNode>\\n' +\r\n            '\\t\\t<feMergeNode in=\"SourceGraphic\"></feMergeNode>\\n' +\r\n          '\\t</feMerge>\\n' +\r\n        '</filter>\\n');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns object representation of a shadow\r\n     * @return {Object} Object representation of a shadow instance\r\n     */\r\n    toObject: function() {\r\n      if (this.includeDefaultValues) {\r\n        return {\r\n          color: this.color,\r\n          blur: this.blur,\r\n          offsetX: this.offsetX,\r\n          offsetY: this.offsetY\r\n        };\r\n      }\r\n      var obj = { }, proto = fabric.Shadow.prototype;\r\n      if (this.color !== proto.color) {\r\n        obj.color = this.color;\r\n      }\r\n      if (this.blur !== proto.blur) {\r\n        obj.blur = this.blur;\r\n      }\r\n      if (this.offsetX !== proto.offsetX) {\r\n        obj.offsetX = this.offsetX;\r\n      }\r\n      if (this.offsetY !== proto.offsetY) {\r\n        obj.offsetY = this.offsetY;\r\n      }\r\n      return obj;\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Regex matching shadow offsetX, offsetY and blur (ex: \"2px 2px 10px rgba(0,0,0,0.2)\", \"rgb(0,255,0) 2px 2px\")\r\n   * @static\r\n   * @field\r\n   * @memberOf fabric.Shadow\r\n   */\r\n  fabric.Shadow.reOffsetsAndBlur = /(?:\\s|^)(-?\\d+(?:px)?(?:\\s?|$))?(-?\\d+(?:px)?(?:\\s?|$))?(\\d+(?:px)?)?(?:\\s?|$)(?:$|\\s)/;\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function () {\r\n\r\n  'use strict';\r\n\r\n  if (fabric.StaticCanvas) {\r\n    fabric.warn('fabric.StaticCanvas is already defined.');\r\n    return;\r\n  }\r\n\r\n  // aliases for faster resolution\r\n  var extend = fabric.util.object.extend,\r\n      getElementOffset = fabric.util.getElementOffset,\r\n      removeFromArray = fabric.util.removeFromArray,\r\n\r\n      CANVAS_INIT_ERROR = new Error('Could not initialize `canvas` element');\r\n\r\n  /**\r\n   * Static canvas class\r\n   * @class fabric.StaticCanvas\r\n   * @mixes fabric.Collection\r\n   * @mixes fabric.Observable\r\n   * @see {@link http://fabricjs.com/static_canvas/|StaticCanvas demo}\r\n   * @see {@link fabric.StaticCanvas#initialize} for constructor definition\r\n   * @fires before:render\r\n   * @fires after:render\r\n   * @fires canvas:cleared\r\n   * @fires object:added\r\n   * @fires object:removed\r\n   */\r\n  fabric.StaticCanvas = fabric.util.createClass(/** @lends fabric.StaticCanvas.prototype */ {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\r\n     * @param {Object} [options] Options object\r\n     * @return {Object} thisArg\r\n     */\r\n    initialize: function(el, options) {\r\n      options || (options = { });\r\n\r\n      this._initStatic(el, options);\r\n      fabric.StaticCanvas.activeInstance = this;\r\n    },\r\n\r\n    /**\r\n     * Background color of canvas instance.\r\n     * Should be set via {@link fabric.StaticCanvas#setBackgroundColor}.\r\n     * @type {(String|fabric.Pattern)}\r\n     * @default\r\n     */\r\n    backgroundColor: '',\r\n\r\n    /**\r\n     * Background image of canvas instance.\r\n     * Should be set via {@link fabric.StaticCanvas#setBackgroundImage}.\r\n     * <b>Backwards incompatibility note:</b> The \"backgroundImageOpacity\"\r\n     * and \"backgroundImageStretch\" properties are deprecated since 1.3.9.\r\n     * Use {@link fabric.Image#opacity}, {@link fabric.Image#width} and {@link fabric.Image#height}.\r\n     * @type fabric.Image\r\n     * @default\r\n     */\r\n    backgroundImage: null,\r\n\r\n    /**\r\n     * Overlay color of canvas instance.\r\n     * Should be set via {@link fabric.StaticCanvas#setOverlayColor}\r\n     * @since 1.3.9\r\n     * @type {(String|fabric.Pattern)}\r\n     * @default\r\n     */\r\n    overlayColor: '',\r\n\r\n    /**\r\n     * Overlay image of canvas instance.\r\n     * Should be set via {@link fabric.StaticCanvas#setOverlayImage}.\r\n     * <b>Backwards incompatibility note:</b> The \"overlayImageLeft\"\r\n     * and \"overlayImageTop\" properties are deprecated since 1.3.9.\r\n     * Use {@link fabric.Image#left} and {@link fabric.Image#top}.\r\n     * @type fabric.Image\r\n     * @default\r\n     */\r\n    overlayImage: null,\r\n\r\n    /**\r\n     * Indicates whether toObject/toDatalessObject should include default values\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    includeDefaultValues: true,\r\n\r\n    /**\r\n     * Indicates whether objects' state should be saved\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    stateful: true,\r\n\r\n    /**\r\n     * Indicates whether {@link fabric.Collection.add}, {@link fabric.Collection.insertAt} and {@link fabric.Collection.remove} should also re-render canvas.\r\n     * Disabling this option could give a great performance boost when adding/removing a lot of objects to/from canvas at once\r\n     * (followed by a manual rendering after addition/deletion)\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    renderOnAddRemove: true,\r\n\r\n    /**\r\n     * Function that determines clipping of entire canvas area\r\n     * Being passed context as first argument. See clipping canvas area in {@link https://github.com/kangax/fabric.js/wiki/FAQ}\r\n     * @type Function\r\n     * @default\r\n     */\r\n    clipTo: null,\r\n\r\n    /**\r\n     * Indicates whether object controls (borders/controls) are rendered above overlay image\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    controlsAboveOverlay: false,\r\n\r\n    /**\r\n     * Indicates whether the browser can be scrolled when using a touchscreen and dragging on the canvas\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    allowTouchScrolling: false,\r\n\r\n    /**\r\n     * Indicates whether this canvas will use image smoothing, this is on by default in browsers\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    imageSmoothingEnabled: true,\r\n\r\n    /**\r\n     * Indicates whether objects should remain in current stack position when selected. When false objects are brought to top and rendered as part of the selection group\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    preserveObjectStacking: false,\r\n\r\n    /**\r\n     * The transformation (in the format of Canvas transform) which focuses the viewport\r\n     * @type Array\r\n     * @default\r\n     */\r\n    viewportTransform: [1, 0, 0, 1, 0, 0],\r\n\r\n    /**\r\n     * Callback; invoked right before object is about to be scaled/rotated\r\n     */\r\n    onBeforeScaleRotate: function () {\r\n      /* NOOP */\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\r\n     * @param {Object} [options] Options object\r\n     */\r\n    _initStatic: function(el, options) {\r\n      this._objects = [];\r\n\r\n      this._createLowerCanvas(el);\r\n      this._initOptions(options);\r\n      this._setImageSmoothing();\r\n\r\n      if (options.overlayImage) {\r\n        this.setOverlayImage(options.overlayImage, this.renderAll.bind(this));\r\n      }\r\n      if (options.backgroundImage) {\r\n        this.setBackgroundImage(options.backgroundImage, this.renderAll.bind(this));\r\n      }\r\n      if (options.backgroundColor) {\r\n        this.setBackgroundColor(options.backgroundColor, this.renderAll.bind(this));\r\n      }\r\n      if (options.overlayColor) {\r\n        this.setOverlayColor(options.overlayColor, this.renderAll.bind(this));\r\n      }\r\n      this.calcOffset();\r\n    },\r\n\r\n    /**\r\n     * Calculates canvas element offset relative to the document\r\n     * This method is also attached as \"resize\" event handler of window\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable\r\n     */\r\n    calcOffset: function () {\r\n      this._offset = getElementOffset(this.lowerCanvasEl);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Sets {@link fabric.StaticCanvas#overlayImage|overlay image} for this canvas\r\n     * @param {(fabric.Image|String)} image fabric.Image instance or URL of an image to set overlay to\r\n     * @param {Function} callback callback to invoke when image is loaded and set as an overlay\r\n     * @param {Object} [options] Optional options to set for the {@link fabric.Image|overlay image}.\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     * @see {@link http://jsfiddle.net/fabricjs/MnzHT/|jsFiddle demo}\r\n     * @example <caption>Normal overlayImage with left/top = 0</caption>\r\n     * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\r\n     *   // Needed to position overlayImage at 0/0\r\n     *   originX: 'left',\r\n     *   originY: 'top'\r\n     * });\r\n     * @example <caption>overlayImage with different properties</caption>\r\n     * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\r\n     *   opacity: 0.5,\r\n     *   angle: 45,\r\n     *   left: 400,\r\n     *   top: 400,\r\n     *   originX: 'left',\r\n     *   originY: 'top'\r\n     * });\r\n     * @example <caption>Stretched overlayImage #1 - width/height correspond to canvas width/height</caption>\r\n     * fabric.Image.fromURL('http://fabricjs.com/assets/jail_cell_bars.png', function(img) {\r\n     *    img.set({width: canvas.width, height: canvas.height, originX: 'left', originY: 'top'});\r\n     *    canvas.setOverlayImage(img, canvas.renderAll.bind(canvas));\r\n     * });\r\n     * @example <caption>Stretched overlayImage #2 - width/height correspond to canvas width/height</caption>\r\n     * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\r\n     *   width: canvas.width,\r\n     *   height: canvas.height,\r\n     *   // Needed to position overlayImage at 0/0\r\n     *   originX: 'left',\r\n     *   originY: 'top'\r\n     * });\r\n     * @example <caption>overlayImage loaded from cross-origin</caption>\r\n     * canvas.setOverlayImage('http://fabricjs.com/assets/jail_cell_bars.png', canvas.renderAll.bind(canvas), {\r\n     *   opacity: 0.5,\r\n     *   angle: 45,\r\n     *   left: 400,\r\n     *   top: 400,\r\n     *   originX: 'left',\r\n     *   originY: 'top',\r\n     *   crossOrigin: 'anonymous'\r\n     * });\r\n     */\r\n    setOverlayImage: function (image, callback, options) {\r\n      return this.__setBgOverlayImage('overlayImage', image, callback, options);\r\n    },\r\n\r\n    /**\r\n     * Sets {@link fabric.StaticCanvas#backgroundImage|background image} for this canvas\r\n     * @param {(fabric.Image|String)} image fabric.Image instance or URL of an image to set background to\r\n     * @param {Function} callback Callback to invoke when image is loaded and set as background\r\n     * @param {Object} [options] Optional options to set for the {@link fabric.Image|background image}.\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     * @see {@link http://jsfiddle.net/fabricjs/YH9yD/|jsFiddle demo}\r\n     * @example <caption>Normal backgroundImage with left/top = 0</caption>\r\n     * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\r\n     *   // Needed to position backgroundImage at 0/0\r\n     *   originX: 'left',\r\n     *   originY: 'top'\r\n     * });\r\n     * @example <caption>backgroundImage with different properties</caption>\r\n     * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\r\n     *   opacity: 0.5,\r\n     *   angle: 45,\r\n     *   left: 400,\r\n     *   top: 400,\r\n     *   originX: 'left',\r\n     *   originY: 'top'\r\n     * });\r\n     * @example <caption>Stretched backgroundImage #1 - width/height correspond to canvas width/height</caption>\r\n     * fabric.Image.fromURL('http://fabricjs.com/assets/honey_im_subtle.png', function(img) {\r\n     *    img.set({width: canvas.width, height: canvas.height, originX: 'left', originY: 'top'});\r\n     *    canvas.setBackgroundImage(img, canvas.renderAll.bind(canvas));\r\n     * });\r\n     * @example <caption>Stretched backgroundImage #2 - width/height correspond to canvas width/height</caption>\r\n     * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\r\n     *   width: canvas.width,\r\n     *   height: canvas.height,\r\n     *   // Needed to position backgroundImage at 0/0\r\n     *   originX: 'left',\r\n     *   originY: 'top'\r\n     * });\r\n     * @example <caption>backgroundImage loaded from cross-origin</caption>\r\n     * canvas.setBackgroundImage('http://fabricjs.com/assets/honey_im_subtle.png', canvas.renderAll.bind(canvas), {\r\n     *   opacity: 0.5,\r\n     *   angle: 45,\r\n     *   left: 400,\r\n     *   top: 400,\r\n     *   originX: 'left',\r\n     *   originY: 'top',\r\n     *   crossOrigin: 'anonymous'\r\n     * });\r\n     */\r\n    setBackgroundImage: function (image, callback, options) {\r\n      return this.__setBgOverlayImage('backgroundImage', image, callback, options);\r\n    },\r\n\r\n    /**\r\n     * Sets {@link fabric.StaticCanvas#overlayColor|background color} for this canvas\r\n     * @param {(String|fabric.Pattern)} overlayColor Color or pattern to set background color to\r\n     * @param {Function} callback Callback to invoke when background color is set\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     * @see {@link http://jsfiddle.net/fabricjs/pB55h/|jsFiddle demo}\r\n     * @example <caption>Normal overlayColor - color value</caption>\r\n     * canvas.setOverlayColor('rgba(255, 73, 64, 0.6)', canvas.renderAll.bind(canvas));\r\n     * @example <caption>fabric.Pattern used as overlayColor</caption>\r\n     * canvas.setOverlayColor({\r\n     *   source: 'http://fabricjs.com/assets/escheresque_ste.png'\r\n     * }, canvas.renderAll.bind(canvas));\r\n     * @example <caption>fabric.Pattern used as overlayColor with repeat and offset</caption>\r\n     * canvas.setOverlayColor({\r\n     *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\r\n     *   repeat: 'repeat',\r\n     *   offsetX: 200,\r\n     *   offsetY: 100\r\n     * }, canvas.renderAll.bind(canvas));\r\n     */\r\n    setOverlayColor: function(overlayColor, callback) {\r\n      return this.__setBgOverlayColor('overlayColor', overlayColor, callback);\r\n    },\r\n\r\n    /**\r\n     * Sets {@link fabric.StaticCanvas#backgroundColor|background color} for this canvas\r\n     * @param {(String|fabric.Pattern)} backgroundColor Color or pattern to set background color to\r\n     * @param {Function} callback Callback to invoke when background color is set\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     * @see {@link http://jsfiddle.net/fabricjs/hXzvk/|jsFiddle demo}\r\n     * @example <caption>Normal backgroundColor - color value</caption>\r\n     * canvas.setBackgroundColor('rgba(255, 73, 64, 0.6)', canvas.renderAll.bind(canvas));\r\n     * @example <caption>fabric.Pattern used as backgroundColor</caption>\r\n     * canvas.setBackgroundColor({\r\n     *   source: 'http://fabricjs.com/assets/escheresque_ste.png'\r\n     * }, canvas.renderAll.bind(canvas));\r\n     * @example <caption>fabric.Pattern used as backgroundColor with repeat and offset</caption>\r\n     * canvas.setBackgroundColor({\r\n     *   source: 'http://fabricjs.com/assets/escheresque_ste.png',\r\n     *   repeat: 'repeat',\r\n     *   offsetX: 200,\r\n     *   offsetY: 100\r\n     * }, canvas.renderAll.bind(canvas));\r\n     */\r\n    setBackgroundColor: function(backgroundColor, callback) {\r\n      return this.__setBgOverlayColor('backgroundColor', backgroundColor, callback);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @see {@link http://www.whatwg.org/specs/web-apps/current-work/multipage/the-canvas-element.html#dom-context-2d-imagesmoothingenabled|WhatWG Canvas Standard}\r\n     */\r\n    _setImageSmoothing: function() {\r\n      var ctx = this.getContext();\r\n\r\n      ctx.imageSmoothingEnabled       = this.imageSmoothingEnabled;\r\n      ctx.webkitImageSmoothingEnabled = this.imageSmoothingEnabled;\r\n      ctx.mozImageSmoothingEnabled    = this.imageSmoothingEnabled;\r\n      ctx.msImageSmoothingEnabled     = this.imageSmoothingEnabled;\r\n      ctx.oImageSmoothingEnabled      = this.imageSmoothingEnabled;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} property Property to set ({@link fabric.StaticCanvas#backgroundImage|backgroundImage}\r\n     * or {@link fabric.StaticCanvas#overlayImage|overlayImage})\r\n     * @param {(fabric.Image|String|null)} image fabric.Image instance, URL of an image or null to set background or overlay to\r\n     * @param {Function} callback Callback to invoke when image is loaded and set as background or overlay\r\n     * @param {Object} [options] Optional options to set for the {@link fabric.Image|image}.\r\n     */\r\n    __setBgOverlayImage: function(property, image, callback, options) {\r\n      if (typeof image === 'string') {\r\n        fabric.util.loadImage(image, function(img) {\r\n          this[property] = new fabric.Image(img, options);\r\n          callback && callback();\r\n        }, this, options && options.crossOrigin);\r\n      }\r\n      else {\r\n        options && image.setOptions(options);\r\n        this[property] = image;\r\n        callback && callback();\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} property Property to set ({@link fabric.StaticCanvas#backgroundColor|backgroundColor}\r\n     * or {@link fabric.StaticCanvas#overlayColor|overlayColor})\r\n     * @param {(Object|String|null)} color Object with pattern information, color value or null\r\n     * @param {Function} [callback] Callback is invoked when color is set\r\n     */\r\n    __setBgOverlayColor: function(property, color, callback) {\r\n      if (color && color.source) {\r\n        var _this = this;\r\n        fabric.util.loadImage(color.source, function(img) {\r\n          _this[property] = new fabric.Pattern({\r\n            source: img,\r\n            repeat: color.repeat,\r\n            offsetX: color.offsetX,\r\n            offsetY: color.offsetY\r\n          });\r\n          callback && callback();\r\n        });\r\n      }\r\n      else {\r\n        this[property] = color;\r\n        callback && callback();\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _createCanvasElement: function() {\r\n      var element = fabric.document.createElement('canvas');\r\n      if (!element.style) {\r\n        element.style = { };\r\n      }\r\n      if (!element) {\r\n        throw CANVAS_INIT_ERROR;\r\n      }\r\n      this._initCanvasElement(element);\r\n      return element;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {HTMLElement} element\r\n     */\r\n    _initCanvasElement: function(element) {\r\n      fabric.util.createCanvasElement(element);\r\n\r\n      if (typeof element.getContext === 'undefined') {\r\n        throw CANVAS_INIT_ERROR;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} [options] Options object\r\n     */\r\n    _initOptions: function (options) {\r\n      for (var prop in options) {\r\n        this[prop] = options[prop];\r\n      }\r\n\r\n      this.width = this.width || parseInt(this.lowerCanvasEl.width, 10) || 0;\r\n      this.height = this.height || parseInt(this.lowerCanvasEl.height, 10) || 0;\r\n\r\n      if (!this.lowerCanvasEl.style) {\r\n        return;\r\n      }\r\n\r\n      this.lowerCanvasEl.width = this.width;\r\n      this.lowerCanvasEl.height = this.height;\r\n\r\n      this.lowerCanvasEl.style.width = this.width + 'px';\r\n      this.lowerCanvasEl.style.height = this.height + 'px';\r\n\r\n      this.viewportTransform = this.viewportTransform.slice();\r\n    },\r\n\r\n    /**\r\n     * Creates a bottom canvas\r\n     * @private\r\n     * @param {HTMLElement} [canvasEl]\r\n     */\r\n    _createLowerCanvas: function (canvasEl) {\r\n      this.lowerCanvasEl = fabric.util.getById(canvasEl) || this._createCanvasElement();\r\n      this._initCanvasElement(this.lowerCanvasEl);\r\n\r\n      fabric.util.addClass(this.lowerCanvasEl, 'lower-canvas');\r\n\r\n      if (this.interactive) {\r\n        this._applyCanvasStyle(this.lowerCanvasEl);\r\n      }\r\n\r\n      this.contextContainer = this.lowerCanvasEl.getContext('2d');\r\n    },\r\n\r\n    /**\r\n     * Returns canvas width (in px)\r\n     * @return {Number}\r\n     */\r\n    getWidth: function () {\r\n      return this.width;\r\n    },\r\n\r\n    /**\r\n     * Returns canvas height (in px)\r\n     * @return {Number}\r\n     */\r\n    getHeight: function () {\r\n      return this.height;\r\n    },\r\n\r\n    /**\r\n     * Sets width of this canvas instance\r\n     * @param {Number|String} value                         Value to set width to\r\n     * @param {Object}        [options]                     Options object\r\n     * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\r\n     * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    setWidth: function (value, options) {\r\n      return this.setDimensions({ width: value }, options);\r\n    },\r\n\r\n    /**\r\n     * Sets height of this canvas instance\r\n     * @param {Number|String} value                         Value to set height to\r\n     * @param {Object}        [options]                     Options object\r\n     * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\r\n     * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    setHeight: function (value, options) {\r\n      return this.setDimensions({ height: value }, options);\r\n    },\r\n\r\n    /**\r\n     * Sets dimensions (width, height) of this canvas instance. when options.cssOnly flag active you should also supply the unit of measure (px/%/em)\r\n     * @param {Object}        dimensions                    Object with width/height properties\r\n     * @param {Number|String} [dimensions.width]            Width of canvas element\r\n     * @param {Number|String} [dimensions.height]           Height of canvas element\r\n     * @param {Object}        [options]                     Options object\r\n     * @param {Boolean}       [options.backstoreOnly=false] Set the given dimensions only as canvas backstore dimensions\r\n     * @param {Boolean}       [options.cssOnly=false]       Set the given dimensions only as css dimensions\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    setDimensions: function (dimensions, options) {\r\n      var cssValue;\r\n\r\n      options = options || {};\r\n\r\n      for (var prop in dimensions) {\r\n        cssValue = dimensions[prop];\r\n\r\n        if (!options.cssOnly) {\r\n          this._setBackstoreDimension(prop, dimensions[prop]);\r\n          cssValue += 'px';\r\n        }\r\n\r\n        if (!options.backstoreOnly) {\r\n          this._setCssDimension(prop, cssValue);\r\n        }\r\n      }\r\n\r\n      if (!options.cssOnly) {\r\n        this.renderAll();\r\n      }\r\n\r\n      this.calcOffset();\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Helper for setting width/height\r\n     * @private\r\n     * @param {String} prop property (width|height)\r\n     * @param {Number} value value to set property to\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    _setBackstoreDimension: function (prop, value) {\r\n      this.lowerCanvasEl[prop] = value;\r\n\r\n      if (this.upperCanvasEl) {\r\n        this.upperCanvasEl[prop] = value;\r\n      }\r\n\r\n      if (this.cacheCanvasEl) {\r\n        this.cacheCanvasEl[prop] = value;\r\n      }\r\n\r\n      this[prop] = value;\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Helper for setting css width/height\r\n     * @private\r\n     * @param {String} prop property (width|height)\r\n     * @param {String} value value to set property to\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    _setCssDimension: function (prop, value) {\r\n      this.lowerCanvasEl.style[prop] = value;\r\n\r\n      if (this.upperCanvasEl) {\r\n        this.upperCanvasEl.style[prop] = value;\r\n      }\r\n\r\n      if (this.wrapperEl) {\r\n        this.wrapperEl.style[prop] = value;\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns canvas zoom level\r\n     * @return {Number}\r\n     */\r\n    getZoom: function () {\r\n      return Math.sqrt(this.viewportTransform[0] * this.viewportTransform[3]);\r\n    },\r\n\r\n    /**\r\n     * Sets viewport transform of this canvas instance\r\n     * @param {Array} vpt the transform in the form of context.transform\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    setViewportTransform: function (vpt) {\r\n      var activeGroup = this.getActiveGroup();\r\n      this.viewportTransform = vpt;\r\n      this.renderAll();\r\n      for (var i = 0, len = this._objects.length; i < len; i++) {\r\n        this._objects[i].setCoords();\r\n      }\r\n      if (activeGroup) {\r\n        activeGroup.setCoords();\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Sets zoom level of this canvas instance, zoom centered around point\r\n     * @param {fabric.Point} point to zoom with respect to\r\n     * @param {Number} value to set zoom to, less than 1 zooms out\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    zoomToPoint: function (point, value) {\r\n      // TODO: just change the scale, preserve other transformations\r\n      var before = point;\r\n      point = fabric.util.transformPoint(point, fabric.util.invertTransform(this.viewportTransform));\r\n      this.viewportTransform[0] = value;\r\n      this.viewportTransform[3] = value;\r\n      var after = fabric.util.transformPoint(point, this.viewportTransform);\r\n      this.viewportTransform[4] += before.x - after.x;\r\n      this.viewportTransform[5] += before.y - after.y;\r\n      this.renderAll();\r\n      for (var i = 0, len = this._objects.length; i < len; i++) {\r\n        this._objects[i].setCoords();\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Sets zoom level of this canvas instance\r\n     * @param {Number} value to set zoom to, less than 1 zooms out\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    setZoom: function (value) {\r\n      this.zoomToPoint(new fabric.Point(0, 0), value);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Pan viewport so as to place point at top left corner of canvas\r\n     * @param {fabric.Point} point to move to\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    absolutePan: function (point) {\r\n      this.viewportTransform[4] = -point.x;\r\n      this.viewportTransform[5] = -point.y;\r\n      this.renderAll();\r\n      for (var i = 0, len = this._objects.length; i < len; i++) {\r\n        this._objects[i].setCoords();\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Pans viewpoint relatively\r\n     * @param {fabric.Point} point (position vector) to move by\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable true\r\n     */\r\n    relativePan: function (point) {\r\n      return this.absolutePan(new fabric.Point(\r\n        -point.x - this.viewportTransform[4],\r\n        -point.y - this.viewportTransform[5]\r\n      ));\r\n    },\r\n\r\n    /**\r\n     * Returns &lt;canvas> element corresponding to this instance\r\n     * @return {HTMLCanvasElement}\r\n     */\r\n    getElement: function () {\r\n      return this.lowerCanvasEl;\r\n    },\r\n\r\n    /**\r\n     * Returns currently selected object, if any\r\n     * @return {fabric.Object}\r\n     */\r\n    getActiveObject: function() {\r\n      return null;\r\n    },\r\n\r\n    /**\r\n     * Returns currently selected group of object, if any\r\n     * @return {fabric.Group}\r\n     */\r\n    getActiveGroup: function() {\r\n      return null;\r\n    },\r\n\r\n    /**\r\n     * Given a context, renders an object on that context\r\n     * @param {CanvasRenderingContext2D} ctx Context to render object on\r\n     * @param {fabric.Object} object Object to render\r\n     * @private\r\n     */\r\n    _draw: function (ctx, object) {\r\n      if (!object) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n      var v = this.viewportTransform;\r\n      ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\r\n      if (this._shouldRenderObject(object)) {\r\n        object.render(ctx);\r\n      }\r\n      ctx.restore();\r\n      if (!this.controlsAboveOverlay) {\r\n        object._renderControls(ctx);\r\n      }\r\n    },\r\n\r\n    _shouldRenderObject: function(object) {\r\n      if (!object) {\r\n        return false;\r\n      }\r\n      return (object !== this.getActiveGroup() || !this.preserveObjectStacking);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {fabric.Object} obj Object that was added\r\n     */\r\n    _onObjectAdded: function(obj) {\r\n      this.stateful && obj.setupState();\r\n      obj.canvas = this;\r\n      obj.setCoords();\r\n      this.fire('object:added', { target: obj });\r\n      obj.fire('added');\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {fabric.Object} obj Object that was removed\r\n     */\r\n    _onObjectRemoved: function(obj) {\r\n      // removing active object should fire \"selection:cleared\" events\r\n      if (this.getActiveObject() === obj) {\r\n        this.fire('before:selection:cleared', { target: obj });\r\n        this._discardActiveObject();\r\n        this.fire('selection:cleared');\r\n      }\r\n\r\n      this.fire('object:removed', { target: obj });\r\n      obj.fire('removed');\r\n    },\r\n\r\n    /**\r\n     * Clears specified context of canvas element\r\n     * @param {CanvasRenderingContext2D} ctx Context to clear\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    clearContext: function(ctx) {\r\n      ctx.clearRect(0, 0, this.width, this.height);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns context of canvas where objects are drawn\r\n     * @return {CanvasRenderingContext2D}\r\n     */\r\n    getContext: function () {\r\n      return this.contextContainer;\r\n    },\r\n\r\n    /**\r\n     * Clears all contexts (background, main, top) of an instance\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    clear: function () {\r\n      this._objects.length = 0;\r\n      if (this.discardActiveGroup) {\r\n        this.discardActiveGroup();\r\n      }\r\n      if (this.discardActiveObject) {\r\n        this.discardActiveObject();\r\n      }\r\n      this.clearContext(this.contextContainer);\r\n      if (this.contextTop) {\r\n        this.clearContext(this.contextTop);\r\n      }\r\n      this.fire('canvas:cleared');\r\n      this.renderAll();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Renders both the top canvas and the secondary container canvas.\r\n     * @param {Boolean} [allOnTop] Whether we want to force all images to be rendered on the top canvas\r\n     * @return {fabric.Canvas} instance\r\n     * @chainable\r\n     */\r\n    renderAll: function (allOnTop) {\r\n      var canvasToDrawOn = this[(allOnTop === true && this.interactive) ? 'contextTop' : 'contextContainer'],\r\n          activeGroup = this.getActiveGroup();\r\n\r\n      if (this.contextTop && this.selection && !this._groupSelector) {\r\n        this.clearContext(this.contextTop);\r\n      }\r\n\r\n      if (!allOnTop) {\r\n        this.clearContext(canvasToDrawOn);\r\n      }\r\n\r\n      this.fire('before:render');\r\n\r\n      if (this.clipTo) {\r\n        fabric.util.clipContext(this, canvasToDrawOn);\r\n      }\r\n\r\n      this._renderBackground(canvasToDrawOn);\r\n      this._renderObjects(canvasToDrawOn, activeGroup);\r\n      this._renderActiveGroup(canvasToDrawOn, activeGroup);\r\n\r\n      if (this.clipTo) {\r\n        canvasToDrawOn.restore();\r\n      }\r\n\r\n      this._renderOverlay(canvasToDrawOn);\r\n\r\n      if (this.controlsAboveOverlay && this.interactive) {\r\n        this.drawControls(canvasToDrawOn);\r\n      }\r\n\r\n      this.fire('after:render');\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {fabric.Group} activeGroup\r\n     */\r\n    _renderObjects: function(ctx, activeGroup) {\r\n      var i, length;\r\n\r\n      // fast path\r\n      if (!activeGroup || this.preserveObjectStacking) {\r\n        for (i = 0, length = this._objects.length; i < length; ++i) {\r\n          this._draw(ctx, this._objects[i]);\r\n        }\r\n      }\r\n      else {\r\n        for (i = 0, length = this._objects.length; i < length; ++i) {\r\n          if (this._objects[i] && !activeGroup.contains(this._objects[i])) {\r\n            this._draw(ctx, this._objects[i]);\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {fabric.Group} activeGroup\r\n     */\r\n    _renderActiveGroup: function(ctx, activeGroup) {\r\n\r\n      // delegate rendering to group selection (if one exists)\r\n      if (activeGroup) {\r\n\r\n        //Store objects in group preserving order, then replace\r\n        var sortedObjects = [];\r\n        this.forEachObject(function (object) {\r\n          if (activeGroup.contains(object)) {\r\n            sortedObjects.push(object);\r\n          }\r\n        });\r\n        activeGroup._set('objects', sortedObjects);\r\n        this._draw(ctx, activeGroup);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderBackground: function(ctx) {\r\n      if (this.backgroundColor) {\r\n        ctx.fillStyle = this.backgroundColor.toLive\r\n          ? this.backgroundColor.toLive(ctx)\r\n          : this.backgroundColor;\r\n\r\n        ctx.fillRect(\r\n          this.backgroundColor.offsetX || 0,\r\n          this.backgroundColor.offsetY || 0,\r\n          this.width,\r\n          this.height);\r\n      }\r\n      if (this.backgroundImage) {\r\n        this._draw(ctx, this.backgroundImage);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderOverlay: function(ctx) {\r\n      if (this.overlayColor) {\r\n        ctx.fillStyle = this.overlayColor.toLive\r\n          ? this.overlayColor.toLive(ctx)\r\n          : this.overlayColor;\r\n\r\n        ctx.fillRect(\r\n          this.overlayColor.offsetX || 0,\r\n          this.overlayColor.offsetY || 0,\r\n          this.width,\r\n          this.height);\r\n      }\r\n      if (this.overlayImage) {\r\n        this._draw(ctx, this.overlayImage);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Method to render only the top canvas.\r\n     * Also used to render the group selection box.\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    renderTop: function () {\r\n      var ctx = this.contextTop || this.contextContainer;\r\n      this.clearContext(ctx);\r\n\r\n      // we render the top context - last object\r\n      if (this.selection && this._groupSelector) {\r\n        this._drawSelection();\r\n      }\r\n\r\n      // delegate rendering to group selection if one exists\r\n      // used for drawing selection borders/controls\r\n      var activeGroup = this.getActiveGroup();\r\n      if (activeGroup) {\r\n        activeGroup.render(ctx);\r\n      }\r\n\r\n      this._renderOverlay(ctx);\r\n\r\n      this.fire('after:render');\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns coordinates of a center of canvas.\r\n     * Returned value is an object with top and left properties\r\n     * @return {Object} object with \"top\" and \"left\" number values\r\n     */\r\n    getCenter: function () {\r\n      return {\r\n        top: this.getHeight() / 2,\r\n        left: this.getWidth() / 2\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Centers object horizontally.\r\n     * You might need to call `setCoords` on an object after centering, to update controls area.\r\n     * @param {fabric.Object} object Object to center horizontally\r\n     * @return {fabric.Canvas} thisArg\r\n     */\r\n    centerObjectH: function (object) {\r\n      this._centerObject(object, new fabric.Point(this.getCenter().left, object.getCenterPoint().y));\r\n      this.renderAll();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Centers object vertically.\r\n     * You might need to call `setCoords` on an object after centering, to update controls area.\r\n     * @param {fabric.Object} object Object to center vertically\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    centerObjectV: function (object) {\r\n      this._centerObject(object, new fabric.Point(object.getCenterPoint().x, this.getCenter().top));\r\n      this.renderAll();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Centers object vertically and horizontally.\r\n     * You might need to call `setCoords` on an object after centering, to update controls area.\r\n     * @param {fabric.Object} object Object to center vertically and horizontally\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    centerObject: function(object) {\r\n      var center = this.getCenter();\r\n\r\n      this._centerObject(object, new fabric.Point(center.left, center.top));\r\n      this.renderAll();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {fabric.Object} object Object to center\r\n     * @param {fabric.Point} center Center point\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    _centerObject: function(object, center) {\r\n      object.setPositionByOrigin(center, 'center', 'center');\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returs dataless JSON representation of canvas\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {String} json string\r\n     */\r\n    toDatalessJSON: function (propertiesToInclude) {\r\n      return this.toDatalessObject(propertiesToInclude);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of canvas\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function (propertiesToInclude) {\r\n      return this._toObjectMethod('toObject', propertiesToInclude);\r\n    },\r\n\r\n    /**\r\n     * Returns dataless object representation of canvas\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toDatalessObject: function (propertiesToInclude) {\r\n      return this._toObjectMethod('toDatalessObject', propertiesToInclude);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _toObjectMethod: function (methodName, propertiesToInclude) {\r\n\r\n      var data = {\r\n        objects: this._toObjects(methodName, propertiesToInclude)\r\n      };\r\n\r\n      extend(data, this.__serializeBgOverlay());\r\n\r\n      fabric.util.populateWithProperties(this, data, propertiesToInclude);\r\n\r\n      return data;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _toObjects: function(methodName, propertiesToInclude) {\r\n      return this.getObjects().map(function(instance) {\r\n        return this._toObject(instance, methodName, propertiesToInclude);\r\n      }, this);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _toObject: function(instance, methodName, propertiesToInclude) {\r\n      var originalValue;\r\n\r\n      if (!this.includeDefaultValues) {\r\n        originalValue = instance.includeDefaultValues;\r\n        instance.includeDefaultValues = false;\r\n      }\r\n\r\n      //If the object is part of the current selection group, it should\r\n      //be transformed appropriately\r\n      //i.e. it should be serialised as it would appear if the selection group\r\n      //were to be destroyed.\r\n      var originalProperties = this._realizeGroupTransformOnObject(instance),\r\n          object = instance[methodName](propertiesToInclude);\r\n      if (!this.includeDefaultValues) {\r\n        instance.includeDefaultValues = originalValue;\r\n      }\r\n\r\n      //Undo the damage we did by changing all of its properties\r\n      this._unwindGroupTransformOnObject(instance, originalProperties);\r\n\r\n      return object;\r\n    },\r\n\r\n    /**\r\n     * Realises an object's group transformation on it\r\n     * @private\r\n     * @param {fabric.Object} [instance] the object to transform (gets mutated)\r\n     * @returns the original values of instance which were changed\r\n     */\r\n    _realizeGroupTransformOnObject: function(instance) {\r\n      var layoutProps = ['angle', 'flipX', 'flipY', 'height', 'left', 'scaleX', 'scaleY', 'top', 'width'];\r\n      if (instance.group && instance.group === this.getActiveGroup()) {\r\n        //Copy all the positionally relevant properties across now\r\n        var originalValues = {};\r\n        layoutProps.forEach(function(prop) {\r\n          originalValues[prop] = instance[prop];\r\n        });\r\n        this.getActiveGroup().realizeTransform(instance);\r\n        return originalValues;\r\n      }\r\n      else {\r\n        return null;\r\n      }\r\n    },\r\n\r\n    /*\r\n     * Restores the changed properties of instance\r\n     * @private\r\n     * @param {fabric.Object} [instance] the object to un-transform (gets mutated)\r\n     * @param {Object} [originalValues] the original values of instance, as returned by _realizeGroupTransformOnObject\r\n     */\r\n    _unwindGroupTransformOnObject: function(instance, originalValues) {\r\n      if (originalValues) {\r\n        instance.set(originalValues);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    __serializeBgOverlay: function() {\r\n      var data = {\r\n        background: (this.backgroundColor && this.backgroundColor.toObject)\r\n          ? this.backgroundColor.toObject()\r\n          : this.backgroundColor\r\n      };\r\n\r\n      if (this.overlayColor) {\r\n        data.overlay = this.overlayColor.toObject\r\n          ? this.overlayColor.toObject()\r\n          : this.overlayColor;\r\n      }\r\n      if (this.backgroundImage) {\r\n        data.backgroundImage = this.backgroundImage.toObject();\r\n      }\r\n      if (this.overlayImage) {\r\n        data.overlayImage = this.overlayImage.toObject();\r\n      }\r\n\r\n      return data;\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * When true, getSvgTransform() will apply the StaticCanvas.viewportTransform to the SVG transformation. When true,\r\n     * a zoomed canvas will then produce zoomed SVG output.\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    svgViewportTransformation: true,\r\n\r\n    /**\r\n     * Returns SVG representation of canvas\r\n     * @function\r\n     * @param {Object} [options] Options object for SVG output\r\n     * @param {Boolean} [options.suppressPreamble=false] If true xml tag is not included\r\n     * @param {Object} [options.viewBox] SVG viewbox object\r\n     * @param {Number} [options.viewBox.x] x-cooridnate of viewbox\r\n     * @param {Number} [options.viewBox.y] y-coordinate of viewbox\r\n     * @param {Number} [options.viewBox.width] Width of viewbox\r\n     * @param {Number} [options.viewBox.height] Height of viewbox\r\n     * @param {String} [options.encoding=UTF-8] Encoding of SVG output\r\n     * @param {Function} [reviver] Method for further parsing of svg elements, called after each fabric object converted into svg representation.\r\n     * @return {String} SVG string\r\n     * @tutorial {@link http://fabricjs.com/fabric-intro-part-3/#serialization}\r\n     * @see {@link http://jsfiddle.net/fabricjs/jQ3ZZ/|jsFiddle demo}\r\n     * @example <caption>Normal SVG output</caption>\r\n     * var svg = canvas.toSVG();\r\n     * @example <caption>SVG output without preamble (without &lt;?xml ../>)</caption>\r\n     * var svg = canvas.toSVG({suppressPreamble: true});\r\n     * @example <caption>SVG output with viewBox attribute</caption>\r\n     * var svg = canvas.toSVG({\r\n     *   viewBox: {\r\n     *     x: 100,\r\n     *     y: 100,\r\n     *     width: 200,\r\n     *     height: 300\r\n     *   }\r\n     * });\r\n     * @example <caption>SVG output with different encoding (default: UTF-8)</caption>\r\n     * var svg = canvas.toSVG({encoding: 'ISO-8859-1'});\r\n     * @example <caption>Modify SVG output with reviver function</caption>\r\n     * var svg = canvas.toSVG(null, function(svg) {\r\n     *   return svg.replace('stroke-dasharray: ; stroke-linecap: butt; stroke-linejoin: miter; stroke-miterlimit: 10; ', '');\r\n     * });\r\n     */\r\n    toSVG: function(options, reviver) {\r\n      options || (options = { });\r\n\r\n      var markup = [];\r\n\r\n      this._setSVGPreamble(markup, options);\r\n      this._setSVGHeader(markup, options);\r\n\r\n      this._setSVGBgOverlayColor(markup, 'backgroundColor');\r\n      this._setSVGBgOverlayImage(markup, 'backgroundImage');\r\n\r\n      this._setSVGObjects(markup, reviver);\r\n\r\n      this._setSVGBgOverlayColor(markup, 'overlayColor');\r\n      this._setSVGBgOverlayImage(markup, 'overlayImage');\r\n\r\n      markup.push('</svg>');\r\n\r\n      return markup.join('');\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setSVGPreamble: function(markup, options) {\r\n      if (!options.suppressPreamble) {\r\n        markup.push(\r\n          '<?xml version=\"1.0\" encoding=\"', (options.encoding || 'UTF-8'), '\" standalone=\"no\" ?>',\r\n            '<!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\" ',\r\n              '\"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\">\\n'\r\n        );\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setSVGHeader: function(markup, options) {\r\n      var width, height, vpt;\r\n\r\n      if (options.viewBox) {\r\n        width = options.viewBox.width;\r\n        height = options.viewBox.height;\r\n      }\r\n      else {\r\n        width = this.width;\r\n        height = this.height;\r\n        if (!this.svgViewportTransformation) {\r\n          vpt = this.viewportTransform;\r\n          width /= vpt[0];\r\n          height /= vpt[3];\r\n        }\r\n      }\r\n\r\n      markup.push(\r\n        '<svg ',\r\n          'xmlns=\"http://www.w3.org/2000/svg\" ',\r\n          'xmlns:xlink=\"http://www.w3.org/1999/xlink\" ',\r\n          'version=\"1.1\" ',\r\n          'width=\"', width, '\" ',\r\n          'height=\"', height, '\" ',\r\n          (this.backgroundColor && !this.backgroundColor.toLive\r\n            ? 'style=\"background-color: ' + this.backgroundColor + '\" '\r\n            : null),\r\n          (options.viewBox\r\n              ? 'viewBox=\"' +\r\n                options.viewBox.x + ' ' +\r\n                options.viewBox.y + ' ' +\r\n                options.viewBox.width + ' ' +\r\n                options.viewBox.height + '\" '\r\n              : null),\r\n          'xml:space=\"preserve\">',\r\n        '<desc>Created with Fabric.js ', fabric.version, '</desc>',\r\n        '<defs>',\r\n          fabric.createSVGFontFacesMarkup(this.getObjects()),\r\n          fabric.createSVGRefElementsMarkup(this),\r\n        '</defs>'\r\n      );\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setSVGObjects: function(markup, reviver) {\r\n      for (var i = 0, objects = this.getObjects(), len = objects.length; i < len; i++) {\r\n        var instance = objects[i],\r\n            //If the object is in a selection group, simulate what would happen to that\r\n            //object when the group is deselected\r\n            originalProperties = this._realizeGroupTransformOnObject(instance);\r\n        markup.push(instance.toSVG(reviver));\r\n        this._unwindGroupTransformOnObject(instance, originalProperties);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setSVGBgOverlayImage: function(markup, property) {\r\n      if (this[property] && this[property].toSVG) {\r\n        markup.push(this[property].toSVG());\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setSVGBgOverlayColor: function(markup, property) {\r\n      if (this[property] && this[property].source) {\r\n        markup.push(\r\n          '<rect x=\"', this[property].offsetX, '\" y=\"', this[property].offsetY, '\" ',\r\n            'width=\"',\r\n              (this[property].repeat === 'repeat-y' || this[property].repeat === 'no-repeat'\r\n                ? this[property].source.width\r\n                : this.width),\r\n            '\" height=\"',\r\n              (this[property].repeat === 'repeat-x' || this[property].repeat === 'no-repeat'\r\n                ? this[property].source.height\r\n                : this.height),\r\n            '\" fill=\"url(#' + property + 'Pattern)\"',\r\n          '></rect>'\r\n        );\r\n      }\r\n      else if (this[property] && property === 'overlayColor') {\r\n        markup.push(\r\n          '<rect x=\"0\" y=\"0\" ',\r\n            'width=\"', this.width,\r\n            '\" height=\"', this.height,\r\n            '\" fill=\"', this[property], '\"',\r\n          '></rect>'\r\n        );\r\n      }\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Moves an object to the bottom of the stack of drawn objects\r\n     * @param {fabric.Object} object Object to send to back\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    sendToBack: function (object) {\r\n      removeFromArray(this._objects, object);\r\n      this._objects.unshift(object);\r\n      return this.renderAll && this.renderAll();\r\n    },\r\n\r\n    /**\r\n     * Moves an object to the top of the stack of drawn objects\r\n     * @param {fabric.Object} object Object to send\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    bringToFront: function (object) {\r\n      removeFromArray(this._objects, object);\r\n      this._objects.push(object);\r\n      return this.renderAll && this.renderAll();\r\n    },\r\n\r\n    /**\r\n     * Moves an object down in stack of drawn objects\r\n     * @param {fabric.Object} object Object to send\r\n     * @param {Boolean} [intersecting] If `true`, send object behind next lower intersecting object\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    sendBackwards: function (object, intersecting) {\r\n      var idx = this._objects.indexOf(object);\r\n\r\n      // if object is not on the bottom of stack\r\n      if (idx !== 0) {\r\n        var newIdx = this._findNewLowerIndex(object, idx, intersecting);\r\n\r\n        removeFromArray(this._objects, object);\r\n        this._objects.splice(newIdx, 0, object);\r\n        this.renderAll && this.renderAll();\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _findNewLowerIndex: function(object, idx, intersecting) {\r\n      var newIdx;\r\n\r\n      if (intersecting) {\r\n        newIdx = idx;\r\n\r\n        // traverse down the stack looking for the nearest intersecting object\r\n        for (var i = idx - 1; i >= 0; --i) {\r\n\r\n          var isIntersecting = object.intersectsWithObject(this._objects[i]) ||\r\n                               object.isContainedWithinObject(this._objects[i]) ||\r\n                               this._objects[i].isContainedWithinObject(object);\r\n\r\n          if (isIntersecting) {\r\n            newIdx = i;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      else {\r\n        newIdx = idx - 1;\r\n      }\r\n\r\n      return newIdx;\r\n    },\r\n\r\n    /**\r\n     * Moves an object up in stack of drawn objects\r\n     * @param {fabric.Object} object Object to send\r\n     * @param {Boolean} [intersecting] If `true`, send object in front of next upper intersecting object\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    bringForward: function (object, intersecting) {\r\n      var idx = this._objects.indexOf(object);\r\n\r\n      // if object is not on top of stack (last item in an array)\r\n      if (idx !== this._objects.length - 1) {\r\n        var newIdx = this._findNewUpperIndex(object, idx, intersecting);\r\n\r\n        removeFromArray(this._objects, object);\r\n        this._objects.splice(newIdx, 0, object);\r\n        this.renderAll && this.renderAll();\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _findNewUpperIndex: function(object, idx, intersecting) {\r\n      var newIdx;\r\n\r\n      if (intersecting) {\r\n        newIdx = idx;\r\n\r\n        // traverse up the stack looking for the nearest intersecting object\r\n        for (var i = idx + 1; i < this._objects.length; ++i) {\r\n\r\n          var isIntersecting = object.intersectsWithObject(this._objects[i]) ||\r\n                               object.isContainedWithinObject(this._objects[i]) ||\r\n                               this._objects[i].isContainedWithinObject(object);\r\n\r\n          if (isIntersecting) {\r\n            newIdx = i;\r\n            break;\r\n          }\r\n        }\r\n      }\r\n      else {\r\n        newIdx = idx + 1;\r\n      }\r\n\r\n      return newIdx;\r\n    },\r\n\r\n    /**\r\n     * Moves an object to specified level in stack of drawn objects\r\n     * @param {fabric.Object} object Object to send\r\n     * @param {Number} index Position to move to\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    moveTo: function (object, index) {\r\n      removeFromArray(this._objects, object);\r\n      this._objects.splice(index, 0, object);\r\n      return this.renderAll && this.renderAll();\r\n    },\r\n\r\n    /**\r\n     * Clears a canvas element and removes all event listeners\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    dispose: function () {\r\n      this.clear();\r\n      this.interactive && this.removeListeners();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns a string representation of an instance\r\n     * @return {String} string representation of an instance\r\n     */\r\n    toString: function () {\r\n      return '#<fabric.Canvas (' + this.complexity() + '): ' +\r\n               '{ objects: ' + this.getObjects().length + ' }>';\r\n    }\r\n  });\r\n\r\n  extend(fabric.StaticCanvas.prototype, fabric.Observable);\r\n  extend(fabric.StaticCanvas.prototype, fabric.Collection);\r\n  extend(fabric.StaticCanvas.prototype, fabric.DataURLExporter);\r\n\r\n  extend(fabric.StaticCanvas, /** @lends fabric.StaticCanvas */ {\r\n\r\n    /**\r\n     * @static\r\n     * @type String\r\n     * @default\r\n     */\r\n    EMPTY_JSON: '{\"objects\": [], \"background\": \"white\"}',\r\n\r\n    /**\r\n     * Provides a way to check support of some of the canvas methods\r\n     * (either those of HTMLCanvasElement itself, or rendering context)\r\n     *\r\n     * @param {String} methodName Method to check support for;\r\n     *                            Could be one of \"getImageData\", \"toDataURL\", \"toDataURLWithQuality\" or \"setLineDash\"\r\n     * @return {Boolean | null} `true` if method is supported (or at least exists),\r\n     *                          `null` if canvas element or context can not be initialized\r\n     */\r\n    supports: function (methodName) {\r\n      var el = fabric.util.createCanvasElement();\r\n\r\n      if (!el || !el.getContext) {\r\n        return null;\r\n      }\r\n\r\n      var ctx = el.getContext('2d');\r\n      if (!ctx) {\r\n        return null;\r\n      }\r\n\r\n      switch (methodName) {\r\n\r\n        case 'getImageData':\r\n          return typeof ctx.getImageData !== 'undefined';\r\n\r\n        case 'setLineDash':\r\n          return typeof ctx.setLineDash !== 'undefined';\r\n\r\n        case 'toDataURL':\r\n          return typeof el.toDataURL !== 'undefined';\r\n\r\n        case 'toDataURLWithQuality':\r\n          try {\r\n            el.toDataURL('image/jpeg', 0);\r\n            return true;\r\n          }\r\n          catch (e) { }\r\n          return false;\r\n\r\n        default:\r\n          return null;\r\n      }\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns JSON representation of canvas\r\n   * @function\r\n   * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n   * @return {String} JSON string\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3/#serialization}\r\n   * @see {@link http://jsfiddle.net/fabricjs/pec86/|jsFiddle demo}\r\n   * @example <caption>JSON without additional properties</caption>\r\n   * var json = canvas.toJSON();\r\n   * @example <caption>JSON with additional properties included</caption>\r\n   * var json = canvas.toJSON(['lockMovementX', 'lockMovementY', 'lockRotation', 'lockScalingX', 'lockScalingY', 'lockUniScaling']);\r\n   * @example <caption>JSON without default values</caption>\r\n   * canvas.includeDefaultValues = false;\r\n   * var json = canvas.toJSON();\r\n   */\r\n  fabric.StaticCanvas.prototype.toJSON = fabric.StaticCanvas.prototype.toObject;\r\n\r\n})();\r\n\r\n\r\n/**\r\n * BaseBrush class\r\n * @class fabric.BaseBrush\r\n * @see {@link http://fabricjs.com/freedrawing/|Freedrawing demo}\r\n */\r\nfabric.BaseBrush = fabric.util.createClass(/** @lends fabric.BaseBrush.prototype */ {\r\n\r\n  /**\r\n   * Color of a brush\r\n   * @type String\r\n   * @default\r\n   */\r\n  color:            'rgb(0, 0, 0)',\r\n\r\n  /**\r\n   * Width of a brush\r\n   * @type Number\r\n   * @default\r\n   */\r\n  width:            1,\r\n\r\n  /**\r\n   * Shadow object representing shadow of this shape.\r\n   * <b>Backwards incompatibility note:</b> This property replaces \"shadowColor\" (String), \"shadowOffsetX\" (Number),\r\n   * \"shadowOffsetY\" (Number) and \"shadowBlur\" (Number) since v1.2.12\r\n   * @type fabric.Shadow\r\n   * @default\r\n   */\r\n  shadow:          null,\r\n\r\n  /**\r\n   * Line endings style of a brush (one of \"butt\", \"round\", \"square\")\r\n   * @type String\r\n   * @default\r\n   */\r\n  strokeLineCap:    'round',\r\n\r\n  /**\r\n   * Corner style of a brush (one of \"bevil\", \"round\", \"miter\")\r\n   * @type String\r\n   * @default\r\n   */\r\n  strokeLineJoin:   'round',\r\n\r\n  /**\r\n   * Stroke Dash Array.\r\n   * @type Array\r\n   * @default\r\n   */\r\n  strokeDashArray:   null,\r\n\r\n  /**\r\n   * Sets shadow of an object\r\n   * @param {Object|String} [options] Options object or string (e.g. \"2px 2px 10px rgba(0,0,0,0.2)\")\r\n   * @return {fabric.Object} thisArg\r\n   * @chainable\r\n   */\r\n  setShadow: function(options) {\r\n    this.shadow = new fabric.Shadow(options);\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Sets brush styles\r\n   * @private\r\n   */\r\n  _setBrushStyles: function() {\r\n    var ctx = this.canvas.contextTop;\r\n\r\n    ctx.strokeStyle = this.color;\r\n    ctx.lineWidth = this.width;\r\n    ctx.lineCap = this.strokeLineCap;\r\n    ctx.lineJoin = this.strokeLineJoin;\r\n    if (this.strokeDashArray && fabric.StaticCanvas.supports('setLineDash')) {\r\n      ctx.setLineDash(this.strokeDashArray);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Sets brush shadow styles\r\n   * @private\r\n   */\r\n  _setShadow: function() {\r\n    if (!this.shadow) {\r\n      return;\r\n    }\r\n\r\n    var ctx = this.canvas.contextTop;\r\n\r\n    ctx.shadowColor = this.shadow.color;\r\n    ctx.shadowBlur = this.shadow.blur;\r\n    ctx.shadowOffsetX = this.shadow.offsetX;\r\n    ctx.shadowOffsetY = this.shadow.offsetY;\r\n  },\r\n\r\n  /**\r\n   * Removes brush shadow styles\r\n   * @private\r\n   */\r\n  _resetShadow: function() {\r\n    var ctx = this.canvas.contextTop;\r\n\r\n    ctx.shadowColor = '';\r\n    ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\r\n  }\r\n});\r\n\r\n\r\n(function() {\r\n\r\n  /**\r\n   * PencilBrush class\r\n   * @class fabric.PencilBrush\r\n   * @extends fabric.BaseBrush\r\n   */\r\n  fabric.PencilBrush = fabric.util.createClass(fabric.BaseBrush, /** @lends fabric.PencilBrush.prototype */ {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {fabric.Canvas} canvas\r\n     * @return {fabric.PencilBrush} Instance of a pencil brush\r\n     */\r\n    initialize: function(canvas) {\r\n      this.canvas = canvas;\r\n      this._points = [ ];\r\n    },\r\n\r\n    /**\r\n     * Inovoked on mouse down\r\n     * @param {Object} pointer\r\n     */\r\n    onMouseDown: function(pointer) {\r\n      this._prepareForDrawing(pointer);\r\n      // capture coordinates immediately\r\n      // this allows to draw dots (when movement never occurs)\r\n      this._captureDrawingPath(pointer);\r\n      this._render();\r\n    },\r\n\r\n    /**\r\n     * Inovoked on mouse move\r\n     * @param {Object} pointer\r\n     */\r\n    onMouseMove: function(pointer) {\r\n      this._captureDrawingPath(pointer);\r\n      // redraw curve\r\n      // clear top canvas\r\n      this.canvas.clearContext(this.canvas.contextTop);\r\n      this._render();\r\n    },\r\n\r\n    /**\r\n     * Invoked on mouse up\r\n     */\r\n    onMouseUp: function() {\r\n      this._finalizeAndAddPath();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} pointer Actual mouse position related to the canvas.\r\n     */\r\n    _prepareForDrawing: function(pointer) {\r\n\r\n      var p = new fabric.Point(pointer.x, pointer.y);\r\n\r\n      this._reset();\r\n      this._addPoint(p);\r\n\r\n      this.canvas.contextTop.moveTo(p.x, p.y);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {fabric.Point} point Point to be added to points array\r\n     */\r\n    _addPoint: function(point) {\r\n      this._points.push(point);\r\n    },\r\n\r\n    /**\r\n     * Clear points array and set contextTop canvas style.\r\n     * @private\r\n     */\r\n    _reset: function() {\r\n      this._points.length = 0;\r\n\r\n      this._setBrushStyles();\r\n      this._setShadow();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} pointer Actual mouse position related to the canvas.\r\n     */\r\n    _captureDrawingPath: function(pointer) {\r\n      var pointerPoint = new fabric.Point(pointer.x, pointer.y);\r\n      this._addPoint(pointerPoint);\r\n    },\r\n\r\n    /**\r\n     * Draw a smooth path on the topCanvas using quadraticCurveTo\r\n     * @private\r\n     */\r\n    _render: function() {\r\n      var ctx  = this.canvas.contextTop,\r\n          v = this.canvas.viewportTransform,\r\n          p1 = this._points[0],\r\n          p2 = this._points[1];\r\n\r\n      ctx.save();\r\n      ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\r\n      ctx.beginPath();\r\n\r\n      //if we only have 2 points in the path and they are the same\r\n      //it means that the user only clicked the canvas without moving the mouse\r\n      //then we should be drawing a dot. A path isn't drawn between two identical dots\r\n      //that's why we set them apart a bit\r\n      if (this._points.length === 2 && p1.x === p2.x && p1.y === p2.y) {\r\n        p1.x -= 0.5;\r\n        p2.x += 0.5;\r\n      }\r\n      ctx.moveTo(p1.x, p1.y);\r\n\r\n      for (var i = 1, len = this._points.length; i < len; i++) {\r\n        // we pick the point between pi + 1 & pi + 2 as the\r\n        // end point and p1 as our control point.\r\n        var midPoint = p1.midPointFrom(p2);\r\n        ctx.quadraticCurveTo(p1.x, p1.y, midPoint.x, midPoint.y);\r\n\r\n        p1 = this._points[i];\r\n        p2 = this._points[i + 1];\r\n      }\r\n      // Draw last line as a straight line while\r\n      // we wait for the next point to be able to calculate\r\n      // the bezier control point\r\n      ctx.lineTo(p1.x, p1.y);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Converts points to SVG path\r\n     * @param {Array} points Array of points\r\n     * @param {Number} minX\r\n     * @param {Number} minY\r\n     * @return {String} SVG path\r\n     */\r\n    convertPointsToSVGPath: function(points) {\r\n      var path = [],\r\n          p1 = new fabric.Point(points[0].x, points[0].y),\r\n          p2 = new fabric.Point(points[1].x, points[1].y);\r\n\r\n      path.push('M ', points[0].x, ' ', points[0].y, ' ');\r\n      for (var i = 1, len = points.length; i < len; i++) {\r\n        var midPoint = p1.midPointFrom(p2);\r\n        // p1 is our bezier control point\r\n        // midpoint is our endpoint\r\n        // start point is p(i-1) value.\r\n        path.push('Q ', p1.x, ' ', p1.y, ' ', midPoint.x, ' ', midPoint.y, ' ');\r\n        p1 = new fabric.Point(points[i].x, points[i].y);\r\n        if ((i + 1) < points.length) {\r\n          p2 = new fabric.Point(points[i + 1].x, points[i + 1].y);\r\n        }\r\n      }\r\n      path.push('L ', p1.x, ' ', p1.y, ' ');\r\n      return path;\r\n    },\r\n\r\n    /**\r\n     * Creates fabric.Path object to add on canvas\r\n     * @param {String} pathData Path data\r\n     * @return {fabric.Path} Path to add on canvas\r\n     */\r\n    createPath: function(pathData) {\r\n      var path = new fabric.Path(pathData, {\r\n                   fill: null,\r\n                   stroke: this.color,\r\n                   strokeWidth: this.width,\r\n                   strokeLineCap: this.strokeLineCap,\r\n                   strokeLineJoin: this.strokeLineJoin,\r\n                   strokeDashArray: this.strokeDashArray,\r\n                   originX: 'center',\r\n                   originY: 'center'\r\n                 });\r\n\r\n      if (this.shadow) {\r\n        this.shadow.affectStroke = true;\r\n        path.setShadow(this.shadow);\r\n      }\r\n\r\n      return path;\r\n    },\r\n\r\n    /**\r\n     * On mouseup after drawing the path on contextTop canvas\r\n     * we use the points captured to create an new fabric path object\r\n     * and add it to the fabric canvas.\r\n     */\r\n    _finalizeAndAddPath: function() {\r\n      var ctx = this.canvas.contextTop;\r\n      ctx.closePath();\r\n\r\n      var pathData = this.convertPointsToSVGPath(this._points).join('');\r\n      if (pathData === 'M 0 0 Q 0 0 0 0 L 0 0') {\r\n        // do not create 0 width/height paths, as they are\r\n        // rendered inconsistently across browsers\r\n        // Firefox 4, for example, renders a dot,\r\n        // whereas Chrome 10 renders nothing\r\n        this.canvas.renderAll();\r\n        return;\r\n      }\r\n\r\n      var path = this.createPath(pathData);\r\n\r\n      this.canvas.add(path);\r\n      path.setCoords();\r\n\r\n      this.canvas.clearContext(this.canvas.contextTop);\r\n      this._resetShadow();\r\n      this.canvas.renderAll();\r\n\r\n      // fire event 'path' created\r\n      this.canvas.fire('path:created', { path: path });\r\n    }\r\n  });\r\n})();\r\n\r\n\r\n/**\r\n * CircleBrush class\r\n * @class fabric.CircleBrush\r\n */\r\nfabric.CircleBrush = fabric.util.createClass(fabric.BaseBrush, /** @lends fabric.CircleBrush.prototype */ {\r\n\r\n  /**\r\n   * Width of a brush\r\n   * @type Number\r\n   * @default\r\n   */\r\n  width: 10,\r\n\r\n  /**\r\n   * Constructor\r\n   * @param {fabric.Canvas} canvas\r\n   * @return {fabric.CircleBrush} Instance of a circle brush\r\n   */\r\n  initialize: function(canvas) {\r\n    this.canvas = canvas;\r\n    this.points = [ ];\r\n  },\r\n  /**\r\n  * Invoked inside on mouse down and mouse move\r\n  * @param {Object} pointer\r\n  */\r\n  drawDot: function(pointer) {\r\n    var point = this.addPoint(pointer),\r\n        ctx = this.canvas.contextTop,\r\n        v = this.canvas.viewportTransform;\r\n    ctx.save();\r\n    ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\r\n\r\n    ctx.fillStyle = point.fill;\r\n    ctx.beginPath();\r\n    ctx.arc(point.x, point.y, point.radius, 0, Math.PI * 2, false);\r\n    ctx.closePath();\r\n    ctx.fill();\r\n\r\n    ctx.restore();\r\n  },\r\n\r\n  /**\r\n   * Invoked on mouse down\r\n   */\r\n  onMouseDown: function(pointer) {\r\n    this.points.length = 0;\r\n    this.canvas.clearContext(this.canvas.contextTop);\r\n    this._setShadow();\r\n    this.drawDot(pointer);\r\n  },\r\n\r\n  /**\r\n   * Invoked on mouse move\r\n   * @param {Object} pointer\r\n   */\r\n  onMouseMove: function(pointer) {\r\n    this.drawDot(pointer);\r\n  },\r\n\r\n  /**\r\n   * Invoked on mouse up\r\n   */\r\n  onMouseUp: function() {\r\n    var originalRenderOnAddRemove = this.canvas.renderOnAddRemove;\r\n    this.canvas.renderOnAddRemove = false;\r\n\r\n    var circles = [ ];\r\n\r\n    for (var i = 0, len = this.points.length; i < len; i++) {\r\n      var point = this.points[i],\r\n          circle = new fabric.Circle({\r\n            radius: point.radius,\r\n            left: point.x,\r\n            top: point.y,\r\n            originX: 'center',\r\n            originY: 'center',\r\n            fill: point.fill\r\n          });\r\n\r\n      this.shadow && circle.setShadow(this.shadow);\r\n\r\n      circles.push(circle);\r\n    }\r\n    var group = new fabric.Group(circles, { originX: 'center', originY: 'center' });\r\n    group.canvas = this.canvas;\r\n\r\n    this.canvas.add(group);\r\n    this.canvas.fire('path:created', { path: group });\r\n\r\n    this.canvas.clearContext(this.canvas.contextTop);\r\n    this._resetShadow();\r\n    this.canvas.renderOnAddRemove = originalRenderOnAddRemove;\r\n    this.canvas.renderAll();\r\n  },\r\n\r\n  /**\r\n   * @param {Object} pointer\r\n   * @return {fabric.Point} Just added pointer point\r\n   */\r\n  addPoint: function(pointer) {\r\n    var pointerPoint = new fabric.Point(pointer.x, pointer.y),\r\n\r\n        circleRadius = fabric.util.getRandomInt(\r\n                        Math.max(0, this.width - 20), this.width + 20) / 2,\r\n\r\n        circleColor = new fabric.Color(this.color)\r\n                        .setAlpha(fabric.util.getRandomInt(0, 100) / 100)\r\n                        .toRgba();\r\n\r\n    pointerPoint.radius = circleRadius;\r\n    pointerPoint.fill = circleColor;\r\n\r\n    this.points.push(pointerPoint);\r\n\r\n    return pointerPoint;\r\n  }\r\n});\r\n\r\n\r\n/**\r\n * SprayBrush class\r\n * @class fabric.SprayBrush\r\n */\r\nfabric.SprayBrush = fabric.util.createClass( fabric.BaseBrush, /** @lends fabric.SprayBrush.prototype */ {\r\n\r\n  /**\r\n   * Width of a spray\r\n   * @type Number\r\n   * @default\r\n   */\r\n  width:              10,\r\n\r\n  /**\r\n   * Density of a spray (number of dots per chunk)\r\n   * @type Number\r\n   * @default\r\n   */\r\n  density:            20,\r\n\r\n  /**\r\n   * Width of spray dots\r\n   * @type Number\r\n   * @default\r\n   */\r\n  dotWidth:           1,\r\n\r\n  /**\r\n   * Width variance of spray dots\r\n   * @type Number\r\n   * @default\r\n   */\r\n  dotWidthVariance:   1,\r\n\r\n  /**\r\n   * Whether opacity of a dot should be random\r\n   * @type Boolean\r\n   * @default\r\n   */\r\n  randomOpacity:        false,\r\n\r\n  /**\r\n   * Whether overlapping dots (rectangles) should be removed (for performance reasons)\r\n   * @type Boolean\r\n   * @default\r\n   */\r\n  optimizeOverlapping:  true,\r\n\r\n  /**\r\n   * Constructor\r\n   * @param {fabric.Canvas} canvas\r\n   * @return {fabric.SprayBrush} Instance of a spray brush\r\n   */\r\n  initialize: function(canvas) {\r\n    this.canvas = canvas;\r\n    this.sprayChunks = [ ];\r\n  },\r\n\r\n  /**\r\n   * Invoked on mouse down\r\n   * @param {Object} pointer\r\n   */\r\n  onMouseDown: function(pointer) {\r\n    this.sprayChunks.length = 0;\r\n    this.canvas.clearContext(this.canvas.contextTop);\r\n    this._setShadow();\r\n\r\n    this.addSprayChunk(pointer);\r\n    this.render();\r\n  },\r\n\r\n  /**\r\n   * Invoked on mouse move\r\n   * @param {Object} pointer\r\n   */\r\n  onMouseMove: function(pointer) {\r\n    this.addSprayChunk(pointer);\r\n    this.render();\r\n  },\r\n\r\n  /**\r\n   * Invoked on mouse up\r\n   */\r\n  onMouseUp: function() {\r\n    var originalRenderOnAddRemove = this.canvas.renderOnAddRemove;\r\n    this.canvas.renderOnAddRemove = false;\r\n\r\n    var rects = [ ];\r\n\r\n    for (var i = 0, ilen = this.sprayChunks.length; i < ilen; i++) {\r\n      var sprayChunk = this.sprayChunks[i];\r\n\r\n      for (var j = 0, jlen = sprayChunk.length; j < jlen; j++) {\r\n\r\n        var rect = new fabric.Rect({\r\n          width: sprayChunk[j].width,\r\n          height: sprayChunk[j].width,\r\n          left: sprayChunk[j].x + 1,\r\n          top: sprayChunk[j].y + 1,\r\n          originX: 'center',\r\n          originY: 'center',\r\n          fill: this.color\r\n        });\r\n\r\n        this.shadow && rect.setShadow(this.shadow);\r\n        rects.push(rect);\r\n      }\r\n    }\r\n\r\n    if (this.optimizeOverlapping) {\r\n      rects = this._getOptimizedRects(rects);\r\n    }\r\n\r\n    var group = new fabric.Group(rects, { originX: 'center', originY: 'center' });\r\n    group.canvas = this.canvas;\r\n\r\n    this.canvas.add(group);\r\n    this.canvas.fire('path:created', { path: group });\r\n\r\n    this.canvas.clearContext(this.canvas.contextTop);\r\n    this._resetShadow();\r\n    this.canvas.renderOnAddRemove = originalRenderOnAddRemove;\r\n    this.canvas.renderAll();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {Array} rects\r\n   */\r\n  _getOptimizedRects: function(rects) {\r\n\r\n    // avoid creating duplicate rects at the same coordinates\r\n    var uniqueRects = { }, key;\r\n\r\n    for (var i = 0, len = rects.length; i < len; i++) {\r\n      key = rects[i].left + '' + rects[i].top;\r\n      if (!uniqueRects[key]) {\r\n        uniqueRects[key] = rects[i];\r\n      }\r\n    }\r\n    var uniqueRectsArray = [ ];\r\n    for (key in uniqueRects) {\r\n      uniqueRectsArray.push(uniqueRects[key]);\r\n    }\r\n\r\n    return uniqueRectsArray;\r\n  },\r\n\r\n  /**\r\n   * Renders brush\r\n   */\r\n  render: function() {\r\n    var ctx = this.canvas.contextTop;\r\n    ctx.fillStyle = this.color;\r\n\r\n    var v = this.canvas.viewportTransform;\r\n    ctx.save();\r\n    ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\r\n\r\n    for (var i = 0, len = this.sprayChunkPoints.length; i < len; i++) {\r\n      var point = this.sprayChunkPoints[i];\r\n      if (typeof point.opacity !== 'undefined') {\r\n        ctx.globalAlpha = point.opacity;\r\n      }\r\n      ctx.fillRect(point.x, point.y, point.width, point.width);\r\n    }\r\n    ctx.restore();\r\n  },\r\n\r\n  /**\r\n   * @param {Object} pointer\r\n   */\r\n  addSprayChunk: function(pointer) {\r\n    this.sprayChunkPoints = [ ];\r\n\r\n    var x, y, width, radius = this.width / 2;\r\n\r\n    for (var i = 0; i < this.density; i++) {\r\n\r\n      x = fabric.util.getRandomInt(pointer.x - radius, pointer.x + radius);\r\n      y = fabric.util.getRandomInt(pointer.y - radius, pointer.y + radius);\r\n\r\n      if (this.dotWidthVariance) {\r\n        width = fabric.util.getRandomInt(\r\n          // bottom clamp width to 1\r\n          Math.max(1, this.dotWidth - this.dotWidthVariance),\r\n          this.dotWidth + this.dotWidthVariance);\r\n      }\r\n      else {\r\n        width = this.dotWidth;\r\n      }\r\n\r\n      var point = new fabric.Point(x, y);\r\n      point.width = width;\r\n\r\n      if (this.randomOpacity) {\r\n        point.opacity = fabric.util.getRandomInt(0, 100) / 100;\r\n      }\r\n\r\n      this.sprayChunkPoints.push(point);\r\n    }\r\n\r\n    this.sprayChunks.push(this.sprayChunkPoints);\r\n  }\r\n});\r\n\r\n\r\n/**\r\n * PatternBrush class\r\n * @class fabric.PatternBrush\r\n * @extends fabric.BaseBrush\r\n */\r\nfabric.PatternBrush = fabric.util.createClass(fabric.PencilBrush, /** @lends fabric.PatternBrush.prototype */ {\r\n\r\n  getPatternSrc: function() {\r\n\r\n    var dotWidth = 20,\r\n        dotDistance = 5,\r\n        patternCanvas = fabric.document.createElement('canvas'),\r\n        patternCtx = patternCanvas.getContext('2d');\r\n\r\n    patternCanvas.width = patternCanvas.height = dotWidth + dotDistance;\r\n\r\n    patternCtx.fillStyle = this.color;\r\n    patternCtx.beginPath();\r\n    patternCtx.arc(dotWidth / 2, dotWidth / 2, dotWidth / 2, 0, Math.PI * 2, false);\r\n    patternCtx.closePath();\r\n    patternCtx.fill();\r\n\r\n    return patternCanvas;\r\n  },\r\n\r\n  getPatternSrcFunction: function() {\r\n    return String(this.getPatternSrc).replace('this.color', '\"' + this.color + '\"');\r\n  },\r\n\r\n  /**\r\n   * Creates \"pattern\" instance property\r\n   */\r\n  getPattern: function() {\r\n    return this.canvas.contextTop.createPattern(this.source || this.getPatternSrc(), 'repeat');\r\n  },\r\n\r\n  /**\r\n   * Sets brush styles\r\n   */\r\n  _setBrushStyles: function() {\r\n    this.callSuper('_setBrushStyles');\r\n    this.canvas.contextTop.strokeStyle = this.getPattern();\r\n  },\r\n\r\n  /**\r\n   * Creates path\r\n   */\r\n  createPath: function(pathData) {\r\n    var path = this.callSuper('createPath', pathData);\r\n    path.stroke = new fabric.Pattern({\r\n      source: this.source || this.getPatternSrcFunction()\r\n    });\r\n    return path;\r\n  }\r\n});\r\n\r\n\r\n(function() {\r\n\r\n  var getPointer = fabric.util.getPointer,\r\n      degreesToRadians = fabric.util.degreesToRadians,\r\n      radiansToDegrees = fabric.util.radiansToDegrees,\r\n      atan2 = Math.atan2,\r\n      abs = Math.abs,\r\n\r\n      STROKE_OFFSET = 0.5;\r\n\r\n  /**\r\n   * Canvas class\r\n   * @class fabric.Canvas\r\n   * @extends fabric.StaticCanvas\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1/#canvas}\r\n   * @see {@link fabric.Canvas#initialize} for constructor definition\r\n   *\r\n   * @fires object:modified\r\n   * @fires object:rotating\r\n   * @fires object:scaling\r\n   * @fires object:moving\r\n   * @fires object:selected\r\n   *\r\n   * @fires before:selection:cleared\r\n   * @fires selection:cleared\r\n   * @fires selection:created\r\n   *\r\n   * @fires path:created\r\n   * @fires mouse:down\r\n   * @fires mouse:move\r\n   * @fires mouse:up\r\n   * @fires mouse:over\r\n   * @fires mouse:out\r\n   *\r\n   */\r\n  fabric.Canvas = fabric.util.createClass(fabric.StaticCanvas, /** @lends fabric.Canvas.prototype */ {\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {HTMLElement | String} el &lt;canvas> element to initialize instance on\r\n     * @param {Object} [options] Options object\r\n     * @return {Object} thisArg\r\n     */\r\n    initialize: function(el, options) {\r\n      options || (options = { });\r\n\r\n      this._initStatic(el, options);\r\n      this._initInteractive();\r\n      this._createCacheCanvas();\r\n\r\n      fabric.Canvas.activeInstance = this;\r\n    },\r\n\r\n    /**\r\n     * When true, objects can be transformed by one side (unproportionally)\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    uniScaleTransform:      false,\r\n\r\n    /**\r\n     * When true, objects use center point as the origin of scale transformation.\r\n     * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\r\n     * @since 1.3.4\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    centeredScaling:        false,\r\n\r\n    /**\r\n     * When true, objects use center point as the origin of rotate transformation.\r\n     * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\r\n     * @since 1.3.4\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    centeredRotation:       false,\r\n\r\n    /**\r\n     * Indicates that canvas is interactive. This property should not be changed.\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    interactive:            true,\r\n\r\n    /**\r\n     * Indicates whether group selection should be enabled\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    selection:              true,\r\n\r\n    /**\r\n     * Color of selection\r\n     * @type String\r\n     * @default\r\n     */\r\n    selectionColor:         'rgba(100, 100, 255, 0.3)', // blue\r\n\r\n    /**\r\n     * Default dash array pattern\r\n     * If not empty the selection border is dashed\r\n     * @type Array\r\n     */\r\n    selectionDashArray:     [ ],\r\n\r\n    /**\r\n     * Color of the border of selection (usually slightly darker than color of selection itself)\r\n     * @type String\r\n     * @default\r\n     */\r\n    selectionBorderColor:   'rgba(255, 255, 255, 0.3)',\r\n\r\n    /**\r\n     * Width of a line used in object/group selection\r\n     * @type Number\r\n     * @default\r\n     */\r\n    selectionLineWidth:     1,\r\n\r\n    /**\r\n     * Default cursor value used when hovering over an object on canvas\r\n     * @type String\r\n     * @default\r\n     */\r\n    hoverCursor:            'move',\r\n\r\n    /**\r\n     * Default cursor value used when moving an object on canvas\r\n     * @type String\r\n     * @default\r\n     */\r\n    moveCursor:             'move',\r\n\r\n    /**\r\n     * Default cursor value used for the entire canvas\r\n     * @type String\r\n     * @default\r\n     */\r\n    defaultCursor:          'default',\r\n\r\n    /**\r\n     * Cursor value used during free drawing\r\n     * @type String\r\n     * @default\r\n     */\r\n    freeDrawingCursor:      'crosshair',\r\n\r\n    /**\r\n     * Cursor value used for rotation point\r\n     * @type String\r\n     * @default\r\n     */\r\n    rotationCursor:         'crosshair',\r\n\r\n    /**\r\n     * Default element class that's given to wrapper (div) element of canvas\r\n     * @type String\r\n     * @default\r\n     */\r\n    containerClass:         'canvas-container',\r\n\r\n    /**\r\n     * When true, object detection happens on per-pixel basis rather than on per-bounding-box\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    perPixelTargetFind:     false,\r\n\r\n    /**\r\n     * Number of pixels around target pixel to tolerate (consider active) during object detection\r\n     * @type Number\r\n     * @default\r\n     */\r\n    targetFindTolerance:    0,\r\n\r\n    /**\r\n     * When true, target detection is skipped when hovering over canvas. This can be used to improve performance.\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    skipTargetFind:         false,\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _initInteractive: function() {\r\n      this._currentTransform = null;\r\n      this._groupSelector = null;\r\n      this._initWrapperElement();\r\n      this._createUpperCanvas();\r\n      this._initEventListeners();\r\n\r\n      this.freeDrawingBrush = fabric.PencilBrush && new fabric.PencilBrush(this);\r\n\r\n      this.calcOffset();\r\n    },\r\n\r\n    /**\r\n     * Resets the current transform to its original values and chooses the type of resizing based on the event\r\n     * @private\r\n     * @param {Event} e Event object fired on mousemove\r\n     */\r\n    _resetCurrentTransform: function(e) {\r\n      var t = this._currentTransform;\r\n\r\n      t.target.set({\r\n        scaleX: t.original.scaleX,\r\n        scaleY: t.original.scaleY,\r\n        left: t.original.left,\r\n        top: t.original.top\r\n      });\r\n\r\n      if (this._shouldCenterTransform(e, t.target)) {\r\n        if (t.action === 'rotate') {\r\n          this._setOriginToCenter(t.target);\r\n        }\r\n        else {\r\n          if (t.originX !== 'center') {\r\n            if (t.originX === 'right') {\r\n              t.mouseXSign = -1;\r\n            }\r\n            else {\r\n              t.mouseXSign = 1;\r\n            }\r\n          }\r\n          if (t.originY !== 'center') {\r\n            if (t.originY === 'bottom') {\r\n              t.mouseYSign = -1;\r\n            }\r\n            else {\r\n              t.mouseYSign = 1;\r\n            }\r\n          }\r\n\r\n          t.originX = 'center';\r\n          t.originY = 'center';\r\n        }\r\n      }\r\n      else {\r\n        t.originX = t.original.originX;\r\n        t.originY = t.original.originY;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Checks if point is contained within an area of given object\r\n     * @param {Event} e Event object\r\n     * @param {fabric.Object} target Object to test against\r\n     * @return {Boolean} true if point is contained within an area of given object\r\n     */\r\n    containsPoint: function (e, target) {\r\n      var pointer = this.getPointer(e, true),\r\n          xy = this._normalizePointer(target, pointer);\r\n\r\n      // http://www.geog.ubc.ca/courses/klink/gis.notes/ncgia/u32.html\r\n      // http://idav.ucdavis.edu/~okreylos/TAship/Spring2000/PointInPolygon.html\r\n      return (target.containsPoint(xy) || target._findTargetCorner(pointer));\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _normalizePointer: function (object, pointer) {\r\n      var activeGroup = this.getActiveGroup(),\r\n          x = pointer.x,\r\n          y = pointer.y,\r\n          isObjectInGroup = (\r\n            activeGroup &&\r\n            object.type !== 'group' &&\r\n            activeGroup.contains(object)),\r\n          lt;\r\n\r\n      if (isObjectInGroup) {\r\n        lt = new fabric.Point(activeGroup.left, activeGroup.top);\r\n        lt = fabric.util.transformPoint(lt, this.viewportTransform, true);\r\n        x -= lt.x;\r\n        y -= lt.y;\r\n      }\r\n      return { x: x, y: y };\r\n    },\r\n\r\n    /**\r\n     * Returns true if object is transparent at a certain location\r\n     * @param {fabric.Object} target Object to check\r\n     * @param {Number} x Left coordinate\r\n     * @param {Number} y Top coordinate\r\n     * @return {Boolean}\r\n     */\r\n    isTargetTransparent: function (target, x, y) {\r\n      var hasBorders = target.hasBorders,\r\n          transparentCorners = target.transparentCorners;\r\n\r\n      target.hasBorders = target.transparentCorners = false;\r\n\r\n      this._draw(this.contextCache, target);\r\n\r\n      target.hasBorders = hasBorders;\r\n      target.transparentCorners = transparentCorners;\r\n\r\n      var isTransparent = fabric.util.isTransparent(\r\n        this.contextCache, x, y, this.targetFindTolerance);\r\n\r\n      this.clearContext(this.contextCache);\r\n\r\n      return isTransparent;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object\r\n     * @param {fabric.Object} target\r\n     */\r\n    _shouldClearSelection: function (e, target) {\r\n      var activeGroup = this.getActiveGroup(),\r\n          activeObject = this.getActiveObject();\r\n\r\n      return (\r\n        !target\r\n        ||\r\n        (target &&\r\n          activeGroup &&\r\n          !activeGroup.contains(target) &&\r\n          activeGroup !== target &&\r\n          !e.shiftKey)\r\n        ||\r\n        (target && !target.evented)\r\n        ||\r\n        (target &&\r\n          !target.selectable &&\r\n          activeObject &&\r\n          activeObject !== target)\r\n      );\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object\r\n     * @param {fabric.Object} target\r\n     */\r\n    _shouldCenterTransform: function (e, target) {\r\n      if (!target) {\r\n        return;\r\n      }\r\n\r\n      var t = this._currentTransform,\r\n          centerTransform;\r\n\r\n      if (t.action === 'scale' || t.action === 'scaleX' || t.action === 'scaleY') {\r\n        centerTransform = this.centeredScaling || target.centeredScaling;\r\n      }\r\n      else if (t.action === 'rotate') {\r\n        centerTransform = this.centeredRotation || target.centeredRotation;\r\n      }\r\n\r\n      return centerTransform ? !e.altKey : e.altKey;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getOriginFromCorner: function(target, corner) {\r\n      var origin = {\r\n        x: target.originX,\r\n        y: target.originY\r\n      };\r\n\r\n      if (corner === 'ml' || corner === 'tl' || corner === 'bl') {\r\n        origin.x = 'right';\r\n      }\r\n      else if (corner === 'mr' || corner === 'tr' || corner === 'br') {\r\n        origin.x = 'left';\r\n      }\r\n\r\n      if (corner === 'tl' || corner === 'mt' || corner === 'tr') {\r\n        origin.y = 'bottom';\r\n      }\r\n      else if (corner === 'bl' || corner === 'mb' || corner === 'br') {\r\n        origin.y = 'top';\r\n      }\r\n\r\n      return origin;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getActionFromCorner: function(target, corner) {\r\n      var action = 'drag';\r\n      if (corner) {\r\n        action = (corner === 'ml' || corner === 'mr')\r\n          ? 'scaleX'\r\n          : (corner === 'mt' || corner === 'mb')\r\n            ? 'scaleY'\r\n            : corner === 'mtr'\r\n              ? 'rotate'\r\n              : 'scale';\r\n      }\r\n      return action;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object\r\n     * @param {fabric.Object} target\r\n     */\r\n    _setupCurrentTransform: function (e, target) {\r\n      if (!target) {\r\n        return;\r\n      }\r\n\r\n      var pointer = this.getPointer(e),\r\n          corner = target._findTargetCorner(this.getPointer(e, true)),\r\n          action = this._getActionFromCorner(target, corner),\r\n          origin = this._getOriginFromCorner(target, corner);\r\n\r\n      this._currentTransform = {\r\n        target: target,\r\n        action: action,\r\n        scaleX: target.scaleX,\r\n        scaleY: target.scaleY,\r\n        offsetX: pointer.x - target.left,\r\n        offsetY: pointer.y - target.top,\r\n        originX: origin.x,\r\n        originY: origin.y,\r\n        ex: pointer.x,\r\n        ey: pointer.y,\r\n        left: target.left,\r\n        top: target.top,\r\n        theta: degreesToRadians(target.angle),\r\n        width: target.width * target.scaleX,\r\n        mouseXSign: 1,\r\n        mouseYSign: 1\r\n      };\r\n\r\n      this._currentTransform.original = {\r\n        left: target.left,\r\n        top: target.top,\r\n        scaleX: target.scaleX,\r\n        scaleY: target.scaleY,\r\n        originX: origin.x,\r\n        originY: origin.y\r\n      };\r\n\r\n      this._resetCurrentTransform(e);\r\n    },\r\n\r\n    /**\r\n     * Translates object by \"setting\" its left/top\r\n     * @private\r\n     * @param {Number} x pointer's x coordinate\r\n     * @param {Number} y pointer's y coordinate\r\n     */\r\n    _translateObject: function (x, y) {\r\n      var target = this._currentTransform.target;\r\n\r\n      if (!target.get('lockMovementX')) {\r\n        target.set('left', x - this._currentTransform.offsetX);\r\n      }\r\n      if (!target.get('lockMovementY')) {\r\n        target.set('top', y - this._currentTransform.offsetY);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Scales object by invoking its scaleX/scaleY methods\r\n     * @private\r\n     * @param {Number} x pointer's x coordinate\r\n     * @param {Number} y pointer's y coordinate\r\n     * @param {String} by Either 'x' or 'y' - specifies dimension constraint by which to scale an object.\r\n     *                    When not provided, an object is scaled by both dimensions equally\r\n     */\r\n    _scaleObject: function (x, y, by) {\r\n      var t = this._currentTransform,\r\n          target = t.target,\r\n          lockScalingX = target.get('lockScalingX'),\r\n          lockScalingY = target.get('lockScalingY'),\r\n          lockScalingFlip = target.get('lockScalingFlip');\r\n\r\n      if (lockScalingX && lockScalingY) {\r\n        return;\r\n      }\r\n\r\n      // Get the constraint point\r\n      var constraintPosition = target.translateToOriginPoint(target.getCenterPoint(), t.originX, t.originY),\r\n          localMouse = target.toLocalPoint(new fabric.Point(x, y), t.originX, t.originY);\r\n\r\n      this._setLocalMouse(localMouse, t);\r\n\r\n      // Actually scale the object\r\n      this._setObjectScale(localMouse, t, lockScalingX, lockScalingY, by, lockScalingFlip);\r\n\r\n      // Make sure the constraints apply\r\n      target.setPositionByOrigin(constraintPosition, t.originX, t.originY);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setObjectScale: function(localMouse, transform, lockScalingX, lockScalingY, by, lockScalingFlip) {\r\n      var target = transform.target, forbidScalingX = false, forbidScalingY = false,\r\n          strokeWidth = target.stroke ? target.strokeWidth : 0;\r\n\r\n      transform.newScaleX = localMouse.x / (target.width + strokeWidth / 2);\r\n      transform.newScaleY = localMouse.y / (target.height + strokeWidth / 2);\r\n\r\n      if (lockScalingFlip && transform.newScaleX <= 0 && transform.newScaleX < target.scaleX) {\r\n        forbidScalingX = true;\r\n      }\r\n\r\n      if (lockScalingFlip && transform.newScaleY <= 0 && transform.newScaleY < target.scaleY) {\r\n        forbidScalingY = true;\r\n      }\r\n\r\n      if (by === 'equally' && !lockScalingX && !lockScalingY) {\r\n        forbidScalingX || forbidScalingY || this._scaleObjectEqually(localMouse, target, transform);\r\n      }\r\n      else if (!by) {\r\n        forbidScalingX || lockScalingX || target.set('scaleX', transform.newScaleX);\r\n        forbidScalingY || lockScalingY || target.set('scaleY', transform.newScaleY);\r\n      }\r\n      else if (by === 'x' && !target.get('lockUniScaling')) {\r\n        forbidScalingX || lockScalingX || target.set('scaleX', transform.newScaleX);\r\n      }\r\n      else if (by === 'y' && !target.get('lockUniScaling')) {\r\n        forbidScalingY || lockScalingY || target.set('scaleY', transform.newScaleY);\r\n      }\r\n\r\n      forbidScalingX || forbidScalingY || this._flipObject(transform, by);\r\n\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _scaleObjectEqually: function(localMouse, target, transform) {\r\n\r\n      var dist = localMouse.y + localMouse.x,\r\n          strokeWidth = target.stroke ? target.strokeWidth : 0,\r\n          lastDist = (target.height + (strokeWidth / 2)) * transform.original.scaleY +\r\n                     (target.width + (strokeWidth / 2)) * transform.original.scaleX;\r\n\r\n      // We use transform.scaleX/Y instead of target.scaleX/Y\r\n      // because the object may have a min scale and we'll loose the proportions\r\n      transform.newScaleX = transform.original.scaleX * dist / lastDist;\r\n      transform.newScaleY = transform.original.scaleY * dist / lastDist;\r\n\r\n      target.set('scaleX', transform.newScaleX);\r\n      target.set('scaleY', transform.newScaleY);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _flipObject: function(transform, by) {\r\n      if (transform.newScaleX < 0 && by !== 'y') {\r\n        if (transform.originX === 'left') {\r\n          transform.originX = 'right';\r\n        }\r\n        else if (transform.originX === 'right') {\r\n          transform.originX = 'left';\r\n        }\r\n      }\r\n\r\n      if (transform.newScaleY < 0 && by !== 'x') {\r\n        if (transform.originY === 'top') {\r\n          transform.originY = 'bottom';\r\n        }\r\n        else if (transform.originY === 'bottom') {\r\n          transform.originY = 'top';\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setLocalMouse: function(localMouse, t) {\r\n      var target = t.target;\r\n\r\n      if (t.originX === 'right') {\r\n        localMouse.x *= -1;\r\n      }\r\n      else if (t.originX === 'center') {\r\n        localMouse.x *= t.mouseXSign * 2;\r\n\r\n        if (localMouse.x < 0) {\r\n          t.mouseXSign = -t.mouseXSign;\r\n        }\r\n      }\r\n\r\n      if (t.originY === 'bottom') {\r\n        localMouse.y *= -1;\r\n      }\r\n      else if (t.originY === 'center') {\r\n        localMouse.y *= t.mouseYSign * 2;\r\n\r\n        if (localMouse.y < 0) {\r\n          t.mouseYSign = -t.mouseYSign;\r\n        }\r\n      }\r\n\r\n      // adjust the mouse coordinates when dealing with padding\r\n      if (abs(localMouse.x) > target.padding) {\r\n        if (localMouse.x < 0) {\r\n          localMouse.x += target.padding;\r\n        }\r\n        else {\r\n          localMouse.x -= target.padding;\r\n        }\r\n      }\r\n      else { // mouse is within the padding, set to 0\r\n        localMouse.x = 0;\r\n      }\r\n\r\n      if (abs(localMouse.y) > target.padding) {\r\n        if (localMouse.y < 0) {\r\n          localMouse.y += target.padding;\r\n        }\r\n        else {\r\n          localMouse.y -= target.padding;\r\n        }\r\n      }\r\n      else {\r\n        localMouse.y = 0;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Rotates object by invoking its rotate method\r\n     * @private\r\n     * @param {Number} x pointer's x coordinate\r\n     * @param {Number} y pointer's y coordinate\r\n     */\r\n    _rotateObject: function (x, y) {\r\n\r\n      var t = this._currentTransform;\r\n\r\n      if (t.target.get('lockRotation')) {\r\n        return;\r\n      }\r\n\r\n      var lastAngle = atan2(t.ey - t.top, t.ex - t.left),\r\n          curAngle = atan2(y - t.top, x - t.left),\r\n          angle = radiansToDegrees(curAngle - lastAngle + t.theta);\r\n\r\n      // normalize angle to positive value\r\n      if (angle < 0) {\r\n        angle = 360 + angle;\r\n      }\r\n\r\n      t.target.angle = angle % 360;\r\n    },\r\n\r\n    /**\r\n     * Set the cursor type of the canvas element\r\n     * @param {String} value Cursor type of the canvas element.\r\n     * @see http://www.w3.org/TR/css3-ui/#cursor\r\n     */\r\n    setCursor: function (value) {\r\n      this.upperCanvasEl.style.cursor = value;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _resetObjectTransform: function (target) {\r\n      target.scaleX = 1;\r\n      target.scaleY = 1;\r\n      target.setAngle(0);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _drawSelection: function () {\r\n      var ctx = this.contextTop,\r\n          groupSelector = this._groupSelector,\r\n          left = groupSelector.left,\r\n          top = groupSelector.top,\r\n          aleft = abs(left),\r\n          atop = abs(top);\r\n\r\n      ctx.fillStyle = this.selectionColor;\r\n\r\n      ctx.fillRect(\r\n        groupSelector.ex - ((left > 0) ? 0 : -left),\r\n        groupSelector.ey - ((top > 0) ? 0 : -top),\r\n        aleft,\r\n        atop\r\n      );\r\n\r\n      ctx.lineWidth = this.selectionLineWidth;\r\n      ctx.strokeStyle = this.selectionBorderColor;\r\n\r\n      // selection border\r\n      if (this.selectionDashArray.length > 1) {\r\n\r\n        var px = groupSelector.ex + STROKE_OFFSET - ((left > 0) ? 0: aleft),\r\n            py = groupSelector.ey + STROKE_OFFSET - ((top > 0) ? 0: atop);\r\n\r\n        ctx.beginPath();\r\n\r\n        fabric.util.drawDashedLine(ctx, px, py, px + aleft, py, this.selectionDashArray);\r\n        fabric.util.drawDashedLine(ctx, px, py + atop - 1, px + aleft, py + atop - 1, this.selectionDashArray);\r\n        fabric.util.drawDashedLine(ctx, px, py, px, py + atop, this.selectionDashArray);\r\n        fabric.util.drawDashedLine(ctx, px + aleft - 1, py, px + aleft - 1, py + atop, this.selectionDashArray);\r\n\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n      }\r\n      else {\r\n        ctx.strokeRect(\r\n          groupSelector.ex + STROKE_OFFSET - ((left > 0) ? 0 : aleft),\r\n          groupSelector.ey + STROKE_OFFSET - ((top > 0) ? 0 : atop),\r\n          aleft,\r\n          atop\r\n        );\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _isLastRenderedObject: function(e) {\r\n      return (\r\n        this.controlsAboveOverlay &&\r\n        this.lastRenderedObjectWithControlsAboveOverlay &&\r\n        this.lastRenderedObjectWithControlsAboveOverlay.visible &&\r\n        this.containsPoint(e, this.lastRenderedObjectWithControlsAboveOverlay) &&\r\n        this.lastRenderedObjectWithControlsAboveOverlay._findTargetCorner(this.getPointer(e, true)));\r\n    },\r\n\r\n    /**\r\n     * Method that determines what object we are clicking on\r\n     * @param {Event} e mouse event\r\n     * @param {Boolean} skipGroup when true, group is skipped and only objects are traversed through\r\n     */\r\n    findTarget: function (e, skipGroup) {\r\n      if (this.skipTargetFind) {\r\n        return;\r\n      }\r\n\r\n      if (this._isLastRenderedObject(e)) {\r\n        return this.lastRenderedObjectWithControlsAboveOverlay;\r\n      }\r\n\r\n      // first check current group (if one exists)\r\n      var activeGroup = this.getActiveGroup();\r\n      if (activeGroup && !skipGroup && this.containsPoint(e, activeGroup)) {\r\n        return activeGroup;\r\n      }\r\n\r\n      var target = this._searchPossibleTargets(e);\r\n      this._fireOverOutEvents(target);\r\n\r\n      return target;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _fireOverOutEvents: function(target) {\r\n      if (target) {\r\n        if (this._hoveredTarget !== target) {\r\n          this.fire('mouse:over', { target: target });\r\n          target.fire('mouseover');\r\n          if (this._hoveredTarget) {\r\n            this.fire('mouse:out', { target: this._hoveredTarget });\r\n            this._hoveredTarget.fire('mouseout');\r\n          }\r\n          this._hoveredTarget = target;\r\n        }\r\n      }\r\n      else if (this._hoveredTarget) {\r\n        this.fire('mouse:out', { target: this._hoveredTarget });\r\n        this._hoveredTarget.fire('mouseout');\r\n        this._hoveredTarget = null;\r\n      }\r\n    },\r\n\r\n    /**\r\n    * @private\r\n    */\r\n    _checkTarget: function(e, obj, pointer) {\r\n      if (obj &&\r\n          obj.visible &&\r\n          obj.evented &&\r\n          this.containsPoint(e, obj)){\r\n        if ((this.perPixelTargetFind || obj.perPixelTargetFind) && !obj.isEditing) {\r\n          var isTransparent = this.isTargetTransparent(obj, pointer.x, pointer.y);\r\n          if (!isTransparent) {\r\n            return true;\r\n          }\r\n        }\r\n        else {\r\n          return true;\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _searchPossibleTargets: function(e) {\r\n\r\n      // Cache all targets where their bounding box contains point.\r\n      var target,\r\n          pointer = this.getPointer(e, true),\r\n          i = this._objects.length;\r\n      // Do not check for currently grouped objects, since we check the parent group itself.\r\n      while (i--) {\r\n        if (!this._objects[i].group && this._checkTarget(e, this._objects[i], pointer)){\r\n          this.relatedTarget = this._objects[i];\r\n          target = this._objects[i];\r\n          break;\r\n        }\r\n      }\r\n\r\n      return target;\r\n    },\r\n\r\n    /**\r\n     * Returns pointer coordinates relative to canvas.\r\n     * @param {Event} e\r\n     * @return {Object} object with \"x\" and \"y\" number values\r\n     */\r\n    getPointer: function (e, ignoreZoom, upperCanvasEl) {\r\n      if (!upperCanvasEl) {\r\n        upperCanvasEl = this.upperCanvasEl;\r\n      }\r\n      var pointer = getPointer(e, upperCanvasEl),\r\n          bounds = upperCanvasEl.getBoundingClientRect(),\r\n          boundsWidth = bounds.width || 0,\r\n          boundsHeight = bounds.height || 0,\r\n          cssScale;\r\n\r\n      if (!boundsWidth || !boundsHeight ) {\r\n        if ('top' in bounds && 'bottom' in bounds) {\r\n          boundsHeight = Math.abs( bounds.top - bounds.bottom );\r\n        }\r\n        if ('right' in bounds && 'left' in bounds) {\r\n          boundsWidth = Math.abs( bounds.right - bounds.left );\r\n        }\r\n      }\r\n\r\n      this.calcOffset();\r\n\r\n      pointer.x = pointer.x - this._offset.left;\r\n      pointer.y = pointer.y - this._offset.top;\r\n      if (!ignoreZoom) {\r\n        pointer = fabric.util.transformPoint(\r\n          pointer,\r\n          fabric.util.invertTransform(this.viewportTransform)\r\n        );\r\n      }\r\n\r\n      if (boundsWidth === 0 || boundsHeight === 0) {\r\n        // If bounds are not available (i.e. not visible), do not apply scale.\r\n        cssScale = { width: 1, height: 1 };\r\n      }\r\n      else {\r\n        cssScale = {\r\n          width: upperCanvasEl.width / boundsWidth,\r\n          height: upperCanvasEl.height / boundsHeight\r\n        };\r\n      }\r\n\r\n      return {\r\n        x: pointer.x * cssScale.width,\r\n        y: pointer.y * cssScale.height\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @throws {CANVAS_INIT_ERROR} If canvas can not be initialized\r\n     */\r\n    _createUpperCanvas: function () {\r\n      var lowerCanvasClass = this.lowerCanvasEl.className.replace(/\\s*lower-canvas\\s*/, '');\r\n\r\n      this.upperCanvasEl = this._createCanvasElement();\r\n      fabric.util.addClass(this.upperCanvasEl, 'upper-canvas ' + lowerCanvasClass);\r\n\r\n      this.wrapperEl.appendChild(this.upperCanvasEl);\r\n\r\n      this._copyCanvasStyle(this.lowerCanvasEl, this.upperCanvasEl);\r\n      this._applyCanvasStyle(this.upperCanvasEl);\r\n      this.contextTop = this.upperCanvasEl.getContext('2d');\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _createCacheCanvas: function () {\r\n      this.cacheCanvasEl = this._createCanvasElement();\r\n      this.cacheCanvasEl.setAttribute('width', this.width);\r\n      this.cacheCanvasEl.setAttribute('height', this.height);\r\n      this.contextCache = this.cacheCanvasEl.getContext('2d');\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _initWrapperElement: function () {\r\n      this.wrapperEl = fabric.util.wrapElement(this.lowerCanvasEl, 'div', {\r\n        'class': this.containerClass\r\n      });\r\n      fabric.util.setStyle(this.wrapperEl, {\r\n        width: this.getWidth() + 'px',\r\n        height: this.getHeight() + 'px',\r\n        position: 'relative'\r\n      });\r\n      fabric.util.makeElementUnselectable(this.wrapperEl);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {HTMLElement} element canvas element to apply styles on\r\n     */\r\n    _applyCanvasStyle: function (element) {\r\n      var width = this.getWidth() || element.width,\r\n          height = this.getHeight() || element.height;\r\n\r\n      fabric.util.setStyle(element, {\r\n        position: 'absolute',\r\n        width: width + 'px',\r\n        height: height + 'px',\r\n        left: 0,\r\n        top: 0\r\n      });\r\n      element.width = width;\r\n      element.height = height;\r\n      fabric.util.makeElementUnselectable(element);\r\n    },\r\n\r\n    /**\r\n     * Copys the the entire inline style from one element (fromEl) to another (toEl)\r\n     * @private\r\n     * @param {Element} fromEl Element style is copied from\r\n     * @param {Element} toEl Element copied style is applied to\r\n     */\r\n    _copyCanvasStyle: function (fromEl, toEl) {\r\n      toEl.style.cssText = fromEl.style.cssText;\r\n    },\r\n\r\n    /**\r\n     * Returns context of canvas where object selection is drawn\r\n     * @return {CanvasRenderingContext2D}\r\n     */\r\n    getSelectionContext: function() {\r\n      return this.contextTop;\r\n    },\r\n\r\n    /**\r\n     * Returns &lt;canvas> element on which object selection is drawn\r\n     * @return {HTMLCanvasElement}\r\n     */\r\n    getSelectionElement: function () {\r\n      return this.upperCanvasEl;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} object\r\n     */\r\n    _setActiveObject: function(object) {\r\n      if (this._activeObject) {\r\n        this._activeObject.set('active', false);\r\n      }\r\n      this._activeObject = object;\r\n      object.set('active', true);\r\n    },\r\n\r\n    /**\r\n     * Sets given object as the only active object on canvas\r\n     * @param {fabric.Object} object Object to set as an active one\r\n     * @param {Event} [e] Event (passed along when firing \"object:selected\")\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    setActiveObject: function (object, e) {\r\n      this._setActiveObject(object);\r\n      this.renderAll();\r\n      this.fire('object:selected', { target: object, e: e });\r\n      object.fire('selected', { e: e });\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns currently active object\r\n     * @return {fabric.Object} active object\r\n     */\r\n    getActiveObject: function () {\r\n      return this._activeObject;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _discardActiveObject: function() {\r\n      if (this._activeObject) {\r\n        this._activeObject.set('active', false);\r\n      }\r\n      this._activeObject = null;\r\n    },\r\n\r\n    /**\r\n     * Discards currently active object\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    discardActiveObject: function (e) {\r\n      this._discardActiveObject();\r\n      this.renderAll();\r\n      this.fire('selection:cleared', { e: e });\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {fabric.Group} group\r\n     */\r\n    _setActiveGroup: function(group) {\r\n      this._activeGroup = group;\r\n      if (group) {\r\n        group.set('active', true);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Sets active group to a speicified one\r\n     * @param {fabric.Group} group Group to set as a current one\r\n     * @return {fabric.Canvas} thisArg\r\n     * @chainable\r\n     */\r\n    setActiveGroup: function (group, e) {\r\n      this._setActiveGroup(group);\r\n      if (group) {\r\n        this.fire('object:selected', { target: group, e: e });\r\n        group.fire('selected', { e: e });\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns currently active group\r\n     * @return {fabric.Group} Current group\r\n     */\r\n    getActiveGroup: function () {\r\n      return this._activeGroup;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _discardActiveGroup: function() {\r\n      var g = this.getActiveGroup();\r\n      if (g) {\r\n        g.destroy();\r\n      }\r\n      this.setActiveGroup(null);\r\n    },\r\n\r\n    /**\r\n     * Discards currently active group\r\n     * @return {fabric.Canvas} thisArg\r\n     */\r\n    discardActiveGroup: function (e) {\r\n      this._discardActiveGroup();\r\n      this.fire('selection:cleared', { e: e });\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Deactivates all objects on canvas, removing any active group or object\r\n     * @return {fabric.Canvas} thisArg\r\n     */\r\n    deactivateAll: function () {\r\n      var allObjects = this.getObjects(),\r\n          i = 0,\r\n          len = allObjects.length;\r\n      for ( ; i < len; i++) {\r\n        allObjects[i].set('active', false);\r\n      }\r\n      this._discardActiveGroup();\r\n      this._discardActiveObject();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Deactivates all objects and dispatches appropriate events\r\n     * @return {fabric.Canvas} thisArg\r\n     */\r\n    deactivateAllWithDispatch: function (e) {\r\n      var activeObject = this.getActiveGroup() || this.getActiveObject();\r\n      if (activeObject) {\r\n        this.fire('before:selection:cleared', { target: activeObject, e: e });\r\n      }\r\n      this.deactivateAll();\r\n      if (activeObject) {\r\n        this.fire('selection:cleared', { e: e });\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Draws objects' controls (borders/controls)\r\n     * @param {CanvasRenderingContext2D} ctx Context to render controls on\r\n     */\r\n    drawControls: function(ctx) {\r\n      var activeGroup = this.getActiveGroup();\r\n      if (activeGroup) {\r\n        this._drawGroupControls(ctx, activeGroup);\r\n      }\r\n      else {\r\n        this._drawObjectsControls(ctx);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _drawGroupControls: function(ctx, activeGroup) {\r\n      activeGroup._renderControls(ctx);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _drawObjectsControls: function(ctx) {\r\n      for (var i = 0, len = this._objects.length; i < len; ++i) {\r\n        if (!this._objects[i] || !this._objects[i].active) {\r\n          continue;\r\n        }\r\n        this._objects[i]._renderControls(ctx);\r\n        this.lastRenderedObjectWithControlsAboveOverlay = this._objects[i];\r\n      }\r\n    }\r\n  });\r\n\r\n  // copying static properties manually to work around Opera's bug,\r\n  // where \"prototype\" property is enumerable and overrides existing prototype\r\n  for (var prop in fabric.StaticCanvas) {\r\n    if (prop !== 'prototype') {\r\n      fabric.Canvas[prop] = fabric.StaticCanvas[prop];\r\n    }\r\n  }\r\n\r\n  if (fabric.isTouchSupported) {\r\n    /** @ignore */\r\n    fabric.Canvas.prototype._setCursorFromEvent = function() { };\r\n  }\r\n\r\n  /**\r\n   * @class fabric.Element\r\n   * @alias fabric.Canvas\r\n   * @deprecated Use {@link fabric.Canvas} instead.\r\n   * @constructor\r\n   */\r\n  fabric.Element = fabric.Canvas;\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  var cursorOffset = {\r\n    mt: 0, // n\r\n    tr: 1, // ne\r\n    mr: 2, // e\r\n    br: 3, // se\r\n    mb: 4, // s\r\n    bl: 5, // sw\r\n    ml: 6, // w\r\n    tl: 7 // nw\r\n  },\r\n  addListener = fabric.util.addListener,\r\n  removeListener = fabric.util.removeListener;\r\n\r\n  fabric.util.object.extend(fabric.Canvas.prototype, /** @lends fabric.Canvas.prototype */ {\r\n\r\n    /**\r\n     * Map of cursor style values for each of the object controls\r\n     * @private\r\n     */\r\n    cursorMap: [\r\n      'n-resize',\r\n      'ne-resize',\r\n      'e-resize',\r\n      'se-resize',\r\n      's-resize',\r\n      'sw-resize',\r\n      'w-resize',\r\n      'nw-resize'\r\n    ],\r\n\r\n    /**\r\n     * Adds mouse listeners to canvas\r\n     * @private\r\n     */\r\n    _initEventListeners: function () {\r\n\r\n      this._bindEvents();\r\n\r\n      addListener(fabric.window, 'resize', this._onResize);\r\n\r\n      // mouse events\r\n      addListener(this.upperCanvasEl, 'mousedown', this._onMouseDown);\r\n      addListener(this.upperCanvasEl, 'mousemove', this._onMouseMove);\r\n      addListener(this.upperCanvasEl, 'mousewheel', this._onMouseWheel);\r\n\r\n      // touch events\r\n      addListener(this.upperCanvasEl, 'touchstart', this._onMouseDown);\r\n      addListener(this.upperCanvasEl, 'touchmove', this._onMouseMove);\r\n\r\n      if (typeof eventjs !== 'undefined' && 'add' in eventjs) {\r\n        eventjs.add(this.upperCanvasEl, 'gesture', this._onGesture);\r\n        eventjs.add(this.upperCanvasEl, 'drag', this._onDrag);\r\n        eventjs.add(this.upperCanvasEl, 'orientation', this._onOrientationChange);\r\n        eventjs.add(this.upperCanvasEl, 'shake', this._onShake);\r\n        eventjs.add(this.upperCanvasEl, 'longpress', this._onLongPress);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _bindEvents: function() {\r\n      this._onMouseDown = this._onMouseDown.bind(this);\r\n      this._onMouseMove = this._onMouseMove.bind(this);\r\n      this._onMouseUp = this._onMouseUp.bind(this);\r\n      this._onResize = this._onResize.bind(this);\r\n      this._onGesture = this._onGesture.bind(this);\r\n      this._onDrag = this._onDrag.bind(this);\r\n      this._onShake = this._onShake.bind(this);\r\n      this._onLongPress = this._onLongPress.bind(this);\r\n      this._onOrientationChange = this._onOrientationChange.bind(this);\r\n      this._onMouseWheel = this._onMouseWheel.bind(this);\r\n    },\r\n\r\n    /**\r\n     * Removes all event listeners\r\n     */\r\n    removeListeners: function() {\r\n      removeListener(fabric.window, 'resize', this._onResize);\r\n\r\n      removeListener(this.upperCanvasEl, 'mousedown', this._onMouseDown);\r\n      removeListener(this.upperCanvasEl, 'mousemove', this._onMouseMove);\r\n      removeListener(this.upperCanvasEl, 'mousewheel', this._onMouseWheel);\r\n\r\n      removeListener(this.upperCanvasEl, 'touchstart', this._onMouseDown);\r\n      removeListener(this.upperCanvasEl, 'touchmove', this._onMouseMove);\r\n\r\n      if (typeof eventjs !== 'undefined' && 'remove' in eventjs) {\r\n        eventjs.remove(this.upperCanvasEl, 'gesture', this._onGesture);\r\n        eventjs.remove(this.upperCanvasEl, 'drag', this._onDrag);\r\n        eventjs.remove(this.upperCanvasEl, 'orientation', this._onOrientationChange);\r\n        eventjs.remove(this.upperCanvasEl, 'shake', this._onShake);\r\n        eventjs.remove(this.upperCanvasEl, 'longpress', this._onLongPress);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} [e] Event object fired on Event.js gesture\r\n     * @param {Event} [self] Inner Event object\r\n     */\r\n    _onGesture: function(e, self) {\r\n      this.__onTransformGesture && this.__onTransformGesture(e, self);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} [e] Event object fired on Event.js drag\r\n     * @param {Event} [self] Inner Event object\r\n     */\r\n    _onDrag: function(e, self) {\r\n      this.__onDrag && this.__onDrag(e, self);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} [e] Event object fired on Event.js wheel event\r\n     * @param {Event} [self] Inner Event object\r\n     */\r\n    _onMouseWheel: function(e, self) {\r\n      this.__onMouseWheel && this.__onMouseWheel(e, self);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} [e] Event object fired on Event.js orientation change\r\n     * @param {Event} [self] Inner Event object\r\n     */\r\n    _onOrientationChange: function(e, self) {\r\n      this.__onOrientationChange && this.__onOrientationChange(e, self);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} [e] Event object fired on Event.js shake\r\n     * @param {Event} [self] Inner Event object\r\n     */\r\n    _onShake: function(e, self) {\r\n      this.__onShake && this.__onShake(e, self);\r\n    },\r\n    /**\r\n     * @private\r\n     * @param {Event} [e] Event object fired on Event.js shake\r\n     * @param {Event} [self] Inner Event object\r\n     */\r\n    _onLongPress: function(e, self) {\r\n      this.__onLongPress && this.__onLongPress(e, self);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object fired on mousedown\r\n     */\r\n    _onMouseDown: function (e) {\r\n      this.__onMouseDown(e);\r\n\r\n      addListener(fabric.document, 'touchend', this._onMouseUp);\r\n      addListener(fabric.document, 'touchmove', this._onMouseMove);\r\n\r\n      removeListener(this.upperCanvasEl, 'mousemove', this._onMouseMove);\r\n      removeListener(this.upperCanvasEl, 'touchmove', this._onMouseMove);\r\n\r\n      if (e.type === 'touchstart') {\r\n        // Unbind mousedown to prevent double triggers from touch devices\r\n        removeListener(this.upperCanvasEl, 'mousedown', this._onMouseDown);\r\n      }\r\n      else {\r\n        addListener(fabric.document, 'mouseup', this._onMouseUp);\r\n        addListener(fabric.document, 'mousemove', this._onMouseMove);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object fired on mouseup\r\n     */\r\n    _onMouseUp: function (e) {\r\n      this.__onMouseUp(e);\r\n\r\n      removeListener(fabric.document, 'mouseup', this._onMouseUp);\r\n      removeListener(fabric.document, 'touchend', this._onMouseUp);\r\n\r\n      removeListener(fabric.document, 'mousemove', this._onMouseMove);\r\n      removeListener(fabric.document, 'touchmove', this._onMouseMove);\r\n\r\n      addListener(this.upperCanvasEl, 'mousemove', this._onMouseMove);\r\n      addListener(this.upperCanvasEl, 'touchmove', this._onMouseMove);\r\n\r\n      if (e.type === 'touchend') {\r\n        // Wait 400ms before rebinding mousedown to prevent double triggers\r\n        // from touch devices\r\n        var _this = this;\r\n        setTimeout(function() {\r\n          addListener(_this.upperCanvasEl, 'mousedown', _this._onMouseDown);\r\n        }, 400);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object fired on mousemove\r\n     */\r\n    _onMouseMove: function (e) {\r\n      !this.allowTouchScrolling && e.preventDefault && e.preventDefault();\r\n      this.__onMouseMove(e);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _onResize: function () {\r\n      this.calcOffset();\r\n    },\r\n\r\n    /**\r\n     * Decides whether the canvas should be redrawn in mouseup and mousedown events.\r\n     * @private\r\n     * @param {Object} target\r\n     * @param {Object} pointer\r\n     */\r\n    _shouldRender: function(target, pointer) {\r\n      var activeObject = this.getActiveGroup() || this.getActiveObject();\r\n\r\n      return !!(\r\n        (target && (\r\n          target.isMoving ||\r\n          target !== activeObject))\r\n        ||\r\n        (!target && !!activeObject)\r\n        ||\r\n        (!target && !activeObject && !this._groupSelector)\r\n        ||\r\n        (pointer &&\r\n          this._previousPointer &&\r\n          this.selection && (\r\n          pointer.x !== this._previousPointer.x ||\r\n          pointer.y !== this._previousPointer.y))\r\n      );\r\n    },\r\n\r\n    /**\r\n     * Method that defines the actions when mouse is released on canvas.\r\n     * The method resets the currentTransform parameters, store the image corner\r\n     * position in the image object and render the canvas on top.\r\n     * @private\r\n     * @param {Event} e Event object fired on mouseup\r\n     */\r\n    __onMouseUp: function (e) {\r\n      var target;\r\n\r\n      if (this.isDrawingMode && this._isCurrentlyDrawing) {\r\n        this._onMouseUpInDrawingMode(e);\r\n        return;\r\n      }\r\n\r\n      if (this._currentTransform) {\r\n        this._finalizeCurrentTransform();\r\n        target = this._currentTransform.target;\r\n      }\r\n      else {\r\n        target = this.findTarget(e, true);\r\n      }\r\n\r\n      var shouldRender = this._shouldRender(target, this.getPointer(e));\r\n\r\n      this._maybeGroupObjects(e);\r\n\r\n      if (target) {\r\n        target.isMoving = false;\r\n      }\r\n\r\n      shouldRender && this.renderAll();\r\n\r\n      this._handleCursorAndEvent(e, target);\r\n    },\r\n\r\n    _handleCursorAndEvent: function(e, target) {\r\n      this._setCursorFromEvent(e, target);\r\n\r\n      // TODO: why are we doing this?\r\n      var _this = this;\r\n      setTimeout(function () {\r\n        _this._setCursorFromEvent(e, target);\r\n      }, 50);\r\n\r\n      this.fire('mouse:up', { target: target, e: e });\r\n      target && target.fire('mouseup', { e: e });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _finalizeCurrentTransform: function() {\r\n\r\n      var transform = this._currentTransform,\r\n          target = transform.target;\r\n\r\n      if (target._scaling) {\r\n        target._scaling = false;\r\n      }\r\n\r\n      target.setCoords();\r\n\r\n      // only fire :modified event if target coordinates were changed during mousedown-mouseup\r\n      if (this.stateful && target.hasStateChanged()) {\r\n        this.fire('object:modified', { target: target });\r\n        target.fire('modified');\r\n      }\r\n\r\n      this._restoreOriginXY(target);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} target Object to restore\r\n     */\r\n    _restoreOriginXY: function(target) {\r\n      if (this._previousOriginX && this._previousOriginY) {\r\n\r\n        var originPoint = target.translateToOriginPoint(\r\n          target.getCenterPoint(),\r\n          this._previousOriginX,\r\n          this._previousOriginY);\r\n\r\n        target.originX = this._previousOriginX;\r\n        target.originY = this._previousOriginY;\r\n\r\n        target.left = originPoint.x;\r\n        target.top = originPoint.y;\r\n\r\n        this._previousOriginX = null;\r\n        this._previousOriginY = null;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object fired on mousedown\r\n     */\r\n    _onMouseDownInDrawingMode: function(e) {\r\n      this._isCurrentlyDrawing = true;\r\n      this.discardActiveObject(e).renderAll();\r\n      if (this.clipTo) {\r\n        fabric.util.clipContext(this, this.contextTop);\r\n      }\r\n      var ivt = fabric.util.invertTransform(this.viewportTransform),\r\n          pointer = fabric.util.transformPoint(this.getPointer(e, true), ivt);\r\n      this.freeDrawingBrush.onMouseDown(pointer);\r\n      this.fire('mouse:down', { e: e });\r\n\r\n      var target = this.findTarget(e);\r\n      if (typeof target !== 'undefined') {\r\n        target.fire('mousedown', { e: e, target: target });\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object fired on mousemove\r\n     */\r\n    _onMouseMoveInDrawingMode: function(e) {\r\n      if (this._isCurrentlyDrawing) {\r\n        var ivt = fabric.util.invertTransform(this.viewportTransform),\r\n            pointer = fabric.util.transformPoint(this.getPointer(e, true), ivt);\r\n        this.freeDrawingBrush.onMouseMove(pointer);\r\n      }\r\n      this.setCursor(this.freeDrawingCursor);\r\n      this.fire('mouse:move', { e: e });\r\n\r\n      var target = this.findTarget(e);\r\n      if (typeof target !== 'undefined') {\r\n        target.fire('mousemove', { e: e, target: target });\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object fired on mouseup\r\n     */\r\n    _onMouseUpInDrawingMode: function(e) {\r\n      this._isCurrentlyDrawing = false;\r\n      if (this.clipTo) {\r\n        this.contextTop.restore();\r\n      }\r\n      this.freeDrawingBrush.onMouseUp();\r\n      this.fire('mouse:up', { e: e });\r\n\r\n      var target = this.findTarget(e);\r\n      if (typeof target !== 'undefined') {\r\n        target.fire('mouseup', { e: e, target: target });\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Method that defines the actions when mouse is clic ked on canvas.\r\n     * The method inits the currentTransform parameters and renders all the\r\n     * canvas so the current image can be placed on the top canvas and the rest\r\n     * in on the container one.\r\n     * @private\r\n     * @param {Event} e Event object fired on mousedown\r\n     */\r\n    __onMouseDown: function (e) {\r\n\r\n      // accept only left clicks\r\n      var isLeftClick  = 'which' in e ? e.which === 1 : e.button === 1;\r\n      if (!isLeftClick && !fabric.isTouchSupported) {\r\n        return;\r\n      }\r\n\r\n      if (this.isDrawingMode) {\r\n        this._onMouseDownInDrawingMode(e);\r\n        return;\r\n      }\r\n\r\n      // ignore if some object is being transformed at this moment\r\n      if (this._currentTransform) {\r\n        return;\r\n      }\r\n\r\n      var target = this.findTarget(e),\r\n          pointer = this.getPointer(e, true);\r\n\r\n      // save pointer for check in __onMouseUp event\r\n      this._previousPointer = pointer;\r\n\r\n      var shouldRender = this._shouldRender(target, pointer),\r\n          shouldGroup = this._shouldGroup(e, target);\r\n\r\n      if (this._shouldClearSelection(e, target)) {\r\n        this._clearSelection(e, target, pointer);\r\n      }\r\n      else if (shouldGroup) {\r\n        this._handleGrouping(e, target);\r\n        target = this.getActiveGroup();\r\n      }\r\n\r\n      if (target && target.selectable && !shouldGroup) {\r\n        this._beforeTransform(e, target);\r\n        this._setupCurrentTransform(e, target);\r\n      }\r\n      // we must renderAll so that active image is placed on the top canvas\r\n      shouldRender && this.renderAll();\r\n\r\n      this.fire('mouse:down', { target: target, e: e });\r\n      target && target.fire('mousedown', { e: e });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _beforeTransform: function(e, target) {\r\n      this.stateful && target.saveState();\r\n\r\n      // determine if it's a drag or rotate case\r\n      if (target._findTargetCorner(this.getPointer(e))) {\r\n        this.onBeforeScaleRotate(target);\r\n      }\r\n\r\n      if (target !== this.getActiveGroup() && target !== this.getActiveObject()) {\r\n        this.deactivateAll();\r\n        this.setActiveObject(target, e);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _clearSelection: function(e, target, pointer) {\r\n      this.deactivateAllWithDispatch(e);\r\n\r\n      if (target && target.selectable) {\r\n        this.setActiveObject(target, e);\r\n      }\r\n      else if (this.selection) {\r\n        this._groupSelector = {\r\n          ex: pointer.x,\r\n          ey: pointer.y,\r\n          top: 0,\r\n          left: 0\r\n        };\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} target Object for that origin is set to center\r\n     */\r\n    _setOriginToCenter: function(target) {\r\n      this._previousOriginX = this._currentTransform.target.originX;\r\n      this._previousOriginY = this._currentTransform.target.originY;\r\n\r\n      var center = target.getCenterPoint();\r\n\r\n      target.originX = 'center';\r\n      target.originY = 'center';\r\n\r\n      target.left = center.x;\r\n      target.top = center.y;\r\n\r\n      this._currentTransform.left = target.left;\r\n      this._currentTransform.top = target.top;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} target Object for that center is set to origin\r\n     */\r\n    _setCenterToOrigin: function(target) {\r\n      var originPoint = target.translateToOriginPoint(\r\n        target.getCenterPoint(),\r\n        this._previousOriginX,\r\n        this._previousOriginY);\r\n\r\n      target.originX = this._previousOriginX;\r\n      target.originY = this._previousOriginY;\r\n\r\n      target.left = originPoint.x;\r\n      target.top = originPoint.y;\r\n\r\n      this._previousOriginX = null;\r\n      this._previousOriginY = null;\r\n    },\r\n\r\n    /**\r\n      * Method that defines the actions when mouse is hovering the canvas.\r\n      * The currentTransform parameter will definde whether the user is rotating/scaling/translating\r\n      * an image or neither of them (only hovering). A group selection is also possible and would cancel\r\n      * all any other type of action.\r\n      * In case of an image transformation only the top canvas will be rendered.\r\n      * @private\r\n      * @param {Event} e Event object fired on mousemove\r\n      */\r\n    __onMouseMove: function (e) {\r\n\r\n      var target, pointer;\r\n\r\n      if (this.isDrawingMode) {\r\n        this._onMouseMoveInDrawingMode(e);\r\n        return;\r\n      }\r\n      if (typeof e.touches !== 'undefined' && e.touches.length > 1) {\r\n        return;\r\n      }\r\n\r\n      var groupSelector = this._groupSelector;\r\n\r\n      // We initially clicked in an empty area, so we draw a box for multiple selection\r\n      if (groupSelector) {\r\n        pointer = this.getPointer(e, true);\r\n\r\n        groupSelector.left = pointer.x - groupSelector.ex;\r\n        groupSelector.top = pointer.y - groupSelector.ey;\r\n\r\n        this.renderTop();\r\n      }\r\n      else if (!this._currentTransform) {\r\n\r\n        target = this.findTarget(e);\r\n\r\n        if (!target || target && !target.selectable) {\r\n          this.setCursor(this.defaultCursor);\r\n        }\r\n        else {\r\n          this._setCursorFromEvent(e, target);\r\n        }\r\n      }\r\n      else {\r\n        this._transformObject(e);\r\n      }\r\n\r\n      this.fire('mouse:move', { target: target, e: e });\r\n      target && target.fire('mousemove', { e: e });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event fired on mousemove\r\n     */\r\n    _transformObject: function(e) {\r\n      var pointer = this.getPointer(e),\r\n          transform = this._currentTransform;\r\n\r\n      transform.reset = false,\r\n      transform.target.isMoving = true;\r\n\r\n      this._beforeScaleTransform(e, transform);\r\n      this._performTransformAction(e, transform, pointer);\r\n\r\n      this.renderAll();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _performTransformAction: function(e, transform, pointer) {\r\n      var x = pointer.x,\r\n          y = pointer.y,\r\n          target = transform.target,\r\n          action = transform.action;\r\n\r\n      if (action === 'rotate') {\r\n        this._rotateObject(x, y);\r\n        this._fire('rotating', target, e);\r\n      }\r\n      else if (action === 'scale') {\r\n        this._onScale(e, transform, x, y);\r\n        this._fire('scaling', target, e);\r\n      }\r\n      else if (action === 'scaleX') {\r\n        this._scaleObject(x, y, 'x');\r\n        this._fire('scaling', target, e);\r\n      }\r\n      else if (action === 'scaleY') {\r\n        this._scaleObject(x, y, 'y');\r\n        this._fire('scaling', target, e);\r\n      }\r\n      else {\r\n        this._translateObject(x, y);\r\n        this._fire('moving', target, e);\r\n        this.setCursor(this.moveCursor);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _fire: function(eventName, target, e) {\r\n      this.fire('object:' + eventName, { target: target, e: e });\r\n      target.fire(eventName, { e: e });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _beforeScaleTransform: function(e, transform) {\r\n      if (transform.action === 'scale' || transform.action === 'scaleX' || transform.action === 'scaleY') {\r\n        var centerTransform = this._shouldCenterTransform(e, transform.target);\r\n\r\n        // Switch from a normal resize to center-based\r\n        if ((centerTransform && (transform.originX !== 'center' || transform.originY !== 'center')) ||\r\n           // Switch from center-based resize to normal one\r\n           (!centerTransform && transform.originX === 'center' && transform.originY === 'center')\r\n        ) {\r\n          this._resetCurrentTransform(e);\r\n          transform.reset = true;\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _onScale: function(e, transform, x, y) {\r\n      // rotate object only if shift key is not pressed\r\n      // and if it is not a group we are transforming\r\n      if ((e.shiftKey || this.uniScaleTransform) && !transform.target.get('lockUniScaling')) {\r\n        transform.currentAction = 'scale';\r\n        this._scaleObject(x, y);\r\n      }\r\n      else {\r\n        // Switch from a normal resize to proportional\r\n        if (!transform.reset && transform.currentAction === 'scale') {\r\n          this._resetCurrentTransform(e, transform.target);\r\n        }\r\n\r\n        transform.currentAction = 'scaleEqually';\r\n        this._scaleObject(x, y, 'equally');\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Sets the cursor depending on where the canvas is being hovered.\r\n     * Note: very buggy in Opera\r\n     * @param {Event} e Event object\r\n     * @param {Object} target Object that the mouse is hovering, if so.\r\n     */\r\n    _setCursorFromEvent: function (e, target) {\r\n      if (!target || !target.selectable) {\r\n        this.setCursor(this.defaultCursor);\r\n        return false;\r\n      }\r\n      else {\r\n        var activeGroup = this.getActiveGroup(),\r\n            // only show proper corner when group selection is not active\r\n            corner = target._findTargetCorner\r\n                      && (!activeGroup || !activeGroup.contains(target))\r\n                      && target._findTargetCorner(this.getPointer(e, true));\r\n\r\n        if (!corner) {\r\n          this.setCursor(target.hoverCursor || this.hoverCursor);\r\n        }\r\n        else {\r\n          this._setCornerCursor(corner, target);\r\n        }\r\n      }\r\n      return true;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setCornerCursor: function(corner, target) {\r\n      if (corner in cursorOffset) {\r\n        this.setCursor(this._getRotatedCornerCursor(corner, target));\r\n      }\r\n      else if (corner === 'mtr' && target.hasRotatingPoint) {\r\n        this.setCursor(this.rotationCursor);\r\n      }\r\n      else {\r\n        this.setCursor(this.defaultCursor);\r\n        return false;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getRotatedCornerCursor: function(corner, target) {\r\n      var n = Math.round((target.getAngle() % 360) / 45);\r\n\r\n      if (n < 0) {\r\n        n += 8; // full circle ahead\r\n      }\r\n      n += cursorOffset[corner];\r\n      // normalize n to be from 0 to 7\r\n      n %= 8;\r\n\r\n      return this.cursorMap[n];\r\n    }\r\n  });\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  var min = Math.min,\r\n      max = Math.max;\r\n\r\n  fabric.util.object.extend(fabric.Canvas.prototype, /** @lends fabric.Canvas.prototype */ {\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object\r\n     * @param {fabric.Object} target\r\n     * @return {Boolean}\r\n     */\r\n    _shouldGroup: function(e, target) {\r\n      var activeObject = this.getActiveObject();\r\n      return e.shiftKey &&\r\n            (this.getActiveGroup() || (activeObject && activeObject !== target))\r\n            && this.selection;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e Event object\r\n     * @param {fabric.Object} target\r\n     */\r\n    _handleGrouping: function (e, target) {\r\n\r\n      if (target === this.getActiveGroup()) {\r\n\r\n        // if it's a group, find target again, this time skipping group\r\n        target = this.findTarget(e, true);\r\n\r\n        // if even object is not found, bail out\r\n        if (!target || target.isType('group')) {\r\n          return;\r\n        }\r\n      }\r\n      if (this.getActiveGroup()) {\r\n        this._updateActiveGroup(target, e);\r\n      }\r\n      else {\r\n        this._createActiveGroup(target, e);\r\n      }\r\n\r\n      if (this._activeGroup) {\r\n        this._activeGroup.saveCoords();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _updateActiveGroup: function(target, e) {\r\n      var activeGroup = this.getActiveGroup();\r\n\r\n      if (activeGroup.contains(target)) {\r\n\r\n        activeGroup.removeWithUpdate(target);\r\n        this._resetObjectTransform(activeGroup);\r\n        target.set('active', false);\r\n\r\n        if (activeGroup.size() === 1) {\r\n          // remove group alltogether if after removal it only contains 1 object\r\n          this.discardActiveGroup(e);\r\n          // activate last remaining object\r\n          this.setActiveObject(activeGroup.item(0));\r\n          return;\r\n        }\r\n      }\r\n      else {\r\n        activeGroup.addWithUpdate(target);\r\n        this._resetObjectTransform(activeGroup);\r\n      }\r\n      this.fire('selection:created', { target: activeGroup, e: e });\r\n      activeGroup.set('active', true);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _createActiveGroup: function(target, e) {\r\n\r\n      if (this._activeObject && target !== this._activeObject) {\r\n\r\n        var group = this._createGroup(target);\r\n        group.addWithUpdate();\r\n\r\n        this.setActiveGroup(group);\r\n        this._activeObject = null;\r\n\r\n        this.fire('selection:created', { target: group, e: e });\r\n      }\r\n\r\n      target.set('active', true);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} target\r\n     */\r\n    _createGroup: function(target) {\r\n\r\n      var objects = this.getObjects(),\r\n          isActiveLower = objects.indexOf(this._activeObject) < objects.indexOf(target),\r\n          groupObjects = isActiveLower\r\n            ? [ this._activeObject, target ]\r\n            : [ target, this._activeObject ];\r\n\r\n      return new fabric.Group(groupObjects, {\r\n        canvas: this\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Event} e mouse event\r\n     */\r\n    _groupSelectedObjects: function (e) {\r\n\r\n      var group = this._collectObjects();\r\n\r\n      // do not create group for 1 element only\r\n      if (group.length === 1) {\r\n        this.setActiveObject(group[0], e);\r\n      }\r\n      else if (group.length > 1) {\r\n        group = new fabric.Group(group.reverse(), {\r\n          canvas: this\r\n        });\r\n        group.addWithUpdate();\r\n        this.setActiveGroup(group, e);\r\n        group.saveCoords();\r\n        this.fire('selection:created', { target: group });\r\n        this.renderAll();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _collectObjects: function() {\r\n      var group = [ ],\r\n          currentObject,\r\n          x1 = this._groupSelector.ex,\r\n          y1 = this._groupSelector.ey,\r\n          x2 = x1 + this._groupSelector.left,\r\n          y2 = y1 + this._groupSelector.top,\r\n          selectionX1Y1 = new fabric.Point(min(x1, x2), min(y1, y2)),\r\n          selectionX2Y2 = new fabric.Point(max(x1, x2), max(y1, y2)),\r\n          isClick = x1 === x2 && y1 === y2;\r\n\r\n      for (var i = this._objects.length; i--; ) {\r\n        currentObject = this._objects[i];\r\n\r\n        if (!currentObject || !currentObject.selectable || !currentObject.visible) {\r\n          continue;\r\n        }\r\n\r\n        if (currentObject.intersectsWithRect(selectionX1Y1, selectionX2Y2) ||\r\n            currentObject.isContainedWithinRect(selectionX1Y1, selectionX2Y2) ||\r\n            currentObject.containsPoint(selectionX1Y1) ||\r\n            currentObject.containsPoint(selectionX2Y2)\r\n        ) {\r\n          currentObject.set('active', true);\r\n          group.push(currentObject);\r\n\r\n          // only add one object if it's a click\r\n          if (isClick) {\r\n            break;\r\n          }\r\n        }\r\n      }\r\n\r\n      return group;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _maybeGroupObjects: function(e) {\r\n      if (this.selection && this._groupSelector) {\r\n        this._groupSelectedObjects(e);\r\n      }\r\n\r\n      var activeGroup = this.getActiveGroup();\r\n      if (activeGroup) {\r\n        activeGroup.setObjectsCoords().setCoords();\r\n        activeGroup.isMoving = false;\r\n        this.setCursor(this.defaultCursor);\r\n      }\r\n\r\n      // clear selection and current transformation\r\n      this._groupSelector = null;\r\n      this._currentTransform = null;\r\n    }\r\n  });\r\n\r\n})();\r\n\r\n\r\nfabric.util.object.extend(fabric.StaticCanvas.prototype, /** @lends fabric.StaticCanvas.prototype */ {\r\n\r\n  /**\r\n   * Exports canvas element to a dataurl image. Note that when multiplier is used, cropping is scaled appropriately\r\n   * @param {Object} [options] Options object\r\n   * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\r\n   * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\r\n   * @param {Number} [options.multiplier=1] Multiplier to scale by\r\n   * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\r\n   * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\r\n   * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\r\n   * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\r\n   * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\r\n   * @see {@link http://jsfiddle.net/fabricjs/NfZVb/|jsFiddle demo}\r\n   * @example <caption>Generate jpeg dataURL with lower quality</caption>\r\n   * var dataURL = canvas.toDataURL({\r\n   *   format: 'jpeg',\r\n   *   quality: 0.8\r\n   * });\r\n   * @example <caption>Generate cropped png dataURL (clipping of canvas)</caption>\r\n   * var dataURL = canvas.toDataURL({\r\n   *   format: 'png',\r\n   *   left: 100,\r\n   *   top: 100,\r\n   *   width: 200,\r\n   *   height: 200\r\n   * });\r\n   * @example <caption>Generate double scaled png dataURL</caption>\r\n   * var dataURL = canvas.toDataURL({\r\n   *   format: 'png',\r\n   *   multiplier: 2\r\n   * });\r\n   */\r\n  toDataURL: function (options) {\r\n    options || (options = { });\r\n\r\n    var format = options.format || 'png',\r\n        quality = options.quality || 1,\r\n        multiplier = options.multiplier || 1,\r\n        cropping = {\r\n          left: options.left,\r\n          top: options.top,\r\n          width: options.width,\r\n          height: options.height\r\n        };\r\n\r\n    if (multiplier !== 1) {\r\n      return this.__toDataURLWithMultiplier(format, quality, cropping, multiplier);\r\n    }\r\n    else {\r\n      return this.__toDataURL(format, quality, cropping);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  __toDataURL: function(format, quality, cropping) {\r\n\r\n    this.renderAll(true);\r\n\r\n    var canvasEl = this.upperCanvasEl || this.lowerCanvasEl,\r\n        croppedCanvasEl = this.__getCroppedCanvas(canvasEl, cropping);\r\n\r\n    // to avoid common confusion https://github.com/kangax/fabric.js/issues/806\r\n    if (format === 'jpg') {\r\n      format = 'jpeg';\r\n    }\r\n\r\n    var data = (fabric.StaticCanvas.supports('toDataURLWithQuality'))\r\n              ? (croppedCanvasEl || canvasEl).toDataURL('image/' + format, quality)\r\n              : (croppedCanvasEl || canvasEl).toDataURL('image/' + format);\r\n\r\n    this.contextTop && this.clearContext(this.contextTop);\r\n    this.renderAll();\r\n\r\n    if (croppedCanvasEl) {\r\n      croppedCanvasEl = null;\r\n    }\r\n\r\n    return data;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  __getCroppedCanvas: function(canvasEl, cropping) {\r\n\r\n    var croppedCanvasEl,\r\n        croppedCtx,\r\n        shouldCrop = 'left' in cropping ||\r\n                     'top' in cropping ||\r\n                     'width' in cropping ||\r\n                     'height' in cropping;\r\n\r\n    if (shouldCrop) {\r\n\r\n      croppedCanvasEl = fabric.util.createCanvasElement();\r\n      croppedCtx = croppedCanvasEl.getContext('2d');\r\n\r\n      croppedCanvasEl.width = cropping.width || this.width;\r\n      croppedCanvasEl.height = cropping.height || this.height;\r\n\r\n      croppedCtx.drawImage(canvasEl, -cropping.left || 0, -cropping.top || 0);\r\n    }\r\n\r\n    return croppedCanvasEl;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  __toDataURLWithMultiplier: function(format, quality, cropping, multiplier) {\r\n\r\n    var origWidth = this.getWidth(),\r\n        origHeight = this.getHeight(),\r\n        scaledWidth = origWidth * multiplier,\r\n        scaledHeight = origHeight * multiplier,\r\n        activeObject = this.getActiveObject(),\r\n        activeGroup = this.getActiveGroup(),\r\n\r\n        ctx = this.contextTop || this.contextContainer;\r\n\r\n    if (multiplier > 1) {\r\n      this.setWidth(scaledWidth).setHeight(scaledHeight);\r\n    }\r\n    ctx.scale(multiplier, multiplier);\r\n\r\n    if (cropping.left) {\r\n      cropping.left *= multiplier;\r\n    }\r\n    if (cropping.top) {\r\n      cropping.top *= multiplier;\r\n    }\r\n    if (cropping.width) {\r\n      cropping.width *= multiplier;\r\n    }\r\n    else if (multiplier < 1) {\r\n      cropping.width = scaledWidth;\r\n    }\r\n    if (cropping.height) {\r\n      cropping.height *= multiplier;\r\n    }\r\n    else if (multiplier < 1) {\r\n      cropping.height = scaledHeight;\r\n    }\r\n\r\n    if (activeGroup) {\r\n      // not removing group due to complications with restoring it with correct state afterwords\r\n      this._tempRemoveBordersControlsFromGroup(activeGroup);\r\n    }\r\n    else if (activeObject && this.deactivateAll) {\r\n      this.deactivateAll();\r\n    }\r\n\r\n    this.renderAll(true);\r\n\r\n    var data = this.__toDataURL(format, quality, cropping);\r\n\r\n    // restoring width, height for `renderAll` to draw\r\n    // background properly (while context is scaled)\r\n    this.width = origWidth;\r\n    this.height = origHeight;\r\n\r\n    ctx.scale(1 / multiplier,  1 / multiplier);\r\n    this.setWidth(origWidth).setHeight(origHeight);\r\n\r\n    if (activeGroup) {\r\n      this._restoreBordersControlsOnGroup(activeGroup);\r\n    }\r\n    else if (activeObject && this.setActiveObject) {\r\n      this.setActiveObject(activeObject);\r\n    }\r\n\r\n    this.contextTop && this.clearContext(this.contextTop);\r\n    this.renderAll();\r\n\r\n    return data;\r\n  },\r\n\r\n  /**\r\n   * Exports canvas element to a dataurl image (allowing to change image size via multiplier).\r\n   * @deprecated since 1.0.13\r\n   * @param {String} format (png|jpeg)\r\n   * @param {Number} multiplier\r\n   * @param {Number} quality (0..1)\r\n   * @return {String}\r\n   */\r\n  toDataURLWithMultiplier: function (format, multiplier, quality) {\r\n    return this.toDataURL({\r\n      format: format,\r\n      multiplier: multiplier,\r\n      quality: quality\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _tempRemoveBordersControlsFromGroup: function(group) {\r\n    group.origHasControls = group.hasControls;\r\n    group.origBorderColor = group.borderColor;\r\n\r\n    group.hasControls = true;\r\n    group.borderColor = 'rgba(0,0,0,0)';\r\n\r\n    group.forEachObject(function(o) {\r\n      o.origBorderColor = o.borderColor;\r\n      o.borderColor = 'rgba(0,0,0,0)';\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _restoreBordersControlsOnGroup: function(group) {\r\n    group.hideControls = group.origHideControls;\r\n    group.borderColor = group.origBorderColor;\r\n\r\n    group.forEachObject(function(o) {\r\n      o.borderColor = o.origBorderColor;\r\n      delete o.origBorderColor;\r\n    });\r\n  }\r\n});\r\n\r\n\r\nfabric.util.object.extend(fabric.StaticCanvas.prototype, /** @lends fabric.StaticCanvas.prototype */ {\r\n\r\n  /**\r\n   * Populates canvas with data from the specified dataless JSON.\r\n   * JSON format must conform to the one of {@link fabric.Canvas#toDatalessJSON}\r\n   * @deprecated since 1.2.2\r\n   * @param {String|Object} json JSON string or object\r\n   * @param {Function} callback Callback, invoked when json is parsed\r\n   *                            and corresponding objects (e.g: {@link fabric.Image})\r\n   *                            are initialized\r\n   * @param {Function} [reviver] Method for further parsing of JSON elements, called after each fabric object created.\r\n   * @return {fabric.Canvas} instance\r\n   * @chainable\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3/#deserialization}\r\n   */\r\n  loadFromDatalessJSON: function (json, callback, reviver) {\r\n    return this.loadFromJSON(json, callback, reviver);\r\n  },\r\n\r\n  /**\r\n   * Populates canvas with data from the specified JSON.\r\n   * JSON format must conform to the one of {@link fabric.Canvas#toJSON}\r\n   * @param {String|Object} json JSON string or object\r\n   * @param {Function} callback Callback, invoked when json is parsed\r\n   *                            and corresponding objects (e.g: {@link fabric.Image})\r\n   *                            are initialized\r\n   * @param {Function} [reviver] Method for further parsing of JSON elements, called after each fabric object created.\r\n   * @return {fabric.Canvas} instance\r\n   * @chainable\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3/#deserialization}\r\n   * @see {@link http://jsfiddle.net/fabricjs/fmgXt/|jsFiddle demo}\r\n   * @example <caption>loadFromJSON</caption>\r\n   * canvas.loadFromJSON(json, canvas.renderAll.bind(canvas));\r\n   * @example <caption>loadFromJSON with reviver</caption>\r\n   * canvas.loadFromJSON(json, canvas.renderAll.bind(canvas), function(o, object) {\r\n   *   // `o` = json object\r\n   *   // `object` = fabric.Object instance\r\n   *   // ... do some stuff ...\r\n   * });\r\n   */\r\n  loadFromJSON: function (json, callback, reviver) {\r\n    if (!json) {\r\n      return;\r\n    }\r\n\r\n    // serialize if it wasn't already\r\n    var serialized = (typeof json === 'string')\r\n      ? JSON.parse(json)\r\n      : json;\r\n\r\n    this.clear();\r\n\r\n    var _this = this;\r\n    this._enlivenObjects(serialized.objects, function () {\r\n      _this._setBgOverlay(serialized, callback);\r\n    }, reviver);\r\n\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {Object} serialized Object with background and overlay information\r\n   * @param {Function} callback Invoked after all background and overlay images/patterns loaded\r\n   */\r\n  _setBgOverlay: function(serialized, callback) {\r\n    var _this = this,\r\n        loaded = {\r\n          backgroundColor: false,\r\n          overlayColor: false,\r\n          backgroundImage: false,\r\n          overlayImage: false\r\n        };\r\n\r\n    if (!serialized.backgroundImage && !serialized.overlayImage && !serialized.background && !serialized.overlay) {\r\n      callback && callback();\r\n      return;\r\n    }\r\n\r\n    var cbIfLoaded = function () {\r\n      if (loaded.backgroundImage && loaded.overlayImage && loaded.backgroundColor && loaded.overlayColor) {\r\n        _this.renderAll();\r\n        callback && callback();\r\n      }\r\n    };\r\n\r\n    this.__setBgOverlay('backgroundImage', serialized.backgroundImage, loaded, cbIfLoaded);\r\n    this.__setBgOverlay('overlayImage', serialized.overlayImage, loaded, cbIfLoaded);\r\n    this.__setBgOverlay('backgroundColor', serialized.background, loaded, cbIfLoaded);\r\n    this.__setBgOverlay('overlayColor', serialized.overlay, loaded, cbIfLoaded);\r\n\r\n    cbIfLoaded();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {String} property Property to set (backgroundImage, overlayImage, backgroundColor, overlayColor)\r\n   * @param {(Object|String)} value Value to set\r\n   * @param {Object} loaded Set loaded property to true if property is set\r\n   * @param {Object} callback Callback function to invoke after property is set\r\n   */\r\n  __setBgOverlay: function(property, value, loaded, callback) {\r\n    var _this = this;\r\n\r\n    if (!value) {\r\n      loaded[property] = true;\r\n      return;\r\n    }\r\n\r\n    if (property === 'backgroundImage' || property === 'overlayImage') {\r\n      fabric.Image.fromObject(value, function(img) {\r\n        _this[property] = img;\r\n        loaded[property] = true;\r\n        callback && callback();\r\n      });\r\n    }\r\n    else {\r\n      this['set' + fabric.util.string.capitalize(property, true)](value, function() {\r\n        loaded[property] = true;\r\n        callback && callback();\r\n      });\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {Array} objects\r\n   * @param {Function} callback\r\n   * @param {Function} [reviver]\r\n   */\r\n  _enlivenObjects: function (objects, callback, reviver) {\r\n    var _this = this;\r\n\r\n    if (!objects || objects.length === 0) {\r\n      callback && callback();\r\n      return;\r\n    }\r\n\r\n    var renderOnAddRemove = this.renderOnAddRemove;\r\n    this.renderOnAddRemove = false;\r\n\r\n    fabric.util.enlivenObjects(objects, function(enlivenedObjects) {\r\n      enlivenedObjects.forEach(function(obj, index) {\r\n        _this.insertAt(obj, index, true);\r\n      });\r\n\r\n      _this.renderOnAddRemove = renderOnAddRemove;\r\n      callback && callback();\r\n    }, null, reviver);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {String} format\r\n   * @param {Function} callback\r\n   */\r\n  _toDataURL: function (format, callback) {\r\n    this.clone(function (clone) {\r\n      callback(clone.toDataURL(format));\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {String} format\r\n   * @param {Number} multiplier\r\n   * @param {Function} callback\r\n   */\r\n  _toDataURLWithMultiplier: function (format, multiplier, callback) {\r\n    this.clone(function (clone) {\r\n      callback(clone.toDataURLWithMultiplier(format, multiplier));\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Clones canvas instance\r\n   * @param {Object} [callback] Receives cloned instance as a first argument\r\n   * @param {Array} [properties] Array of properties to include in the cloned canvas and children\r\n   */\r\n  clone: function (callback, properties) {\r\n    var data = JSON.stringify(this.toJSON(properties));\r\n    this.cloneWithoutData(function(clone) {\r\n      clone.loadFromJSON(data, function() {\r\n        callback && callback(clone);\r\n      });\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Clones canvas instance without cloning existing data.\r\n   * This essentially copies canvas dimensions, clipping properties, etc.\r\n   * but leaves data empty (so that you can populate it with your own)\r\n   * @param {Object} [callback] Receives cloned instance as a first argument\r\n   */\r\n  cloneWithoutData: function(callback) {\r\n    var el = fabric.document.createElement('canvas');\r\n\r\n    el.width = this.getWidth();\r\n    el.height = this.getHeight();\r\n\r\n    var clone = new fabric.Canvas(el);\r\n    clone.clipTo = this.clipTo;\r\n    if (this.backgroundImage) {\r\n      clone.setBackgroundImage(this.backgroundImage.src, function() {\r\n        clone.renderAll();\r\n        callback && callback(clone);\r\n      });\r\n      clone.backgroundImageOpacity = this.backgroundImageOpacity;\r\n      clone.backgroundImageStretch = this.backgroundImageStretch;\r\n    }\r\n    else {\r\n      callback && callback(clone);\r\n    }\r\n  }\r\n});\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend,\r\n      toFixed = fabric.util.toFixed,\r\n      capitalize = fabric.util.string.capitalize,\r\n      degreesToRadians = fabric.util.degreesToRadians,\r\n      supportsLineDash = fabric.StaticCanvas.supports('setLineDash');\r\n\r\n  if (fabric.Object) {\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Root object class from which all 2d shape classes inherit from\r\n   * @class fabric.Object\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1/#objects}\r\n   * @see {@link fabric.Object#initialize} for constructor definition\r\n   *\r\n   * @fires added\r\n   * @fires removed\r\n   *\r\n   * @fires selected\r\n   * @fires modified\r\n   * @fires rotating\r\n   * @fires scaling\r\n   * @fires moving\r\n   *\r\n   * @fires mousedown\r\n   * @fires mouseup\r\n   */\r\n  fabric.Object = fabric.util.createClass(/** @lends fabric.Object.prototype */ {\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#clipTo|clipping function}\r\n     * @method getClipTo\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Function}\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#clipTo|clipping function}\r\n     * @method setClipTo\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Function} clipTo Clipping function\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#transformMatrix|transformMatrix}\r\n     * @method getTransformMatrix\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Array} transformMatrix\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#transformMatrix|transformMatrix}\r\n     * @method setTransformMatrix\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Array} transformMatrix\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#visible|visible} state\r\n     * @method getVisible\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Boolean} True if visible\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#visible|visible} state\r\n     * @method setVisible\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Boolean} value visible value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#shadow|shadow}\r\n     * @method getShadow\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Object} Shadow instance\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#stroke|stroke}\r\n     * @method getStroke\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {String} stroke value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#stroke|stroke}\r\n     * @method setStroke\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {String} value stroke value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#strokeWidth|strokeWidth}\r\n     * @method getStrokeWidth\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Number} strokeWidth value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#strokeWidth|strokeWidth}\r\n     * @method setStrokeWidth\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Number} value strokeWidth value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#originX|originX}\r\n     * @method getOriginX\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {String} originX value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#originX|originX}\r\n     * @method setOriginX\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {String} value originX value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#originY|originY}\r\n     * @method getOriginY\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {String} originY value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#originY|originY}\r\n     * @method setOriginY\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {String} value originY value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#fill|fill}\r\n     * @method getFill\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {String} Fill value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#fill|fill}\r\n     * @method setFill\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {String} value Fill value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#opacity|opacity}\r\n     * @method getOpacity\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Number} Opacity value (0-1)\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#opacity|opacity}\r\n     * @method setOpacity\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Number} value Opacity value (0-1)\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#angle|angle} (in degrees)\r\n     * @method getAngle\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Number}\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#top|top position}\r\n     * @method getTop\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Number} Top value (in pixels)\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#top|top position}\r\n     * @method setTop\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Number} value Top value (in pixels)\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#left|left position}\r\n     * @method getLeft\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Number} Left value (in pixels)\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#left|left position}\r\n     * @method setLeft\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Number} value Left value (in pixels)\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#scaleX|scaleX} value\r\n     * @method getScaleX\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Number} scaleX value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#scaleX|scaleX} value\r\n     * @method setScaleX\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Number} value scaleX value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#scaleY|scaleY} value\r\n     * @method getScaleY\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Number} scaleY value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#scaleY|scaleY} value\r\n     * @method setScaleY\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Number} value scaleY value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#flipX|flipX} value\r\n     * @method getFlipX\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Boolean} flipX value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#flipX|flipX} value\r\n     * @method setFlipX\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Boolean} value flipX value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's {@link fabric.Object#flipY|flipY} value\r\n     * @method getFlipY\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Boolean} flipY value\r\n     */\r\n\r\n    /**\r\n     * Sets object's {@link fabric.Object#flipY|flipY} value\r\n     * @method setFlipY\r\n     * @memberOf fabric.Object.prototype\r\n     * @param {Boolean} value flipY value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Type of an object (rect, circle, path, etc.).\r\n     * Note that this property is meant to be read-only and not meant to be modified.\r\n     * If you modify, certain parts of Fabric (such as JSON loading) won't work correctly.\r\n     * @type String\r\n     * @default\r\n     */\r\n    type:                     'object',\r\n\r\n    /**\r\n     * Horizontal origin of transformation of an object (one of \"left\", \"right\", \"center\")\r\n     * See http://jsfiddle.net/1ow02gea/40/ on how originX/originY affect objects in groups\r\n     * @type String\r\n     * @default\r\n     */\r\n    originX:                  'left',\r\n\r\n    /**\r\n     * Vertical origin of transformation of an object (one of \"top\", \"bottom\", \"center\")\r\n     * See http://jsfiddle.net/1ow02gea/40/ on how originX/originY affect objects in groups\r\n     * @type String\r\n     * @default\r\n     */\r\n    originY:                  'top',\r\n\r\n    /**\r\n     * Top position of an object. Note that by default it's relative to object center. You can change this by setting originY={top/center/bottom}\r\n     * @type Number\r\n     * @default\r\n     */\r\n    top:                      0,\r\n\r\n    /**\r\n     * Left position of an object. Note that by default it's relative to object center. You can change this by setting originX={left/center/right}\r\n     * @type Number\r\n     * @default\r\n     */\r\n    left:                     0,\r\n\r\n    /**\r\n     * Object width\r\n     * @type Number\r\n     * @default\r\n     */\r\n    width:                    0,\r\n\r\n    /**\r\n     * Object height\r\n     * @type Number\r\n     * @default\r\n     */\r\n    height:                   0,\r\n\r\n    /**\r\n     * Object scale factor (horizontal)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    scaleX:                   1,\r\n\r\n    /**\r\n     * Object scale factor (vertical)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    scaleY:                   1,\r\n\r\n    /**\r\n     * When true, an object is rendered as flipped horizontally\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    flipX:                    false,\r\n\r\n    /**\r\n     * When true, an object is rendered as flipped vertically\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    flipY:                    false,\r\n\r\n    /**\r\n     * Opacity of an object\r\n     * @type Number\r\n     * @default\r\n     */\r\n    opacity:                  1,\r\n\r\n    /**\r\n     * Angle of rotation of an object (in degrees)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    angle:                    0,\r\n\r\n    /**\r\n     * Size of object's controlling corners (in pixels)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    cornerSize:               12,\r\n\r\n    /**\r\n     * When true, object's controlling corners are rendered as transparent inside (i.e. stroke instead of fill)\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    transparentCorners:       true,\r\n\r\n    /**\r\n     * Default cursor value used when hovering over this object on canvas\r\n     * @type String\r\n     * @default\r\n     */\r\n    hoverCursor:              null,\r\n\r\n    /**\r\n     * Padding between object and its controlling borders (in pixels)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    padding:                  0,\r\n\r\n    /**\r\n     * Color of controlling borders of an object (when it's active)\r\n     * @type String\r\n     * @default\r\n     */\r\n    borderColor:              'rgba(102,153,255,0.75)',\r\n\r\n    /**\r\n     * Color of controlling corners of an object (when it's active)\r\n     * @type String\r\n     * @default\r\n     */\r\n    cornerColor:              'rgba(102,153,255,0.5)',\r\n\r\n    /**\r\n     * When true, this object will use center point as the origin of transformation\r\n     * when being scaled via the controls.\r\n     * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\r\n     * @since 1.3.4\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    centeredScaling:          false,\r\n\r\n    /**\r\n     * When true, this object will use center point as the origin of transformation\r\n     * when being rotated via the controls.\r\n     * <b>Backwards incompatibility note:</b> This property replaces \"centerTransform\" (Boolean).\r\n     * @since 1.3.4\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    centeredRotation:         true,\r\n\r\n    /**\r\n     * Color of object's fill\r\n     * @type String\r\n     * @default\r\n     */\r\n    fill:                     'rgb(0,0,0)',\r\n\r\n    /**\r\n     * Fill rule used to fill an object\r\n     * accepted values are nonzero, evenodd\r\n     * <b>Backwards incompatibility note:</b> This property was used for setting globalCompositeOperation until v1.4.12 (use `fabric.Object#globalCompositeOperation` instead)\r\n     * @type String\r\n     * @default\r\n     */\r\n    fillRule:                 'nonzero',\r\n\r\n    /**\r\n     * Composite rule used for canvas globalCompositeOperation\r\n     * @type String\r\n     * @default\r\n     */\r\n    globalCompositeOperation: 'source-over',\r\n\r\n    /**\r\n     * Background color of an object. Only works with text objects at the moment.\r\n     * @type String\r\n     * @default\r\n     */\r\n    backgroundColor:          '',\r\n\r\n    /**\r\n     * When defined, an object is rendered via stroke and this property specifies its color\r\n     * @type String\r\n     * @default\r\n     */\r\n    stroke:                   null,\r\n\r\n    /**\r\n     * Width of a stroke used to render this object\r\n     * @type Number\r\n     * @default\r\n     */\r\n    strokeWidth:              1,\r\n\r\n    /**\r\n     * Array specifying dash pattern of an object's stroke (stroke must be defined)\r\n     * @type Array\r\n     */\r\n    strokeDashArray:          null,\r\n\r\n    /**\r\n     * Line endings style of an object's stroke (one of \"butt\", \"round\", \"square\")\r\n     * @type String\r\n     * @default\r\n     */\r\n    strokeLineCap:            'butt',\r\n\r\n    /**\r\n     * Corner style of an object's stroke (one of \"bevil\", \"round\", \"miter\")\r\n     * @type String\r\n     * @default\r\n     */\r\n    strokeLineJoin:           'miter',\r\n\r\n    /**\r\n     * Maximum miter length (used for strokeLineJoin = \"miter\") of an object's stroke\r\n     * @type Number\r\n     * @default\r\n     */\r\n    strokeMiterLimit:         10,\r\n\r\n    /**\r\n     * Shadow object representing shadow of this shape\r\n     * @type fabric.Shadow\r\n     * @default\r\n     */\r\n    shadow:                   null,\r\n\r\n    /**\r\n     * Opacity of object's controlling borders when object is active and moving\r\n     * @type Number\r\n     * @default\r\n     */\r\n    borderOpacityWhenMoving:  0.4,\r\n\r\n    /**\r\n     * Scale factor of object's controlling borders\r\n     * @type Number\r\n     * @default\r\n     */\r\n    borderScaleFactor:        1,\r\n\r\n    /**\r\n     * Transform matrix (similar to SVG's transform matrix)\r\n     * @type Array\r\n     */\r\n    transformMatrix:          null,\r\n\r\n    /**\r\n     * Minimum allowed scale value of an object\r\n     * @type Number\r\n     * @default\r\n     */\r\n    minScaleLimit:            0.01,\r\n\r\n    /**\r\n     * When set to `false`, an object can not be selected for modification (using either point-click-based or group-based selection).\r\n     * But events still fire on it.\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    selectable:               true,\r\n\r\n    /**\r\n     * When set to `false`, an object can not be a target of events. All events propagate through it. Introduced in v1.3.4\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    evented:                  true,\r\n\r\n    /**\r\n     * When set to `false`, an object is not rendered on canvas\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    visible:                  true,\r\n\r\n    /**\r\n     * When set to `false`, object's controls are not displayed and can not be used to manipulate object\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    hasControls:              true,\r\n\r\n    /**\r\n     * When set to `false`, object's controlling borders are not rendered\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    hasBorders:               true,\r\n\r\n    /**\r\n     * When set to `false`, object's controlling rotating point will not be visible or selectable\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    hasRotatingPoint:         true,\r\n\r\n    /**\r\n     * Offset for object's controlling rotating point (when enabled via `hasRotatingPoint`)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    rotatingPointOffset:      40,\r\n\r\n    /**\r\n     * When set to `true`, objects are \"found\" on canvas on per-pixel basis rather than according to bounding box\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    perPixelTargetFind:       false,\r\n\r\n    /**\r\n     * When `false`, default object's values are not included in its serialization\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    includeDefaultValues:     true,\r\n\r\n    /**\r\n     * Function that determines clipping of an object (context is passed as a first argument)\r\n     * Note that context origin is at the object's center point (not left/top corner)\r\n     * @type Function\r\n     */\r\n    clipTo:                   null,\r\n\r\n    /**\r\n     * When `true`, object horizontal movement is locked\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    lockMovementX:            false,\r\n\r\n    /**\r\n     * When `true`, object vertical movement is locked\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    lockMovementY:            false,\r\n\r\n    /**\r\n     * When `true`, object rotation is locked\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    lockRotation:             false,\r\n\r\n    /**\r\n     * When `true`, object horizontal scaling is locked\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    lockScalingX:             false,\r\n\r\n    /**\r\n     * When `true`, object vertical scaling is locked\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    lockScalingY:             false,\r\n\r\n    /**\r\n     * When `true`, object non-uniform scaling is locked\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    lockUniScaling:           false,\r\n\r\n    /**\r\n     * When `true`, object cannot be flipped by scaling into negative values\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n\r\n    lockScalingFlip:          false,\r\n    /**\r\n     * List of properties to consider when checking if state\r\n     * of an object is changed (fabric.Object#hasStateChanged)\r\n     * as well as for history (undo/redo) purposes\r\n     * @type Array\r\n     */\r\n    stateProperties:  (\r\n      'top left width height scaleX scaleY flipX flipY originX originY transformMatrix ' +\r\n      'stroke strokeWidth strokeDashArray strokeLineCap strokeLineJoin strokeMiterLimit ' +\r\n      'angle opacity fill fillRule globalCompositeOperation shadow clipTo visible backgroundColor'\r\n    ).split(' '),\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Object} [options] Options object\r\n     */\r\n    initialize: function(options) {\r\n      if (options) {\r\n        this.setOptions(options);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} [options] Options object\r\n     */\r\n    _initGradient: function(options) {\r\n      if (options.fill && options.fill.colorStops && !(options.fill instanceof fabric.Gradient)) {\r\n        this.set('fill', new fabric.Gradient(options.fill));\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} [options] Options object\r\n     */\r\n    _initPattern: function(options) {\r\n      if (options.fill && options.fill.source && !(options.fill instanceof fabric.Pattern)) {\r\n        this.set('fill', new fabric.Pattern(options.fill));\r\n      }\r\n      if (options.stroke && options.stroke.source && !(options.stroke instanceof fabric.Pattern)) {\r\n        this.set('stroke', new fabric.Pattern(options.stroke));\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} [options] Options object\r\n     */\r\n    _initClipping: function(options) {\r\n      if (!options.clipTo || typeof options.clipTo !== 'string') {\r\n        return;\r\n      }\r\n\r\n      var functionBody = fabric.util.getFunctionBody(options.clipTo);\r\n      if (typeof functionBody !== 'undefined') {\r\n        this.clipTo = new Function('ctx', functionBody);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Sets object's properties from options\r\n     * @param {Object} [options] Options object\r\n     */\r\n    setOptions: function(options) {\r\n      for (var prop in options) {\r\n        this.set(prop, options[prop]);\r\n      }\r\n      this._initGradient(options);\r\n      this._initPattern(options);\r\n      this._initClipping(options);\r\n    },\r\n\r\n    /**\r\n     * Transforms context when rendering an object\r\n     * @param {CanvasRenderingContext2D} ctx Context\r\n     * @param {Boolean} fromLeft When true, context is transformed to object's top/left corner. This is used when rendering text on Node\r\n     */\r\n    transform: function(ctx, fromLeft) {\r\n      var center = fromLeft ? this._getLeftTopCoords() : this.getCenterPoint();\r\n      ctx.translate(center.x, center.y);\r\n      ctx.rotate(degreesToRadians(this.angle));\r\n      ctx.scale(\r\n        this.scaleX * (this.flipX ? -1 : 1),\r\n        this.scaleY * (this.flipY ? -1 : 1)\r\n      );\r\n    },\r\n\r\n    /**\r\n     * Returns an object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      var NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS,\r\n\r\n          object = {\r\n            type:                     this.type,\r\n            originX:                  this.originX,\r\n            originY:                  this.originY,\r\n            left:                     toFixed(this.left, NUM_FRACTION_DIGITS),\r\n            top:                      toFixed(this.top, NUM_FRACTION_DIGITS),\r\n            width:                    toFixed(this.width, NUM_FRACTION_DIGITS),\r\n            height:                   toFixed(this.height, NUM_FRACTION_DIGITS),\r\n            fill:                     (this.fill && this.fill.toObject) ? this.fill.toObject() : this.fill,\r\n            stroke:                   (this.stroke && this.stroke.toObject) ? this.stroke.toObject() : this.stroke,\r\n            strokeWidth:              toFixed(this.strokeWidth, NUM_FRACTION_DIGITS),\r\n            strokeDashArray:          this.strokeDashArray,\r\n            strokeLineCap:            this.strokeLineCap,\r\n            strokeLineJoin:           this.strokeLineJoin,\r\n            strokeMiterLimit:         toFixed(this.strokeMiterLimit, NUM_FRACTION_DIGITS),\r\n            scaleX:                   toFixed(this.scaleX, NUM_FRACTION_DIGITS),\r\n            scaleY:                   toFixed(this.scaleY, NUM_FRACTION_DIGITS),\r\n            angle:                    toFixed(this.getAngle(), NUM_FRACTION_DIGITS),\r\n            flipX:                    this.flipX,\r\n            flipY:                    this.flipY,\r\n            opacity:                  toFixed(this.opacity, NUM_FRACTION_DIGITS),\r\n            shadow:                   (this.shadow && this.shadow.toObject) ? this.shadow.toObject() : this.shadow,\r\n            visible:                  this.visible,\r\n            clipTo:                   this.clipTo && String(this.clipTo),\r\n            backgroundColor:          this.backgroundColor,\r\n            fillRule:                 this.fillRule,\r\n            globalCompositeOperation: this.globalCompositeOperation\r\n          };\r\n\r\n      if (!this.includeDefaultValues) {\r\n        object = this._removeDefaultValues(object);\r\n      }\r\n\r\n      fabric.util.populateWithProperties(this, object, propertiesToInclude);\r\n\r\n      return object;\r\n    },\r\n\r\n    /**\r\n     * Returns (dataless) object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toDatalessObject: function(propertiesToInclude) {\r\n      // will be overwritten by subclasses\r\n      return this.toObject(propertiesToInclude);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} object\r\n     */\r\n    _removeDefaultValues: function(object) {\r\n      var prototype = fabric.util.getKlass(object.type).prototype,\r\n          stateProperties = prototype.stateProperties;\r\n\r\n      stateProperties.forEach(function(prop) {\r\n        if (object[prop] === prototype[prop]) {\r\n          delete object[prop];\r\n        }\r\n      });\r\n\r\n      return object;\r\n    },\r\n\r\n    /**\r\n     * Returns a string representation of an instance\r\n     * @return {String}\r\n     */\r\n    toString: function() {\r\n      return '#<fabric.' + capitalize(this.type) + '>';\r\n    },\r\n\r\n    /**\r\n     * Basic getter\r\n     * @param {String} property Property name\r\n     * @return {Any} value of a property\r\n     */\r\n    get: function(property) {\r\n      return this[property];\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setObject: function(obj) {\r\n      for (var prop in obj) {\r\n        this._set(prop, obj[prop]);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Sets property to a given value. When changing position/dimension -related properties (left, top, scale, angle, etc.) `set` does not update position of object's borders/controls. If you need to update those, call `setCoords()`.\r\n     * @param {String|Object} key Property name or object (if object, iterate over the object properties)\r\n     * @param {Object|Function} value Property value (if function, the value is passed into it and its return value is used as a new one)\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    set: function(key, value) {\r\n      if (typeof key === 'object') {\r\n        this._setObject(key);\r\n      }\r\n      else {\r\n        if (typeof value === 'function' && key !== 'clipTo') {\r\n          this._set(key, value(this.get(key)));\r\n        }\r\n        else {\r\n          this._set(key, value);\r\n        }\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} key\r\n     * @param {Any} value\r\n     * @return {fabric.Object} thisArg\r\n     */\r\n    _set: function(key, value) {\r\n      var shouldConstrainValue = (key === 'scaleX' || key === 'scaleY');\r\n\r\n      if (shouldConstrainValue) {\r\n        value = this._constrainScale(value);\r\n      }\r\n      if (key === 'scaleX' && value < 0) {\r\n        this.flipX = !this.flipX;\r\n        value *= -1;\r\n      }\r\n      else if (key === 'scaleY' && value < 0) {\r\n        this.flipY = !this.flipY;\r\n        value *= -1;\r\n      }\r\n      else if (key === 'width' || key === 'height') {\r\n        this.minScaleLimit = toFixed(Math.min(0.1, 1/Math.max(this.width, this.height)), 2);\r\n      }\r\n      else if (key === 'shadow' && value && !(value instanceof fabric.Shadow)) {\r\n        value = new fabric.Shadow(value);\r\n      }\r\n\r\n      this[key] = value;\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Toggles specified property from `true` to `false` or from `false` to `true`\r\n     * @param {String} property Property to toggle\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    toggle: function(property) {\r\n      var value = this.get(property);\r\n      if (typeof value === 'boolean') {\r\n        this.set(property, !value);\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Sets sourcePath of an object\r\n     * @param {String} value Value to set sourcePath to\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    setSourcePath: function(value) {\r\n      this.sourcePath = value;\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Retrieves viewportTransform from Object's canvas if possible\r\n     * @method getViewportTransform\r\n     * @memberOf fabric.Object.prototype\r\n     * @return {Boolean} flipY value // TODO\r\n     */\r\n    getViewportTransform: function() {\r\n      if (this.canvas && this.canvas.viewportTransform) {\r\n        return this.canvas.viewportTransform;\r\n      }\r\n      return [1, 0, 0, 1, 0, 0];\r\n    },\r\n\r\n    /**\r\n     * Renders an object on a specified context\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {Boolean} [noTransform] When true, context is not transformed\r\n     */\r\n    render: function(ctx, noTransform) {\r\n      // do not render if width/height are zeros or object is not visible\r\n      if ((this.width === 0 && this.height === 0) || !this.visible) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n\r\n      //setup fill rule for current object\r\n      this._setupCompositeOperation(ctx);\r\n      if (!noTransform) {\r\n        this.transform(ctx);\r\n      }\r\n      this._setStrokeStyles(ctx);\r\n      this._setFillStyles(ctx);\r\n      if (this.transformMatrix) {\r\n        ctx.transform.apply(ctx, this.transformMatrix);\r\n      }\r\n      this._setOpacity(ctx);\r\n      this._setShadow(ctx);\r\n      this.clipTo && fabric.util.clipContext(this, ctx);\r\n      this._render(ctx, noTransform);\r\n      this.clipTo && ctx.restore();\r\n      this._removeShadow(ctx);\r\n      this._restoreCompositeOperation(ctx);\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /* @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _setOpacity: function(ctx) {\r\n      if (this.group) {\r\n        this.group._setOpacity(ctx);\r\n      }\r\n      ctx.globalAlpha *= this.opacity;\r\n    },\r\n\r\n    _setStrokeStyles: function(ctx) {\r\n      if (this.stroke) {\r\n        ctx.lineWidth = this.strokeWidth;\r\n        ctx.lineCap = this.strokeLineCap;\r\n        ctx.lineJoin = this.strokeLineJoin;\r\n        ctx.miterLimit = this.strokeMiterLimit;\r\n        ctx.strokeStyle = this.stroke.toLive\r\n          ? this.stroke.toLive(ctx, this)\r\n          : this.stroke;\r\n      }\r\n    },\r\n\r\n    _setFillStyles: function(ctx) {\r\n      if (this.fill) {\r\n        ctx.fillStyle = this.fill.toLive\r\n          ? this.fill.toLive(ctx, this)\r\n          : this.fill;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Renders controls and borders for the object\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {Boolean} [noTransform] When true, context is not transformed\r\n     */\r\n    _renderControls: function(ctx, noTransform) {\r\n      if (!this.active || noTransform) {\r\n        return;\r\n      }\r\n      var vpt = this.getViewportTransform();\r\n      ctx.save();\r\n      var center;\r\n      if (this.group) {\r\n        center = fabric.util.transformPoint(this.group.getCenterPoint(), vpt);\r\n        ctx.translate(center.x, center.y);\r\n        ctx.rotate(degreesToRadians(this.group.angle));\r\n      }\r\n      center = fabric.util.transformPoint(this.getCenterPoint(), vpt, null != this.group);\r\n      if (this.group) {\r\n        center.x *= this.group.scaleX;\r\n        center.y *= this.group.scaleY;\r\n      }\r\n      ctx.translate(center.x, center.y);\r\n      ctx.rotate(degreesToRadians(this.angle));\r\n      this.drawBorders(ctx);\r\n      this.drawControls(ctx);\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _setShadow: function(ctx) {\r\n      if (!this.shadow) {\r\n        return;\r\n      }\r\n\r\n      var multX = (this.canvas && this.canvas.viewportTransform[0]) || 1,\r\n          multY = (this.canvas && this.canvas.viewportTransform[3]) || 1;\r\n\r\n      ctx.shadowColor = this.shadow.color;\r\n      ctx.shadowBlur = this.shadow.blur * (multX + multY) * (this.scaleX + this.scaleY) / 4;\r\n      ctx.shadowOffsetX = this.shadow.offsetX * multX * this.scaleX;\r\n      ctx.shadowOffsetY = this.shadow.offsetY * multY * this.scaleY;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _removeShadow: function(ctx) {\r\n      if (!this.shadow) {\r\n        return;\r\n      }\r\n\r\n      ctx.shadowColor = '';\r\n      ctx.shadowBlur = ctx.shadowOffsetX = ctx.shadowOffsetY = 0;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderFill: function(ctx) {\r\n      if (!this.fill) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n      if (this.fill.gradientTransform) {\r\n        var g = this.fill.gradientTransform;\r\n        ctx.transform.apply(ctx, g);\r\n      }\r\n      if (this.fill.toLive) {\r\n        ctx.translate(\r\n          -this.width / 2 + this.fill.offsetX || 0,\r\n          -this.height / 2 + this.fill.offsetY || 0);\r\n      }\r\n      if (this.fillRule === 'evenodd') {\r\n        ctx.fill('evenodd');\r\n      }\r\n      else {\r\n        ctx.fill();\r\n      }\r\n      ctx.restore();\r\n      if (this.shadow && !this.shadow.affectStroke) {\r\n        this._removeShadow(ctx);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderStroke: function(ctx) {\r\n      if (!this.stroke || this.strokeWidth === 0) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n      if (this.strokeDashArray) {\r\n        // Spec requires the concatenation of two copies the dash list when the number of elements is odd\r\n        if (1 & this.strokeDashArray.length) {\r\n          this.strokeDashArray.push.apply(this.strokeDashArray, this.strokeDashArray);\r\n        }\r\n        if (supportsLineDash) {\r\n          ctx.setLineDash(this.strokeDashArray);\r\n          this._stroke && this._stroke(ctx);\r\n        }\r\n        else {\r\n          this._renderDashedStroke && this._renderDashedStroke(ctx);\r\n        }\r\n        ctx.stroke();\r\n      }\r\n      else {\r\n        if (this.stroke.gradientTransform) {\r\n          var g = this.stroke.gradientTransform;\r\n          ctx.transform.apply(ctx, g);\r\n        }\r\n        this._stroke ? this._stroke(ctx) : ctx.stroke();\r\n      }\r\n      this._removeShadow(ctx);\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Clones an instance\r\n     * @param {Function} callback Callback is invoked with a clone as a first argument\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {fabric.Object} clone of an instance\r\n     */\r\n    clone: function(callback, propertiesToInclude) {\r\n      if (this.constructor.fromObject) {\r\n        return this.constructor.fromObject(this.toObject(propertiesToInclude), callback);\r\n      }\r\n      return new fabric.Object(this.toObject(propertiesToInclude));\r\n    },\r\n\r\n    /**\r\n     * Creates an instance of fabric.Image out of an object\r\n     * @param {Function} callback callback, invoked with an instance as a first argument\r\n     * @return {fabric.Object} thisArg\r\n     */\r\n    cloneAsImage: function(callback) {\r\n      var dataUrl = this.toDataURL();\r\n      fabric.util.loadImage(dataUrl, function(img) {\r\n        if (callback) {\r\n          callback(new fabric.Image(img));\r\n        }\r\n      });\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Converts an object into a data-url-like string\r\n     * @param {Object} options Options object\r\n     * @param {String} [options.format=png] The format of the output image. Either \"jpeg\" or \"png\"\r\n     * @param {Number} [options.quality=1] Quality level (0..1). Only used for jpeg.\r\n     * @param {Number} [options.multiplier=1] Multiplier to scale by\r\n     * @param {Number} [options.left] Cropping left offset. Introduced in v1.2.14\r\n     * @param {Number} [options.top] Cropping top offset. Introduced in v1.2.14\r\n     * @param {Number} [options.width] Cropping width. Introduced in v1.2.14\r\n     * @param {Number} [options.height] Cropping height. Introduced in v1.2.14\r\n     * @return {String} Returns a data: URL containing a representation of the object in the format specified by options.format\r\n     */\r\n    toDataURL: function(options) {\r\n      options || (options = { });\r\n\r\n      var el = fabric.util.createCanvasElement(),\r\n          boundingRect = this.getBoundingRect();\r\n\r\n      el.width = boundingRect.width;\r\n      el.height = boundingRect.height;\r\n\r\n      fabric.util.wrapElement(el, 'div');\r\n      var canvas = new fabric.StaticCanvas(el);\r\n\r\n      // to avoid common confusion https://github.com/kangax/fabric.js/issues/806\r\n      if (options.format === 'jpg') {\r\n        options.format = 'jpeg';\r\n      }\r\n\r\n      if (options.format === 'jpeg') {\r\n        canvas.backgroundColor = '#fff';\r\n      }\r\n\r\n      var origParams = {\r\n        active: this.get('active'),\r\n        left: this.getLeft(),\r\n        top: this.getTop()\r\n      };\r\n\r\n      this.set('active', false);\r\n      this.setPositionByOrigin(new fabric.Point(el.width / 2, el.height / 2), 'center', 'center');\r\n\r\n      var originalCanvas = this.canvas;\r\n      canvas.add(this);\r\n      var data = canvas.toDataURL(options);\r\n\r\n      this.set(origParams).setCoords();\r\n      this.canvas = originalCanvas;\r\n\r\n      canvas.dispose();\r\n      canvas = null;\r\n\r\n      return data;\r\n    },\r\n\r\n    /**\r\n     * Returns true if specified type is identical to the type of an instance\r\n     * @param {String} type Type to check against\r\n     * @return {Boolean}\r\n     */\r\n    isType: function(type) {\r\n      return this.type === type;\r\n    },\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity of this instance\r\n     */\r\n    complexity: function() {\r\n      return 0;\r\n    },\r\n\r\n    /**\r\n     * Returns a JSON representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} JSON\r\n     */\r\n    toJSON: function(propertiesToInclude) {\r\n      // delegate, not alias\r\n      return this.toObject(propertiesToInclude);\r\n    },\r\n\r\n    /**\r\n     * Sets gradient (fill or stroke) of an object\r\n     * <b>Backwards incompatibility note:</b> This method was named \"setGradientFill\" until v1.1.0\r\n     * @param {String} property Property name 'stroke' or 'fill'\r\n     * @param {Object} [options] Options object\r\n     * @param {String} [options.type] Type of gradient 'radial' or 'linear'\r\n     * @param {Number} [options.x1=0] x-coordinate of start point\r\n     * @param {Number} [options.y1=0] y-coordinate of start point\r\n     * @param {Number} [options.x2=0] x-coordinate of end point\r\n     * @param {Number} [options.y2=0] y-coordinate of end point\r\n     * @param {Number} [options.r1=0] Radius of start point (only for radial gradients)\r\n     * @param {Number} [options.r2=0] Radius of end point (only for radial gradients)\r\n     * @param {Object} [options.colorStops] Color stops object eg. {0: 'ff0000', 1: '000000'}\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     * @see {@link http://jsfiddle.net/fabricjs/58y8b/|jsFiddle demo}\r\n     * @example <caption>Set linear gradient</caption>\r\n     * object.setGradient('fill', {\r\n     *   type: 'linear',\r\n     *   x1: -object.width / 2,\r\n     *   y1: 0,\r\n     *   x2: object.width / 2,\r\n     *   y2: 0,\r\n     *   colorStops: {\r\n     *     0: 'red',\r\n     *     0.5: '#005555',\r\n     *     1: 'rgba(0,0,255,0.5)'\r\n     *   }\r\n     * });\r\n     * canvas.renderAll();\r\n     * @example <caption>Set radial gradient</caption>\r\n     * object.setGradient('fill', {\r\n     *   type: 'radial',\r\n     *   x1: 0,\r\n     *   y1: 0,\r\n     *   x2: 0,\r\n     *   y2: 0,\r\n     *   r1: object.width / 2,\r\n     *   r2: 10,\r\n     *   colorStops: {\r\n     *     0: 'red',\r\n     *     0.5: '#005555',\r\n     *     1: 'rgba(0,0,255,0.5)'\r\n     *   }\r\n     * });\r\n     * canvas.renderAll();\r\n     */\r\n    setGradient: function(property, options) {\r\n      options || (options = { });\r\n\r\n      var gradient = { colorStops: [] };\r\n\r\n      gradient.type = options.type || (options.r1 || options.r2 ? 'radial' : 'linear');\r\n      gradient.coords = {\r\n        x1: options.x1,\r\n        y1: options.y1,\r\n        x2: options.x2,\r\n        y2: options.y2\r\n      };\r\n\r\n      if (options.r1 || options.r2) {\r\n        gradient.coords.r1 = options.r1;\r\n        gradient.coords.r2 = options.r2;\r\n      }\r\n\r\n      for (var position in options.colorStops) {\r\n        var color = new fabric.Color(options.colorStops[position]);\r\n        gradient.colorStops.push({\r\n          offset: position,\r\n          color: color.toRgb(),\r\n          opacity: color.getAlpha()\r\n        });\r\n      }\r\n\r\n      return this.set(property, fabric.Gradient.forObject(this, gradient));\r\n    },\r\n\r\n    /**\r\n     * Sets pattern fill of an object\r\n     * @param {Object} options Options object\r\n     * @param {(String|HTMLImageElement)} options.source Pattern source\r\n     * @param {String} [options.repeat=repeat] Repeat property of a pattern (one of repeat, repeat-x, repeat-y or no-repeat)\r\n     * @param {Number} [options.offsetX=0] Pattern horizontal offset from object's left/top corner\r\n     * @param {Number} [options.offsetY=0] Pattern vertical offset from object's left/top corner\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     * @see {@link http://jsfiddle.net/fabricjs/QT3pa/|jsFiddle demo}\r\n     * @example <caption>Set pattern</caption>\r\n     * fabric.util.loadImage('http://fabricjs.com/assets/escheresque_ste.png', function(img) {\r\n     *   object.setPatternFill({\r\n     *     source: img,\r\n     *     repeat: 'repeat'\r\n     *   });\r\n     *   canvas.renderAll();\r\n     * });\r\n     */\r\n    setPatternFill: function(options) {\r\n      return this.set('fill', new fabric.Pattern(options));\r\n    },\r\n\r\n    /**\r\n     * Sets {@link fabric.Object#shadow|shadow} of an object\r\n     * @param {Object|String} [options] Options object or string (e.g. \"2px 2px 10px rgba(0,0,0,0.2)\")\r\n     * @param {String} [options.color=rgb(0,0,0)] Shadow color\r\n     * @param {Number} [options.blur=0] Shadow blur\r\n     * @param {Number} [options.offsetX=0] Shadow horizontal offset\r\n     * @param {Number} [options.offsetY=0] Shadow vertical offset\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     * @see {@link http://jsfiddle.net/fabricjs/7gvJG/|jsFiddle demo}\r\n     * @example <caption>Set shadow with string notation</caption>\r\n     * object.setShadow('2px 2px 10px rgba(0,0,0,0.2)');\r\n     * canvas.renderAll();\r\n     * @example <caption>Set shadow with object notation</caption>\r\n     * object.setShadow({\r\n     *   color: 'red',\r\n     *   blur: 10,\r\n     *   offsetX: 20,\r\n     *   offsetY: 20\r\n     * });\r\n     * canvas.renderAll();\r\n     */\r\n    setShadow: function(options) {\r\n      return this.set('shadow', options ? new fabric.Shadow(options) : null);\r\n    },\r\n\r\n    /**\r\n     * Sets \"color\" of an instance (alias of `set('fill', &hellip;)`)\r\n     * @param {String} color Color value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    setColor: function(color) {\r\n      this.set('fill', color);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Sets \"angle\" of an instance\r\n     * @param {Number} angle Angle value (in degrees)\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    setAngle: function(angle) {\r\n      var shouldCenterOrigin = (this.originX !== 'center' || this.originY !== 'center') && this.centeredRotation;\r\n\r\n      if (shouldCenterOrigin) {\r\n        this._setOriginToCenter();\r\n      }\r\n\r\n      this.set('angle', angle);\r\n\r\n      if (shouldCenterOrigin) {\r\n        this._resetOrigin();\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Centers object horizontally on canvas to which it was added last.\r\n     * You might need to call `setCoords` on an object after centering, to update controls area.\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    centerH: function () {\r\n      this.canvas.centerObjectH(this);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Centers object vertically on canvas to which it was added last.\r\n     * You might need to call `setCoords` on an object after centering, to update controls area.\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    centerV: function () {\r\n      this.canvas.centerObjectV(this);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Centers object vertically and horizontally on canvas to which is was added last\r\n     * You might need to call `setCoords` on an object after centering, to update controls area.\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    center: function () {\r\n      this.canvas.centerObject(this);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Removes object from canvas to which it was added last\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    remove: function() {\r\n      this.canvas.remove(this);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns coordinates of a pointer relative to an object\r\n     * @param {Event} e Event to operate upon\r\n     * @param {Object} [pointer] Pointer to operate upon (instead of event)\r\n     * @return {Object} Coordinates of a pointer (x, y)\r\n     */\r\n    getLocalPointer: function(e, pointer) {\r\n      pointer = pointer || this.canvas.getPointer(e);\r\n      var objectLeftTop = this.translateToOriginPoint(this.getCenterPoint(), 'left', 'top');\r\n      return {\r\n        x: pointer.x - objectLeftTop.x,\r\n        y: pointer.y - objectLeftTop.y\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Sets canvas globalCompositeOperation for specific object\r\n     * custom composition operation for the particular object can be specifed using globalCompositeOperation property\r\n     * @param {CanvasRenderingContext2D} ctx Rendering canvas context\r\n     */\r\n    _setupCompositeOperation: function (ctx) {\r\n      if (this.globalCompositeOperation) {\r\n        this._prevGlobalCompositeOperation = ctx.globalCompositeOperation;\r\n        ctx.globalCompositeOperation = this.globalCompositeOperation;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Restores previously saved canvas globalCompositeOperation after obeject rendering\r\n     * @param {CanvasRenderingContext2D} ctx Rendering canvas context\r\n     */\r\n    _restoreCompositeOperation: function (ctx) {\r\n      if (this.globalCompositeOperation && this._prevGlobalCompositeOperation) {\r\n        ctx.globalCompositeOperation = this._prevGlobalCompositeOperation;\r\n      }\r\n    }\r\n  });\r\n\r\n  fabric.util.createAccessors(fabric.Object);\r\n\r\n  /**\r\n   * Alias for {@link fabric.Object.prototype.setAngle}\r\n   * @alias rotate -> setAngle\r\n   * @memberof fabric.Object\r\n   */\r\n  fabric.Object.prototype.rotate = fabric.Object.prototype.setAngle;\r\n\r\n  extend(fabric.Object.prototype, fabric.Observable);\r\n\r\n  /**\r\n   * Defines the number of fraction digits to use when serializing object values.\r\n   * You can use it to increase/decrease precision of such values like left, top, scaleX, scaleY, etc.\r\n   * @static\r\n   * @memberof fabric.Object\r\n   * @constant\r\n   * @type Number\r\n   */\r\n  fabric.Object.NUM_FRACTION_DIGITS = 2;\r\n\r\n  /**\r\n   * Unique id used internally when creating SVG elements\r\n   * @static\r\n   * @memberof fabric.Object\r\n   * @type Number\r\n   */\r\n  fabric.Object.__uid = 0;\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function() {\r\n\r\n  var degreesToRadians = fabric.util.degreesToRadians;\r\n\r\n  fabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\r\n\r\n    /**\r\n     * Translates the coordinates from origin to center coordinates (based on the object's dimensions)\r\n     * @param {fabric.Point} point The point which corresponds to the originX and originY params\r\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\r\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\r\n     * @return {fabric.Point}\r\n     */\r\n    translateToCenterPoint: function(point, originX, originY) {\r\n      var cx = point.x,\r\n          cy = point.y,\r\n          strokeWidth = this.stroke ? this.strokeWidth : 0;\r\n\r\n      if (originX === 'left') {\r\n        cx = point.x + (this.getWidth() + strokeWidth * this.scaleX) / 2;\r\n      }\r\n      else if (originX === 'right') {\r\n        cx = point.x - (this.getWidth() + strokeWidth * this.scaleX) / 2;\r\n      }\r\n\r\n      if (originY === 'top') {\r\n        cy = point.y + (this.getHeight() + strokeWidth * this.scaleY) / 2;\r\n      }\r\n      else if (originY === 'bottom') {\r\n        cy = point.y - (this.getHeight() + strokeWidth * this.scaleY) / 2;\r\n      }\r\n\r\n      // Apply the reverse rotation to the point (it's already scaled properly)\r\n      return fabric.util.rotatePoint(new fabric.Point(cx, cy), point, degreesToRadians(this.angle));\r\n    },\r\n\r\n    /**\r\n     * Translates the coordinates from center to origin coordinates (based on the object's dimensions)\r\n     * @param {fabric.Point} center The point which corresponds to center of the object\r\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\r\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\r\n     * @return {fabric.Point}\r\n     */\r\n    translateToOriginPoint: function(center, originX, originY) {\r\n      var x = center.x,\r\n          y = center.y,\r\n          strokeWidth = this.stroke ? this.strokeWidth : 0;\r\n\r\n      // Get the point coordinates\r\n      if (originX === 'left') {\r\n        x = center.x - (this.getWidth() + strokeWidth * this.scaleX) / 2;\r\n      }\r\n      else if (originX === 'right') {\r\n        x = center.x + (this.getWidth() + strokeWidth * this.scaleX) / 2;\r\n      }\r\n      if (originY === 'top') {\r\n        y = center.y - (this.getHeight() + strokeWidth * this.scaleY) / 2;\r\n      }\r\n      else if (originY === 'bottom') {\r\n        y = center.y + (this.getHeight() + strokeWidth * this.scaleY) / 2;\r\n      }\r\n\r\n      // Apply the rotation to the point (it's already scaled properly)\r\n      return fabric.util.rotatePoint(new fabric.Point(x, y), center, degreesToRadians(this.angle));\r\n    },\r\n\r\n    /**\r\n     * Returns the real center coordinates of the object\r\n     * @return {fabric.Point}\r\n     */\r\n    getCenterPoint: function() {\r\n      var leftTop = new fabric.Point(this.left, this.top);\r\n      return this.translateToCenterPoint(leftTop, this.originX, this.originY);\r\n    },\r\n\r\n    /**\r\n     * Returns the coordinates of the object based on center coordinates\r\n     * @param {fabric.Point} point The point which corresponds to the originX and originY params\r\n     * @return {fabric.Point}\r\n     */\r\n    // getOriginPoint: function(center) {\r\n    //   return this.translateToOriginPoint(center, this.originX, this.originY);\r\n    // },\r\n\r\n    /**\r\n     * Returns the coordinates of the object as if it has a different origin\r\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\r\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\r\n     * @return {fabric.Point}\r\n     */\r\n    getPointByOrigin: function(originX, originY) {\r\n      var center = this.getCenterPoint();\r\n      return this.translateToOriginPoint(center, originX, originY);\r\n    },\r\n\r\n    /**\r\n     * Returns the point in local coordinates\r\n     * @param {fabric.Point} point The point relative to the global coordinate system\r\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\r\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\r\n     * @return {fabric.Point}\r\n     */\r\n    toLocalPoint: function(point, originX, originY) {\r\n      var center = this.getCenterPoint(),\r\n          strokeWidth = this.stroke ? this.strokeWidth : 0,\r\n          x, y;\r\n\r\n      if (originX && originY) {\r\n        if (originX === 'left') {\r\n          x = center.x - (this.getWidth() + strokeWidth * this.scaleX) / 2;\r\n        }\r\n        else if (originX === 'right') {\r\n          x = center.x + (this.getWidth() + strokeWidth * this.scaleX) / 2;\r\n        }\r\n        else {\r\n          x = center.x;\r\n        }\r\n\r\n        if (originY === 'top') {\r\n          y = center.y - (this.getHeight() + strokeWidth * this.scaleY) / 2;\r\n        }\r\n        else if (originY === 'bottom') {\r\n          y = center.y + (this.getHeight() + strokeWidth * this.scaleY) / 2;\r\n        }\r\n        else {\r\n          y = center.y;\r\n        }\r\n      }\r\n      else {\r\n        x = this.left;\r\n        y = this.top;\r\n      }\r\n\r\n      return fabric.util.rotatePoint(new fabric.Point(point.x, point.y), center, -degreesToRadians(this.angle))\r\n        .subtractEquals(new fabric.Point(x, y));\r\n    },\r\n\r\n    /**\r\n     * Returns the point in global coordinates\r\n     * @param {fabric.Point} The point relative to the local coordinate system\r\n     * @return {fabric.Point}\r\n     */\r\n    // toGlobalPoint: function(point) {\r\n    //   return fabric.util.rotatePoint(point, this.getCenterPoint(), degreesToRadians(this.angle)).addEquals(new fabric.Point(this.left, this.top));\r\n    // },\r\n\r\n    /**\r\n     * Sets the position of the object taking into consideration the object's origin\r\n     * @param {fabric.Point} pos The new position of the object\r\n     * @param {String} originX Horizontal origin: 'left', 'center' or 'right'\r\n     * @param {String} originY Vertical origin: 'top', 'center' or 'bottom'\r\n     * @return {void}\r\n     */\r\n    setPositionByOrigin: function(pos, originX, originY) {\r\n      var center = this.translateToCenterPoint(pos, originX, originY),\r\n          position = this.translateToOriginPoint(center, this.originX, this.originY);\r\n\r\n      this.set('left', position.x);\r\n      this.set('top', position.y);\r\n    },\r\n\r\n    /**\r\n     * @param {String} to One of 'left', 'center', 'right'\r\n     */\r\n    adjustPosition: function(to) {\r\n      var angle = degreesToRadians(this.angle),\r\n          hypotHalf = this.getWidth() / 2,\r\n          xHalf = Math.cos(angle) * hypotHalf,\r\n          yHalf = Math.sin(angle) * hypotHalf,\r\n          hypotFull = this.getWidth(),\r\n          xFull = Math.cos(angle) * hypotFull,\r\n          yFull = Math.sin(angle) * hypotFull;\r\n\r\n      if (this.originX === 'center' && to === 'left' ||\r\n          this.originX === 'right' && to === 'center') {\r\n        // move half left\r\n        this.left -= xHalf;\r\n        this.top -= yHalf;\r\n      }\r\n      else if (this.originX === 'left' && to === 'center' ||\r\n               this.originX === 'center' && to === 'right') {\r\n        // move half right\r\n        this.left += xHalf;\r\n        this.top += yHalf;\r\n      }\r\n      else if (this.originX === 'left' && to === 'right') {\r\n        // move full right\r\n        this.left += xFull;\r\n        this.top += yFull;\r\n      }\r\n      else if (this.originX === 'right' && to === 'left') {\r\n        // move full left\r\n        this.left -= xFull;\r\n        this.top -= yFull;\r\n      }\r\n\r\n      this.setCoords();\r\n      this.originX = to;\r\n    },\r\n\r\n    /**\r\n     * Sets the origin/position of the object to it's center point\r\n     * @private\r\n     * @return {void}\r\n     */\r\n    _setOriginToCenter: function() {\r\n      this._originalOriginX = this.originX;\r\n      this._originalOriginY = this.originY;\r\n\r\n      var center = this.getCenterPoint();\r\n\r\n      this.originX = 'center';\r\n      this.originY = 'center';\r\n\r\n      this.left = center.x;\r\n      this.top = center.y;\r\n    },\r\n\r\n    /**\r\n     * Resets the origin/position of the object to it's original origin\r\n     * @private\r\n     * @return {void}\r\n     */\r\n    _resetOrigin: function() {\r\n      var originPoint = this.translateToOriginPoint(\r\n        this.getCenterPoint(),\r\n        this._originalOriginX,\r\n        this._originalOriginY);\r\n\r\n      this.originX = this._originalOriginX;\r\n      this.originY = this._originalOriginY;\r\n\r\n      this.left = originPoint.x;\r\n      this.top = originPoint.y;\r\n\r\n      this._originalOriginX = null;\r\n      this._originalOriginY = null;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getLeftTopCoords: function() {\r\n      return this.translateToOriginPoint(this.getCenterPoint(), 'left', 'center');\r\n    }\r\n  });\r\n\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  var degreesToRadians = fabric.util.degreesToRadians;\r\n\r\n  fabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\r\n\r\n    /**\r\n     * Object containing coordinates of object's controls\r\n     * @type Object\r\n     * @default\r\n     */\r\n    oCoords: null,\r\n\r\n    /**\r\n     * Checks if object intersects with an area formed by 2 points\r\n     * @param {Object} pointTL top-left point of area\r\n     * @param {Object} pointBR bottom-right point of area\r\n     * @return {Boolean} true if object intersects with an area formed by 2 points\r\n     */\r\n    intersectsWithRect: function(pointTL, pointBR) {\r\n      var oCoords = this.oCoords,\r\n          tl = new fabric.Point(oCoords.tl.x, oCoords.tl.y),\r\n          tr = new fabric.Point(oCoords.tr.x, oCoords.tr.y),\r\n          bl = new fabric.Point(oCoords.bl.x, oCoords.bl.y),\r\n          br = new fabric.Point(oCoords.br.x, oCoords.br.y),\r\n          intersection = fabric.Intersection.intersectPolygonRectangle(\r\n            [tl, tr, br, bl],\r\n            pointTL,\r\n            pointBR\r\n          );\r\n      return intersection.status === 'Intersection';\r\n    },\r\n\r\n    /**\r\n     * Checks if object intersects with another object\r\n     * @param {Object} other Object to test\r\n     * @return {Boolean} true if object intersects with another object\r\n     */\r\n    intersectsWithObject: function(other) {\r\n      // extracts coords\r\n      function getCoords(oCoords) {\r\n        return {\r\n          tl: new fabric.Point(oCoords.tl.x, oCoords.tl.y),\r\n          tr: new fabric.Point(oCoords.tr.x, oCoords.tr.y),\r\n          bl: new fabric.Point(oCoords.bl.x, oCoords.bl.y),\r\n          br: new fabric.Point(oCoords.br.x, oCoords.br.y)\r\n        };\r\n      }\r\n      var thisCoords = getCoords(this.oCoords),\r\n          otherCoords = getCoords(other.oCoords),\r\n          intersection = fabric.Intersection.intersectPolygonPolygon(\r\n            [thisCoords.tl, thisCoords.tr, thisCoords.br, thisCoords.bl],\r\n            [otherCoords.tl, otherCoords.tr, otherCoords.br, otherCoords.bl]\r\n          );\r\n\r\n      return intersection.status === 'Intersection';\r\n    },\r\n\r\n    /**\r\n     * Checks if object is fully contained within area of another object\r\n     * @param {Object} other Object to test\r\n     * @return {Boolean} true if object is fully contained within area of another object\r\n     */\r\n    isContainedWithinObject: function(other) {\r\n      var boundingRect = other.getBoundingRect(),\r\n          point1 = new fabric.Point(boundingRect.left, boundingRect.top),\r\n          point2 = new fabric.Point(boundingRect.left + boundingRect.width, boundingRect.top + boundingRect.height);\r\n\r\n      return this.isContainedWithinRect(point1, point2);\r\n    },\r\n\r\n    /**\r\n     * Checks if object is fully contained within area formed by 2 points\r\n     * @param {Object} pointTL top-left point of area\r\n     * @param {Object} pointBR bottom-right point of area\r\n     * @return {Boolean} true if object is fully contained within area formed by 2 points\r\n     */\r\n    isContainedWithinRect: function(pointTL, pointBR) {\r\n      var boundingRect = this.getBoundingRect();\r\n\r\n      return (\r\n        boundingRect.left >= pointTL.x &&\r\n        boundingRect.left + boundingRect.width <= pointBR.x &&\r\n        boundingRect.top >= pointTL.y &&\r\n        boundingRect.top + boundingRect.height <= pointBR.y\r\n      );\r\n    },\r\n\r\n    /**\r\n     * Checks if point is inside the object\r\n     * @param {fabric.Point} point Point to check against\r\n     * @return {Boolean} true if point is inside the object\r\n     */\r\n    containsPoint: function(point) {\r\n      var lines = this._getImageLines(this.oCoords),\r\n          xPoints = this._findCrossPoints(point, lines);\r\n\r\n      // if xPoints is odd then point is inside the object\r\n      return (xPoints !== 0 && xPoints % 2 === 1);\r\n    },\r\n\r\n    /**\r\n     * Method that returns an object with the object edges in it, given the coordinates of the corners\r\n     * @private\r\n     * @param {Object} oCoords Coordinates of the object corners\r\n     */\r\n    _getImageLines: function(oCoords) {\r\n      return {\r\n        topline: {\r\n          o: oCoords.tl,\r\n          d: oCoords.tr\r\n        },\r\n        rightline: {\r\n          o: oCoords.tr,\r\n          d: oCoords.br\r\n        },\r\n        bottomline: {\r\n          o: oCoords.br,\r\n          d: oCoords.bl\r\n        },\r\n        leftline: {\r\n          o: oCoords.bl,\r\n          d: oCoords.tl\r\n        }\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Helper method to determine how many cross points are between the 4 object edges\r\n     * and the horizontal line determined by a point on canvas\r\n     * @private\r\n     * @param {fabric.Point} point Point to check\r\n     * @param {Object} oCoords Coordinates of the object being evaluated\r\n     */\r\n    _findCrossPoints: function(point, oCoords) {\r\n      var b1, b2, a1, a2, xi, yi,\r\n          xcount = 0,\r\n          iLine;\r\n\r\n      for (var lineKey in oCoords) {\r\n        iLine = oCoords[lineKey];\r\n        // optimisation 1: line below point. no cross\r\n        if ((iLine.o.y < point.y) && (iLine.d.y < point.y)) {\r\n          continue;\r\n        }\r\n        // optimisation 2: line above point. no cross\r\n        if ((iLine.o.y >= point.y) && (iLine.d.y >= point.y)) {\r\n          continue;\r\n        }\r\n        // optimisation 3: vertical line case\r\n        if ((iLine.o.x === iLine.d.x) && (iLine.o.x >= point.x)) {\r\n          xi = iLine.o.x;\r\n          yi = point.y;\r\n        }\r\n        // calculate the intersection point\r\n        else {\r\n          b1 = 0;\r\n          b2 = (iLine.d.y - iLine.o.y) / (iLine.d.x - iLine.o.x);\r\n          a1 = point.y - b1 * point.x;\r\n          a2 = iLine.o.y - b2 * iLine.o.x;\r\n\r\n          xi = - (a1 - a2) / (b1 - b2);\r\n          yi = a1 + b1 * xi;\r\n        }\r\n        // dont count xi < point.x cases\r\n        if (xi >= point.x) {\r\n          xcount += 1;\r\n        }\r\n        // optimisation 4: specific for square images\r\n        if (xcount === 2) {\r\n          break;\r\n        }\r\n      }\r\n      return xcount;\r\n    },\r\n\r\n    /**\r\n     * Returns width of an object's bounding rectangle\r\n     * @deprecated since 1.0.4\r\n     * @return {Number} width value\r\n     */\r\n    getBoundingRectWidth: function() {\r\n      return this.getBoundingRect().width;\r\n    },\r\n\r\n    /**\r\n     * Returns height of an object's bounding rectangle\r\n     * @deprecated since 1.0.4\r\n     * @return {Number} height value\r\n     */\r\n    getBoundingRectHeight: function() {\r\n      return this.getBoundingRect().height;\r\n    },\r\n\r\n    /**\r\n     * Returns coordinates of object's bounding rectangle (left, top, width, height)\r\n     * @return {Object} Object with left, top, width, height properties\r\n     */\r\n    getBoundingRect: function() {\r\n      this.oCoords || this.setCoords();\r\n\r\n      var xCoords = [this.oCoords.tl.x, this.oCoords.tr.x, this.oCoords.br.x, this.oCoords.bl.x],\r\n          minX = fabric.util.array.min(xCoords),\r\n          maxX = fabric.util.array.max(xCoords),\r\n          width = Math.abs(minX - maxX),\r\n\r\n          yCoords = [this.oCoords.tl.y, this.oCoords.tr.y, this.oCoords.br.y, this.oCoords.bl.y],\r\n          minY = fabric.util.array.min(yCoords),\r\n          maxY = fabric.util.array.max(yCoords),\r\n          height = Math.abs(minY - maxY);\r\n\r\n      return {\r\n        left: minX,\r\n        top: minY,\r\n        width: width,\r\n        height: height\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Returns width of an object\r\n     * @return {Number} width value\r\n     */\r\n    getWidth: function() {\r\n      return this.width * this.scaleX;\r\n    },\r\n\r\n    /**\r\n     * Returns height of an object\r\n     * @return {Number} height value\r\n     */\r\n    getHeight: function() {\r\n      return this.height * this.scaleY;\r\n    },\r\n\r\n    /**\r\n     * Makes sure the scale is valid and modifies it if necessary\r\n     * @private\r\n     * @param {Number} value\r\n     * @return {Number}\r\n     */\r\n    _constrainScale: function(value) {\r\n      if (Math.abs(value) < this.minScaleLimit) {\r\n        if (value < 0) {\r\n          return -this.minScaleLimit;\r\n        }\r\n        else {\r\n          return this.minScaleLimit;\r\n        }\r\n      }\r\n      return value;\r\n    },\r\n\r\n    /**\r\n     * Scales an object (equally by x and y)\r\n     * @param {Number} value Scale factor\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    scale: function(value) {\r\n      value = this._constrainScale(value);\r\n\r\n      if (value < 0) {\r\n        this.flipX = !this.flipX;\r\n        this.flipY = !this.flipY;\r\n        value *= -1;\r\n      }\r\n\r\n      this.scaleX = value;\r\n      this.scaleY = value;\r\n      this.setCoords();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Scales an object to a given width, with respect to bounding box (scaling by x/y equally)\r\n     * @param {Number} value New width value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    scaleToWidth: function(value) {\r\n      // adjust to bounding rect factor so that rotated shapes would fit as well\r\n      var boundingRectFactor = this.getBoundingRectWidth() / this.getWidth();\r\n      return this.scale(value / this.width / boundingRectFactor);\r\n    },\r\n\r\n    /**\r\n     * Scales an object to a given height, with respect to bounding box (scaling by x/y equally)\r\n     * @param {Number} value New height value\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    scaleToHeight: function(value) {\r\n      // adjust to bounding rect factor so that rotated shapes would fit as well\r\n      var boundingRectFactor = this.getBoundingRectHeight() / this.getHeight();\r\n      return this.scale(value / this.height / boundingRectFactor);\r\n    },\r\n\r\n    /**\r\n     * Sets corner position coordinates based on current angle, width and height\r\n     * See https://github.com/kangax/fabric.js/wiki/When-to-call-setCoords\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    setCoords: function() {\r\n      var theta = degreesToRadians(this.angle),\r\n          vpt = this.getViewportTransform(),\r\n          f = function (p) {\r\n            return fabric.util.transformPoint(p, vpt);\r\n          },\r\n          p = this._calculateCurrentDimensions(false),\r\n          currentWidth = p.x, currentHeight = p.y;\r\n\r\n      // If width is negative, make postive. Fixes path selection issue\r\n      if (currentWidth < 0) {\r\n        currentWidth = Math.abs(currentWidth);\r\n      }\r\n\r\n      var _hypotenuse = Math.sqrt(\r\n            Math.pow(currentWidth / 2, 2) +\r\n            Math.pow(currentHeight / 2, 2)),\r\n\r\n          _angle = Math.atan(\r\n            isFinite(currentHeight / currentWidth)\r\n              ? currentHeight / currentWidth\r\n              : 0),\r\n\r\n          // offset added for rotate and scale actions\r\n          offsetX = Math.cos(_angle + theta) * _hypotenuse,\r\n          offsetY = Math.sin(_angle + theta) * _hypotenuse,\r\n          sinTh = Math.sin(theta),\r\n          cosTh = Math.cos(theta),\r\n          coords = this.getCenterPoint(),\r\n          wh = new fabric.Point(currentWidth, currentHeight),\r\n          _tl =   new fabric.Point(coords.x - offsetX, coords.y - offsetY),\r\n          _tr =   new fabric.Point(_tl.x + (wh.x * cosTh),   _tl.y + (wh.x * sinTh)),\r\n          bl =  f(new fabric.Point(_tl.x - (wh.y * sinTh),   _tl.y + (wh.y * cosTh))),\r\n          br  = f(new fabric.Point(_tr.x - (wh.y * sinTh),   _tr.y + (wh.y * cosTh))),\r\n          tl  = f(_tl),\r\n          tr  = f(_tr),\r\n          ml  = new fabric.Point((tl.x + bl.x)/2, (tl.y + bl.y)/2),\r\n          mt  = new fabric.Point((tr.x + tl.x)/2, (tr.y + tl.y)/2),\r\n          mr  = new fabric.Point((br.x + tr.x)/2, (br.y + tr.y)/2),\r\n          mb  = new fabric.Point((br.x + bl.x)/2, (br.y + bl.y)/2),\r\n          mtr = new fabric.Point(mt.x + sinTh * this.rotatingPointOffset, mt.y - cosTh * this.rotatingPointOffset);\r\n      // debugging\r\n\r\n      /* setTimeout(function() {\r\n         canvas.contextTop.fillStyle = 'green';\r\n         canvas.contextTop.fillRect(mb.x, mb.y, 3, 3);\r\n         canvas.contextTop.fillRect(bl.x, bl.y, 3, 3);\r\n         canvas.contextTop.fillRect(br.x, br.y, 3, 3);\r\n         canvas.contextTop.fillRect(tl.x, tl.y, 3, 3);\r\n         canvas.contextTop.fillRect(tr.x, tr.y, 3, 3);\r\n         canvas.contextTop.fillRect(ml.x, ml.y, 3, 3);\r\n         canvas.contextTop.fillRect(mr.x, mr.y, 3, 3);\r\n         canvas.contextTop.fillRect(mt.x, mt.y, 3, 3);\r\n         canvas.contextTop.fillRect(mtr.x, mtr.y, 3, 3);\r\n       }, 50); */\r\n\r\n      this.oCoords = {\r\n        // corners\r\n        tl: tl, tr: tr, br: br, bl: bl,\r\n        // middle\r\n        ml: ml, mt: mt, mr: mr, mb: mb,\r\n        // rotating point\r\n        mtr: mtr\r\n      };\r\n\r\n      // set coordinates of the draggable boxes in the corners used to scale/rotate the image\r\n      this._setCornerCoords && this._setCornerCoords();\r\n\r\n      return this;\r\n    }\r\n  });\r\n})();\r\n\r\n\r\nfabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\r\n\r\n  /**\r\n   * Moves an object to the bottom of the stack of drawn objects\r\n   * @return {fabric.Object} thisArg\r\n   * @chainable\r\n   */\r\n  sendToBack: function() {\r\n    if (this.group) {\r\n      fabric.StaticCanvas.prototype.sendToBack.call(this.group, this);\r\n    }\r\n    else {\r\n      this.canvas.sendToBack(this);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Moves an object to the top of the stack of drawn objects\r\n   * @return {fabric.Object} thisArg\r\n   * @chainable\r\n   */\r\n  bringToFront: function() {\r\n    if (this.group) {\r\n      fabric.StaticCanvas.prototype.bringToFront.call(this.group, this);\r\n    }\r\n    else {\r\n      this.canvas.bringToFront(this);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Moves an object down in stack of drawn objects\r\n   * @param {Boolean} [intersecting] If `true`, send object behind next lower intersecting object\r\n   * @return {fabric.Object} thisArg\r\n   * @chainable\r\n   */\r\n  sendBackwards: function(intersecting) {\r\n    if (this.group) {\r\n      fabric.StaticCanvas.prototype.sendBackwards.call(this.group, this, intersecting);\r\n    }\r\n    else {\r\n      this.canvas.sendBackwards(this, intersecting);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Moves an object up in stack of drawn objects\r\n   * @param {Boolean} [intersecting] If `true`, send object in front of next upper intersecting object\r\n   * @return {fabric.Object} thisArg\r\n   * @chainable\r\n   */\r\n  bringForward: function(intersecting) {\r\n    if (this.group) {\r\n      fabric.StaticCanvas.prototype.bringForward.call(this.group, this, intersecting);\r\n    }\r\n    else {\r\n      this.canvas.bringForward(this, intersecting);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Moves an object to specified level in stack of drawn objects\r\n   * @param {Number} index New position of object\r\n   * @return {fabric.Object} thisArg\r\n   * @chainable\r\n   */\r\n  moveTo: function(index) {\r\n    if (this.group) {\r\n      fabric.StaticCanvas.prototype.moveTo.call(this.group, this, index);\r\n    }\r\n    else {\r\n      this.canvas.moveTo(this, index);\r\n    }\r\n    return this;\r\n  }\r\n});\r\n\r\n\r\n/* _TO_SVG_START_ */\r\nfabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\r\n\r\n  /**\r\n   * Returns styles-string for svg-export\r\n   * @return {String}\r\n   */\r\n  getSvgStyles: function() {\r\n\r\n    var fill = this.fill\r\n          ? (this.fill.toLive ? 'url(#SVGID_' + this.fill.id + ')' : this.fill)\r\n          : 'none',\r\n        fillRule = this.fillRule,\r\n        stroke = this.stroke\r\n          ? (this.stroke.toLive ? 'url(#SVGID_' + this.stroke.id + ')' : this.stroke)\r\n          : 'none',\r\n\r\n        strokeWidth = this.strokeWidth ? this.strokeWidth : '0',\r\n        strokeDashArray = this.strokeDashArray ? this.strokeDashArray.join(' ') : '',\r\n        strokeLineCap = this.strokeLineCap ? this.strokeLineCap : 'butt',\r\n        strokeLineJoin = this.strokeLineJoin ? this.strokeLineJoin : 'miter',\r\n        strokeMiterLimit = this.strokeMiterLimit ? this.strokeMiterLimit : '4',\r\n        opacity = typeof this.opacity !== 'undefined' ? this.opacity : '1',\r\n\r\n        visibility = this.visible ? '' : ' visibility: hidden;',\r\n        filter = this.shadow ? 'filter: url(#SVGID_' + this.shadow.id + ');' : '';\r\n\r\n    return [\r\n      'stroke: ', stroke, '; ',\r\n      'stroke-width: ', strokeWidth, '; ',\r\n      'stroke-dasharray: ', strokeDashArray, '; ',\r\n      'stroke-linecap: ', strokeLineCap, '; ',\r\n      'stroke-linejoin: ', strokeLineJoin, '; ',\r\n      'stroke-miterlimit: ', strokeMiterLimit, '; ',\r\n      'fill: ', fill, '; ',\r\n      'fill-rule: ', fillRule, '; ',\r\n      'opacity: ', opacity, ';',\r\n      filter,\r\n      visibility\r\n    ].join('');\r\n  },\r\n\r\n  /**\r\n   * Returns transform-string for svg-export\r\n   * @return {String}\r\n   */\r\n  getSvgTransform: function() {\r\n    if (this.group && this.group.type === 'path-group') {\r\n      return '';\r\n    }\r\n    var toFixed = fabric.util.toFixed,\r\n        angle = this.getAngle(),\r\n        vpt = !this.canvas || this.canvas.svgViewportTransformation ? this.getViewportTransform() : [1, 0, 0, 1, 0, 0],\r\n        center = fabric.util.transformPoint(this.getCenterPoint(), vpt),\r\n\r\n        NUM_FRACTION_DIGITS = fabric.Object.NUM_FRACTION_DIGITS,\r\n\r\n        translatePart = this.type === 'path-group' ? '' : 'translate(' +\r\n                          toFixed(center.x, NUM_FRACTION_DIGITS) +\r\n                          ' ' +\r\n                          toFixed(center.y, NUM_FRACTION_DIGITS) +\r\n                        ')',\r\n\r\n        anglePart = angle !== 0\r\n          ? (' rotate(' + toFixed(angle, NUM_FRACTION_DIGITS) + ')')\r\n          : '',\r\n\r\n        scalePart = (this.scaleX === 1 && this.scaleY === 1 && vpt[0] === 1 && vpt[3] === 1)\r\n          ? '' :\r\n          (' scale(' +\r\n            toFixed(this.scaleX * vpt[0], NUM_FRACTION_DIGITS) +\r\n            ' ' +\r\n            toFixed(this.scaleY * vpt[3], NUM_FRACTION_DIGITS) +\r\n          ')'),\r\n\r\n        addTranslateX = this.type === 'path-group' ? this.width * vpt[0] : 0,\r\n\r\n        flipXPart = this.flipX ? ' matrix(-1 0 0 1 ' + addTranslateX + ' 0) ' : '',\r\n\r\n        addTranslateY = this.type === 'path-group' ? this.height * vpt[3] : 0,\r\n\r\n        flipYPart = this.flipY ? ' matrix(1 0 0 -1 0 ' + addTranslateY + ')' : '';\r\n\r\n    return [\r\n      translatePart, anglePart, scalePart, flipXPart, flipYPart\r\n    ].join('');\r\n  },\r\n\r\n  /**\r\n   * Returns transform-string for svg-export from the transform matrix of single elements\r\n   * @return {String}\r\n   */\r\n  getSvgTransformMatrix: function() {\r\n    return this.transformMatrix ? ' matrix(' + this.transformMatrix.join(' ') + ') ' : '';\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _createBaseSVGMarkup: function() {\r\n    var markup = [ ];\r\n\r\n    if (this.fill && this.fill.toLive) {\r\n      markup.push(this.fill.toSVG(this, false));\r\n    }\r\n    if (this.stroke && this.stroke.toLive) {\r\n      markup.push(this.stroke.toSVG(this, false));\r\n    }\r\n    if (this.shadow) {\r\n      markup.push(this.shadow.toSVG(this));\r\n    }\r\n    return markup;\r\n  }\r\n});\r\n/* _TO_SVG_END_ */\r\n\r\n\r\n/*\r\n  Depends on `stateProperties`\r\n*/\r\nfabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\r\n\r\n  /**\r\n   * Returns true if object state (one of its state properties) was changed\r\n   * @return {Boolean} true if instance' state has changed since `{@link fabric.Object#saveState}` was called\r\n   */\r\n  hasStateChanged: function() {\r\n    return this.stateProperties.some(function(prop) {\r\n      return this.get(prop) !== this.originalState[prop];\r\n    }, this);\r\n  },\r\n\r\n  /**\r\n   * Saves state of an object\r\n   * @param {Object} [options] Object with additional `stateProperties` array to include when saving state\r\n   * @return {fabric.Object} thisArg\r\n   */\r\n  saveState: function(options) {\r\n    this.stateProperties.forEach(function(prop) {\r\n      this.originalState[prop] = this.get(prop);\r\n    }, this);\r\n\r\n    if (options && options.stateProperties) {\r\n      options.stateProperties.forEach(function(prop) {\r\n        this.originalState[prop] = this.get(prop);\r\n      }, this);\r\n    }\r\n\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Setups state of an object\r\n   * @return {fabric.Object} thisArg\r\n   */\r\n  setupState: function() {\r\n    this.originalState = { };\r\n    this.saveState();\r\n\r\n    return this;\r\n  }\r\n});\r\n\r\n\r\n(function() {\r\n\r\n  var degreesToRadians = fabric.util.degreesToRadians,\r\n      //jscs:disable requireCamelCaseOrUpperCaseIdentifiers\r\n      isVML = function() { return typeof G_vmlCanvasManager !== 'undefined'; };\r\n  //jscs:enable requireCamelCaseOrUpperCaseIdentifiers\r\n\r\n  fabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\r\n\r\n    /**\r\n     * The object interactivity controls.\r\n     * @private\r\n     */\r\n    _controlsVisibility: null,\r\n\r\n    /**\r\n     * Determines which corner has been clicked\r\n     * @private\r\n     * @param {Object} pointer The pointer indicating the mouse position\r\n     * @return {String|Boolean} corner code (tl, tr, bl, br, etc.), or false if nothing is found\r\n     */\r\n    _findTargetCorner: function(pointer) {\r\n      if (!this.hasControls || !this.active) {\r\n        return false;\r\n      }\r\n\r\n      var ex = pointer.x,\r\n          ey = pointer.y,\r\n          xPoints,\r\n          lines;\r\n\r\n      for (var i in this.oCoords) {\r\n\r\n        if (!this.isControlVisible(i)) {\r\n          continue;\r\n        }\r\n\r\n        if (i === 'mtr' && !this.hasRotatingPoint) {\r\n          continue;\r\n        }\r\n\r\n        if (this.get('lockUniScaling') &&\r\n           (i === 'mt' || i === 'mr' || i === 'mb' || i === 'ml')) {\r\n          continue;\r\n        }\r\n\r\n        lines = this._getImageLines(this.oCoords[i].corner);\r\n\r\n        // debugging\r\n\r\n        // canvas.contextTop.fillRect(lines.bottomline.d.x, lines.bottomline.d.y, 2, 2);\r\n        // canvas.contextTop.fillRect(lines.bottomline.o.x, lines.bottomline.o.y, 2, 2);\r\n\r\n        // canvas.contextTop.fillRect(lines.leftline.d.x, lines.leftline.d.y, 2, 2);\r\n        // canvas.contextTop.fillRect(lines.leftline.o.x, lines.leftline.o.y, 2, 2);\r\n\r\n        // canvas.contextTop.fillRect(lines.topline.d.x, lines.topline.d.y, 2, 2);\r\n        // canvas.contextTop.fillRect(lines.topline.o.x, lines.topline.o.y, 2, 2);\r\n\r\n        // canvas.contextTop.fillRect(lines.rightline.d.x, lines.rightline.d.y, 2, 2);\r\n        // canvas.contextTop.fillRect(lines.rightline.o.x, lines.rightline.o.y, 2, 2);\r\n\r\n        xPoints = this._findCrossPoints({ x: ex, y: ey }, lines);\r\n        if (xPoints !== 0 && xPoints % 2 === 1) {\r\n          this.__corner = i;\r\n          return i;\r\n        }\r\n      }\r\n      return false;\r\n    },\r\n\r\n    /**\r\n     * Sets the coordinates of the draggable boxes in the corners of\r\n     * the image used to scale/rotate it.\r\n     * @private\r\n     */\r\n    _setCornerCoords: function() {\r\n      var coords = this.oCoords,\r\n          newTheta = degreesToRadians(45 - this.angle),\r\n          cornerHypotenuse = Math.sqrt(2 * Math.pow(this.cornerSize, 2)) / 2,\r\n          cosHalfOffset = cornerHypotenuse * Math.cos(newTheta),\r\n          sinHalfOffset = cornerHypotenuse * Math.sin(newTheta),\r\n          x, y;\r\n\r\n      for (var point in coords) {\r\n        x = coords[point].x;\r\n        y = coords[point].y;\r\n        coords[point].corner = {\r\n          tl: {\r\n            x: x - sinHalfOffset,\r\n            y: y - cosHalfOffset\r\n          },\r\n          tr: {\r\n            x: x + cosHalfOffset,\r\n            y: y - sinHalfOffset\r\n          },\r\n          bl: {\r\n            x: x - cosHalfOffset,\r\n            y: y + sinHalfOffset\r\n          },\r\n          br: {\r\n            x: x + sinHalfOffset,\r\n            y: y + cosHalfOffset\r\n          }\r\n        };\r\n      }\r\n    },\r\n\r\n    _calculateCurrentDimensions: function(shouldTransform)  {\r\n      var vpt = this.getViewportTransform(),\r\n          strokeWidth = this.strokeWidth,\r\n          w = this.width,\r\n          h = this.height,\r\n          capped = this.strokeLineCap === 'round' || this.strokeLineCap === 'square',\r\n          vLine = this.type === 'line' && this.width === 0,\r\n          hLine = this.type === 'line' && this.height === 0,\r\n          sLine = vLine || hLine,\r\n          strokeW = (capped && hLine) || !sLine,\r\n          strokeH = (capped && vLine) || !sLine;\r\n\r\n      if (vLine) {\r\n        w = strokeWidth;\r\n      }\r\n      else if (hLine) {\r\n        h = strokeWidth;\r\n      }\r\n      if (strokeW) {\r\n        w += (w < 0 ? -strokeWidth : strokeWidth);\r\n      }\r\n      if (strokeH) {\r\n        h += (h < 0 ? -strokeWidth : strokeWidth);\r\n      }\r\n\r\n      w = w * this.scaleX + 2 * this.padding;\r\n      h = h * this.scaleY + 2 * this.padding;\r\n\r\n      if (shouldTransform) {\r\n        return fabric.util.transformPoint(new fabric.Point(w, h), vpt, true);\r\n      }\r\n      return { x: w, y: h };\r\n    },\r\n\r\n    /**\r\n     * Draws borders of an object's bounding box.\r\n     * Requires public properties: width, height\r\n     * Requires public options: padding, borderColor\r\n     * @param {CanvasRenderingContext2D} ctx Context to draw on\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    drawBorders: function(ctx) {\r\n      if (!this.hasBorders) {\r\n        return this;\r\n      }\r\n\r\n      ctx.save();\r\n\r\n      ctx.globalAlpha = this.isMoving ? this.borderOpacityWhenMoving : 1;\r\n      ctx.strokeStyle = this.borderColor;\r\n      ctx.lineWidth = 1 / this.borderScaleFactor;\r\n\r\n      var wh = this._calculateCurrentDimensions(true),\r\n          width = wh.x,\r\n          height = wh.y;\r\n      if (this.group) {\r\n        width = width * this.group.scaleX;\r\n        height = height * this.group.scaleY;\r\n      }\r\n\r\n      ctx.strokeRect(\r\n        ~~(-(width / 2)) - 0.5, // offset needed to make lines look sharper\r\n        ~~(-(height / 2)) - 0.5,\r\n        ~~(width) + 1, // double offset needed to make lines look sharper\r\n        ~~(height) + 1\r\n      );\r\n\r\n      if (this.hasRotatingPoint && this.isControlVisible('mtr') && !this.get('lockRotation') && this.hasControls) {\r\n\r\n        var rotateHeight = -height / 2;\r\n\r\n        ctx.beginPath();\r\n        ctx.moveTo(0, rotateHeight);\r\n        ctx.lineTo(0, rotateHeight - this.rotatingPointOffset);\r\n        ctx.closePath();\r\n        ctx.stroke();\r\n      }\r\n\r\n      ctx.restore();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Draws corners of an object's bounding box.\r\n     * Requires public properties: width, height\r\n     * Requires public options: cornerSize, padding\r\n     * @param {CanvasRenderingContext2D} ctx Context to draw on\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    drawControls: function(ctx) {\r\n      if (!this.hasControls) {\r\n        return this;\r\n      }\r\n\r\n      var wh = this._calculateCurrentDimensions(true),\r\n          width = wh.x,\r\n          height = wh.y,\r\n          left = -(width / 2),\r\n          top = -(height / 2),\r\n          scaleOffset = this.cornerSize / 2,\r\n          methodName = this.transparentCorners ? 'strokeRect' : 'fillRect';\r\n\r\n      ctx.save();\r\n\r\n      ctx.lineWidth = 1;\r\n\r\n      ctx.globalAlpha = this.isMoving ? this.borderOpacityWhenMoving : 1;\r\n      ctx.strokeStyle = ctx.fillStyle = this.cornerColor;\r\n\r\n      // top-left\r\n      this._drawControl('tl', ctx, methodName,\r\n        left - scaleOffset,\r\n        top - scaleOffset);\r\n\r\n      // top-right\r\n      this._drawControl('tr', ctx, methodName,\r\n        left + width - scaleOffset,\r\n        top - scaleOffset);\r\n\r\n      // bottom-left\r\n      this._drawControl('bl', ctx, methodName,\r\n        left - scaleOffset,\r\n        top + height - scaleOffset);\r\n\r\n      // bottom-right\r\n      this._drawControl('br', ctx, methodName,\r\n        left + width - scaleOffset,\r\n        top + height - scaleOffset);\r\n\r\n      if (!this.get('lockUniScaling')) {\r\n\r\n        // middle-top\r\n        this._drawControl('mt', ctx, methodName,\r\n          left + width/2 - scaleOffset,\r\n          top - scaleOffset);\r\n\r\n        // middle-bottom\r\n        this._drawControl('mb', ctx, methodName,\r\n          left + width/2 - scaleOffset,\r\n          top + height - scaleOffset);\r\n\r\n        // middle-right\r\n        this._drawControl('mr', ctx, methodName,\r\n          left + width - scaleOffset,\r\n          top + height/2 - scaleOffset);\r\n\r\n        // middle-left\r\n        this._drawControl('ml', ctx, methodName,\r\n          left - scaleOffset,\r\n          top + height/2 - scaleOffset);\r\n      }\r\n\r\n      // middle-top-rotate\r\n      if (this.hasRotatingPoint) {\r\n        this._drawControl('mtr', ctx, methodName,\r\n          left + width/2 - scaleOffset,\r\n          top - this.rotatingPointOffset - scaleOffset);\r\n      }\r\n\r\n      ctx.restore();\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _drawControl: function(control, ctx, methodName, left, top) {\r\n      if (!this.isControlVisible(control)) {\r\n        return;\r\n      }\r\n      var size = this.cornerSize;\r\n      isVML() || this.transparentCorners || ctx.clearRect(left, top, size, size);\r\n      ctx[methodName](left, top, size, size);\r\n    },\r\n\r\n    /**\r\n     * Returns true if the specified control is visible, false otherwise.\r\n     * @param {String} controlName The name of the control. Possible values are 'tl', 'tr', 'br', 'bl', 'ml', 'mt', 'mr', 'mb', 'mtr'.\r\n     * @returns {Boolean} true if the specified control is visible, false otherwise\r\n     */\r\n    isControlVisible: function(controlName) {\r\n      return this._getControlsVisibility()[controlName];\r\n    },\r\n\r\n    /**\r\n     * Sets the visibility of the specified control.\r\n     * @param {String} controlName The name of the control. Possible values are 'tl', 'tr', 'br', 'bl', 'ml', 'mt', 'mr', 'mb', 'mtr'.\r\n     * @param {Boolean} visible true to set the specified control visible, false otherwise\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    setControlVisible: function(controlName, visible) {\r\n      this._getControlsVisibility()[controlName] = visible;\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Sets the visibility state of object controls.\r\n     * @param {Object} [options] Options object\r\n     * @param {Boolean} [options.bl] true to enable the bottom-left control, false to disable it\r\n     * @param {Boolean} [options.br] true to enable the bottom-right control, false to disable it\r\n     * @param {Boolean} [options.mb] true to enable the middle-bottom control, false to disable it\r\n     * @param {Boolean} [options.ml] true to enable the middle-left control, false to disable it\r\n     * @param {Boolean} [options.mr] true to enable the middle-right control, false to disable it\r\n     * @param {Boolean} [options.mt] true to enable the middle-top control, false to disable it\r\n     * @param {Boolean} [options.tl] true to enable the top-left control, false to disable it\r\n     * @param {Boolean} [options.tr] true to enable the top-right control, false to disable it\r\n     * @param {Boolean} [options.mtr] true to enable the middle-top-rotate control, false to disable it\r\n     * @return {fabric.Object} thisArg\r\n     * @chainable\r\n     */\r\n    setControlsVisibility: function(options) {\r\n      options || (options = { });\r\n\r\n      for (var p in options) {\r\n        this.setControlVisible(p, options[p]);\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns the instance of the control visibility set for this object.\r\n     * @private\r\n     * @returns {Object}\r\n     */\r\n    _getControlsVisibility: function() {\r\n      if (!this._controlsVisibility) {\r\n        this._controlsVisibility = {\r\n          tl: true,\r\n          tr: true,\r\n          br: true,\r\n          bl: true,\r\n          ml: true,\r\n          mt: true,\r\n          mr: true,\r\n          mb: true,\r\n          mtr: true\r\n        };\r\n      }\r\n      return this._controlsVisibility;\r\n    }\r\n  });\r\n})();\r\n\r\n\r\nfabric.util.object.extend(fabric.StaticCanvas.prototype, /** @lends fabric.StaticCanvas.prototype */ {\r\n\r\n  /**\r\n   * Animation duration (in ms) for fx* methods\r\n   * @type Number\r\n   * @default\r\n   */\r\n  FX_DURATION: 500,\r\n\r\n  /**\r\n   * Centers object horizontally with animation.\r\n   * @param {fabric.Object} object Object to center\r\n   * @param {Object} [callbacks] Callbacks object with optional \"onComplete\" and/or \"onChange\" properties\r\n   * @param {Function} [callbacks.onComplete] Invoked on completion\r\n   * @param {Function} [callbacks.onChange] Invoked on every step of animation\r\n   * @return {fabric.Canvas} thisArg\r\n   * @chainable\r\n   */\r\n  fxCenterObjectH: function (object, callbacks) {\r\n    callbacks = callbacks || { };\r\n\r\n    var empty = function() { },\r\n        onComplete = callbacks.onComplete || empty,\r\n        onChange = callbacks.onChange || empty,\r\n        _this = this;\r\n\r\n    fabric.util.animate({\r\n      startValue: object.get('left'),\r\n      endValue: this.getCenter().left,\r\n      duration: this.FX_DURATION,\r\n      onChange: function(value) {\r\n        object.set('left', value);\r\n        _this.renderAll();\r\n        onChange();\r\n      },\r\n      onComplete: function() {\r\n        object.setCoords();\r\n        onComplete();\r\n      }\r\n    });\r\n\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Centers object vertically with animation.\r\n   * @param {fabric.Object} object Object to center\r\n   * @param {Object} [callbacks] Callbacks object with optional \"onComplete\" and/or \"onChange\" properties\r\n   * @param {Function} [callbacks.onComplete] Invoked on completion\r\n   * @param {Function} [callbacks.onChange] Invoked on every step of animation\r\n   * @return {fabric.Canvas} thisArg\r\n   * @chainable\r\n   */\r\n  fxCenterObjectV: function (object, callbacks) {\r\n    callbacks = callbacks || { };\r\n\r\n    var empty = function() { },\r\n        onComplete = callbacks.onComplete || empty,\r\n        onChange = callbacks.onChange || empty,\r\n        _this = this;\r\n\r\n    fabric.util.animate({\r\n      startValue: object.get('top'),\r\n      endValue: this.getCenter().top,\r\n      duration: this.FX_DURATION,\r\n      onChange: function(value) {\r\n        object.set('top', value);\r\n        _this.renderAll();\r\n        onChange();\r\n      },\r\n      onComplete: function() {\r\n        object.setCoords();\r\n        onComplete();\r\n      }\r\n    });\r\n\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Same as `fabric.Canvas#remove` but animated\r\n   * @param {fabric.Object} object Object to remove\r\n   * @param {Object} [callbacks] Callbacks object with optional \"onComplete\" and/or \"onChange\" properties\r\n   * @param {Function} [callbacks.onComplete] Invoked on completion\r\n   * @param {Function} [callbacks.onChange] Invoked on every step of animation\r\n   * @return {fabric.Canvas} thisArg\r\n   * @chainable\r\n   */\r\n  fxRemove: function (object, callbacks) {\r\n    callbacks = callbacks || { };\r\n\r\n    var empty = function() { },\r\n        onComplete = callbacks.onComplete || empty,\r\n        onChange = callbacks.onChange || empty,\r\n        _this = this;\r\n\r\n    fabric.util.animate({\r\n      startValue: object.get('opacity'),\r\n      endValue: 0,\r\n      duration: this.FX_DURATION,\r\n      onStart: function() {\r\n        object.set('active', false);\r\n      },\r\n      onChange: function(value) {\r\n        object.set('opacity', value);\r\n        _this.renderAll();\r\n        onChange();\r\n      },\r\n      onComplete: function () {\r\n        _this.remove(object);\r\n        onComplete();\r\n      }\r\n    });\r\n\r\n    return this;\r\n  }\r\n});\r\n\r\nfabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\r\n  /**\r\n   * Animates object's properties\r\n   * @param {String|Object} property Property to animate (if string) or properties to animate (if object)\r\n   * @param {Number|Object} value Value to animate property to (if string was given first) or options object\r\n   * @return {fabric.Object} thisArg\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#animation}\r\n   * @chainable\r\n   *\r\n   * As object — multiple properties\r\n   *\r\n   * object.animate({ left: ..., top: ... });\r\n   * object.animate({ left: ..., top: ... }, { duration: ... });\r\n   *\r\n   * As string — one property\r\n   *\r\n   * object.animate('left', ...);\r\n   * object.animate('left', { duration: ... });\r\n   *\r\n   */\r\n  animate: function() {\r\n    if (arguments[0] && typeof arguments[0] === 'object') {\r\n      var propsToAnimate = [ ], prop, skipCallbacks;\r\n      for (prop in arguments[0]) {\r\n        propsToAnimate.push(prop);\r\n      }\r\n      for (var i = 0, len = propsToAnimate.length; i < len; i++) {\r\n        prop = propsToAnimate[i];\r\n        skipCallbacks = i !== len - 1;\r\n        this._animate(prop, arguments[0][prop], arguments[1], skipCallbacks);\r\n      }\r\n    }\r\n    else {\r\n      this._animate.apply(this, arguments);\r\n    }\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {String} property Property to animate\r\n   * @param {String} to Value to animate to\r\n   * @param {Object} [options] Options object\r\n   * @param {Boolean} [skipCallbacks] When true, callbacks like onchange and oncomplete are not invoked\r\n   */\r\n  _animate: function(property, to, options, skipCallbacks) {\r\n    var _this = this, propPair;\r\n\r\n    to = to.toString();\r\n\r\n    if (!options) {\r\n      options = { };\r\n    }\r\n    else {\r\n      options = fabric.util.object.clone(options);\r\n    }\r\n\r\n    if (~property.indexOf('.')) {\r\n      propPair = property.split('.');\r\n    }\r\n\r\n    var currentValue = propPair\r\n      ? this.get(propPair[0])[propPair[1]]\r\n      : this.get(property);\r\n\r\n    if (!('from' in options)) {\r\n      options.from = currentValue;\r\n    }\r\n\r\n    if (~to.indexOf('=')) {\r\n      to = currentValue + parseFloat(to.replace('=', ''));\r\n    }\r\n    else {\r\n      to = parseFloat(to);\r\n    }\r\n\r\n    fabric.util.animate({\r\n      startValue: options.from,\r\n      endValue: to,\r\n      byValue: options.by,\r\n      easing: options.easing,\r\n      duration: options.duration,\r\n      abort: options.abort && function() {\r\n        return options.abort.call(_this);\r\n      },\r\n      onChange: function(value) {\r\n        if (propPair) {\r\n          _this[propPair[0]][propPair[1]] = value;\r\n        }\r\n        else {\r\n          _this.set(property, value);\r\n        }\r\n        if (skipCallbacks) {\r\n          return;\r\n        }\r\n        options.onChange && options.onChange();\r\n      },\r\n      onComplete: function() {\r\n        if (skipCallbacks) {\r\n          return;\r\n        }\r\n\r\n        _this.setCoords();\r\n        options.onComplete && options.onComplete();\r\n      }\r\n    });\r\n  }\r\n});\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend,\r\n      coordProps = { x1: 1, x2: 1, y1: 1, y2: 1 },\r\n      supportsLineDash = fabric.StaticCanvas.supports('setLineDash');\r\n\r\n  if (fabric.Line) {\r\n    fabric.warn('fabric.Line is already defined');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Line class\r\n   * @class fabric.Line\r\n   * @extends fabric.Object\r\n   * @see {@link fabric.Line#initialize} for constructor definition\r\n   */\r\n  fabric.Line = fabric.util.createClass(fabric.Object, /** @lends fabric.Line.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'line',\r\n\r\n    /**\r\n     * x value or first line edge\r\n     * @type Number\r\n     * @default\r\n     */\r\n    x1: 0,\r\n\r\n    /**\r\n     * y value or first line edge\r\n     * @type Number\r\n     * @default\r\n     */\r\n    y1: 0,\r\n\r\n    /**\r\n     * x value or second line edge\r\n     * @type Number\r\n     * @default\r\n     */\r\n    x2: 0,\r\n\r\n    /**\r\n     * y value or second line edge\r\n     * @type Number\r\n     * @default\r\n     */\r\n    y2: 0,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Array} [points] Array of points\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Line} thisArg\r\n     */\r\n    initialize: function(points, options) {\r\n      options = options || { };\r\n\r\n      if (!points) {\r\n        points = [0, 0, 0, 0];\r\n      }\r\n\r\n      this.callSuper('initialize', options);\r\n\r\n      this.set('x1', points[0]);\r\n      this.set('y1', points[1]);\r\n      this.set('x2', points[2]);\r\n      this.set('y2', points[3]);\r\n\r\n      this._setWidthHeight(options);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} [options] Options\r\n     */\r\n    _setWidthHeight: function(options) {\r\n      options || (options = { });\r\n\r\n      this.width = Math.abs(this.x2 - this.x1);\r\n      this.height = Math.abs(this.y2 - this.y1);\r\n\r\n      this.left = 'left' in options\r\n        ? options.left\r\n        : this._getLeftToOriginX();\r\n\r\n      this.top = 'top' in options\r\n        ? options.top\r\n        : this._getTopToOriginY();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} key\r\n     * @param {Any} value\r\n     */\r\n    _set: function(key, value) {\r\n      this.callSuper('_set', key, value);\r\n      if (typeof coordProps[key] !== 'undefined') {\r\n        this._setWidthHeight();\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @return {Number} leftToOriginX Distance from left edge of canvas to originX of Line.\r\n     */\r\n    _getLeftToOriginX: makeEdgeToOriginGetter(\r\n      { // property names\r\n        origin: 'originX',\r\n        axis1: 'x1',\r\n        axis2: 'x2',\r\n        dimension: 'width'\r\n      },\r\n      { // possible values of origin\r\n        nearest: 'left',\r\n        center: 'center',\r\n        farthest: 'right'\r\n      }\r\n    ),\r\n\r\n    /**\r\n     * @private\r\n     * @return {Number} topToOriginY Distance from top edge of canvas to originY of Line.\r\n     */\r\n    _getTopToOriginY: makeEdgeToOriginGetter(\r\n      { // property names\r\n        origin: 'originY',\r\n        axis1: 'y1',\r\n        axis2: 'y2',\r\n        dimension: 'height'\r\n      },\r\n      { // possible values of origin\r\n        nearest: 'top',\r\n        center: 'center',\r\n        farthest: 'bottom'\r\n      }\r\n    ),\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _render: function(ctx, noTransform) {\r\n      ctx.beginPath();\r\n\r\n      if (noTransform) {\r\n        //  Line coords are distances from left-top of canvas to origin of line.\r\n        //  To render line in a path-group, we need to translate them to\r\n        //  distances from center of path-group to center of line.\r\n        var cp = this.getCenterPoint();\r\n        ctx.translate(\r\n          cp.x - this.strokeWidth / 2,\r\n          cp.y - this.strokeWidth / 2\r\n        );\r\n      }\r\n\r\n      if (!this.strokeDashArray || this.strokeDashArray && supportsLineDash) {\r\n        // move from center (of virtual box) to its left/top corner\r\n        // we can't assume x1, y1 is top left and x2, y2 is bottom right\r\n        var p = this.calcLinePoints();\r\n        ctx.moveTo(p.x1, p.y1);\r\n        ctx.lineTo(p.x2, p.y2);\r\n      }\r\n\r\n      ctx.lineWidth = this.strokeWidth;\r\n\r\n      // TODO: test this\r\n      // make sure setting \"fill\" changes color of a line\r\n      // (by copying fillStyle to strokeStyle, since line is stroked, not filled)\r\n      var origStrokeStyle = ctx.strokeStyle;\r\n      ctx.strokeStyle = this.stroke || ctx.fillStyle;\r\n      this.stroke && this._renderStroke(ctx);\r\n      ctx.strokeStyle = origStrokeStyle;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderDashedStroke: function(ctx) {\r\n      var p = this.calcLinePoints();\r\n\r\n      ctx.beginPath();\r\n      fabric.util.drawDashedLine(ctx, p.x1, p.y1, p.x2, p.y2, this.strokeDashArray);\r\n      ctx.closePath();\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @methd toObject\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      return extend(this.callSuper('toObject', propertiesToInclude), this.calcLinePoints());\r\n    },\r\n\r\n    /**\r\n     * Recalculates line points given width and height\r\n     * @private\r\n     */\r\n    calcLinePoints: function() {\r\n      var xMult = this.x1 <= this.x2 ? -1 : 1,\r\n          yMult = this.y1 <= this.y2 ? -1 : 1,\r\n          x1 = (xMult * this.width * 0.5),\r\n          y1 = (yMult * this.height * 0.5),\r\n          x2 = (xMult * this.width * -0.5),\r\n          y2 = (yMult * this.height * -0.5);\r\n\r\n      return {\r\n        x1: x1,\r\n        x2: x2,\r\n        y1: y1,\r\n        y2: y2\r\n      };\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns SVG representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var markup = this._createBaseSVGMarkup(),\r\n          p = { x1: this.x1, x2: this.x2, y1: this.y1, y2: this.y2 };\r\n\r\n      if (!(this.group && this.group.type === 'path-group')) {\r\n        p = this.calcLinePoints();\r\n      }\r\n      markup.push(\r\n        '<line ',\r\n          'x1=\"', p.x1,\r\n          '\" y1=\"', p.y1,\r\n          '\" x2=\"', p.x2,\r\n          '\" y2=\"', p.y2,\r\n          '\" style=\"', this.getSvgStyles(),\r\n          '\" transform=\"', this.getSvgTransform(),\r\n          this.getSvgTransformMatrix(),\r\n        '\"/>\\n'\r\n      );\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity\r\n     */\r\n    complexity: function() {\r\n      return 1;\r\n    }\r\n  });\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Line.fromElement})\r\n   * @static\r\n   * @memberOf fabric.Line\r\n   * @see http://www.w3.org/TR/SVG/shapes.html#LineElement\r\n   */\r\n  fabric.Line.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat('x1 y1 x2 y2'.split(' '));\r\n\r\n  /**\r\n   * Returns fabric.Line instance from an SVG element\r\n   * @static\r\n   * @memberOf fabric.Line\r\n   * @param {SVGElement} element Element to parse\r\n   * @param {Object} [options] Options object\r\n   * @return {fabric.Line} instance of fabric.Line\r\n   */\r\n  fabric.Line.fromElement = function(element, options) {\r\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Line.ATTRIBUTE_NAMES),\r\n        points = [\r\n          parsedAttributes.x1 || 0,\r\n          parsedAttributes.y1 || 0,\r\n          parsedAttributes.x2 || 0,\r\n          parsedAttributes.y2 || 0\r\n        ];\r\n    return new fabric.Line(points, extend(parsedAttributes, options));\r\n  };\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Returns fabric.Line instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Line\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Line} instance of fabric.Line\r\n   */\r\n  fabric.Line.fromObject = function(object) {\r\n    var points = [object.x1, object.y1, object.x2, object.y2];\r\n    return new fabric.Line(points, object);\r\n  };\r\n\r\n  /**\r\n   * Produces a function that calculates distance from canvas edge to Line origin.\r\n   */\r\n  function makeEdgeToOriginGetter(propertyNames, originValues) {\r\n    var origin = propertyNames.origin,\r\n        axis1 = propertyNames.axis1,\r\n        axis2 = propertyNames.axis2,\r\n        dimension = propertyNames.dimension,\r\n        nearest = originValues.nearest,\r\n        center = originValues.center,\r\n        farthest = originValues.farthest;\r\n\r\n    return function() {\r\n      switch (this.get(origin)) {\r\n      case nearest:\r\n        return Math.min(this.get(axis1), this.get(axis2));\r\n      case center:\r\n        return Math.min(this.get(axis1), this.get(axis2)) + (0.5 * this.get(dimension));\r\n      case farthest:\r\n        return Math.max(this.get(axis1), this.get(axis2));\r\n      }\r\n    };\r\n\r\n  }\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      pi = Math.PI,\r\n      extend = fabric.util.object.extend;\r\n\r\n  if (fabric.Circle) {\r\n    fabric.warn('fabric.Circle is already defined.');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Circle class\r\n   * @class fabric.Circle\r\n   * @extends fabric.Object\r\n   * @see {@link fabric.Circle#initialize} for constructor definition\r\n   */\r\n  fabric.Circle = fabric.util.createClass(fabric.Object, /** @lends fabric.Circle.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'circle',\r\n\r\n    /**\r\n     * Radius of this circle\r\n     * @type Number\r\n     * @default\r\n     */\r\n    radius: 0,\r\n\r\n    /**\r\n     * Start angle of the circle, moving clockwise\r\n     * @type Number\r\n     * @default 0\r\n     */\r\n    startAngle: 0,\r\n\r\n    /**\r\n     * End angle of the circle\r\n     * @type Number\r\n     * @default 2Pi\r\n     */\r\n    endAngle: pi * 2,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Circle} thisArg\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n\r\n      this.callSuper('initialize', options);\r\n      this.set('radius', options.radius || 0);\r\n      this.startAngle = options.startAngle || this.startAngle;\r\n      this.endAngle = options.endAngle || this.endAngle;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} key\r\n     * @param {Any} value\r\n     * @return {fabric.Circle} thisArg\r\n     */\r\n    _set: function(key, value) {\r\n      this.callSuper('_set', key, value);\r\n\r\n      if (key === 'radius') {\r\n        this.setRadius(value);\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      return extend(this.callSuper('toObject', propertiesToInclude), {\r\n        radius: this.get('radius'),\r\n        startAngle: this.startAngle,\r\n        endAngle: this.endAngle\r\n      });\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns svg representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var markup = this._createBaseSVGMarkup(), x = 0, y = 0,\r\n      angle = (this.endAngle - this.startAngle) % ( 2 * pi);\r\n\r\n      if (angle === 0) {\r\n        if (this.group && this.group.type === 'path-group') {\r\n          x = this.left + this.radius;\r\n          y = this.top + this.radius;\r\n        }\r\n        markup.push(\r\n          '<circle ',\r\n            'cx=\"' + x + '\" cy=\"' + y + '\" ',\r\n            'r=\"', this.radius,\r\n            '\" style=\"', this.getSvgStyles(),\r\n            '\" transform=\"', this.getSvgTransform(),\r\n            ' ', this.getSvgTransformMatrix(),\r\n          '\"/>\\n'\r\n        );\r\n      }\r\n      else {\r\n        var startX = Math.cos(this.startAngle) * this.radius,\r\n            startY = Math.sin(this.startAngle) * this.radius,\r\n            endX = Math.cos(this.endAngle) * this.radius,\r\n            endY = Math.sin(this.endAngle) * this.radius,\r\n            largeFlag = angle > pi ? '1' : '0';\r\n\r\n        markup.push(\r\n          '<path d=\"M ' + startX + ' ' + startY,\r\n          ' A ' + this.radius + ' ' + this.radius,\r\n          ' 0 ', + largeFlag + ' 1', ' ' + endX + ' ' + endY,\r\n          '\" style=\"', this.getSvgStyles(),\r\n          '\" transform=\"', this.getSvgTransform(),\r\n          ' ', this.getSvgTransformMatrix(),\r\n          '\"/>\\n'\r\n        );\r\n      }\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx context to render on\r\n     * @param {Boolean} [noTransform] When true, context is not transformed\r\n     */\r\n    _render: function(ctx, noTransform) {\r\n      ctx.beginPath();\r\n      ctx.arc(noTransform ? this.left + this.radius : 0,\r\n              noTransform ? this.top + this.radius : 0,\r\n              this.radius,\r\n              this.startAngle,\r\n              this.endAngle, false);\r\n      this._renderFill(ctx);\r\n      this._renderStroke(ctx);\r\n    },\r\n\r\n    /**\r\n     * Returns horizontal radius of an object (according to how an object is scaled)\r\n     * @return {Number}\r\n     */\r\n    getRadiusX: function() {\r\n      return this.get('radius') * this.get('scaleX');\r\n    },\r\n\r\n    /**\r\n     * Returns vertical radius of an object (according to how an object is scaled)\r\n     * @return {Number}\r\n     */\r\n    getRadiusY: function() {\r\n      return this.get('radius') * this.get('scaleY');\r\n    },\r\n\r\n    /**\r\n     * Sets radius of an object (and updates width accordingly)\r\n     * @return {Number}\r\n     */\r\n    setRadius: function(value) {\r\n      this.radius = value;\r\n      this.set('width', value * 2).set('height', value * 2);\r\n    },\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity of this instance\r\n     */\r\n    complexity: function() {\r\n      return 1;\r\n    }\r\n  });\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Circle.fromElement})\r\n   * @static\r\n   * @memberOf fabric.Circle\r\n   * @see: http://www.w3.org/TR/SVG/shapes.html#CircleElement\r\n   */\r\n  fabric.Circle.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat('cx cy r'.split(' '));\r\n\r\n  /**\r\n   * Returns {@link fabric.Circle} instance from an SVG element\r\n   * @static\r\n   * @memberOf fabric.Circle\r\n   * @param {SVGElement} element Element to parse\r\n   * @param {Object} [options] Options object\r\n   * @throws {Error} If value of `r` attribute is missing or invalid\r\n   * @return {fabric.Circle} Instance of fabric.Circle\r\n   */\r\n  fabric.Circle.fromElement = function(element, options) {\r\n    options || (options = { });\r\n\r\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Circle.ATTRIBUTE_NAMES);\r\n\r\n    if (!isValidRadius(parsedAttributes)) {\r\n      throw new Error('value of `r` attribute is required and can not be negative');\r\n    }\r\n\r\n    parsedAttributes.left = parsedAttributes.left || 0;\r\n    parsedAttributes.top = parsedAttributes.top || 0;\r\n\r\n    var obj = new fabric.Circle(extend(parsedAttributes, options));\r\n\r\n    obj.left -= obj.radius;\r\n    obj.top -= obj.radius;\r\n    return obj;\r\n  };\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  function isValidRadius(attributes) {\r\n    return (('radius' in attributes) && (attributes.radius >= 0));\r\n  }\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Returns {@link fabric.Circle} instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Circle\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {Object} Instance of fabric.Circle\r\n   */\r\n  fabric.Circle.fromObject = function(object) {\r\n    return new fabric.Circle(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { });\r\n\r\n  if (fabric.Triangle) {\r\n    fabric.warn('fabric.Triangle is already defined');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Triangle class\r\n   * @class fabric.Triangle\r\n   * @extends fabric.Object\r\n   * @return {fabric.Triangle} thisArg\r\n   * @see {@link fabric.Triangle#initialize} for constructor definition\r\n   */\r\n  fabric.Triangle = fabric.util.createClass(fabric.Object, /** @lends fabric.Triangle.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'triangle',\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Object} [options] Options object\r\n     * @return {Object} thisArg\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n\r\n      this.callSuper('initialize', options);\r\n\r\n      this.set('width', options.width || 100)\r\n          .set('height', options.height || 100);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _render: function(ctx) {\r\n      var widthBy2 = this.width / 2,\r\n          heightBy2 = this.height / 2;\r\n\r\n      ctx.beginPath();\r\n      ctx.moveTo(-widthBy2, heightBy2);\r\n      ctx.lineTo(0, -heightBy2);\r\n      ctx.lineTo(widthBy2, heightBy2);\r\n      ctx.closePath();\r\n\r\n      this._renderFill(ctx);\r\n      this._renderStroke(ctx);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderDashedStroke: function(ctx) {\r\n      var widthBy2 = this.width / 2,\r\n          heightBy2 = this.height / 2;\r\n\r\n      ctx.beginPath();\r\n      fabric.util.drawDashedLine(ctx, -widthBy2, heightBy2, 0, -heightBy2, this.strokeDashArray);\r\n      fabric.util.drawDashedLine(ctx, 0, -heightBy2, widthBy2, heightBy2, this.strokeDashArray);\r\n      fabric.util.drawDashedLine(ctx, widthBy2, heightBy2, -widthBy2, heightBy2, this.strokeDashArray);\r\n      ctx.closePath();\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns SVG representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var markup = this._createBaseSVGMarkup(),\r\n          widthBy2 = this.width / 2,\r\n          heightBy2 = this.height / 2,\r\n          points = [\r\n            -widthBy2 + ' ' + heightBy2,\r\n            '0 ' + -heightBy2,\r\n            widthBy2 + ' ' + heightBy2\r\n          ]\r\n          .join(',');\r\n\r\n      markup.push(\r\n        '<polygon ',\r\n          'points=\"', points,\r\n          '\" style=\"', this.getSvgStyles(),\r\n          '\" transform=\"', this.getSvgTransform(),\r\n        '\"/>'\r\n      );\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity of this instance\r\n     */\r\n    complexity: function() {\r\n      return 1;\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns fabric.Triangle instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Triangle\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {Object} instance of Canvas.Triangle\r\n   */\r\n  fabric.Triangle.fromObject = function(object) {\r\n    return new fabric.Triangle(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      piBy2   = Math.PI * 2,\r\n      extend = fabric.util.object.extend;\r\n\r\n  if (fabric.Ellipse) {\r\n    fabric.warn('fabric.Ellipse is already defined.');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Ellipse class\r\n   * @class fabric.Ellipse\r\n   * @extends fabric.Object\r\n   * @return {fabric.Ellipse} thisArg\r\n   * @see {@link fabric.Ellipse#initialize} for constructor definition\r\n   */\r\n  fabric.Ellipse = fabric.util.createClass(fabric.Object, /** @lends fabric.Ellipse.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'ellipse',\r\n\r\n    /**\r\n     * Horizontal radius\r\n     * @type Number\r\n     * @default\r\n     */\r\n    rx:   0,\r\n\r\n    /**\r\n     * Vertical radius\r\n     * @type Number\r\n     * @default\r\n     */\r\n    ry:   0,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Ellipse} thisArg\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n\r\n      this.callSuper('initialize', options);\r\n\r\n      this.set('rx', options.rx || 0);\r\n      this.set('ry', options.ry || 0);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} key\r\n     * @param {Any} value\r\n     * @return {fabric.Ellipse} thisArg\r\n     */\r\n    _set: function(key, value) {\r\n      this.callSuper('_set', key, value);\r\n      switch (key) {\r\n\r\n        case 'rx':\r\n          this.rx = value;\r\n          this.set('width', value * 2);\r\n          break;\r\n\r\n        case 'ry':\r\n          this.ry = value;\r\n          this.set('height', value * 2);\r\n          break;\r\n\r\n      }\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns horizontal radius of an object (according to how an object is scaled)\r\n     * @return {Number}\r\n     */\r\n    getRx: function() {\r\n      return this.get('rx') * this.get('scaleX');\r\n    },\r\n\r\n    /**\r\n     * Returns Vertical radius of an object (according to how an object is scaled)\r\n     * @return {Number}\r\n     */\r\n    getRy: function() {\r\n      return this.get('ry') * this.get('scaleY');\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      return extend(this.callSuper('toObject', propertiesToInclude), {\r\n        rx: this.get('rx'),\r\n        ry: this.get('ry')\r\n      });\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns svg representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var markup = this._createBaseSVGMarkup(), x = 0, y = 0;\r\n      if (this.group && this.group.type === 'path-group') {\r\n        x = this.left + this.rx;\r\n        y = this.top + this.ry;\r\n      }\r\n      markup.push(\r\n        '<ellipse ',\r\n          'cx=\"', x, '\" cy=\"', y, '\" ',\r\n          'rx=\"', this.rx,\r\n          '\" ry=\"', this.ry,\r\n          '\" style=\"', this.getSvgStyles(),\r\n          '\" transform=\"', this.getSvgTransform(),\r\n          this.getSvgTransformMatrix(),\r\n        '\"/>\\n'\r\n      );\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx context to render on\r\n     * @param {Boolean} [noTransform] When true, context is not transformed\r\n     */\r\n    _render: function(ctx, noTransform) {\r\n      ctx.beginPath();\r\n      ctx.save();\r\n      ctx.transform(1, 0, 0, this.ry/this.rx, 0, 0);\r\n      ctx.arc(\r\n        noTransform ? this.left + this.rx : 0,\r\n        noTransform ? (this.top + this.ry) * this.rx/this.ry : 0,\r\n        this.rx,\r\n        0,\r\n        piBy2,\r\n        false);\r\n      ctx.restore();\r\n      this._renderFill(ctx);\r\n      this._renderStroke(ctx);\r\n    },\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity\r\n     */\r\n    complexity: function() {\r\n      return 1;\r\n    }\r\n  });\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Ellipse.fromElement})\r\n   * @static\r\n   * @memberOf fabric.Ellipse\r\n   * @see http://www.w3.org/TR/SVG/shapes.html#EllipseElement\r\n   */\r\n  fabric.Ellipse.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat('cx cy rx ry'.split(' '));\r\n\r\n  /**\r\n   * Returns {@link fabric.Ellipse} instance from an SVG element\r\n   * @static\r\n   * @memberOf fabric.Ellipse\r\n   * @param {SVGElement} element Element to parse\r\n   * @param {Object} [options] Options object\r\n   * @return {fabric.Ellipse}\r\n   */\r\n  fabric.Ellipse.fromElement = function(element, options) {\r\n    options || (options = { });\r\n\r\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Ellipse.ATTRIBUTE_NAMES);\r\n\r\n    parsedAttributes.left = parsedAttributes.left || 0;\r\n    parsedAttributes.top = parsedAttributes.top || 0;\r\n\r\n    var ellipse = new fabric.Ellipse(extend(parsedAttributes, options));\r\n\r\n    ellipse.top -= ellipse.ry;\r\n    ellipse.left -= ellipse.rx;\r\n    return ellipse;\r\n  };\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Returns {@link fabric.Ellipse} instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Ellipse\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Ellipse}\r\n   */\r\n  fabric.Ellipse.fromObject = function(object) {\r\n    return new fabric.Ellipse(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  if (fabric.Rect) {\r\n    console.warn('fabric.Rect is already defined');\r\n    return;\r\n  }\r\n\r\n  var stateProperties = fabric.Object.prototype.stateProperties.concat();\r\n  stateProperties.push('rx', 'ry', 'x', 'y');\r\n\r\n  /**\r\n   * Rectangle class\r\n   * @class fabric.Rect\r\n   * @extends fabric.Object\r\n   * @return {fabric.Rect} thisArg\r\n   * @see {@link fabric.Rect#initialize} for constructor definition\r\n   */\r\n  fabric.Rect = fabric.util.createClass(fabric.Object, /** @lends fabric.Rect.prototype */ {\r\n\r\n    /**\r\n     * List of properties to consider when checking if state of an object is changed ({@link fabric.Object#hasStateChanged})\r\n     * as well as for history (undo/redo) purposes\r\n     * @type Array\r\n     */\r\n    stateProperties: stateProperties,\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'rect',\r\n\r\n    /**\r\n     * Horizontal border radius\r\n     * @type Number\r\n     * @default\r\n     */\r\n    rx:   0,\r\n\r\n    /**\r\n     * Vertical border radius\r\n     * @type Number\r\n     * @default\r\n     */\r\n    ry:   0,\r\n\r\n    /**\r\n     * Used to specify dash pattern for stroke on this object\r\n     * @type Array\r\n     */\r\n    strokeDashArray: null,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Object} [options] Options object\r\n     * @return {Object} thisArg\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n\r\n      this.callSuper('initialize', options);\r\n      this._initRxRy();\r\n\r\n    },\r\n\r\n    /**\r\n     * Initializes rx/ry attributes\r\n     * @private\r\n     */\r\n    _initRxRy: function() {\r\n      if (this.rx && !this.ry) {\r\n        this.ry = this.rx;\r\n      }\r\n      else if (this.ry && !this.rx) {\r\n        this.rx = this.ry;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _render: function(ctx, noTransform) {\r\n\r\n      // optimize 1x1 case (used in spray brush)\r\n      if (this.width === 1 && this.height === 1) {\r\n        ctx.fillRect(0, 0, 1, 1);\r\n        return;\r\n      }\r\n\r\n      var rx = this.rx ? Math.min(this.rx, this.width / 2) : 0,\r\n          ry = this.ry ? Math.min(this.ry, this.height / 2) : 0,\r\n          w = this.width,\r\n          h = this.height,\r\n          x = noTransform ? this.left : -this.width / 2,\r\n          y = noTransform ? this.top : -this.height / 2,\r\n          isRounded = rx !== 0 || ry !== 0,\r\n          k = 1 - 0.5522847498 /* \"magic number\" for bezier approximations of arcs (http://itc.ktu.lt/itc354/Riskus354.pdf) */;\r\n\r\n      ctx.beginPath();\r\n\r\n      ctx.moveTo(x + rx, y);\r\n\r\n      ctx.lineTo(x + w - rx, y);\r\n      isRounded && ctx.bezierCurveTo(x + w - k * rx, y, x + w, y + k * ry, x + w, y + ry);\r\n\r\n      ctx.lineTo(x + w, y + h - ry);\r\n      isRounded && ctx.bezierCurveTo(x + w, y + h - k * ry, x + w - k * rx, y + h, x + w - rx, y + h);\r\n\r\n      ctx.lineTo(x + rx, y + h);\r\n      isRounded && ctx.bezierCurveTo(x + k * rx, y + h, x, y + h - k * ry, x, y + h - ry);\r\n\r\n      ctx.lineTo(x, y + ry);\r\n      isRounded && ctx.bezierCurveTo(x, y + k * ry, x + k * rx, y, x + rx, y);\r\n\r\n      ctx.closePath();\r\n\r\n      this._renderFill(ctx);\r\n      this._renderStroke(ctx);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderDashedStroke: function(ctx) {\r\n      var x = -this.width / 2,\r\n          y = -this.height / 2,\r\n          w = this.width,\r\n          h = this.height;\r\n\r\n      ctx.beginPath();\r\n      fabric.util.drawDashedLine(ctx, x, y, x + w, y, this.strokeDashArray);\r\n      fabric.util.drawDashedLine(ctx, x + w, y, x + w, y + h, this.strokeDashArray);\r\n      fabric.util.drawDashedLine(ctx, x + w, y + h, x, y + h, this.strokeDashArray);\r\n      fabric.util.drawDashedLine(ctx, x, y + h, x, y, this.strokeDashArray);\r\n      ctx.closePath();\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      var object = extend(this.callSuper('toObject', propertiesToInclude), {\r\n        rx: this.get('rx') || 0,\r\n        ry: this.get('ry') || 0\r\n      });\r\n      if (!this.includeDefaultValues) {\r\n        this._removeDefaultValues(object);\r\n      }\r\n      return object;\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns svg representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var markup = this._createBaseSVGMarkup(), x = this.left, y = this.top;\r\n      if (!(this.group && this.group.type === 'path-group')) {\r\n        x = -this.width / 2;\r\n        y = -this.height / 2;\r\n      }\r\n      markup.push(\r\n        '<rect ',\r\n          'x=\"', x, '\" y=\"', y,\r\n          '\" rx=\"', this.get('rx'), '\" ry=\"', this.get('ry'),\r\n          '\" width=\"', this.width, '\" height=\"', this.height,\r\n          '\" style=\"', this.getSvgStyles(),\r\n          '\" transform=\"', this.getSvgTransform(),\r\n          this.getSvgTransformMatrix(),\r\n        '\"/>\\n');\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity\r\n     */\r\n    complexity: function() {\r\n      return 1;\r\n    }\r\n  });\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by `fabric.Rect.fromElement`)\r\n   * @static\r\n   * @memberOf fabric.Rect\r\n   * @see: http://www.w3.org/TR/SVG/shapes.html#RectElement\r\n   */\r\n  fabric.Rect.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat('x y rx ry width height'.split(' '));\r\n\r\n  /**\r\n   * Returns {@link fabric.Rect} instance from an SVG element\r\n   * @static\r\n   * @memberOf fabric.Rect\r\n   * @param {SVGElement} element Element to parse\r\n   * @param {Object} [options] Options object\r\n   * @return {fabric.Rect} Instance of fabric.Rect\r\n   */\r\n  fabric.Rect.fromElement = function(element, options) {\r\n    if (!element) {\r\n      return null;\r\n    }\r\n    options = options || { };\r\n\r\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Rect.ATTRIBUTE_NAMES);\r\n\r\n    parsedAttributes.left = parsedAttributes.left || 0;\r\n    parsedAttributes.top  = parsedAttributes.top  || 0;\r\n    var rect = new fabric.Rect(extend((options ? fabric.util.object.clone(options) : { }), parsedAttributes));\r\n    rect.visible = rect.width > 0 && rect.height > 0;\r\n    return rect;\r\n  };\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Returns {@link fabric.Rect} instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Rect\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {Object} instance of fabric.Rect\r\n   */\r\n  fabric.Rect.fromObject = function(object) {\r\n    return new fabric.Rect(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { });\r\n\r\n  if (fabric.Polyline) {\r\n    fabric.warn('fabric.Polyline is already defined');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Polyline class\r\n   * @class fabric.Polyline\r\n   * @extends fabric.Object\r\n   * @see {@link fabric.Polyline#initialize} for constructor definition\r\n   */\r\n  fabric.Polyline = fabric.util.createClass(fabric.Object, /** @lends fabric.Polyline.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'polyline',\r\n\r\n    /**\r\n     * Points array\r\n     * @type Array\r\n     * @default\r\n     */\r\n    points: null,\r\n\r\n    /**\r\n     * Minimum X from points values, necessary to offset points\r\n     * @type Number\r\n     * @default\r\n     */\r\n    minX: 0,\r\n\r\n    /**\r\n     * Minimum Y from points values, necessary to offset points\r\n     * @type Number\r\n     * @default\r\n     */\r\n    minY: 0,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Array} points Array of points (where each point is an object with x and y)\r\n     * @param {Object} [options] Options object\r\n     * @param {Boolean} [skipOffset] Whether points offsetting should be skipped\r\n     * @return {fabric.Polyline} thisArg\r\n     * @example\r\n     * var poly = new fabric.Polyline([\r\n     *     { x: 10, y: 10 },\r\n     *     { x: 50, y: 30 },\r\n     *     { x: 40, y: 70 },\r\n     *     { x: 60, y: 50 },\r\n     *     { x: 100, y: 150 },\r\n     *     { x: 40, y: 100 }\r\n     *   ], {\r\n     *   stroke: 'red',\r\n     *   left: 100,\r\n     *   top: 100\r\n     * });\r\n     */\r\n    initialize: function(points, options) {\r\n      return fabric.Polygon.prototype.initialize.call(this, points, options);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _calcDimensions: function() {\r\n      return fabric.Polygon.prototype._calcDimensions.call(this);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _applyPointOffset: function() {\r\n      return fabric.Polygon.prototype._applyPointOffset.call(this);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      return fabric.Polygon.prototype.toObject.call(this, propertiesToInclude);\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns SVG representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      return fabric.Polygon.prototype.toSVG.call(this, reviver);\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _render: function(ctx) {\r\n      if (!fabric.Polygon.prototype.commonRender.call(this, ctx)) {\r\n        return;\r\n      }\r\n      this._renderFill(ctx);\r\n      this._renderStroke(ctx);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderDashedStroke: function(ctx) {\r\n      var p1, p2;\r\n\r\n      ctx.beginPath();\r\n      for (var i = 0, len = this.points.length; i < len; i++) {\r\n        p1 = this.points[i];\r\n        p2 = this.points[i + 1] || p1;\r\n        fabric.util.drawDashedLine(ctx, p1.x, p1.y, p2.x, p2.y, this.strokeDashArray);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity of this instance\r\n     */\r\n    complexity: function() {\r\n      return this.get('points').length;\r\n    }\r\n  });\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Polyline.fromElement})\r\n   * @static\r\n   * @memberOf fabric.Polyline\r\n   * @see: http://www.w3.org/TR/SVG/shapes.html#PolylineElement\r\n   */\r\n  fabric.Polyline.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat();\r\n\r\n  /**\r\n   * Returns fabric.Polyline instance from an SVG element\r\n   * @static\r\n   * @memberOf fabric.Polyline\r\n   * @param {SVGElement} element Element to parse\r\n   * @param {Object} [options] Options object\r\n   * @return {fabric.Polyline} Instance of fabric.Polyline\r\n   */\r\n  fabric.Polyline.fromElement = function(element, options) {\r\n    if (!element) {\r\n      return null;\r\n    }\r\n    options || (options = { });\r\n\r\n    var points = fabric.parsePointsAttribute(element.getAttribute('points')),\r\n        parsedAttributes = fabric.parseAttributes(element, fabric.Polyline.ATTRIBUTE_NAMES);\r\n\r\n    return new fabric.Polyline(points, fabric.util.object.extend(parsedAttributes, options));\r\n  };\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Returns fabric.Polyline instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Polyline\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Polyline} Instance of fabric.Polyline\r\n   */\r\n  fabric.Polyline.fromObject = function(object) {\r\n    var points = object.points;\r\n    return new fabric.Polyline(points, object, true);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend,\r\n      min = fabric.util.array.min,\r\n      max = fabric.util.array.max,\r\n      toFixed = fabric.util.toFixed;\r\n\r\n  if (fabric.Polygon) {\r\n    fabric.warn('fabric.Polygon is already defined');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Polygon class\r\n   * @class fabric.Polygon\r\n   * @extends fabric.Object\r\n   * @see {@link fabric.Polygon#initialize} for constructor definition\r\n   */\r\n  fabric.Polygon = fabric.util.createClass(fabric.Object, /** @lends fabric.Polygon.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'polygon',\r\n\r\n    /**\r\n     * Points array\r\n     * @type Array\r\n     * @default\r\n     */\r\n    points: null,\r\n\r\n    /**\r\n     * Minimum X from points values, necessary to offset points\r\n     * @type Number\r\n     * @default\r\n     */\r\n    minX: 0,\r\n\r\n    /**\r\n     * Minimum Y from points values, necessary to offset points\r\n     * @type Number\r\n     * @default\r\n     */\r\n    minY: 0,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Array} points Array of points\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Polygon} thisArg\r\n     */\r\n    initialize: function(points, options) {\r\n      options = options || { };\r\n      this.points = points || [ ];\r\n      this.callSuper('initialize', options);\r\n      this._calcDimensions();\r\n      if (!('top' in options)) {\r\n        this.top = this.minY;\r\n      }\r\n      if (!('left' in options)) {\r\n        this.left = this.minX;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _calcDimensions: function() {\r\n\r\n      var points = this.points,\r\n          minX = min(points, 'x'),\r\n          minY = min(points, 'y'),\r\n          maxX = max(points, 'x'),\r\n          maxY = max(points, 'y');\r\n\r\n      this.width = (maxX - minX) || 0;\r\n      this.height = (maxY - minY) || 0;\r\n\r\n      this.minX = minX || 0,\r\n      this.minY = minY || 0;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _applyPointOffset: function() {\r\n      // change points to offset polygon into a bounding box\r\n      // executed one time\r\n      this.points.forEach(function(p) {\r\n        p.x -= (this.minX + this.width / 2);\r\n        p.y -= (this.minY + this.height / 2);\r\n      }, this);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      return extend(this.callSuper('toObject', propertiesToInclude), {\r\n        points: this.points.concat()\r\n      });\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns svg representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var points = [],\r\n          markup = this._createBaseSVGMarkup();\r\n\r\n      for (var i = 0, len = this.points.length; i < len; i++) {\r\n        points.push(toFixed(this.points[i].x, 2), ',', toFixed(this.points[i].y, 2), ' ');\r\n      }\r\n\r\n      markup.push(\r\n        '<', this.type, ' ',\r\n          'points=\"', points.join(''),\r\n          '\" style=\"', this.getSvgStyles(),\r\n          '\" transform=\"', this.getSvgTransform(),\r\n          ' ', this.getSvgTransformMatrix(),\r\n        '\"/>\\n'\r\n      );\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _render: function(ctx) {\r\n      if (!this.commonRender(ctx)) {\r\n        return;\r\n      }\r\n      this._renderFill(ctx);\r\n      if (this.stroke || this.strokeDashArray) {\r\n        ctx.closePath();\r\n        this._renderStroke(ctx);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    commonRender: function(ctx) {\r\n      var point, len = this.points.length;\r\n\r\n      if (!len || isNaN(this.points[len - 1].y)) {\r\n        // do not draw if no points or odd points\r\n        // NaN comes from parseFloat of a empty string in parser\r\n        return false;\r\n      }\r\n\r\n      ctx.beginPath();\r\n\r\n      if (this._applyPointOffset) {\r\n        if (!(this.group && this.group.type === 'path-group')) {\r\n          this._applyPointOffset();\r\n        }\r\n        this._applyPointOffset = null;\r\n      }\r\n\r\n      ctx.moveTo(this.points[0].x, this.points[0].y);\r\n      for (var i = 0; i < len; i++) {\r\n        point = this.points[i];\r\n        ctx.lineTo(point.x, point.y);\r\n      }\r\n      return true;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderDashedStroke: function(ctx) {\r\n      fabric.Polyline.prototype._renderDashedStroke.call(this, ctx);\r\n      ctx.closePath();\r\n    },\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity of this instance\r\n     */\r\n    complexity: function() {\r\n      return this.points.length;\r\n    }\r\n  });\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by `fabric.Polygon.fromElement`)\r\n   * @static\r\n   * @memberOf fabric.Polygon\r\n   * @see: http://www.w3.org/TR/SVG/shapes.html#PolygonElement\r\n   */\r\n  fabric.Polygon.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat();\r\n\r\n  /**\r\n   * Returns {@link fabric.Polygon} instance from an SVG element\r\n   * @static\r\n   * @memberOf fabric.Polygon\r\n   * @param {SVGElement} element Element to parse\r\n   * @param {Object} [options] Options object\r\n   * @return {fabric.Polygon} Instance of fabric.Polygon\r\n   */\r\n  fabric.Polygon.fromElement = function(element, options) {\r\n    if (!element) {\r\n      return null;\r\n    }\r\n\r\n    options || (options = { });\r\n\r\n    var points = fabric.parsePointsAttribute(element.getAttribute('points')),\r\n        parsedAttributes = fabric.parseAttributes(element, fabric.Polygon.ATTRIBUTE_NAMES);\r\n\r\n    return new fabric.Polygon(points, extend(parsedAttributes, options));\r\n  };\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Returns fabric.Polygon instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Polygon\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Polygon} Instance of fabric.Polygon\r\n   */\r\n  fabric.Polygon.fromObject = function(object) {\r\n    return new fabric.Polygon(object.points, object, true);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      min = fabric.util.array.min,\r\n      max = fabric.util.array.max,\r\n      extend = fabric.util.object.extend,\r\n      _toString = Object.prototype.toString,\r\n      drawArc = fabric.util.drawArc,\r\n      commandLengths = {\r\n        m: 2,\r\n        l: 2,\r\n        h: 1,\r\n        v: 1,\r\n        c: 6,\r\n        s: 4,\r\n        q: 4,\r\n        t: 2,\r\n        a: 7\r\n      },\r\n      repeatedCommands = {\r\n        m: 'l',\r\n        M: 'L'\r\n      };\r\n\r\n  if (fabric.Path) {\r\n    fabric.warn('fabric.Path is already defined');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Path class\r\n   * @class fabric.Path\r\n   * @extends fabric.Object\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1/#path_and_pathgroup}\r\n   * @see {@link fabric.Path#initialize} for constructor definition\r\n   */\r\n  fabric.Path = fabric.util.createClass(fabric.Object, /** @lends fabric.Path.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'path',\r\n\r\n    /**\r\n     * Array of path points\r\n     * @type Array\r\n     * @default\r\n     */\r\n    path: null,\r\n\r\n    /**\r\n     * Minimum X from points values, necessary to offset points\r\n     * @type Number\r\n     * @default\r\n     */\r\n    minX: 0,\r\n\r\n    /**\r\n     * Minimum Y from points values, necessary to offset points\r\n     * @type Number\r\n     * @default\r\n     */\r\n    minY: 0,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Array|String} path Path data (sequence of coordinates and corresponding \"command\" tokens)\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Path} thisArg\r\n     */\r\n    initialize: function(path, options) {\r\n      options = options || { };\r\n\r\n      this.setOptions(options);\r\n\r\n      if (!path) {\r\n        throw new Error('`path` argument is required');\r\n      }\r\n\r\n      var fromArray = _toString.call(path) === '[object Array]';\r\n\r\n      this.path = fromArray\r\n        ? path\r\n        // one of commands (m,M,l,L,q,Q,c,C,etc.) followed by non-command characters (i.e. command values)\r\n        : path.match && path.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);\r\n\r\n      if (!this.path) {\r\n        return;\r\n      }\r\n\r\n      if (!fromArray) {\r\n        this.path = this._parsePath();\r\n      }\r\n\r\n      this._setPositionDimensions();\r\n\r\n      if (options.sourcePath) {\r\n        this.setSourcePath(options.sourcePath);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setPositionDimensions: function() {\r\n      var calcDim = this._parseDimensions();\r\n\r\n      this.minX = calcDim.left;\r\n      this.minY = calcDim.top;\r\n      this.width = calcDim.width;\r\n      this.height = calcDim.height;\r\n\r\n      calcDim.left += this.originX === 'center'\r\n        ? this.width / 2\r\n        : this.originX === 'right'\r\n          ? this.width\r\n          : 0;\r\n\r\n      calcDim.top += this.originY === 'center'\r\n        ? this.height / 2\r\n        : this.originY === 'bottom'\r\n          ? this.height\r\n          : 0;\r\n\r\n      this.top = this.top || calcDim.top;\r\n      this.left = this.left || calcDim.left;\r\n\r\n      this.pathOffset = this.pathOffset || {\r\n        x: this.minX + this.width / 2,\r\n        y: this.minY + this.height / 2\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx context to render path on\r\n     */\r\n    _render: function(ctx) {\r\n      var current, // current instruction\r\n          previous = null,\r\n          subpathStartX = 0,\r\n          subpathStartY = 0,\r\n          x = 0, // current x\r\n          y = 0, // current y\r\n          controlX = 0, // current control point x\r\n          controlY = 0, // current control point y\r\n          tempX,\r\n          tempY,\r\n          l = -this.pathOffset.x,\r\n          t = -this.pathOffset.y;\r\n\r\n      if (this.group && this.group.type === 'path-group') {\r\n        l = 0;\r\n        t = 0;\r\n      }\r\n\r\n      ctx.beginPath();\r\n\r\n      for (var i = 0, len = this.path.length; i < len; ++i) {\r\n\r\n        current = this.path[i];\r\n\r\n        switch (current[0]) { // first letter\r\n\r\n          case 'l': // lineto, relative\r\n            x += current[1];\r\n            y += current[2];\r\n            ctx.lineTo(x + l, y + t);\r\n            break;\r\n\r\n          case 'L': // lineto, absolute\r\n            x = current[1];\r\n            y = current[2];\r\n            ctx.lineTo(x + l, y + t);\r\n            break;\r\n\r\n          case 'h': // horizontal lineto, relative\r\n            x += current[1];\r\n            ctx.lineTo(x + l, y + t);\r\n            break;\r\n\r\n          case 'H': // horizontal lineto, absolute\r\n            x = current[1];\r\n            ctx.lineTo(x + l, y + t);\r\n            break;\r\n\r\n          case 'v': // vertical lineto, relative\r\n            y += current[1];\r\n            ctx.lineTo(x + l, y + t);\r\n            break;\r\n\r\n          case 'V': // verical lineto, absolute\r\n            y = current[1];\r\n            ctx.lineTo(x + l, y + t);\r\n            break;\r\n\r\n          case 'm': // moveTo, relative\r\n            x += current[1];\r\n            y += current[2];\r\n            subpathStartX = x;\r\n            subpathStartY = y;\r\n            ctx.moveTo(x + l, y + t);\r\n            break;\r\n\r\n          case 'M': // moveTo, absolute\r\n            x = current[1];\r\n            y = current[2];\r\n            subpathStartX = x;\r\n            subpathStartY = y;\r\n            ctx.moveTo(x + l, y + t);\r\n            break;\r\n\r\n          case 'c': // bezierCurveTo, relative\r\n            tempX = x + current[5];\r\n            tempY = y + current[6];\r\n            controlX = x + current[3];\r\n            controlY = y + current[4];\r\n            ctx.bezierCurveTo(\r\n              x + current[1] + l, // x1\r\n              y + current[2] + t, // y1\r\n              controlX + l, // x2\r\n              controlY + t, // y2\r\n              tempX + l,\r\n              tempY + t\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n            break;\r\n\r\n          case 'C': // bezierCurveTo, absolute\r\n            x = current[5];\r\n            y = current[6];\r\n            controlX = current[3];\r\n            controlY = current[4];\r\n            ctx.bezierCurveTo(\r\n              current[1] + l,\r\n              current[2] + t,\r\n              controlX + l,\r\n              controlY + t,\r\n              x + l,\r\n              y + t\r\n            );\r\n            break;\r\n\r\n          case 's': // shorthand cubic bezierCurveTo, relative\r\n\r\n            // transform to absolute x,y\r\n            tempX = x + current[3];\r\n            tempY = y + current[4];\r\n\r\n            if (previous[0].match(/[CcSs]/) === null) {\r\n              // If there is no previous command or if the previous command was not a C, c, S, or s,\r\n              // the control point is coincident with the current point\r\n              controlX = x;\r\n              controlY = y;\r\n            }\r\n            else {\r\n              // calculate reflection of previous control points\r\n              controlX = 2 * x - controlX;\r\n              controlY = 2 * y - controlY;\r\n            }\r\n\r\n            ctx.bezierCurveTo(\r\n              controlX + l,\r\n              controlY + t,\r\n              x + current[1] + l,\r\n              y + current[2] + t,\r\n              tempX + l,\r\n              tempY + t\r\n            );\r\n            // set control point to 2nd one of this command\r\n            // \"... the first control point is assumed to be\r\n            // the reflection of the second control point on\r\n            // the previous command relative to the current point.\"\r\n            controlX = x + current[1];\r\n            controlY = y + current[2];\r\n\r\n            x = tempX;\r\n            y = tempY;\r\n            break;\r\n\r\n          case 'S': // shorthand cubic bezierCurveTo, absolute\r\n            tempX = current[3];\r\n            tempY = current[4];\r\n            if (previous[0].match(/[CcSs]/) === null) {\r\n              // If there is no previous command or if the previous command was not a C, c, S, or s,\r\n              // the control point is coincident with the current point\r\n              controlX = x;\r\n              controlY = y;\r\n            }\r\n            else {\r\n              // calculate reflection of previous control points\r\n              controlX = 2 * x - controlX;\r\n              controlY = 2 * y - controlY;\r\n            }\r\n            ctx.bezierCurveTo(\r\n              controlX + l,\r\n              controlY + t,\r\n              current[1] + l,\r\n              current[2] + t,\r\n              tempX + l,\r\n              tempY + t\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n\r\n            // set control point to 2nd one of this command\r\n            // \"... the first control point is assumed to be\r\n            // the reflection of the second control point on\r\n            // the previous command relative to the current point.\"\r\n            controlX = current[1];\r\n            controlY = current[2];\r\n\r\n            break;\r\n\r\n          case 'q': // quadraticCurveTo, relative\r\n            // transform to absolute x,y\r\n            tempX = x + current[3];\r\n            tempY = y + current[4];\r\n\r\n            controlX = x + current[1];\r\n            controlY = y + current[2];\r\n\r\n            ctx.quadraticCurveTo(\r\n              controlX + l,\r\n              controlY + t,\r\n              tempX + l,\r\n              tempY + t\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n            break;\r\n\r\n          case 'Q': // quadraticCurveTo, absolute\r\n            tempX = current[3];\r\n            tempY = current[4];\r\n\r\n            ctx.quadraticCurveTo(\r\n              current[1] + l,\r\n              current[2] + t,\r\n              tempX + l,\r\n              tempY + t\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n            controlX = current[1];\r\n            controlY = current[2];\r\n            break;\r\n\r\n          case 't': // shorthand quadraticCurveTo, relative\r\n\r\n            // transform to absolute x,y\r\n            tempX = x + current[1];\r\n            tempY = y + current[2];\r\n\r\n            if (previous[0].match(/[QqTt]/) === null) {\r\n              // If there is no previous command or if the previous command was not a Q, q, T or t,\r\n              // assume the control point is coincident with the current point\r\n              controlX = x;\r\n              controlY = y;\r\n            }\r\n            else {\r\n              // calculate reflection of previous control point\r\n              controlX = 2 * x - controlX;\r\n              controlY = 2 * y - controlY;\r\n            }\r\n\r\n            ctx.quadraticCurveTo(\r\n              controlX + l,\r\n              controlY + t,\r\n              tempX + l,\r\n              tempY + t\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n\r\n            break;\r\n\r\n          case 'T':\r\n            tempX = current[1];\r\n            tempY = current[2];\r\n\r\n            if (previous[0].match(/[QqTt]/) === null) {\r\n              // If there is no previous command or if the previous command was not a Q, q, T or t,\r\n              // assume the control point is coincident with the current point\r\n              controlX = x;\r\n              controlY = y;\r\n            }\r\n            else {\r\n              // calculate reflection of previous control point\r\n              controlX = 2 * x - controlX;\r\n              controlY = 2 * y - controlY;\r\n            }\r\n            ctx.quadraticCurveTo(\r\n              controlX + l,\r\n              controlY + t,\r\n              tempX + l,\r\n              tempY + t\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n            break;\r\n\r\n          case 'a':\r\n            // TODO: optimize this\r\n            drawArc(ctx, x + l, y + t, [\r\n              current[1],\r\n              current[2],\r\n              current[3],\r\n              current[4],\r\n              current[5],\r\n              current[6] + x + l,\r\n              current[7] + y + t\r\n            ]);\r\n            x += current[6];\r\n            y += current[7];\r\n            break;\r\n\r\n          case 'A':\r\n            // TODO: optimize this\r\n            drawArc(ctx, x + l, y + t, [\r\n              current[1],\r\n              current[2],\r\n              current[3],\r\n              current[4],\r\n              current[5],\r\n              current[6] + l,\r\n              current[7] + t\r\n            ]);\r\n            x = current[6];\r\n            y = current[7];\r\n            break;\r\n\r\n          case 'z':\r\n          case 'Z':\r\n            x = subpathStartX;\r\n            y = subpathStartY;\r\n            ctx.closePath();\r\n            break;\r\n        }\r\n        previous = current;\r\n      }\r\n      this._renderFill(ctx);\r\n      this._renderStroke(ctx);\r\n    },\r\n\r\n    /**\r\n     * Returns string representation of an instance\r\n     * @return {String} string representation of an instance\r\n     */\r\n    toString: function() {\r\n      return '#<fabric.Path (' + this.complexity() +\r\n        '): { \"top\": ' + this.top + ', \"left\": ' + this.left + ' }>';\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      var o = extend(this.callSuper('toObject', propertiesToInclude), {\r\n        path: this.path.map(function(item) { return item.slice() }),\r\n        pathOffset: this.pathOffset\r\n      });\r\n      if (this.sourcePath) {\r\n        o.sourcePath = this.sourcePath;\r\n      }\r\n      if (this.transformMatrix) {\r\n        o.transformMatrix = this.transformMatrix;\r\n      }\r\n      return o;\r\n    },\r\n\r\n    /**\r\n     * Returns dataless object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toDatalessObject: function(propertiesToInclude) {\r\n      var o = this.toObject(propertiesToInclude);\r\n      if (this.sourcePath) {\r\n        o.path = this.sourcePath;\r\n      }\r\n      delete o.sourcePath;\r\n      return o;\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns svg representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var chunks = [],\r\n          markup = this._createBaseSVGMarkup(), addTransform = '';\r\n\r\n      for (var i = 0, len = this.path.length; i < len; i++) {\r\n        chunks.push(this.path[i].join(' '));\r\n      }\r\n      var path = chunks.join(' ');\r\n      if (!(this.group && this.group.type === 'path-group')) {\r\n        addTransform = ' translate(' + (-this.pathOffset.x) + ', ' + (-this.pathOffset.y) + ') ';\r\n      }\r\n      markup.push(\r\n        //jscs:disable validateIndentation\r\n        '<path ',\r\n          'd=\"', path,\r\n          '\" style=\"', this.getSvgStyles(),\r\n          '\" transform=\"', this.getSvgTransform(), addTransform,\r\n          this.getSvgTransformMatrix(), '\" stroke-linecap=\"round\" ',\r\n        '/>\\n'\r\n        //jscs:enable validateIndentation\r\n      );\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns number representation of an instance complexity\r\n     * @return {Number} complexity of this instance\r\n     */\r\n    complexity: function() {\r\n      return this.path.length;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _parsePath: function() {\r\n      var result = [ ],\r\n          coords = [ ],\r\n          currentPath,\r\n          parsed,\r\n          re = /([-+]?((\\d+\\.\\d+)|((\\d+)|(\\.\\d+)))(?:e[-+]?\\d+)?)/ig,\r\n          match,\r\n          coordsStr;\r\n\r\n      for (var i = 0, coordsParsed, len = this.path.length; i < len; i++) {\r\n        currentPath = this.path[i];\r\n\r\n        coordsStr = currentPath.slice(1).trim();\r\n        coords.length = 0;\r\n\r\n        while ((match = re.exec(coordsStr))) {\r\n          coords.push(match[0]);\r\n        }\r\n\r\n        coordsParsed = [ currentPath.charAt(0) ];\r\n\r\n        for (var j = 0, jlen = coords.length; j < jlen; j++) {\r\n          parsed = parseFloat(coords[j]);\r\n          if (!isNaN(parsed)) {\r\n            coordsParsed.push(parsed);\r\n          }\r\n        }\r\n\r\n        var command = coordsParsed[0],\r\n            commandLength = commandLengths[command.toLowerCase()],\r\n            repeatedCommand = repeatedCommands[command] || command;\r\n\r\n        if (coordsParsed.length - 1 > commandLength) {\r\n          for (var k = 1, klen = coordsParsed.length; k < klen; k += commandLength) {\r\n            result.push([ command ].concat(coordsParsed.slice(k, k + commandLength)));\r\n            command = repeatedCommand;\r\n          }\r\n        }\r\n        else {\r\n          result.push(coordsParsed);\r\n        }\r\n      }\r\n\r\n      return result;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _parseDimensions: function() {\r\n\r\n      var aX = [],\r\n          aY = [],\r\n          current, // current instruction\r\n          previous = null,\r\n          subpathStartX = 0,\r\n          subpathStartY = 0,\r\n          x = 0, // current x\r\n          y = 0, // current y\r\n          controlX = 0, // current control point x\r\n          controlY = 0, // current control point y\r\n          tempX,\r\n          tempY,\r\n          bounds;\r\n\r\n      for (var i = 0, len = this.path.length; i < len; ++i) {\r\n\r\n        current = this.path[i];\r\n\r\n        switch (current[0]) { // first letter\r\n\r\n          case 'l': // lineto, relative\r\n            x += current[1];\r\n            y += current[2];\r\n            bounds = [ ];\r\n            break;\r\n\r\n          case 'L': // lineto, absolute\r\n            x = current[1];\r\n            y = current[2];\r\n            bounds = [ ];\r\n            break;\r\n\r\n          case 'h': // horizontal lineto, relative\r\n            x += current[1];\r\n            bounds = [ ];\r\n            break;\r\n\r\n          case 'H': // horizontal lineto, absolute\r\n            x = current[1];\r\n            bounds = [ ];\r\n            break;\r\n\r\n          case 'v': // vertical lineto, relative\r\n            y += current[1];\r\n            bounds = [ ];\r\n            break;\r\n\r\n          case 'V': // verical lineto, absolute\r\n            y = current[1];\r\n            bounds = [ ];\r\n            break;\r\n\r\n          case 'm': // moveTo, relative\r\n            x += current[1];\r\n            y += current[2];\r\n            subpathStartX = x;\r\n            subpathStartY = y;\r\n            bounds = [ ];\r\n            break;\r\n\r\n          case 'M': // moveTo, absolute\r\n            x = current[1];\r\n            y = current[2];\r\n            subpathStartX = x;\r\n            subpathStartY = y;\r\n            bounds = [ ];\r\n            break;\r\n\r\n          case 'c': // bezierCurveTo, relative\r\n            tempX = x + current[5];\r\n            tempY = y + current[6];\r\n            controlX = x + current[3];\r\n            controlY = y + current[4];\r\n            bounds = fabric.util.getBoundsOfCurve(x, y,\r\n              x + current[1], // x1\r\n              y + current[2], // y1\r\n              controlX, // x2\r\n              controlY, // y2\r\n              tempX,\r\n              tempY\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n            break;\r\n\r\n          case 'C': // bezierCurveTo, absolute\r\n            x = current[5];\r\n            y = current[6];\r\n            controlX = current[3];\r\n            controlY = current[4];\r\n            bounds = fabric.util.getBoundsOfCurve(x, y,\r\n              current[1],\r\n              current[2],\r\n              controlX,\r\n              controlY,\r\n              x,\r\n              y\r\n            );\r\n            break;\r\n\r\n          case 's': // shorthand cubic bezierCurveTo, relative\r\n\r\n            // transform to absolute x,y\r\n            tempX = x + current[3];\r\n            tempY = y + current[4];\r\n\r\n            if (previous[0].match(/[CcSs]/) === null) {\r\n              // If there is no previous command or if the previous command was not a C, c, S, or s,\r\n              // the control point is coincident with the current point\r\n              controlX = x;\r\n              controlY = y;\r\n            }\r\n            else {\r\n              // calculate reflection of previous control points\r\n              controlX = 2 * x - controlX;\r\n              controlY = 2 * y - controlY;\r\n            }\r\n\r\n            bounds = fabric.util.getBoundsOfCurve(x, y,\r\n              controlX,\r\n              controlY,\r\n              x + current[1],\r\n              y + current[2],\r\n              tempX,\r\n              tempY\r\n            );\r\n            // set control point to 2nd one of this command\r\n            // \"... the first control point is assumed to be\r\n            // the reflection of the second control point on\r\n            // the previous command relative to the current point.\"\r\n            controlX = x + current[1];\r\n            controlY = y + current[2];\r\n            x = tempX;\r\n            y = tempY;\r\n            break;\r\n\r\n          case 'S': // shorthand cubic bezierCurveTo, absolute\r\n            tempX = current[3];\r\n            tempY = current[4];\r\n            if (previous[0].match(/[CcSs]/) === null) {\r\n              // If there is no previous command or if the previous command was not a C, c, S, or s,\r\n              // the control point is coincident with the current point\r\n              controlX = x;\r\n              controlY = y;\r\n            }\r\n            else {\r\n              // calculate reflection of previous control points\r\n              controlX = 2 * x - controlX;\r\n              controlY = 2 * y - controlY;\r\n            }\r\n            bounds = fabric.util.getBoundsOfCurve(x, y,\r\n              controlX,\r\n              controlY,\r\n              current[1],\r\n              current[2],\r\n              tempX,\r\n              tempY\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n            // set control point to 2nd one of this command\r\n            // \"... the first control point is assumed to be\r\n            // the reflection of the second control point on\r\n            // the previous command relative to the current point.\"\r\n            controlX = current[1];\r\n            controlY = current[2];\r\n            break;\r\n\r\n          case 'q': // quadraticCurveTo, relative\r\n            // transform to absolute x,y\r\n            tempX = x + current[3];\r\n            tempY = y + current[4];\r\n            controlX = x + current[1];\r\n            controlY = y + current[2];\r\n            bounds = fabric.util.getBoundsOfCurve(x, y,\r\n              controlX,\r\n              controlY,\r\n              controlX,\r\n              controlY,\r\n              tempX,\r\n              tempY\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n            break;\r\n\r\n          case 'Q': // quadraticCurveTo, absolute\r\n            controlX = current[1];\r\n            controlY = current[2];\r\n            bounds = fabric.util.getBoundsOfCurve(x, y,\r\n              controlX,\r\n              controlY,\r\n              controlX,\r\n              controlY,\r\n              current[3],\r\n              current[4]\r\n            );\r\n            x = current[3];\r\n            y = current[4];\r\n            break;\r\n\r\n          case 't': // shorthand quadraticCurveTo, relative\r\n            // transform to absolute x,y\r\n            tempX = x + current[1];\r\n            tempY = y + current[2];\r\n            if (previous[0].match(/[QqTt]/) === null) {\r\n              // If there is no previous command or if the previous command was not a Q, q, T or t,\r\n              // assume the control point is coincident with the current point\r\n              controlX = x;\r\n              controlY = y;\r\n            }\r\n            else {\r\n              // calculate reflection of previous control point\r\n              controlX = 2 * x - controlX;\r\n              controlY = 2 * y - controlY;\r\n            }\r\n\r\n            bounds = fabric.util.getBoundsOfCurve(x, y,\r\n              controlX,\r\n              controlY,\r\n              controlX,\r\n              controlY,\r\n              tempX,\r\n              tempY\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n\r\n            break;\r\n\r\n          case 'T':\r\n            tempX = current[1];\r\n            tempY = current[2];\r\n\r\n            if (previous[0].match(/[QqTt]/) === null) {\r\n              // If there is no previous command or if the previous command was not a Q, q, T or t,\r\n              // assume the control point is coincident with the current point\r\n              controlX = x;\r\n              controlY = y;\r\n            }\r\n            else {\r\n              // calculate reflection of previous control point\r\n              controlX = 2 * x - controlX;\r\n              controlY = 2 * y - controlY;\r\n            }\r\n            bounds = fabric.util.getBoundsOfCurve(x, y,\r\n              controlX,\r\n              controlY,\r\n              controlX,\r\n              controlY,\r\n              tempX,\r\n              tempY\r\n            );\r\n            x = tempX;\r\n            y = tempY;\r\n            break;\r\n\r\n          case 'a':\r\n            // TODO: optimize this\r\n            bounds = fabric.util.getBoundsOfArc(x, y,\r\n              current[1],\r\n              current[2],\r\n              current[3],\r\n              current[4],\r\n              current[5],\r\n              current[6] + x,\r\n              current[7] + y\r\n            );\r\n            x += current[6];\r\n            y += current[7];\r\n            break;\r\n\r\n          case 'A':\r\n            // TODO: optimize this\r\n            bounds = fabric.util.getBoundsOfArc(x, y,\r\n              current[1],\r\n              current[2],\r\n              current[3],\r\n              current[4],\r\n              current[5],\r\n              current[6],\r\n              current[7]\r\n            );\r\n            x = current[6];\r\n            y = current[7];\r\n            break;\r\n\r\n          case 'z':\r\n          case 'Z':\r\n            x = subpathStartX;\r\n            y = subpathStartY;\r\n            break;\r\n        }\r\n        previous = current;\r\n        bounds.forEach(function (point) {\r\n          aX.push(point.x);\r\n          aY.push(point.y);\r\n        });\r\n        aX.push(x);\r\n        aY.push(y);\r\n      }\r\n\r\n      var minX = min(aX),\r\n          minY = min(aY),\r\n          maxX = max(aX),\r\n          maxY = max(aY),\r\n          deltaX = maxX - minX,\r\n          deltaY = maxY - minY,\r\n\r\n          o = {\r\n            left: minX,\r\n            top: minY,\r\n            width: deltaX,\r\n            height: deltaY\r\n          };\r\n\r\n      return o;\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Creates an instance of fabric.Path from an object\r\n   * @static\r\n   * @memberOf fabric.Path\r\n   * @param {Object} object\r\n   * @param {Function} callback Callback to invoke when an fabric.Path instance is created\r\n   */\r\n  fabric.Path.fromObject = function(object, callback) {\r\n    if (typeof object.path === 'string') {\r\n      fabric.loadSVGFromURL(object.path, function (elements) {\r\n        var path = elements[0],\r\n            pathUrl = object.path;\r\n\r\n        delete object.path;\r\n\r\n        fabric.util.object.extend(path, object);\r\n        path.setSourcePath(pathUrl);\r\n\r\n        callback(path);\r\n      });\r\n    }\r\n    else {\r\n      callback(new fabric.Path(object.path, object));\r\n    }\r\n  };\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by `fabric.Path.fromElement`)\r\n   * @static\r\n   * @memberOf fabric.Path\r\n   * @see http://www.w3.org/TR/SVG/paths.html#PathElement\r\n   */\r\n  fabric.Path.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat(['d']);\r\n\r\n  /**\r\n   * Creates an instance of fabric.Path from an SVG <path> element\r\n   * @static\r\n   * @memberOf fabric.Path\r\n   * @param {SVGElement} element to parse\r\n   * @param {Function} callback Callback to invoke when an fabric.Path instance is created\r\n   * @param {Object} [options] Options object\r\n   */\r\n  fabric.Path.fromElement = function(element, callback, options) {\r\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Path.ATTRIBUTE_NAMES);\r\n    callback && callback(new fabric.Path(parsedAttributes.d, extend(parsedAttributes, options)));\r\n  };\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Indicates that instances of this type are async\r\n   * @static\r\n   * @memberOf fabric.Path\r\n   * @type Boolean\r\n   * @default\r\n   */\r\n  fabric.Path.async = true;\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend,\r\n      invoke = fabric.util.array.invoke,\r\n      parentToObject = fabric.Object.prototype.toObject;\r\n\r\n  if (fabric.PathGroup) {\r\n    fabric.warn('fabric.PathGroup is already defined');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Path group class\r\n   * @class fabric.PathGroup\r\n   * @extends fabric.Path\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1/#path_and_pathgroup}\r\n   * @see {@link fabric.PathGroup#initialize} for constructor definition\r\n   */\r\n  fabric.PathGroup = fabric.util.createClass(fabric.Path, /** @lends fabric.PathGroup.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'path-group',\r\n\r\n    /**\r\n     * Fill value\r\n     * @type String\r\n     * @default\r\n     */\r\n    fill: '',\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Array} paths\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.PathGroup} thisArg\r\n     */\r\n    initialize: function(paths, options) {\r\n\r\n      options = options || { };\r\n      this.paths = paths || [ ];\r\n\r\n      for (var i = this.paths.length; i--;) {\r\n        this.paths[i].group = this;\r\n      }\r\n\r\n      if (options.toBeParsed) {\r\n        this.parseDimensionsFromPaths(options);\r\n        delete options.toBeParsed;\r\n      }\r\n      this.setOptions(options);\r\n      this.setCoords();\r\n\r\n      if (options.sourcePath) {\r\n        this.setSourcePath(options.sourcePath);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Calculate width and height based on paths contained\r\n     */\r\n    parseDimensionsFromPaths: function(options) {\r\n      var points, p, xC = [ ], yC = [ ], path, height, width,\r\n          m = this.transformMatrix;\r\n      for (var j = this.paths.length; j--;) {\r\n        path = this.paths[j];\r\n        height = path.height + path.strokeWidth;\r\n        width = path.width + path.strokeWidth;\r\n        points = [\r\n          { x: path.left, y: path.top },\r\n          { x: path.left + width, y: path.top },\r\n          { x: path.left, y: path.top + height },\r\n          { x: path.left + width, y: path.top + height }\r\n        ];\r\n        for (var i = 0; i < points.length; i++) {\r\n          p = points[i];\r\n          if (m) {\r\n            p = fabric.util.transformPoint(p, m, false);\r\n          }\r\n          xC.push(p.x);\r\n          yC.push(p.y);\r\n        }\r\n      }\r\n      options.width = Math.max.apply(null, xC);\r\n      options.height = Math.max.apply(null, yC);\r\n    },\r\n\r\n    /**\r\n     * Renders this group on a specified context\r\n     * @param {CanvasRenderingContext2D} ctx Context to render this instance on\r\n     */\r\n    render: function(ctx) {\r\n      // do not render if object is not visible\r\n      if (!this.visible) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n\r\n      if (this.transformMatrix) {\r\n        ctx.transform.apply(ctx, this.transformMatrix);\r\n      }\r\n      this.transform(ctx);\r\n\r\n      this._setShadow(ctx);\r\n      this.clipTo && fabric.util.clipContext(this, ctx);\r\n      ctx.translate(-this.width/2, -this.height/2);\r\n      for (var i = 0, l = this.paths.length; i < l; ++i) {\r\n        this.paths[i].render(ctx, true);\r\n      }\r\n      this.clipTo && ctx.restore();\r\n      this._removeShadow(ctx);\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Sets certain property to a certain value\r\n     * @param {String} prop\r\n     * @param {Any} value\r\n     * @return {fabric.PathGroup} thisArg\r\n     */\r\n    _set: function(prop, value) {\r\n\r\n      if (prop === 'fill' && value && this.isSameColor()) {\r\n        var i = this.paths.length;\r\n        while (i--) {\r\n          this.paths[i]._set(prop, value);\r\n        }\r\n      }\r\n\r\n      return this.callSuper('_set', prop, value);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of this path group\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      var o = extend(parentToObject.call(this, propertiesToInclude), {\r\n        paths: invoke(this.getObjects(), 'toObject', propertiesToInclude)\r\n      });\r\n      if (this.sourcePath) {\r\n        o.sourcePath = this.sourcePath;\r\n      }\r\n      return o;\r\n    },\r\n\r\n    /**\r\n     * Returns dataless object representation of this path group\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} dataless object representation of an instance\r\n     */\r\n    toDatalessObject: function(propertiesToInclude) {\r\n      var o = this.toObject(propertiesToInclude);\r\n      if (this.sourcePath) {\r\n        o.paths = this.sourcePath;\r\n      }\r\n      return o;\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns svg representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var objects = this.getObjects(),\r\n          p = this.getPointByOrigin('left', 'top'),\r\n          translatePart = 'translate(' + p.x + ' ' + p.y + ')',\r\n          markup = [\r\n            //jscs:disable validateIndentation\r\n            '<g ',\r\n              'style=\"', this.getSvgStyles(), '\" ',\r\n              'transform=\"', this.getSvgTransformMatrix(), translatePart, this.getSvgTransform(), '\" ',\r\n            '>\\n'\r\n            //jscs:enable validateIndentation\r\n          ];\r\n\r\n      for (var i = 0, len = objects.length; i < len; i++) {\r\n        markup.push(objects[i].toSVG(reviver));\r\n      }\r\n      markup.push('</g>\\n');\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns a string representation of this path group\r\n     * @return {String} string representation of an object\r\n     */\r\n    toString: function() {\r\n      return '#<fabric.PathGroup (' + this.complexity() +\r\n        '): { top: ' + this.top + ', left: ' + this.left + ' }>';\r\n    },\r\n\r\n    /**\r\n     * Returns true if all paths in this group are of same color\r\n     * @return {Boolean} true if all paths are of the same color (`fill`)\r\n     */\r\n    isSameColor: function() {\r\n      var firstPathFill = (this.getObjects()[0].get('fill') || '').toLowerCase();\r\n      return this.getObjects().every(function(path) {\r\n        return (path.get('fill') || '').toLowerCase() === firstPathFill;\r\n      });\r\n    },\r\n\r\n    /**\r\n     * Returns number representation of object's complexity\r\n     * @return {Number} complexity\r\n     */\r\n    complexity: function() {\r\n      return this.paths.reduce(function(total, path) {\r\n        return total + ((path && path.complexity) ? path.complexity() : 0);\r\n      }, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns all paths in this path group\r\n     * @return {Array} array of path objects included in this path group\r\n     */\r\n    getObjects: function() {\r\n      return this.paths;\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Creates fabric.PathGroup instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.PathGroup\r\n   * @param {Object} object Object to create an instance from\r\n   * @param {Function} callback Callback to invoke when an fabric.PathGroup instance is created\r\n   */\r\n  fabric.PathGroup.fromObject = function(object, callback) {\r\n    if (typeof object.paths === 'string') {\r\n      fabric.loadSVGFromURL(object.paths, function (elements) {\r\n\r\n        var pathUrl = object.paths;\r\n        delete object.paths;\r\n\r\n        var pathGroup = fabric.util.groupSVGElements(elements, object, pathUrl);\r\n\r\n        callback(pathGroup);\r\n      });\r\n    }\r\n    else {\r\n      fabric.util.enlivenObjects(object.paths, function(enlivenedObjects) {\r\n        delete object.paths;\r\n        callback(new fabric.PathGroup(enlivenedObjects, object));\r\n      });\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Indicates that instances of this type are async\r\n   * @static\r\n   * @memberOf fabric.PathGroup\r\n   * @type Boolean\r\n   * @default\r\n   */\r\n  fabric.PathGroup.async = true;\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend,\r\n      min = fabric.util.array.min,\r\n      max = fabric.util.array.max,\r\n      invoke = fabric.util.array.invoke;\r\n\r\n  if (fabric.Group) {\r\n    return;\r\n  }\r\n\r\n  // lock-related properties, for use in fabric.Group#get\r\n  // to enable locking behavior on group\r\n  // when one of its objects has lock-related properties set\r\n  var _lockProperties = {\r\n    lockMovementX:  true,\r\n    lockMovementY:  true,\r\n    lockRotation:   true,\r\n    lockScalingX:   true,\r\n    lockScalingY:   true,\r\n    lockUniScaling: true\r\n  };\r\n\r\n  /**\r\n   * Group class\r\n   * @class fabric.Group\r\n   * @extends fabric.Object\r\n   * @mixes fabric.Collection\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-3/#groups}\r\n   * @see {@link fabric.Group#initialize} for constructor definition\r\n   */\r\n  fabric.Group = fabric.util.createClass(fabric.Object, fabric.Collection, /** @lends fabric.Group.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'group',\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {Object} objects Group objects\r\n     * @param {Object} [options] Options object\r\n     * @return {Object} thisArg\r\n     */\r\n    initialize: function(objects, options) {\r\n      options = options || { };\r\n\r\n      this._objects = objects || [];\r\n      for (var i = this._objects.length; i--; ) {\r\n        this._objects[i].group = this;\r\n      }\r\n\r\n      this.originalState = { };\r\n      this.callSuper('initialize');\r\n\r\n      if (options.originX) {\r\n        this.originX = options.originX;\r\n      }\r\n\r\n      if (options.originY) {\r\n        this.originY = options.originY;\r\n      }\r\n\r\n      this._calcBounds();\r\n      this._updateObjectsCoords();\r\n\r\n      this.callSuper('initialize', options);\r\n\r\n      this.setCoords();\r\n      this.saveCoords();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _updateObjectsCoords: function() {\r\n      this.forEachObject(this._updateObjectCoords, this);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _updateObjectCoords: function(object) {\r\n      var objectLeft = object.getLeft(),\r\n          objectTop = object.getTop(),\r\n          center = this.getCenterPoint();\r\n\r\n      object.set({\r\n        originalLeft: objectLeft,\r\n        originalTop: objectTop,\r\n        left: objectLeft - center.x,\r\n        top: objectTop - center.y\r\n      });\r\n\r\n      object.setCoords();\r\n\r\n      // do not display corners of objects enclosed in a group\r\n      object.__origHasControls = object.hasControls;\r\n      object.hasControls = false;\r\n    },\r\n\r\n    /**\r\n     * Returns string represenation of a group\r\n     * @return {String}\r\n     */\r\n    toString: function() {\r\n      return '#<fabric.Group: (' + this.complexity() + ')>';\r\n    },\r\n\r\n    /**\r\n     * Adds an object to a group; Then recalculates group's dimension, position.\r\n     * @param {Object} object\r\n     * @return {fabric.Group} thisArg\r\n     * @chainable\r\n     */\r\n    addWithUpdate: function(object) {\r\n      this._restoreObjectsState();\r\n      if (object) {\r\n        this._objects.push(object);\r\n        object.group = this;\r\n      }\r\n      // since _restoreObjectsState set objects inactive\r\n      this.forEachObject(this._setObjectActive, this);\r\n      this._calcBounds();\r\n      this._updateObjectsCoords();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setObjectActive: function(object) {\r\n      object.set('active', true);\r\n      object.group = this;\r\n    },\r\n\r\n    /**\r\n     * Removes an object from a group; Then recalculates group's dimension, position.\r\n     * @param {Object} object\r\n     * @return {fabric.Group} thisArg\r\n     * @chainable\r\n     */\r\n    removeWithUpdate: function(object) {\r\n      this._moveFlippedObject(object);\r\n      this._restoreObjectsState();\r\n\r\n      // since _restoreObjectsState set objects inactive\r\n      this.forEachObject(this._setObjectActive, this);\r\n\r\n      this.remove(object);\r\n      this._calcBounds();\r\n      this._updateObjectsCoords();\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _onObjectAdded: function(object) {\r\n      object.group = this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _onObjectRemoved: function(object) {\r\n      delete object.group;\r\n      object.set('active', false);\r\n    },\r\n\r\n    /**\r\n     * Properties that are delegated to group objects when reading/writing\r\n     * @param {Object} delegatedProperties\r\n     */\r\n    delegatedProperties: {\r\n      fill:             true,\r\n      opacity:          true,\r\n      fontFamily:       true,\r\n      fontWeight:       true,\r\n      fontSize:         true,\r\n      fontStyle:        true,\r\n      lineHeight:       true,\r\n      textDecoration:   true,\r\n      textAlign:        true,\r\n      backgroundColor:  true\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _set: function(key, value) {\r\n      if (key in this.delegatedProperties) {\r\n        var i = this._objects.length;\r\n        while (i--) {\r\n          this._objects[i].set(key, value);\r\n        }\r\n      }\r\n      this.callSuper('_set', key, value);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      return extend(this.callSuper('toObject', propertiesToInclude), {\r\n        objects: invoke(this._objects, 'toObject', propertiesToInclude)\r\n      });\r\n    },\r\n\r\n    /**\r\n     * Renders instance on a given context\r\n     * @param {CanvasRenderingContext2D} ctx context to render instance on\r\n     */\r\n    render: function(ctx) {\r\n      // do not render if object is not visible\r\n      if (!this.visible) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n      this.clipTo && fabric.util.clipContext(this, ctx);\r\n      this.transform(ctx);\r\n      // the array is now sorted in order of highest first, so start from end\r\n      for (var i = 0, len = this._objects.length; i < len; i++) {\r\n        this._renderObject(this._objects[i], ctx);\r\n      }\r\n\r\n      this.clipTo && ctx.restore();\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Renders controls and borders for the object\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {Boolean} [noTransform] When true, context is not transformed\r\n     */\r\n    _renderControls: function(ctx, noTransform) {\r\n      this.callSuper('_renderControls', ctx, noTransform);\r\n      for (var i = 0, len = this._objects.length; i < len; i++) {\r\n        this._objects[i]._renderControls(ctx);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _renderObject: function(object, ctx) {\r\n      var originalHasRotatingPoint = object.hasRotatingPoint;\r\n\r\n      // do not render if object is not visible\r\n      if (!object.visible) {\r\n        return;\r\n      }\r\n\r\n      object.hasRotatingPoint = false;\r\n\r\n      object.render(ctx);\r\n\r\n      object.hasRotatingPoint = originalHasRotatingPoint;\r\n    },\r\n\r\n    /**\r\n     * Retores original state of each of group objects (original state is that which was before group was created).\r\n     * @private\r\n     * @return {fabric.Group} thisArg\r\n     * @chainable\r\n     */\r\n    _restoreObjectsState: function() {\r\n      this._objects.forEach(this._restoreObjectState, this);\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Realises the transform from this group onto the supplied object\r\n     * i.e. it tells you what would happen if the supplied object was in\r\n     * the group, and then the group was destroyed. It mutates the supplied\r\n     * object.\r\n     * @param {fabric.Object} object\r\n     * @return {fabric.Object} transformedObject\r\n    */\r\n    realizeTransform: function(object) {\r\n      this._moveFlippedObject(object);\r\n      this._setObjectPosition(object);\r\n      return object;\r\n    },\r\n    /**\r\n     * Moves a flipped object to the position where it's displayed\r\n     * @private\r\n     * @param {fabric.Object} object\r\n     * @return {fabric.Group} thisArg\r\n     */\r\n    _moveFlippedObject: function(object) {\r\n      var oldOriginX = object.get('originX'),\r\n          oldOriginY = object.get('originY'),\r\n          center = object.getCenterPoint();\r\n\r\n      object.set({\r\n        originX: 'center',\r\n        originY: 'center',\r\n        left: center.x,\r\n        top: center.y\r\n      });\r\n\r\n      this._toggleFlipping(object);\r\n\r\n      var newOrigin = object.getPointByOrigin(oldOriginX, oldOriginY);\r\n\r\n      object.set({\r\n        originX: oldOriginX,\r\n        originY: oldOriginY,\r\n        left: newOrigin.x,\r\n        top: newOrigin.y\r\n      });\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _toggleFlipping: function(object) {\r\n      if (this.flipX) {\r\n        object.toggle('flipX');\r\n        object.set('left', -object.get('left'));\r\n        object.setAngle(-object.getAngle());\r\n      }\r\n      if (this.flipY) {\r\n        object.toggle('flipY');\r\n        object.set('top', -object.get('top'));\r\n        object.setAngle(-object.getAngle());\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Restores original state of a specified object in group\r\n     * @private\r\n     * @param {fabric.Object} object\r\n     * @return {fabric.Group} thisArg\r\n     */\r\n    _restoreObjectState: function(object) {\r\n      this._setObjectPosition(object);\r\n\r\n      object.setCoords();\r\n      object.hasControls = object.__origHasControls;\r\n      delete object.__origHasControls;\r\n      object.set('active', false);\r\n      object.setCoords();\r\n      delete object.group;\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setObjectPosition: function(object) {\r\n      var center = this.getCenterPoint(),\r\n          rotated = this._getRotatedLeftTop(object);\r\n\r\n      object.set({\r\n        angle: object.getAngle() + this.getAngle(),\r\n        left: center.x + rotated.left,\r\n        top: center.y + rotated.top,\r\n        scaleX: object.get('scaleX') * this.get('scaleX'),\r\n        scaleY: object.get('scaleY') * this.get('scaleY')\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getRotatedLeftTop: function(object) {\r\n      var groupAngle = this.getAngle() * (Math.PI / 180);\r\n      return {\r\n        left: (-Math.sin(groupAngle) * object.getTop() * this.get('scaleY') +\r\n                Math.cos(groupAngle) * object.getLeft() * this.get('scaleX')),\r\n\r\n        top:  (Math.cos(groupAngle) * object.getTop() * this.get('scaleY') +\r\n               Math.sin(groupAngle) * object.getLeft() * this.get('scaleX'))\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Destroys a group (restoring state of its objects)\r\n     * @return {fabric.Group} thisArg\r\n     * @chainable\r\n     */\r\n    destroy: function() {\r\n      this._objects.forEach(this._moveFlippedObject, this);\r\n      return this._restoreObjectsState();\r\n    },\r\n\r\n    /**\r\n     * Saves coordinates of this instance (to be used together with `hasMoved`)\r\n     * @saveCoords\r\n     * @return {fabric.Group} thisArg\r\n     * @chainable\r\n     */\r\n    saveCoords: function() {\r\n      this._originalLeft = this.get('left');\r\n      this._originalTop = this.get('top');\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Checks whether this group was moved (since `saveCoords` was called last)\r\n     * @return {Boolean} true if an object was moved (since fabric.Group#saveCoords was called)\r\n     */\r\n    hasMoved: function() {\r\n      return this._originalLeft !== this.get('left') ||\r\n             this._originalTop !== this.get('top');\r\n    },\r\n\r\n    /**\r\n     * Sets coordinates of all group objects\r\n     * @return {fabric.Group} thisArg\r\n     * @chainable\r\n     */\r\n    setObjectsCoords: function() {\r\n      this.forEachObject(function(object) {\r\n        object.setCoords();\r\n      });\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _calcBounds: function(onlyWidthHeight) {\r\n      var aX = [],\r\n          aY = [],\r\n          o, prop,\r\n          props = ['tr', 'br', 'bl', 'tl'];\r\n\r\n      for (var i = 0, len = this._objects.length; i < len; ++i) {\r\n        o = this._objects[i];\r\n        o.setCoords();\r\n        for (var j = 0; j < props.length; j++) {\r\n          prop = props[j];\r\n          aX.push(o.oCoords[prop].x);\r\n          aY.push(o.oCoords[prop].y);\r\n        }\r\n      }\r\n\r\n      this.set(this._getBounds(aX, aY, onlyWidthHeight));\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getBounds: function(aX, aY, onlyWidthHeight) {\r\n      var ivt = fabric.util.invertTransform(this.getViewportTransform()),\r\n          minXY = fabric.util.transformPoint(new fabric.Point(min(aX), min(aY)), ivt),\r\n          maxXY = fabric.util.transformPoint(new fabric.Point(max(aX), max(aY)), ivt),\r\n          obj = {\r\n            width: (maxXY.x - minXY.x) || 0,\r\n            height: (maxXY.y - minXY.y) || 0\r\n          };\r\n\r\n      if (!onlyWidthHeight) {\r\n        obj.left = minXY.x || 0;\r\n        obj.top = minXY.y || 0;\r\n        if (this.originX === 'center') {\r\n          obj.left += obj.width / 2;\r\n        }\r\n        if (this.originX === 'right') {\r\n          obj.left += obj.width;\r\n        }\r\n        if (this.originY === 'center') {\r\n          obj.top += obj.height / 2;\r\n        }\r\n        if (this.originY === 'bottom') {\r\n          obj.top += obj.height;\r\n        }\r\n      }\r\n      return obj;\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns svg representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var markup = [\r\n        //jscs:disable validateIndentation\r\n        '<g ',\r\n          'transform=\"', this.getSvgTransform(),\r\n        '\">\\n'\r\n        //jscs:enable validateIndentation\r\n      ];\r\n\r\n      for (var i = 0, len = this._objects.length; i < len; i++) {\r\n        markup.push(this._objects[i].toSVG(reviver));\r\n      }\r\n\r\n      markup.push('</g>\\n');\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns requested property\r\n     * @param {String} prop Property to get\r\n     * @return {Any}\r\n     */\r\n    get: function(prop) {\r\n      if (prop in _lockProperties) {\r\n        if (this[prop]) {\r\n          return this[prop];\r\n        }\r\n        else {\r\n          for (var i = 0, len = this._objects.length; i < len; i++) {\r\n            if (this._objects[i][prop]) {\r\n              return true;\r\n            }\r\n          }\r\n          return false;\r\n        }\r\n      }\r\n      else {\r\n        if (prop in this.delegatedProperties) {\r\n          return this._objects[0] && this._objects[0].get(prop);\r\n        }\r\n        return this[prop];\r\n      }\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns {@link fabric.Group} instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Group\r\n   * @param {Object} object Object to create a group from\r\n   * @param {Function} [callback] Callback to invoke when an group instance is created\r\n   * @return {fabric.Group} An instance of fabric.Group\r\n   */\r\n  fabric.Group.fromObject = function(object, callback) {\r\n    fabric.util.enlivenObjects(object.objects, function(enlivenedObjects) {\r\n      delete object.objects;\r\n      callback && callback(new fabric.Group(enlivenedObjects, object));\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Indicates that instances of this type are async\r\n   * @static\r\n   * @memberOf fabric.Group\r\n   * @type Boolean\r\n   * @default\r\n   */\r\n  fabric.Group.async = true;\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var extend = fabric.util.object.extend;\r\n\r\n  if (!global.fabric) {\r\n    global.fabric = { };\r\n  }\r\n\r\n  if (global.fabric.Image) {\r\n    fabric.warn('fabric.Image is already defined.');\r\n    return;\r\n  }\r\n\r\n  /**\r\n   * Image class\r\n   * @class fabric.Image\r\n   * @extends fabric.Object\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-1/#images}\r\n   * @see {@link fabric.Image#initialize} for constructor definition\r\n   */\r\n  fabric.Image = fabric.util.createClass(fabric.Object, /** @lends fabric.Image.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'image',\r\n\r\n    /**\r\n     * crossOrigin value (one of \"\", \"anonymous\", \"allow-credentials\")\r\n     * @see https://developer.mozilla.org/en-US/docs/HTML/CORS_settings_attributes\r\n     * @type String\r\n     * @default\r\n     */\r\n    crossOrigin: '',\r\n\r\n    /**\r\n     * AlignX value, part of preserveAspectRatio (one of \"none\", \"mid\", \"min\", \"max\")\r\n     * @see http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute\r\n     * This parameter defines how the picture is aligned to its viewport when image element width differs from image width.\r\n     * @type String\r\n     * @default\r\n     */\r\n    alignX: 'none',\r\n\r\n    /**\r\n     * AlignY value, part of preserveAspectRatio (one of \"none\", \"mid\", \"min\", \"max\")\r\n     * @see http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute\r\n     * This parameter defines how the picture is aligned to its viewport when image element height differs from image height.\r\n     * @type String\r\n     * @default\r\n     */\r\n    alignY: 'none',\r\n\r\n    /**\r\n     * meetOrSlice value, part of preserveAspectRatio  (one of \"meet\", \"slice\").\r\n     * if meet the image is always fully visibile, if slice the viewport is always filled with image.\r\n     * @see http://www.w3.org/TR/SVG/coords.html#PreserveAspectRatioAttribute\r\n     * @type String\r\n     * @default\r\n     */\r\n    meetOrSlice: 'meet',\r\n\r\n    /**\r\n     * private\r\n     * contains last value of scaleX to detect\r\n     * if the Image got resized after the last Render\r\n     * @type Number\r\n     */\r\n    _lastScaleX: 1,\r\n\r\n    /**\r\n     * private\r\n     * contains last value of scaleY to detect\r\n     * if the Image got resized after the last Render\r\n     * @type Number\r\n     */\r\n    _lastScaleY: 1,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {HTMLImageElement | String} element Image element\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Image} thisArg\r\n     */\r\n    initialize: function(element, options) {\r\n      options || (options = { });\r\n\r\n      this.filters = [ ];\r\n      this.resizeFilters = [ ];\r\n      this.callSuper('initialize', options);\r\n\r\n      this._initElement(element, options);\r\n      this._initConfig(options);\r\n\r\n      if (options.filters) {\r\n        this.filters = options.filters;\r\n        this.applyFilters();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Returns image element which this instance if based on\r\n     * @return {HTMLImageElement} Image element\r\n     */\r\n    getElement: function() {\r\n      return this._element;\r\n    },\r\n\r\n    /**\r\n     * Sets image element for this instance to a specified one.\r\n     * If filters defined they are applied to new image.\r\n     * You might need to call `canvas.renderAll` and `object.setCoords` after replacing, to render new image and update controls area.\r\n     * @param {HTMLImageElement} element\r\n     * @param {Function} [callback] Callback is invoked when all filters have been applied and new image is generated\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Image} thisArg\r\n     * @chainable\r\n     */\r\n    setElement: function(element, callback, options) {\r\n      this._element = element;\r\n      this._originalElement = element;\r\n      this._initConfig(options);\r\n\r\n      if (this.filters.length !== 0) {\r\n        this.applyFilters(callback);\r\n      }\r\n      else if (callback) {\r\n        callback();\r\n      }\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Sets crossOrigin value (on an instance and corresponding image element)\r\n     * @return {fabric.Image} thisArg\r\n     * @chainable\r\n     */\r\n    setCrossOrigin: function(value) {\r\n      this.crossOrigin = value;\r\n      this._element.crossOrigin = value;\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * Returns original size of an image\r\n     * @return {Object} Object with \"width\" and \"height\" properties\r\n     */\r\n    getOriginalSize: function() {\r\n      var element = this.getElement();\r\n      return {\r\n        width: element.width,\r\n        height: element.height\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _stroke: function(ctx) {\r\n      ctx.save();\r\n      this._setStrokeStyles(ctx);\r\n      ctx.beginPath();\r\n      ctx.strokeRect(-this.width / 2, -this.height / 2, this.width, this.height);\r\n      ctx.closePath();\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderDashedStroke: function(ctx) {\r\n      var x = -this.width / 2,\r\n          y = -this.height / 2,\r\n          w = this.width,\r\n          h = this.height;\r\n\r\n      ctx.save();\r\n      this._setStrokeStyles(ctx);\r\n\r\n      ctx.beginPath();\r\n      fabric.util.drawDashedLine(ctx, x, y, x + w, y, this.strokeDashArray);\r\n      fabric.util.drawDashedLine(ctx, x + w, y, x + w, y + h, this.strokeDashArray);\r\n      fabric.util.drawDashedLine(ctx, x + w, y + h, x, y + h, this.strokeDashArray);\r\n      fabric.util.drawDashedLine(ctx, x, y + h, x, y, this.strokeDashArray);\r\n      ctx.closePath();\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      return extend(this.callSuper('toObject', propertiesToInclude), {\r\n        src: this._originalElement.src || this._originalElement._src,\r\n        filters: this.filters.map(function(filterObj) {\r\n          return filterObj && filterObj.toObject();\r\n        }),\r\n        crossOrigin: this.crossOrigin,\r\n        alignX: this.alignX,\r\n        alignY: this.alignY,\r\n        meetOrSlice: this.meetOrSlice\r\n      });\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns SVG representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var markup = [], x = -this.width / 2, y = -this.height / 2,\r\n          preserveAspectRatio = 'none';\r\n      if (this.group && this.group.type === 'path-group') {\r\n        x = this.left;\r\n        y = this.top;\r\n      }\r\n      if (this.alignX !== 'none' && this.alignY !== 'none') {\r\n        preserveAspectRatio = 'x' + this.alignX + 'Y' + this.alignY + ' ' + this.meetOrSlice;\r\n      }\r\n      markup.push(\r\n        '<g transform=\"', this.getSvgTransform(), this.getSvgTransformMatrix(), '\">\\n',\r\n          '<image xlink:href=\"', this.getSvgSrc(),\r\n            '\" x=\"', x, '\" y=\"', y,\r\n            '\" style=\"', this.getSvgStyles(),\r\n            // we're essentially moving origin of transformation from top/left corner to the center of the shape\r\n            // by wrapping it in container <g> element with actual transformation, then offsetting object to the top/left\r\n            // so that object's center aligns with container's left/top\r\n            '\" width=\"', this.width,\r\n            '\" height=\"', this.height,\r\n            '\" preserveAspectRatio=\"', preserveAspectRatio, '\"',\r\n          '></image>\\n'\r\n      );\r\n\r\n      if (this.stroke || this.strokeDashArray) {\r\n        var origFill = this.fill;\r\n        this.fill = null;\r\n        markup.push(\r\n          '<rect ',\r\n            'x=\"', x, '\" y=\"', y,\r\n            '\" width=\"', this.width, '\" height=\"', this.height,\r\n            '\" style=\"', this.getSvgStyles(),\r\n          '\"/>\\n'\r\n        );\r\n        this.fill = origFill;\r\n      }\r\n\r\n      markup.push('</g>\\n');\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Returns source of an image\r\n     * @return {String} Source of an image\r\n     */\r\n    getSrc: function() {\r\n      if (this.getElement()) {\r\n        return this.getElement().src || this.getElement()._src;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Sets source of an image\r\n     * @param {String} src Source string (URL)\r\n     * @param {Function} [callback] Callback is invoked when image has been loaded (and all filters have been applied)\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Image} thisArg\r\n     * @chainable\r\n     */\r\n    setSrc: function(src, callback, options) {\r\n      fabric.util.loadImage(src, function(img) {\r\n        return this.setElement(img, callback, options);\r\n      }, this, options && options.crossOrigin);\r\n    },\r\n\r\n    /**\r\n     * Returns string representation of an instance\r\n     * @return {String} String representation of an instance\r\n     */\r\n    toString: function() {\r\n      return '#<fabric.Image: { src: \"' + this.getSrc() + '\" }>';\r\n    },\r\n\r\n    /**\r\n     * Returns a clone of an instance\r\n     * @param {Function} callback Callback is invoked with a clone as a first argument\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     */\r\n    clone: function(callback, propertiesToInclude) {\r\n      this.constructor.fromObject(this.toObject(propertiesToInclude), callback);\r\n    },\r\n\r\n    /**\r\n     * Applies filters assigned to this image (from \"filters\" array)\r\n     * @method applyFilters\r\n     * @param {Function} callback Callback is invoked when all filters have been applied and new image is generated\r\n     * @return {fabric.Image} thisArg\r\n     * @chainable\r\n     */\r\n    applyFilters: function(callback, filters, imgElement, forResizing) {\r\n\r\n      filters = filters || this.filters;\r\n      imgElement = imgElement || this._originalElement;\r\n\r\n      if (!imgElement) {\r\n        return;\r\n      }\r\n\r\n      var imgEl = imgElement,\r\n          canvasEl = fabric.util.createCanvasElement(),\r\n          replacement = fabric.util.createImage(),\r\n          _this = this;\r\n\r\n      canvasEl.width = imgEl.width;\r\n      canvasEl.height = imgEl.height;\r\n      canvasEl.getContext('2d').drawImage(imgEl, 0, 0, imgEl.width, imgEl.height);\r\n\r\n      if (filters.length === 0) {\r\n        this._element = imgElement;\r\n        callback && callback();\r\n        return canvasEl;\r\n      }\r\n      filters.forEach(function(filter) {\r\n        filter && filter.applyTo(canvasEl, filter.scaleX || _this.scaleX, filter.scaleY || _this.scaleY);\r\n        if (!forResizing && filter && filter.type === 'Resize') {\r\n          _this.width *= filter.scaleX;\r\n          _this.height *= filter.scaleY;\r\n        }\r\n      });\r\n\r\n      /** @ignore */\r\n      replacement.width = canvasEl.width;\r\n      replacement.height = canvasEl.height;\r\n\r\n      if (fabric.isLikelyNode) {\r\n        replacement.src = canvasEl.toBuffer(undefined, fabric.Image.pngCompression);\r\n        // onload doesn't fire in some node versions, so we invoke callback manually\r\n        _this._element = replacement;\r\n        !forResizing && (_this._filteredEl = replacement);\r\n        callback && callback();\r\n      }\r\n      else {\r\n        replacement.onload = function() {\r\n          _this._element = replacement;\r\n          !forResizing && (_this._filteredEl = replacement);\r\n          callback && callback();\r\n          replacement.onload = canvasEl = imgEl = null;\r\n        };\r\n        replacement.src = canvasEl.toDataURL('image/png');\r\n      }\r\n      return canvasEl;\r\n    },\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _render: function(ctx, noTransform) {\r\n      var x, y, imageMargins = this._findMargins(), elementToDraw;\r\n\r\n      x = (noTransform ? this.left : -this.width / 2);\r\n      y = (noTransform ? this.top : -this.height / 2);\r\n\r\n      if (this.meetOrSlice === 'slice') {\r\n        ctx.beginPath();\r\n        ctx.rect(x, y, this.width, this.height);\r\n        ctx.clip();\r\n      }\r\n\r\n      if (this.isMoving === false && this.resizeFilters.length && this._needsResize()) {\r\n        this._lastScaleX = this.scaleX;\r\n        this._lastScaleY = this.scaleY;\r\n        elementToDraw = this.applyFilters(null, this.resizeFilters, this._filteredEl || this._originalElement, true);\r\n      }\r\n      else {\r\n        elementToDraw = this._element;\r\n      }\r\n      elementToDraw && ctx.drawImage(elementToDraw,\r\n                                     x + imageMargins.marginX,\r\n                                     y + imageMargins.marginY,\r\n                                     imageMargins.width,\r\n                                     imageMargins.height\r\n                                    );\r\n\r\n      this._renderStroke(ctx);\r\n    },\r\n    /**\r\n     * @private, needed to check if image needs resize\r\n     */\r\n    _needsResize: function() {\r\n      return (this.scaleX !== this._lastScaleX || this.scaleY !== this._lastScaleY);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _findMargins: function() {\r\n      var width = this.width, height = this.height, scales,\r\n          scale, marginX = 0, marginY = 0;\r\n\r\n      if (this.alignX !== 'none' || this.alignY !== 'none') {\r\n        scales = [this.width / this._element.width, this.height / this._element.height];\r\n        scale = this.meetOrSlice === 'meet'\r\n                ? Math.min.apply(null, scales) : Math.max.apply(null, scales);\r\n        width = this._element.width * scale;\r\n        height = this._element.height * scale;\r\n        if (this.alignX === 'Mid') {\r\n          marginX = (this.width - width) / 2;\r\n        }\r\n        if (this.alignX === 'Max') {\r\n          marginX = this.width - width;\r\n        }\r\n        if (this.alignY === 'Mid') {\r\n          marginY = (this.height - height) / 2;\r\n        }\r\n        if (this.alignY === 'Max') {\r\n          marginY = this.height - height;\r\n        }\r\n      }\r\n      return {\r\n        width:  width,\r\n        height: height,\r\n        marginX: marginX,\r\n        marginY: marginY\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _resetWidthHeight: function() {\r\n      var element = this.getElement();\r\n\r\n      this.set('width', element.width);\r\n      this.set('height', element.height);\r\n    },\r\n\r\n    /**\r\n     * The Image class's initialization method. This method is automatically\r\n     * called by the constructor.\r\n     * @private\r\n     * @param {HTMLImageElement|String} element The element representing the image\r\n     */\r\n    _initElement: function(element) {\r\n      this.setElement(fabric.util.getById(element));\r\n      fabric.util.addClass(this.getElement(), fabric.Image.CSS_CANVAS);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} [options] Options object\r\n     */\r\n    _initConfig: function(options) {\r\n      options || (options = { });\r\n      this.setOptions(options);\r\n      this._setWidthHeight(options);\r\n      if (this._element && this.crossOrigin) {\r\n        this._element.crossOrigin = this.crossOrigin;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} object Object with filters property\r\n     * @param {Function} callback Callback to invoke when all fabric.Image.filters instances are created\r\n     */\r\n    _initFilters: function(object, callback) {\r\n      if (object.filters && object.filters.length) {\r\n        fabric.util.enlivenObjects(object.filters, function(enlivenedObjects) {\r\n          callback && callback(enlivenedObjects);\r\n        }, 'fabric.Image.filters');\r\n      }\r\n      else {\r\n        callback && callback();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} [options] Object with width/height properties\r\n     */\r\n    _setWidthHeight: function(options) {\r\n      this.width = 'width' in options\r\n        ? options.width\r\n        : (this.getElement()\r\n            ? this.getElement().width || 0\r\n            : 0);\r\n\r\n      this.height = 'height' in options\r\n        ? options.height\r\n        : (this.getElement()\r\n            ? this.getElement().height || 0\r\n            : 0);\r\n    },\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity of this instance\r\n     */\r\n    complexity: function() {\r\n      return 1;\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Default CSS class name for canvas\r\n   * @static\r\n   * @type String\r\n   * @default\r\n   */\r\n  fabric.Image.CSS_CANVAS = 'canvas-img';\r\n\r\n  /**\r\n   * Alias for getSrc\r\n   * @static\r\n   */\r\n  fabric.Image.prototype.getSvgSrc = fabric.Image.prototype.getSrc;\r\n\r\n  /**\r\n   * Creates an instance of fabric.Image from its object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @param {Function} [callback] Callback to invoke when an image instance is created\r\n   */\r\n  fabric.Image.fromObject = function(object, callback) {\r\n    fabric.util.loadImage(object.src, function(img) {\r\n      fabric.Image.prototype._initFilters.call(object, object, function(filters) {\r\n        object.filters = filters || [ ];\r\n        var instance = new fabric.Image(img, object);\r\n        callback && callback(instance);\r\n      });\r\n    }, null, object.crossOrigin);\r\n  };\r\n\r\n  /**\r\n   * Creates an instance of fabric.Image from an URL string\r\n   * @static\r\n   * @param {String} url URL to create an image from\r\n   * @param {Function} [callback] Callback to invoke when image is created (newly created image is passed as a first argument)\r\n   * @param {Object} [imgOptions] Options object\r\n   */\r\n  fabric.Image.fromURL = function(url, callback, imgOptions) {\r\n    fabric.util.loadImage(url, function(img) {\r\n      callback && callback(new fabric.Image(img, imgOptions));\r\n    }, null, imgOptions && imgOptions.crossOrigin);\r\n  };\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Image.fromElement})\r\n   * @static\r\n   * @see {@link http://www.w3.org/TR/SVG/struct.html#ImageElement}\r\n   */\r\n  fabric.Image.ATTRIBUTE_NAMES =\r\n    fabric.SHARED_ATTRIBUTES.concat('x y width height preserveAspectRatio xlink:href'.split(' '));\r\n\r\n  /**\r\n   * Returns {@link fabric.Image} instance from an SVG element\r\n   * @static\r\n   * @param {SVGElement} element Element to parse\r\n   * @param {Function} callback Callback to execute when fabric.Image object is created\r\n   * @param {Object} [options] Options object\r\n   * @return {fabric.Image} Instance of fabric.Image\r\n   */\r\n  fabric.Image.fromElement = function(element, callback, options) {\r\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Image.ATTRIBUTE_NAMES),\r\n        align = 'xMidYMid', meetOrSlice = 'meet', alignX, alignY, aspectRatioAttrs;\r\n\r\n    if (parsedAttributes.preserveAspectRatio) {\r\n      aspectRatioAttrs = parsedAttributes.preserveAspectRatio.split(' ');\r\n    }\r\n\r\n    if (aspectRatioAttrs && aspectRatioAttrs.length) {\r\n      meetOrSlice = aspectRatioAttrs.pop();\r\n      if (meetOrSlice !== 'meet' && meetOrSlice !== 'slice') {\r\n        align = meetOrSlice;\r\n        meetOrSlice = 'meet';\r\n      }\r\n      else if (aspectRatioAttrs.length) {\r\n        align = aspectRatioAttrs.pop();\r\n      }\r\n    }\r\n    //divide align in alignX and alignY\r\n    alignX = align !== 'none' ? align.slice(1, 4) : 'none';\r\n    alignY = align !== 'none' ? align.slice(5, 8) : 'none';\r\n    parsedAttributes.alignX = alignX;\r\n    parsedAttributes.alignY = alignY;\r\n    parsedAttributes.meetOrSlice = meetOrSlice;\r\n    fabric.Image.fromURL(parsedAttributes['xlink:href'], callback,\r\n      extend((options ? fabric.util.object.clone(options) : { }), parsedAttributes));\r\n  };\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Indicates that instances of this type are async\r\n   * @static\r\n   * @type Boolean\r\n   * @default\r\n   */\r\n  fabric.Image.async = true;\r\n\r\n  /**\r\n   * Indicates compression level used when generating PNG under Node (in applyFilters). Any of 0-9\r\n   * @static\r\n   * @type Number\r\n   * @default\r\n   */\r\n  fabric.Image.pngCompression = 1;\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\nfabric.util.object.extend(fabric.Object.prototype, /** @lends fabric.Object.prototype */ {\r\n\r\n  /**\r\n   * @private\r\n   * @return {Number} angle value\r\n   */\r\n  _getAngleValueForStraighten: function() {\r\n    var angle = this.getAngle() % 360;\r\n    if (angle > 0) {\r\n      return Math.round((angle - 1) / 90) * 90;\r\n    }\r\n    return Math.round(angle / 90) * 90;\r\n  },\r\n\r\n  /**\r\n   * Straightens an object (rotating it from current angle to one of 0, 90, 180, 270, etc. depending on which is closer)\r\n   * @return {fabric.Object} thisArg\r\n   * @chainable\r\n   */\r\n  straighten: function() {\r\n    this.setAngle(this._getAngleValueForStraighten());\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Same as {@link fabric.Object.prototype.straighten} but with animation\r\n   * @param {Object} callbacks Object with callback functions\r\n   * @param {Function} [callbacks.onComplete] Invoked on completion\r\n   * @param {Function} [callbacks.onChange] Invoked on every step of animation\r\n   * @return {fabric.Object} thisArg\r\n   * @chainable\r\n   */\r\n  fxStraighten: function(callbacks) {\r\n    callbacks = callbacks || { };\r\n\r\n    var empty = function() { },\r\n        onComplete = callbacks.onComplete || empty,\r\n        onChange = callbacks.onChange || empty,\r\n        _this = this;\r\n\r\n    fabric.util.animate({\r\n      startValue: this.get('angle'),\r\n      endValue: this._getAngleValueForStraighten(),\r\n      duration: this.FX_DURATION,\r\n      onChange: function(value) {\r\n        _this.setAngle(value);\r\n        onChange();\r\n      },\r\n      onComplete: function() {\r\n        _this.setCoords();\r\n        onComplete();\r\n      },\r\n      onStart: function() {\r\n        _this.set('active', false);\r\n      }\r\n    });\r\n\r\n    return this;\r\n  }\r\n});\r\n\r\nfabric.util.object.extend(fabric.StaticCanvas.prototype, /** @lends fabric.StaticCanvas.prototype */ {\r\n\r\n  /**\r\n   * Straightens object, then rerenders canvas\r\n   * @param {fabric.Object} object Object to straighten\r\n   * @return {fabric.Canvas} thisArg\r\n   * @chainable\r\n   */\r\n  straightenObject: function (object) {\r\n    object.straighten();\r\n    this.renderAll();\r\n    return this;\r\n  },\r\n\r\n  /**\r\n   * Same as {@link fabric.Canvas.prototype.straightenObject}, but animated\r\n   * @param {fabric.Object} object Object to straighten\r\n   * @return {fabric.Canvas} thisArg\r\n   * @chainable\r\n   */\r\n  fxStraightenObject: function (object) {\r\n    object.fxStraighten({\r\n      onChange: this.renderAll.bind(this)\r\n    });\r\n    return this;\r\n  }\r\n});\r\n\r\n\r\n/**\r\n * @namespace fabric.Image.filters\r\n * @memberOf fabric.Image\r\n * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#image_filters}\r\n * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n */\r\nfabric.Image.filters = fabric.Image.filters || { };\r\n\r\n/**\r\n * Root filter class from which all filter classes inherit from\r\n * @class fabric.Image.filters.BaseFilter\r\n * @memberOf fabric.Image.filters\r\n */\r\nfabric.Image.filters.BaseFilter = fabric.util.createClass(/** @lends fabric.Image.filters.BaseFilter.prototype */ {\r\n\r\n  /**\r\n   * Filter type\r\n   * @param {String} type\r\n   * @default\r\n   */\r\n  type: 'BaseFilter',\r\n\r\n  /**\r\n   * Constructor\r\n   * @param {Object} [options] Options object\r\n   */\r\n  initialize: function(options) {\r\n    if (options) {\r\n      this.setOptions(options);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Sets filter's properties from options\r\n   * @param {Object} [options] Options object\r\n   */\r\n  setOptions: function(options) {\r\n    for (var prop in options) {\r\n      this[prop] = options[prop];\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Returns object representation of an instance\r\n   * @return {Object} Object representation of an instance\r\n   */\r\n  toObject: function() {\r\n    return { type: this.type };\r\n  },\r\n\r\n  /**\r\n   * Returns a JSON representation of an instance\r\n   * @return {Object} JSON\r\n   */\r\n  toJSON: function() {\r\n    // delegate, not alias\r\n    return this.toObject();\r\n  }\r\n});\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * Brightness filter class\r\n   * @class fabric.Image.filters.Brightness\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link fabric.Image.filters.Brightness#initialize} for constructor definition\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Brightness({\r\n   *   brightness: 200\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Brightness = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Brightness.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Brightness',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.Brightness.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {Number} [options.brightness=0] Value to brighten the image up (0..255)\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n      this.brightness = options.brightness || 0;\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          brightness = this.brightness;\r\n\r\n      for (var i = 0, len = data.length; i < len; i += 4) {\r\n        data[i] += brightness;\r\n        data[i + 1] += brightness;\r\n        data[i + 2] += brightness;\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        brightness: this.brightness\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Image.filters.Brightness} Instance of fabric.Image.filters.Brightness\r\n   */\r\n  fabric.Image.filters.Brightness.fromObject = function(object) {\r\n    return new fabric.Image.filters.Brightness(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * Adapted from <a href=\"http://www.html5rocks.com/en/tutorials/canvas/imagefilters/\">html5rocks article</a>\r\n   * @class fabric.Image.filters.Convolute\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link fabric.Image.filters.Convolute#initialize} for constructor definition\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example <caption>Sharpen filter</caption>\r\n   * var filter = new fabric.Image.filters.Convolute({\r\n   *   matrix: [ 0, -1,  0,\r\n   *            -1,  5, -1,\r\n   *             0, -1,  0 ]\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   * @example <caption>Blur filter</caption>\r\n   * var filter = new fabric.Image.filters.Convolute({\r\n   *   matrix: [ 1/9, 1/9, 1/9,\r\n   *             1/9, 1/9, 1/9,\r\n   *             1/9, 1/9, 1/9 ]\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   * @example <caption>Emboss filter</caption>\r\n   * var filter = new fabric.Image.filters.Convolute({\r\n   *   matrix: [ 1,   1,  1,\r\n   *             1, 0.7, -1,\r\n   *            -1,  -1, -1 ]\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   * @example <caption>Emboss filter with opaqueness</caption>\r\n   * var filter = new fabric.Image.filters.Convolute({\r\n   *   opaque: true,\r\n   *   matrix: [ 1,   1,  1,\r\n   *             1, 0.7, -1,\r\n   *            -1,  -1, -1 ]\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Convolute = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Convolute.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Convolute',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.Convolute.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {Boolean} [options.opaque=false] Opaque value (true/false)\r\n     * @param {Array} [options.matrix] Filter matrix\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n\r\n      this.opaque = options.opaque;\r\n      this.matrix = options.matrix || [\r\n        0, 0, 0,\r\n        0, 1, 0,\r\n        0, 0, 0\r\n      ];\r\n\r\n      var canvasEl = fabric.util.createCanvasElement();\r\n      this.tmpCtx = canvasEl.getContext('2d');\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _createImageData: function(w, h) {\r\n      return this.tmpCtx.createImageData(w, h);\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n\r\n      var weights = this.matrix,\r\n          context = canvasEl.getContext('2d'),\r\n          pixels = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n\r\n          side = Math.round(Math.sqrt(weights.length)),\r\n          halfSide = Math.floor(side/2),\r\n          src = pixels.data,\r\n          sw = pixels.width,\r\n          sh = pixels.height,\r\n\r\n          // pad output by the convolution matrix\r\n          w = sw,\r\n          h = sh,\r\n          output = this._createImageData(w, h),\r\n\r\n          dst = output.data,\r\n\r\n          // go through the destination image pixels\r\n          alphaFac = this.opaque ? 1 : 0;\r\n\r\n      for (var y = 0; y < h; y++) {\r\n        for (var x = 0; x < w; x++) {\r\n          var sy = y,\r\n              sx = x,\r\n              dstOff = (y * w + x) * 4,\r\n              // calculate the weighed sum of the source image pixels that\r\n              // fall under the convolution matrix\r\n              r = 0, g = 0, b = 0, a = 0;\r\n\r\n          for (var cy = 0; cy < side; cy++) {\r\n            for (var cx = 0; cx < side; cx++) {\r\n\r\n              var scy = sy + cy - halfSide,\r\n                  scx = sx + cx - halfSide;\r\n\r\n              /* jshint maxdepth:5 */\r\n              if (scy < 0 || scy > sh || scx < 0 || scx > sw) {\r\n                continue;\r\n              }\r\n\r\n              var srcOff = (scy * sw + scx) * 4,\r\n                  wt = weights[cy * side + cx];\r\n\r\n              r += src[srcOff] * wt;\r\n              g += src[srcOff + 1] * wt;\r\n              b += src[srcOff + 2] * wt;\r\n              a += src[srcOff + 3] * wt;\r\n            }\r\n          }\r\n          dst[dstOff] = r;\r\n          dst[dstOff + 1] = g;\r\n          dst[dstOff + 2] = b;\r\n          dst[dstOff + 3] = a + alphaFac * (255 - a);\r\n        }\r\n      }\r\n\r\n      context.putImageData(output, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        opaque: this.opaque,\r\n        matrix: this.matrix\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Image.filters.Convolute} Instance of fabric.Image.filters.Convolute\r\n   */\r\n  fabric.Image.filters.Convolute.fromObject = function(object) {\r\n    return new fabric.Image.filters.Convolute(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * GradientTransparency filter class\r\n   * @class fabric.Image.filters.GradientTransparency\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link fabric.Image.filters.GradientTransparency#initialize} for constructor definition\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.GradientTransparency({\r\n   *   threshold: 200\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.GradientTransparency = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.GradientTransparency.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'GradientTransparency',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.GradientTransparency.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {Number} [options.threshold=100] Threshold value\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n      this.threshold = options.threshold || 100;\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          threshold = this.threshold,\r\n          total = data.length;\r\n\r\n      for (var i = 0, len = data.length; i < len; i += 4) {\r\n        data[i + 3] = threshold + 255 * (total - i) / total;\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        threshold: this.threshold\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Image.filters.GradientTransparency} Instance of fabric.Image.filters.GradientTransparency\r\n   */\r\n  fabric.Image.filters.GradientTransparency.fromObject = function(object) {\r\n    return new fabric.Image.filters.GradientTransparency(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { });\r\n\r\n  /**\r\n   * Grayscale image filter class\r\n   * @class fabric.Image.filters.Grayscale\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Grayscale();\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Grayscale = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Grayscale.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Grayscale',\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @memberOf fabric.Image.filters.Grayscale.prototype\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          len = imageData.width * imageData.height * 4,\r\n          index = 0,\r\n          average;\r\n\r\n      while (index < len) {\r\n        average = (data[index] + data[index + 1] + data[index + 2]) / 3;\r\n        data[index]     = average;\r\n        data[index + 1] = average;\r\n        data[index + 2] = average;\r\n        index += 4;\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @return {fabric.Image.filters.Grayscale} Instance of fabric.Image.filters.Grayscale\r\n   */\r\n  fabric.Image.filters.Grayscale.fromObject = function() {\r\n    return new fabric.Image.filters.Grayscale();\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { });\r\n\r\n  /**\r\n   * Invert filter class\r\n   * @class fabric.Image.filters.Invert\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Invert();\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Invert = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Invert.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Invert',\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @memberOf fabric.Image.filters.Invert.prototype\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          iLen = data.length, i;\r\n\r\n      for (i = 0; i < iLen; i+=4) {\r\n        data[i] = 255 - data[i];\r\n        data[i + 1] = 255 - data[i + 1];\r\n        data[i + 2] = 255 - data[i + 2];\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @return {fabric.Image.filters.Invert} Instance of fabric.Image.filters.Invert\r\n   */\r\n  fabric.Image.filters.Invert.fromObject = function() {\r\n    return new fabric.Image.filters.Invert();\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * Mask filter class\r\n   * See http://resources.aleph-1.com/mask/\r\n   * @class fabric.Image.filters.Mask\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link fabric.Image.filters.Mask#initialize} for constructor definition\r\n   */\r\n  fabric.Image.filters.Mask = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Mask.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Mask',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.Mask.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {fabric.Image} [options.mask] Mask image object\r\n     * @param {Number} [options.channel=0] Rgb channel (0, 1, 2 or 3)\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n\r\n      this.mask = options.mask;\r\n      this.channel = [ 0, 1, 2, 3 ].indexOf(options.channel) > -1 ? options.channel : 0;\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      if (!this.mask) {\r\n        return;\r\n      }\r\n\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          maskEl = this.mask.getElement(),\r\n          maskCanvasEl = fabric.util.createCanvasElement(),\r\n          channel = this.channel,\r\n          i,\r\n          iLen = imageData.width * imageData.height * 4;\r\n\r\n      maskCanvasEl.width = maskEl.width;\r\n      maskCanvasEl.height = maskEl.height;\r\n\r\n      maskCanvasEl.getContext('2d').drawImage(maskEl, 0, 0, maskEl.width, maskEl.height);\r\n\r\n      var maskImageData = maskCanvasEl.getContext('2d').getImageData(0, 0, maskEl.width, maskEl.height),\r\n          maskData = maskImageData.data;\r\n\r\n      for (i = 0; i < iLen; i += 4) {\r\n        data[i + 3] = maskData[i + channel];\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        mask: this.mask.toObject(),\r\n        channel: this.channel\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @param {Function} [callback] Callback to invoke when a mask filter instance is created\r\n   */\r\n  fabric.Image.filters.Mask.fromObject = function(object, callback) {\r\n    fabric.util.loadImage(object.mask.src, function(img) {\r\n      object.mask = new fabric.Image(img, object.mask);\r\n      callback && callback(new fabric.Image.filters.Mask(object));\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Indicates that instances of this type are async\r\n   * @static\r\n   * @type Boolean\r\n   * @default\r\n   */\r\n  fabric.Image.filters.Mask.async = true;\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * Noise filter class\r\n   * @class fabric.Image.filters.Noise\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link fabric.Image.filters.Noise#initialize} for constructor definition\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Noise({\r\n   *   noise: 700\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Noise = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Noise.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Noise',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.Noise.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {Number} [options.noise=0] Noise value\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n      this.noise = options.noise || 0;\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          noise = this.noise, rand;\r\n\r\n      for (var i = 0, len = data.length; i < len; i += 4) {\r\n\r\n        rand = (0.5 - Math.random()) * noise;\r\n\r\n        data[i] += rand;\r\n        data[i + 1] += rand;\r\n        data[i + 2] += rand;\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        noise: this.noise\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Image.filters.Noise} Instance of fabric.Image.filters.Noise\r\n   */\r\n  fabric.Image.filters.Noise.fromObject = function(object) {\r\n    return new fabric.Image.filters.Noise(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * Pixelate filter class\r\n   * @class fabric.Image.filters.Pixelate\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link fabric.Image.filters.Pixelate#initialize} for constructor definition\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Pixelate({\r\n   *   blocksize: 8\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Pixelate = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Pixelate.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Pixelate',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.Pixelate.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {Number} [options.blocksize=4] Blocksize for pixelate\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n      this.blocksize = options.blocksize || 4;\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          iLen = imageData.height,\r\n          jLen = imageData.width,\r\n          index, i, j, r, g, b, a;\r\n\r\n      for (i = 0; i < iLen; i += this.blocksize) {\r\n        for (j = 0; j < jLen; j += this.blocksize) {\r\n\r\n          index = (i * 4) * jLen + (j * 4);\r\n\r\n          r = data[index];\r\n          g = data[index + 1];\r\n          b = data[index + 2];\r\n          a = data[index + 3];\r\n\r\n          /*\r\n           blocksize: 4\r\n\r\n           [1,x,x,x,1]\r\n           [x,x,x,x,1]\r\n           [x,x,x,x,1]\r\n           [x,x,x,x,1]\r\n           [1,1,1,1,1]\r\n           */\r\n\r\n          for (var _i = i, _ilen = i + this.blocksize; _i < _ilen; _i++) {\r\n            for (var _j = j, _jlen = j + this.blocksize; _j < _jlen; _j++) {\r\n              index = (_i * 4) * jLen + (_j * 4);\r\n              data[index] = r;\r\n              data[index + 1] = g;\r\n              data[index + 2] = b;\r\n              data[index + 3] = a;\r\n            }\r\n          }\r\n        }\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        blocksize: this.blocksize\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Image.filters.Pixelate} Instance of fabric.Image.filters.Pixelate\r\n   */\r\n  fabric.Image.filters.Pixelate.fromObject = function(object) {\r\n    return new fabric.Image.filters.Pixelate(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * Remove white filter class\r\n   * @class fabric.Image.filters.RemoveWhite\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link fabric.Image.filters.RemoveWhite#initialize} for constructor definition\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.RemoveWhite({\r\n   *   threshold: 40,\r\n   *   distance: 140\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.RemoveWhite = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.RemoveWhite.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'RemoveWhite',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.RemoveWhite.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {Number} [options.threshold=30] Threshold value\r\n     * @param {Number} [options.distance=20] Distance value\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n      this.threshold = options.threshold || 30;\r\n      this.distance = options.distance || 20;\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          threshold = this.threshold,\r\n          distance = this.distance,\r\n          limit = 255 - threshold,\r\n          abs = Math.abs,\r\n          r, g, b;\r\n\r\n      for (var i = 0, len = data.length; i < len; i += 4) {\r\n        r = data[i];\r\n        g = data[i + 1];\r\n        b = data[i + 2];\r\n\r\n        if (r > limit &&\r\n            g > limit &&\r\n            b > limit &&\r\n            abs(r - g) < distance &&\r\n            abs(r - b) < distance &&\r\n            abs(g - b) < distance\r\n        ) {\r\n          data[i + 3] = 1;\r\n        }\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        threshold: this.threshold,\r\n        distance: this.distance\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Image.filters.RemoveWhite} Instance of fabric.Image.filters.RemoveWhite\r\n   */\r\n  fabric.Image.filters.RemoveWhite.fromObject = function(object) {\r\n    return new fabric.Image.filters.RemoveWhite(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { });\r\n\r\n  /**\r\n   * Sepia filter class\r\n   * @class fabric.Image.filters.Sepia\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Sepia();\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Sepia = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Sepia.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Sepia',\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @memberOf fabric.Image.filters.Sepia.prototype\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          iLen = data.length, i, avg;\r\n\r\n      for (i = 0; i < iLen; i+=4) {\r\n        avg = 0.3  * data[i] + 0.59 * data[i + 1] + 0.11 * data[i + 2];\r\n        data[i] = avg + 100;\r\n        data[i + 1] = avg + 50;\r\n        data[i + 2] = avg + 255;\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @return {fabric.Image.filters.Sepia} Instance of fabric.Image.filters.Sepia\r\n   */\r\n  fabric.Image.filters.Sepia.fromObject = function() {\r\n    return new fabric.Image.filters.Sepia();\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { });\r\n\r\n  /**\r\n   * Sepia2 filter class\r\n   * @class fabric.Image.filters.Sepia2\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Sepia2();\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Sepia2 = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Sepia2.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Sepia2',\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @memberOf fabric.Image.filters.Sepia.prototype\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          iLen = data.length, i, r, g, b;\r\n\r\n      for (i = 0; i < iLen; i+=4) {\r\n        r = data[i];\r\n        g = data[i + 1];\r\n        b = data[i + 2];\r\n\r\n        data[i] = (r * 0.393 + g * 0.769 + b * 0.189 ) / 1.351;\r\n        data[i + 1] = (r * 0.349 + g * 0.686 + b * 0.168 ) / 1.203;\r\n        data[i + 2] = (r * 0.272 + g * 0.534 + b * 0.131 ) / 2.140;\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @return {fabric.Image.filters.Sepia2} Instance of fabric.Image.filters.Sepia2\r\n   */\r\n  fabric.Image.filters.Sepia2.fromObject = function() {\r\n    return new fabric.Image.filters.Sepia2();\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * Tint filter class\r\n   * Adapted from <a href=\"https://github.com/mezzoblue/PaintbrushJS\">https://github.com/mezzoblue/PaintbrushJS</a>\r\n   * @class fabric.Image.filters.Tint\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link fabric.Image.filters.Tint#initialize} for constructor definition\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example <caption>Tint filter with hex color and opacity</caption>\r\n   * var filter = new fabric.Image.filters.Tint({\r\n   *   color: '#3513B0',\r\n   *   opacity: 0.5\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   * @example <caption>Tint filter with rgba color</caption>\r\n   * var filter = new fabric.Image.filters.Tint({\r\n   *   color: 'rgba(53, 21, 176, 0.5)'\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Tint = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Tint.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Tint',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.Tint.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {String} [options.color=#000000] Color to tint the image with\r\n     * @param {Number} [options.opacity] Opacity value that controls the tint effect's transparency (0..1)\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n\r\n      this.color = options.color || '#000000';\r\n      this.opacity = typeof options.opacity !== 'undefined'\r\n                      ? options.opacity\r\n                      : new fabric.Color(this.color).getAlpha();\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          iLen = data.length, i,\r\n          tintR, tintG, tintB,\r\n          r, g, b, alpha1,\r\n          source;\r\n\r\n      source = new fabric.Color(this.color).getSource();\r\n\r\n      tintR = source[0] * this.opacity;\r\n      tintG = source[1] * this.opacity;\r\n      tintB = source[2] * this.opacity;\r\n\r\n      alpha1 = 1 - this.opacity;\r\n\r\n      for (i = 0; i < iLen; i+=4) {\r\n        r = data[i];\r\n        g = data[i + 1];\r\n        b = data[i + 2];\r\n\r\n        // alpha compositing\r\n        data[i] = tintR + r * alpha1;\r\n        data[i + 1] = tintG + g * alpha1;\r\n        data[i + 2] = tintB + b * alpha1;\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        color: this.color,\r\n        opacity: this.opacity\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Image.filters.Tint} Instance of fabric.Image.filters.Tint\r\n   */\r\n  fabric.Image.filters.Tint.fromObject = function(object) {\r\n    return new fabric.Image.filters.Tint(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend;\r\n\r\n  /**\r\n   * Multiply filter class\r\n   * Adapted from <a href=\"http://www.laurenscorijn.com/articles/colormath-basics\">http://www.laurenscorijn.com/articles/colormath-basics</a>\r\n   * @class fabric.Image.filters.Multiply\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @example <caption>Multiply filter with hex color</caption>\r\n   * var filter = new fabric.Image.filters.Multiply({\r\n   *   color: '#F0F'\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   * @example <caption>Multiply filter with rgb color</caption>\r\n   * var filter = new fabric.Image.filters.Multiply({\r\n   *   color: 'rgb(53, 21, 176)'\r\n   * });\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Multiply = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Multiply.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Multiply',\r\n\r\n    /**\r\n     * Constructor\r\n     * @memberOf fabric.Image.filters.Multiply.prototype\r\n     * @param {Object} [options] Options object\r\n     * @param {String} [options.color=#000000] Color to multiply the image pixels with\r\n     */\r\n    initialize: function(options) {\r\n      options = options || { };\r\n\r\n      this.color = options.color || '#000000';\r\n    },\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          iLen = data.length, i,\r\n          source;\r\n\r\n      source = new fabric.Color(this.color).getSource();\r\n\r\n      for (i = 0; i < iLen; i+=4) {\r\n        data[i] *= source[0] / 255;\r\n        data[i + 1] *= source[1] / 255;\r\n        data[i + 2] *= source[2] / 255;\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return extend(this.callSuper('toObject'), {\r\n        color: this.color\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Image.filters.Multiply} Instance of fabric.Image.filters.Multiply\r\n   */\r\n  fabric.Image.filters.Multiply.fromObject = function(object) {\r\n    return new fabric.Image.filters.Multiply(object);\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n  'use strict';\r\n\r\n  var fabric = global.fabric;\r\n\r\n  /**\r\n   * Color Blend filter class\r\n   * @class fabric.Image.filter.Blend\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Blend({\r\n   *  color: '#000',\r\n   *  mode: 'multiply'\r\n   * });\r\n   *\r\n   * var filter = new fabric.Image.filters.Blend({\r\n   *  image: fabricImageObject,\r\n   *  mode: 'multiply',\r\n   *  alpha: 0.5\r\n   * });\r\n\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Blend = fabric.util.createClass({\r\n    type: 'Blend',\r\n\r\n    initialize: function(options) {\r\n      options = options || {};\r\n      this.color = options.color || '#000';\r\n      this.image = options.image || false;\r\n      this.mode = options.mode || 'multiply';\r\n      this.alpha = options.alpha || 1;\r\n    },\r\n\r\n    applyTo: function(canvasEl) {\r\n      var context = canvasEl.getContext('2d'),\r\n          imageData = context.getImageData(0, 0, canvasEl.width, canvasEl.height),\r\n          data = imageData.data,\r\n          tr, tg, tb,\r\n          r, g, b,\r\n          _r, _g, _b,\r\n          source,\r\n          isImage = false;\r\n\r\n      if (this.image) {\r\n        // Blend images\r\n        isImage = true;\r\n\r\n        var _el = fabric.util.createCanvasElement();\r\n        _el.width = this.image.width;\r\n        _el.height = this.image.height;\r\n\r\n        var tmpCanvas = new fabric.StaticCanvas(_el);\r\n        tmpCanvas.add(this.image);\r\n        var context2 =  tmpCanvas.getContext('2d');\r\n        source = context2.getImageData(0, 0, tmpCanvas.width, tmpCanvas.height).data;\r\n      }\r\n      else {\r\n        // Blend color\r\n        source = new fabric.Color(this.color).getSource();\r\n\r\n        tr = source[0] * this.alpha;\r\n        tg = source[1] * this.alpha;\r\n        tb = source[2] * this.alpha;\r\n      }\r\n\r\n      for (var i = 0, len = data.length; i < len; i += 4) {\r\n\r\n        r = data[i];\r\n        g = data[i + 1];\r\n        b = data[i + 2];\r\n\r\n        if (isImage) {\r\n          tr = source[i] * this.alpha;\r\n          tg = source[i + 1] * this.alpha;\r\n          tb = source[i + 2] * this.alpha;\r\n        }\r\n\r\n        switch (this.mode) {\r\n          case 'multiply':\r\n            data[i] = r * tr / 255;\r\n            data[i + 1] = g * tg / 255;\r\n            data[i + 2] = b * tb / 255;\r\n            break;\r\n          case 'screen':\r\n            data[i] = 1 - (1 - r) * (1 - tr);\r\n            data[i + 1] = 1 - (1 - g) * (1 - tg);\r\n            data[i + 2] = 1 - (1 - b) * (1 - tb);\r\n            break;\r\n          case 'add':\r\n            data[i] = Math.min(255, r + tr);\r\n            data[i + 1] = Math.min(255, g + tg);\r\n            data[i + 2] = Math.min(255, b + tb);\r\n            break;\r\n          case 'diff':\r\n          case 'difference':\r\n            data[i] = Math.abs(r - tr);\r\n            data[i + 1] = Math.abs(g - tg);\r\n            data[i + 2] = Math.abs(b - tb);\r\n            break;\r\n          case 'subtract':\r\n            _r = r - tr;\r\n            _g = g - tg;\r\n            _b = b - tb;\r\n\r\n            data[i] = (_r < 0) ? 0 : _r;\r\n            data[i + 1] = (_g < 0) ? 0 : _g;\r\n            data[i + 2] = (_b < 0) ? 0 : _b;\r\n            break;\r\n          case 'darken':\r\n            data[i] = Math.min(r, tr);\r\n            data[i + 1] = Math.min(g, tg);\r\n            data[i + 2] = Math.min(b, tb);\r\n            break;\r\n          case 'lighten':\r\n            data[i] = Math.max(r, tr);\r\n            data[i + 1] = Math.max(g, tg);\r\n            data[i + 2] = Math.max(b, tb);\r\n            break;\r\n        }\r\n      }\r\n\r\n      context.putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return {\r\n        color: this.color,\r\n        image: this.image,\r\n        mode: this.mode,\r\n        alpha: this.alpha\r\n      };\r\n    }\r\n  });\r\n\r\n  fabric.Image.filters.Blend.fromObject = function(object) {\r\n    return new fabric.Image.filters.Blend(object);\r\n  };\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric  = global.fabric || (global.fabric = { }), pow = Math.pow, floor = Math.floor,\r\n      sqrt = Math.sqrt, abs = Math.abs, max = Math.max, round = Math.round, sin = Math.sin,\r\n      ceil = Math.ceil;\r\n\r\n  /**\r\n   * Resize image filter class\r\n   * @class fabric.Image.filters.Resize\r\n   * @memberOf fabric.Image.filters\r\n   * @extends fabric.Image.filters.BaseFilter\r\n   * @see {@link http://fabricjs.com/image-filters/|ImageFilters demo}\r\n   * @example\r\n   * var filter = new fabric.Image.filters.Resize();\r\n   * object.filters.push(filter);\r\n   * object.applyFilters(canvas.renderAll.bind(canvas));\r\n   */\r\n  fabric.Image.filters.Resize = fabric.util.createClass(fabric.Image.filters.BaseFilter, /** @lends fabric.Image.filters.Resize.prototype */ {\r\n\r\n    /**\r\n     * Filter type\r\n     * @param {String} type\r\n     * @default\r\n     */\r\n    type: 'Resize',\r\n\r\n    /**\r\n     * Resize type\r\n     * @param {String} resizeType\r\n     * @default\r\n     */\r\n    resizeType: 'hermite',\r\n\r\n    /**\r\n     * Scale factor for resizing, x axis\r\n     * @param {Number} scaleX\r\n     * @default\r\n     */\r\n    scaleX: 0,\r\n\r\n    /**\r\n     * Scale factor for resizing, y axis\r\n     * @param {Number} scaleY\r\n     * @default\r\n     */\r\n    scaleY: 0,\r\n\r\n    /**\r\n     * LanczosLobes parameter for lanczos filter\r\n     * @param {Number} lanczosLobes\r\n     * @default\r\n     */\r\n    lanczosLobes: 3,\r\n\r\n    /**\r\n     * Applies filter to canvas element\r\n     * @memberOf fabric.Image.filters.Resize.prototype\r\n     * @param {Object} canvasEl Canvas element to apply filter to\r\n     */\r\n    applyTo: function(canvasEl, scaleX, scaleY) {\r\n\r\n      this.rcpScaleX = 1 / scaleX;\r\n      this.rcpScaleY = 1 / scaleY;\r\n\r\n      var oW = canvasEl.width, oH = canvasEl.height,\r\n          dW = round(oW * scaleX), dH = round(oH * scaleY),\r\n          imageData;\r\n\r\n      if (this.resizeType === 'sliceHack') {\r\n        imageData = this.sliceByTwo(canvasEl, oW, oH, dW, dH);\r\n      }\r\n      if (this.resizeType === 'hermite') {\r\n        imageData = this.hermiteFastResize(canvasEl, oW, oH, dW, dH);\r\n      }\r\n      if (this.resizeType === 'bilinear') {\r\n        imageData = this.bilinearFiltering(canvasEl, oW, oH, dW, dH);\r\n      }\r\n      if (this.resizeType === 'lanczos') {\r\n        imageData = this.lanczosResize(canvasEl, oW, oH, dW, dH);\r\n      }\r\n      canvasEl.width = dW;\r\n      canvasEl.height = dH;\r\n      canvasEl.getContext('2d').putImageData(imageData, 0, 0);\r\n    },\r\n\r\n    sliceByTwo: function(canvasEl, width, height, newWidth, newHeight) {\r\n      var context = canvasEl.getContext('2d'), imageData,\r\n          multW = 0.5, multH = 0.5, signW = 1, signH = 1,\r\n          doneW = false, doneH = false, stepW = width, stepH = height,\r\n          tmpCanvas = fabric.util.createCanvasElement(),\r\n          tmpCtx = tmpCanvas.getContext('2d');\r\n      newWidth = floor(newWidth);\r\n      newHeight = floor(newHeight);\r\n      tmpCanvas.width = max(newWidth, width);\r\n      tmpCanvas.height = max(newHeight, height);\r\n\r\n      if (newWidth > width) {\r\n        multW = 2;\r\n        signW = -1;\r\n      }\r\n      if (newHeight > height) {\r\n        multH = 2;\r\n        signH = -1;\r\n      }\r\n      imageData = context.getImageData(0, 0, width, height);\r\n      canvasEl.width = max(newWidth, width);\r\n      canvasEl.height = max(newHeight, height);\r\n      context.putImageData(imageData, 0, 0);\r\n\r\n      while (!doneW || !doneH) {\r\n        width = stepW;\r\n        height = stepH;\r\n        if (newWidth * signW < floor(stepW * multW * signW)) {\r\n          stepW = floor(stepW * multW);\r\n        }\r\n        else {\r\n          stepW = newWidth;\r\n          doneW = true;\r\n        }\r\n        if (newHeight * signH < floor(stepH * multH * signH)) {\r\n          stepH = floor(stepH * multH);\r\n        }\r\n        else {\r\n          stepH = newHeight;\r\n          doneH = true;\r\n        }\r\n        imageData = context.getImageData(0, 0, width, height);\r\n        tmpCtx.putImageData(imageData, 0, 0);\r\n        context.clearRect(0, 0, stepW, stepH);\r\n        context.drawImage(tmpCanvas, 0, 0, width, height, 0, 0, stepW, stepH);\r\n      }\r\n      return context.getImageData(0, 0, newWidth, newHeight);\r\n    },\r\n\r\n    lanczosResize: function(canvasEl, oW, oH, dW, dH) {\r\n\r\n      function lanczosCreate(lobes) {\r\n        return function(x) {\r\n          if (x > lobes) {\r\n            return 0;\r\n          }\r\n          x *= Math.PI;\r\n          if (abs(x) < 1e-16) {\r\n            return 1;\r\n          }\r\n          var xx = x / lobes;\r\n          return sin(x) * sin(xx) / x / xx;\r\n        };\r\n      }\r\n\r\n      function process(u) {\r\n        var v, i, weight, idx, a, red, green,\r\n            blue, alpha, fX, fY;\r\n        center.x = (u + 0.5) * ratioX;\r\n        icenter.x = floor(center.x);\r\n        for (v = 0; v < dH; v++) {\r\n          center.y = (v + 0.5) * ratioY;\r\n          icenter.y = floor(center.y);\r\n          a = 0, red = 0, green = 0, blue = 0, alpha = 0;\r\n          for (i = icenter.x - range2X; i <= icenter.x + range2X; i++) {\r\n            if (i < 0 || i >= oW) {\r\n              continue;\r\n            }\r\n            fX = floor(1000 * abs(i - center.x));\r\n            if (!cacheLanc[fX]) {\r\n              cacheLanc[fX] = { };\r\n            }\r\n            for (var j = icenter.y - range2Y; j <= icenter.y + range2Y; j++) {\r\n              if (j < 0 || j >= oH) {\r\n                continue;\r\n              }\r\n              fY = floor(1000 * abs(j - center.y));\r\n              if (!cacheLanc[fX][fY]) {\r\n                cacheLanc[fX][fY] = lanczos(sqrt(pow(fX * rcpRatioX, 2) + pow(fY * rcpRatioY, 2)) / 1000);\r\n              }\r\n              weight = cacheLanc[fX][fY];\r\n              if (weight > 0) {\r\n                idx = (j * oW + i) * 4;\r\n                a += weight;\r\n                red += weight * srcData[idx];\r\n                green += weight * srcData[idx + 1];\r\n                blue += weight * srcData[idx + 2];\r\n                alpha += weight * srcData[idx + 3];\r\n              }\r\n            }\r\n          }\r\n          idx = (v * dW + u) * 4;\r\n          destData[idx] = red / a;\r\n          destData[idx + 1] = green / a;\r\n          destData[idx + 2] = blue / a;\r\n          destData[idx + 3] = alpha / a;\r\n        }\r\n\r\n        if (++u < dW) {\r\n          return process(u);\r\n        }\r\n        else {\r\n          return destImg;\r\n        }\r\n      }\r\n\r\n      var context = canvasEl.getContext('2d'),\r\n          srcImg = context.getImageData(0, 0, oW, oH),\r\n          destImg = context.getImageData(0, 0, dW, dH),\r\n          srcData = srcImg.data, destData = destImg.data,\r\n          lanczos = lanczosCreate(this.lanczosLobes),\r\n          ratioX = this.rcpScaleX, ratioY = this.rcpScaleY,\r\n          rcpRatioX = 2 / this.rcpScaleX, rcpRatioY = 2 / this.rcpScaleY,\r\n          range2X = ceil(ratioX * this.lanczosLobes / 2),\r\n          range2Y = ceil(ratioY * this.lanczosLobes / 2),\r\n          cacheLanc = { }, center = { }, icenter = { };\r\n\r\n      return process(0);\r\n    },\r\n\r\n    bilinearFiltering: function(canvasEl, w, h, w2, h2) {\r\n      var a, b, c, d, x, y, i, j, xDiff, yDiff, chnl,\r\n          color, offset = 0, origPix, ratioX = this.rcpScaleX,\r\n          ratioY = this.rcpScaleY, context = canvasEl.getContext('2d'),\r\n          w4 = 4 * (w - 1), img = context.getImageData(0, 0, w, h),\r\n          pixels = img.data, destImage = context.getImageData(0, 0, w2, h2),\r\n          destPixels = destImage.data;\r\n      for (i = 0; i < h2; i++) {\r\n        for (j = 0; j < w2; j++) {\r\n          x = floor(ratioX * j);\r\n          y = floor(ratioY * i);\r\n          xDiff = ratioX * j - x;\r\n          yDiff = ratioY * i - y;\r\n          origPix = 4 * (y * w + x);\r\n\r\n          for (chnl = 0; chnl < 4; chnl++) {\r\n            a = pixels[origPix + chnl];\r\n            b = pixels[origPix + 4 + chnl];\r\n            c = pixels[origPix + w4 + chnl];\r\n            d = pixels[origPix + w4 + 4 + chnl];\r\n            color = a * (1 - xDiff) * (1 - yDiff) + b * xDiff * (1 - yDiff) +\r\n                    c * yDiff * (1 - xDiff) + d * xDiff * yDiff;\r\n            destPixels[offset++] = color;\r\n          }\r\n        }\r\n      }\r\n      return destImage;\r\n    },\r\n\r\n    hermiteFastResize: function(canvasEl, oW, oH, dW, dH) {\r\n      var ratioW = this.rcpScaleX, ratioH = this.rcpScaleY,\r\n          ratioWHalf = ceil(ratioW / 2),\r\n          ratioHHalf = ceil(ratioH / 2),\r\n          context = canvasEl.getContext('2d'),\r\n          img = context.getImageData(0, 0, oW, oH), data = img.data,\r\n          img2 = context.getImageData(0, 0, dW, dH), data2 = img2.data;\r\n      for (var j = 0; j < dH; j++) {\r\n        for (var i = 0; i < dW; i++) {\r\n          var x2 = (i + j * dW) * 4, weight = 0, weights = 0, weightsAlpha = 0,\r\n              gxR = 0, gxG = 0, gxB = 0, gxA = 0, centerY = (j + 0.5) * ratioH;\r\n          for (var yy = floor(j * ratioH); yy < (j + 1) * ratioH; yy++) {\r\n            var dy = abs(centerY - (yy + 0.5)) / ratioHHalf,\r\n                centerX = (i + 0.5) * ratioW, w0 = dy * dy;\r\n            for (var xx = floor(i * ratioW); xx < (i + 1) * ratioW; xx++) {\r\n              var dx = abs(centerX - (xx + 0.5)) / ratioWHalf,\r\n                  w = sqrt(w0 + dx * dx);\r\n              /*jshint maxdepth:5 */\r\n              if (w > 1 && w < -1) {\r\n                continue;\r\n              }\r\n              //hermite filter\r\n              weight = 2 * w * w * w - 3 * w * w + 1;\r\n              if (weight > 0) {\r\n                dx = 4 * (xx + yy * oW);\r\n                //alpha\r\n                gxA += weight * data[dx + 3];\r\n                weightsAlpha += weight;\r\n                //colors\r\n                /*jshint maxdepth:6 */\r\n                if (data[dx + 3] < 255) {\r\n                  weight = weight * data[dx + 3] / 250;\r\n                }\r\n                /*jshint maxdepth:5 */\r\n                gxR += weight * data[dx];\r\n                gxG += weight * data[dx + 1];\r\n                gxB += weight * data[dx + 2];\r\n                weights += weight;\r\n              }\r\n              /*jshint maxdepth:4 */\r\n            }\r\n          }\r\n          data2[x2] = gxR / weights;\r\n          data2[x2 + 1] = gxG / weights;\r\n          data2[x2 + 2] = gxB / weights;\r\n          data2[x2 + 3] = gxA / weightsAlpha;\r\n        }\r\n      }\r\n      return img2;\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function() {\r\n      return {\r\n        type: this.type,\r\n        scaleX: this.scaleX,\r\n        scaley: this.scaleY,\r\n        resizeType: this.resizeType,\r\n        lanczosLobes: this.lanczosLobes\r\n      };\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns filter instance from an object representation\r\n   * @static\r\n   * @return {fabric.Image.filters.Resize} Instance of fabric.Image.filters.Resize\r\n   */\r\n  fabric.Image.filters.Resize.fromObject = function() {\r\n    return new fabric.Image.filters.Resize();\r\n  };\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function(global) {\r\n\r\n  'use strict';\r\n\r\n  var fabric = global.fabric || (global.fabric = { }),\r\n      extend = fabric.util.object.extend,\r\n      clone = fabric.util.object.clone,\r\n      toFixed = fabric.util.toFixed,\r\n      supportsLineDash = fabric.StaticCanvas.supports('setLineDash');\r\n\r\n  if (fabric.Text) {\r\n    fabric.warn('fabric.Text is already defined');\r\n    return;\r\n  }\r\n\r\n  var stateProperties = fabric.Object.prototype.stateProperties.concat();\r\n  stateProperties.push(\r\n    'fontFamily',\r\n    'fontWeight',\r\n    'fontSize',\r\n    'text',\r\n    'textDecoration',\r\n    'textAlign',\r\n    'fontStyle',\r\n    'lineHeight',\r\n    'textBackgroundColor'\r\n  );\r\n\r\n  /**\r\n   * Text class\r\n   * @class fabric.Text\r\n   * @extends fabric.Object\r\n   * @return {fabric.Text} thisArg\r\n   * @tutorial {@link http://fabricjs.com/fabric-intro-part-2/#text}\r\n   * @see {@link fabric.Text#initialize} for constructor definition\r\n   */\r\n  fabric.Text = fabric.util.createClass(fabric.Object, /** @lends fabric.Text.prototype */ {\r\n\r\n    /**\r\n     * Properties which when set cause object to change dimensions\r\n     * @type Object\r\n     * @private\r\n     */\r\n    _dimensionAffectingProps: {\r\n      fontSize: true,\r\n      fontWeight: true,\r\n      fontFamily: true,\r\n      fontStyle: true,\r\n      lineHeight: true,\r\n      stroke: true,\r\n      strokeWidth: true,\r\n      text: true,\r\n      textAlign: true\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _reNewline: /\\r?\\n/,\r\n\r\n    /**\r\n     * Retrieves object's fontSize\r\n     * @method getFontSize\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {String} Font size (in pixels)\r\n     */\r\n\r\n    /**\r\n     * Sets object's fontSize\r\n     * @method setFontSize\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {Number} fontSize Font size (in pixels)\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's fontWeight\r\n     * @method getFontWeight\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {(String|Number)} Font weight\r\n     */\r\n\r\n    /**\r\n     * Sets object's fontWeight\r\n     * @method setFontWeight\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {(Number|String)} fontWeight Font weight\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's fontFamily\r\n     * @method getFontFamily\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {String} Font family\r\n     */\r\n\r\n    /**\r\n     * Sets object's fontFamily\r\n     * @method setFontFamily\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {String} fontFamily Font family\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's text\r\n     * @method getText\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {String} text\r\n     */\r\n\r\n    /**\r\n     * Sets object's text\r\n     * @method setText\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {String} text Text\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's textDecoration\r\n     * @method getTextDecoration\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {String} Text decoration\r\n     */\r\n\r\n    /**\r\n     * Sets object's textDecoration\r\n     * @method setTextDecoration\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {String} textDecoration Text decoration\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's fontStyle\r\n     * @method getFontStyle\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {String} Font style\r\n     */\r\n\r\n    /**\r\n     * Sets object's fontStyle\r\n     * @method setFontStyle\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {String} fontStyle Font style\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's lineHeight\r\n     * @method getLineHeight\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {Number} Line height\r\n     */\r\n\r\n    /**\r\n     * Sets object's lineHeight\r\n     * @method setLineHeight\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {Number} lineHeight Line height\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's textAlign\r\n     * @method getTextAlign\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {String} Text alignment\r\n     */\r\n\r\n    /**\r\n     * Sets object's textAlign\r\n     * @method setTextAlign\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {String} textAlign Text alignment\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Retrieves object's textBackgroundColor\r\n     * @method getTextBackgroundColor\r\n     * @memberOf fabric.Text.prototype\r\n     * @return {String} Text background color\r\n     */\r\n\r\n    /**\r\n     * Sets object's textBackgroundColor\r\n     * @method setTextBackgroundColor\r\n     * @memberOf fabric.Text.prototype\r\n     * @param {String} textBackgroundColor Text background color\r\n     * @return {fabric.Text}\r\n     * @chainable\r\n     */\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type:                 'text',\r\n\r\n    /**\r\n     * Font size (in pixels)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    fontSize:             40,\r\n\r\n    /**\r\n     * Font weight (e.g. bold, normal, 400, 600, 800)\r\n     * @type {(Number|String)}\r\n     * @default\r\n     */\r\n    fontWeight:           'normal',\r\n\r\n    /**\r\n     * Font family\r\n     * @type String\r\n     * @default\r\n     */\r\n    fontFamily:           'Times New Roman',\r\n\r\n    /**\r\n     * Text decoration Possible values: \"\", \"underline\", \"overline\" or \"line-through\".\r\n     * @type String\r\n     * @default\r\n     */\r\n    textDecoration:       '',\r\n\r\n    /**\r\n     * Text alignment. Possible values: \"left\", \"center\", or \"right\".\r\n     * @type String\r\n     * @default\r\n     */\r\n    textAlign:            'left',\r\n\r\n    /**\r\n     * Font style . Possible values: \"\", \"normal\", \"italic\" or \"oblique\".\r\n     * @type String\r\n     * @default\r\n     */\r\n    fontStyle:            '',\r\n\r\n    /**\r\n     * Line height\r\n     * @type Number\r\n     * @default\r\n     */\r\n    lineHeight:           1.16,\r\n\r\n    /**\r\n     * Background color of text lines\r\n     * @type String\r\n     * @default\r\n     */\r\n    textBackgroundColor:  '',\r\n\r\n    /**\r\n     * List of properties to consider when checking if\r\n     * state of an object is changed ({@link fabric.Object#hasStateChanged})\r\n     * as well as for history (undo/redo) purposes\r\n     * @type Array\r\n     */\r\n    stateProperties:      stateProperties,\r\n\r\n    /**\r\n     * When defined, an object is rendered via stroke and this property specifies its color.\r\n     * <b>Backwards incompatibility note:</b> This property was named \"strokeStyle\" until v1.1.6\r\n     * @type String\r\n     * @default\r\n     */\r\n    stroke:               null,\r\n\r\n    /**\r\n     * Shadow object representing shadow of this shape.\r\n     * <b>Backwards incompatibility note:</b> This property was named \"textShadow\" (String) until v1.2.11\r\n     * @type fabric.Shadow\r\n     * @default\r\n     */\r\n    shadow:               null,\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _fontSizeFraction: 0.25,\r\n\r\n    /**\r\n     * Text Line proportion to font Size (in pixels)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    _fontSizeMult:             1.13,\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {String} text Text string\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.Text} thisArg\r\n     */\r\n    initialize: function(text, options) {\r\n      options = options || { };\r\n      this.text = text;\r\n      this.__skipDimension = true;\r\n      this.setOptions(options);\r\n      this.__skipDimension = false;\r\n      this._initDimensions();\r\n    },\r\n\r\n    /**\r\n     * Renders text object on offscreen canvas, so that it would get dimensions\r\n     * @private\r\n     */\r\n    _initDimensions: function(ctx) {\r\n      if (this.__skipDimension) {\r\n        return;\r\n      }\r\n      if (!ctx) {\r\n        ctx = fabric.util.createCanvasElement().getContext('2d');\r\n        this._setTextStyles(ctx);\r\n      }\r\n      this._textLines = this.text.split(this._reNewline);\r\n      this._clearCache();\r\n      var currentTextAlign = this.textAlign;\r\n      this.textAlign = 'left';\r\n      this.width = this._getTextWidth(ctx);\r\n      this.textAlign = currentTextAlign;\r\n      this.height = this._getTextHeight(ctx);\r\n    },\r\n\r\n    /**\r\n     * Returns string representation of an instance\r\n     * @return {String} String representation of text object\r\n     */\r\n    toString: function() {\r\n      return '#<fabric.Text (' + this.complexity() +\r\n        '): { \"text\": \"' + this.text + '\", \"fontFamily\": \"' + this.fontFamily + '\" }>';\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _render: function(ctx) {\r\n\r\n      this.clipTo && fabric.util.clipContext(this, ctx);\r\n\r\n      this._renderTextBackground(ctx);\r\n      this._renderText(ctx);\r\n\r\n      this._renderTextDecoration(ctx);\r\n      this.clipTo && ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderText: function(ctx) {\r\n      ctx.save();\r\n      this._translateForTextAlign(ctx);\r\n      this._setOpacity(ctx);\r\n      this._setShadow(ctx);\r\n      this._setupCompositeOperation(ctx);\r\n      this._renderTextFill(ctx);\r\n      this._renderTextStroke(ctx);\r\n      this._restoreCompositeOperation(ctx);\r\n      this._removeShadow(ctx);\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _translateForTextAlign: function(ctx) {\r\n      if (this.textAlign !== 'left' && this.textAlign !== 'justify') {\r\n        ctx.translate(this.textAlign === 'center' ? (this.width / 2) : this.width, 0);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _setTextStyles: function(ctx) {\r\n      ctx.textBaseline = 'alphabetic';\r\n      if (!this.skipTextAlign) {\r\n        ctx.textAlign = this.textAlign;\r\n      }\r\n      ctx.font = this._getFontDeclaration();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @return {Number} Height of fabric.Text object\r\n     */\r\n    _getTextHeight: function() {\r\n      return this._textLines.length * this._getHeightOfLine();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @return {Number} Maximum width of fabric.Text object\r\n     */\r\n    _getTextWidth: function(ctx) {\r\n      var maxWidth = this._getLineWidth(ctx, 0);\r\n\r\n      for (var i = 1, len = this._textLines.length; i < len; i++) {\r\n        var currentLineWidth = this._getLineWidth(ctx, i);\r\n        if (currentLineWidth > maxWidth) {\r\n          maxWidth = currentLineWidth;\r\n        }\r\n      }\r\n      return maxWidth;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} method Method name (\"fillText\" or \"strokeText\")\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {String} chars Chars to render\r\n     * @param {Number} left Left position of text\r\n     * @param {Number} top Top position of text\r\n     */\r\n    _renderChars: function(method, ctx, chars, left, top) {\r\n      ctx[method](chars, left, top);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} method Method name (\"fillText\" or \"strokeText\")\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {String} line Text to render\r\n     * @param {Number} left Left position of text\r\n     * @param {Number} top Top position of text\r\n     * @param {Number} lineIndex Index of a line in a text\r\n     */\r\n    _renderTextLine: function(method, ctx, line, left, top, lineIndex) {\r\n      // lift the line by quarter of fontSize\r\n      top -= this.fontSize * this._fontSizeFraction;\r\n\r\n      // short-circuit\r\n      if (this.textAlign !== 'justify') {\r\n        this._renderChars(method, ctx, line, left, top, lineIndex);\r\n        return;\r\n      }\r\n\r\n      var lineWidth = this._getLineWidth(ctx, lineIndex),\r\n          totalWidth = this.width;\r\n      if (totalWidth >= lineWidth) {\r\n        // stretch the line\r\n        var words = line.split(/\\s+/),\r\n            wordsWidth = this._getWidthOfWords(ctx, line, lineIndex),\r\n            widthDiff = totalWidth - wordsWidth,\r\n            numSpaces = words.length - 1,\r\n            spaceWidth = widthDiff / numSpaces,\r\n            leftOffset = 0;\r\n\r\n        for (var i = 0, len = words.length; i < len; i++) {\r\n          this._renderChars(method, ctx, words[i], left + leftOffset, top, lineIndex);\r\n          leftOffset += ctx.measureText(words[i]).width + spaceWidth;\r\n        }\r\n      }\r\n      else {\r\n        this._renderChars(method, ctx, line, left, top, lineIndex);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {Number} line\r\n     */\r\n    _getWidthOfWords: function (ctx, line) {\r\n      return ctx.measureText(line.replace(/\\s+/g, '')).width;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @return {Number} Left offset\r\n     */\r\n    _getLeftOffset: function() {\r\n      return -this.width / 2;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @return {Number} Top offset\r\n     */\r\n    _getTopOffset: function() {\r\n      return -this.height / 2;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderTextFill: function(ctx) {\r\n      if (!this.fill && !this._skipFillStrokeCheck) {\r\n        return;\r\n      }\r\n\r\n      var lineHeights = 0;\r\n\r\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\r\n        var heightOfLine = this._getHeightOfLine(ctx, i),\r\n            maxHeight = heightOfLine / this.lineHeight;\r\n\r\n        this._renderTextLine(\r\n          'fillText',\r\n          ctx,\r\n          this._textLines[i],\r\n          this._getLeftOffset(),\r\n          this._getTopOffset() + lineHeights + maxHeight,\r\n          i\r\n        );\r\n        lineHeights += heightOfLine;\r\n      }\r\n      if (this.shadow && !this.shadow.affectStroke) {\r\n        this._removeShadow(ctx);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderTextStroke: function(ctx) {\r\n      if ((!this.stroke || this.strokeWidth === 0) && !this._skipFillStrokeCheck) {\r\n        return;\r\n      }\r\n\r\n      var lineHeights = 0;\r\n\r\n      ctx.save();\r\n\r\n      if (this.strokeDashArray) {\r\n        // Spec requires the concatenation of two copies the dash list when the number of elements is odd\r\n        if (1 & this.strokeDashArray.length) {\r\n          this.strokeDashArray.push.apply(this.strokeDashArray, this.strokeDashArray);\r\n        }\r\n        supportsLineDash && ctx.setLineDash(this.strokeDashArray);\r\n      }\r\n\r\n      ctx.beginPath();\r\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\r\n        var heightOfLine = this._getHeightOfLine(ctx, i),\r\n            maxHeight = heightOfLine / this.lineHeight;\r\n\r\n        this._renderTextLine(\r\n          'strokeText',\r\n          ctx,\r\n          this._textLines[i],\r\n          this._getLeftOffset(),\r\n          this._getTopOffset() + lineHeights + maxHeight,\r\n          i\r\n        );\r\n        lineHeights += heightOfLine;\r\n      }\r\n      ctx.closePath();\r\n      ctx.restore();\r\n    },\r\n\r\n    _getHeightOfLine: function() {\r\n      return this.fontSize * this._fontSizeMult * this.lineHeight;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {Array} textLines Array of all text lines\r\n     */\r\n    _renderTextBackground: function(ctx) {\r\n      this._renderTextBoxBackground(ctx);\r\n      this._renderTextLinesBackground(ctx);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderTextBoxBackground: function(ctx) {\r\n      if (!this.backgroundColor) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n      ctx.fillStyle = this.backgroundColor;\r\n\r\n      ctx.fillRect(\r\n        this._getLeftOffset(),\r\n        this._getTopOffset(),\r\n        this.width,\r\n        this.height\r\n      );\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderTextLinesBackground: function(ctx) {\r\n      var lineTopOffset = 0, heightOfLine = this._getHeightOfLine();\r\n      if (!this.textBackgroundColor) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n      ctx.fillStyle = this.textBackgroundColor;\r\n\r\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\r\n\r\n        if (this._textLines[i] !== '') {\r\n\r\n          var lineWidth = this._getLineWidth(ctx, i),\r\n              lineLeftOffset = this._getLineLeftOffset(lineWidth);\r\n\r\n          ctx.fillRect(\r\n            this._getLeftOffset() + lineLeftOffset,\r\n            this._getTopOffset() + lineTopOffset,\r\n            lineWidth,\r\n            this.fontSize * this._fontSizeMult\r\n          );\r\n        }\r\n        lineTopOffset += heightOfLine;\r\n      }\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Number} lineWidth Width of text line\r\n     * @return {Number} Line left offset\r\n     */\r\n    _getLineLeftOffset: function(lineWidth) {\r\n      if (this.textAlign === 'center') {\r\n        return (this.width - lineWidth) / 2;\r\n      }\r\n      if (this.textAlign === 'right') {\r\n        return this.width - lineWidth;\r\n      }\r\n      return 0;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _clearCache: function() {\r\n      this.__lineWidths = [ ];\r\n      this.__lineHeights = [ ];\r\n      this.__lineOffsets = [ ];\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _shouldClearCache: function() {\r\n      var shouldClear = false;\r\n      for (var prop in this._dimensionAffectingProps) {\r\n        if (this['__' + prop] !== this[prop]) {\r\n          this['__' + prop] = this[prop];\r\n          shouldClear = true;\r\n        }\r\n      }\r\n      return shouldClear;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @return {Number} Line width\r\n     */\r\n    _getLineWidth: function(ctx, lineIndex) {\r\n      if (this.__lineWidths[lineIndex]) {\r\n        return this.__lineWidths[lineIndex];\r\n      }\r\n      this.__lineWidths[lineIndex] = ctx.measureText(this._textLines[lineIndex]).width;\r\n      return this.__lineWidths[lineIndex];\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderTextDecoration: function(ctx) {\r\n      if (!this.textDecoration) {\r\n        return;\r\n      }\r\n\r\n      var halfOfVerticalBox = this.height / 2,\r\n          _this = this, offsets = [];\r\n\r\n      /** @ignore */\r\n      function renderLinesAtOffset(offsets) {\r\n        var i, lineHeight = 0, len, j, oLen;\r\n        for (i = 0, len = _this._textLines.length; i < len; i++) {\r\n\r\n          var lineWidth = _this._getLineWidth(ctx, i),\r\n              lineLeftOffset = _this._getLineLeftOffset(lineWidth),\r\n              heightOfLine = _this._getHeightOfLine(ctx, i);\r\n\r\n          for (j = 0, oLen = offsets.length; j < oLen; j++) {\r\n            ctx.fillRect(\r\n              _this._getLeftOffset() + lineLeftOffset,\r\n              lineHeight + (_this._fontSizeMult - 1 + offsets[j] ) * _this.fontSize - halfOfVerticalBox,\r\n              lineWidth,\r\n              _this.fontSize / 15);\r\n          }\r\n          lineHeight += heightOfLine;\r\n        }\r\n      }\r\n\r\n      if (this.textDecoration.indexOf('underline') > -1) {\r\n        offsets.push(0.85); // 1 - 3/16\r\n      }\r\n      if (this.textDecoration.indexOf('line-through') > -1) {\r\n        offsets.push(0.43);\r\n      }\r\n      if (this.textDecoration.indexOf('overline') > -1) {\r\n        offsets.push(-0.12);\r\n      }\r\n\r\n      if (offsets.length > 0) {\r\n        renderLinesAtOffset(offsets);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getFontDeclaration: function() {\r\n      return [\r\n        // node-canvas needs \"weight style\", while browsers need \"style weight\"\r\n        (fabric.isLikelyNode ? this.fontWeight : this.fontStyle),\r\n        (fabric.isLikelyNode ? this.fontStyle : this.fontWeight),\r\n        this.fontSize + 'px',\r\n        (fabric.isLikelyNode ? ('\"' + this.fontFamily + '\"') : this.fontFamily)\r\n      ].join(' ');\r\n    },\r\n\r\n    /**\r\n     * Renders text instance on a specified context\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    render: function(ctx, noTransform) {\r\n      // do not render if object is not visible\r\n      if (!this.visible) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n      this._setTextStyles(ctx);\r\n\r\n      if (this._shouldClearCache()) {\r\n        this._initDimensions(ctx);\r\n      }\r\n      if (!noTransform) {\r\n        this.transform(ctx);\r\n      }\r\n      this._setStrokeStyles(ctx);\r\n      this._setFillStyles(ctx);\r\n      if (this.transformMatrix) {\r\n        ctx.transform.apply(ctx, this.transformMatrix);\r\n      }\r\n      if (this.group && this.group.type === 'path-group') {\r\n        ctx.translate(this.left, this.top);\r\n      }\r\n      this._render(ctx);\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} Object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      var object = extend(this.callSuper('toObject', propertiesToInclude), {\r\n        text:                 this.text,\r\n        fontSize:             this.fontSize,\r\n        fontWeight:           this.fontWeight,\r\n        fontFamily:           this.fontFamily,\r\n        fontStyle:            this.fontStyle,\r\n        lineHeight:           this.lineHeight,\r\n        textDecoration:       this.textDecoration,\r\n        textAlign:            this.textAlign,\r\n        textBackgroundColor:  this.textBackgroundColor\r\n      });\r\n      if (!this.includeDefaultValues) {\r\n        this._removeDefaultValues(object);\r\n      }\r\n      return object;\r\n    },\r\n\r\n    /* _TO_SVG_START_ */\r\n    /**\r\n     * Returns SVG representation of an instance\r\n     * @param {Function} [reviver] Method for further parsing of svg representation.\r\n     * @return {String} svg representation of an instance\r\n     */\r\n    toSVG: function(reviver) {\r\n      var markup = this._createBaseSVGMarkup(),\r\n          offsets = this._getSVGLeftTopOffsets(this.ctx),\r\n          textAndBg = this._getSVGTextAndBg(offsets.textTop, offsets.textLeft);\r\n      this._wrapSVGTextAndBg(markup, textAndBg);\r\n\r\n      return reviver ? reviver(markup.join('')) : markup.join('');\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getSVGLeftTopOffsets: function(ctx) {\r\n      var lineTop = this._getHeightOfLine(ctx, 0),\r\n          textLeft = -this.width / 2,\r\n          textTop = 0;\r\n\r\n      return {\r\n        textLeft: textLeft + (this.group && this.group.type === 'path-group' ? this.left : 0),\r\n        textTop: textTop + (this.group && this.group.type === 'path-group' ? -this.top : 0),\r\n        lineTop: lineTop\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _wrapSVGTextAndBg: function(markup, textAndBg) {\r\n      markup.push(\r\n        '\\t<g transform=\"', this.getSvgTransform(), this.getSvgTransformMatrix(), '\">\\n',\r\n          textAndBg.textBgRects.join(''),\r\n          '\\t\\t<text ',\r\n            (this.fontFamily ? 'font-family=\"' + this.fontFamily.replace(/\"/g, '\\'') + '\" ': ''),\r\n            (this.fontSize ? 'font-size=\"' + this.fontSize + '\" ': ''),\r\n            (this.fontStyle ? 'font-style=\"' + this.fontStyle + '\" ': ''),\r\n            (this.fontWeight ? 'font-weight=\"' + this.fontWeight + '\" ': ''),\r\n            (this.textDecoration ? 'text-decoration=\"' + this.textDecoration + '\" ': ''),\r\n            'style=\"', this.getSvgStyles(), '\" >',\r\n            textAndBg.textSpans.join(''),\r\n          '</text>\\n',\r\n        '\\t</g>\\n'\r\n      );\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Number} textTopOffset Text top offset\r\n     * @param {Number} textLeftOffset Text left offset\r\n     * @return {Object}\r\n     */\r\n    _getSVGTextAndBg: function(textTopOffset, textLeftOffset) {\r\n      var textSpans = [ ],\r\n          textBgRects = [ ],\r\n          height = 0;\r\n      // bounding-box background\r\n      this._setSVGBg(textBgRects);\r\n\r\n      // text and text-background\r\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\r\n        if (this.textBackgroundColor) {\r\n          this._setSVGTextLineBg(textBgRects, i, textLeftOffset, textTopOffset, height);\r\n        }\r\n        this._setSVGTextLineText(i, textSpans, height, textLeftOffset, textTopOffset, textBgRects);\r\n        height += this._getHeightOfLine(this.ctx, i);\r\n      }\r\n\r\n      return {\r\n        textSpans: textSpans,\r\n        textBgRects: textBgRects\r\n      };\r\n    },\r\n\r\n    _setSVGTextLineText: function(i, textSpans, height, textLeftOffset, textTopOffset) {\r\n      var yPos = this.fontSize * (this._fontSizeMult - this._fontSizeFraction)\r\n        - textTopOffset + height - this.height / 2;\r\n      textSpans.push(\r\n        '<tspan x=\"',\r\n          toFixed(textLeftOffset + this._getLineLeftOffset(this.__lineWidths[i]), 4), '\" ',\r\n          'y=\"',\r\n          toFixed(yPos, 4),\r\n          '\" ',\r\n          // doing this on <tspan> elements since setting opacity\r\n          // on containing <text> one doesn't work in Illustrator\r\n          this._getFillAttributes(this.fill), '>',\r\n          fabric.util.string.escapeXml(this._textLines[i]),\r\n        '</tspan>'\r\n      );\r\n    },\r\n\r\n    _setSVGTextLineBg: function(textBgRects, i, textLeftOffset, textTopOffset, height) {\r\n      textBgRects.push(\r\n        '\\t\\t<rect ',\r\n          this._getFillAttributes(this.textBackgroundColor),\r\n          ' x=\"',\r\n          toFixed(textLeftOffset + this._getLineLeftOffset(this.__lineWidths[i]), 4),\r\n          '\" y=\"',\r\n          toFixed(height - this.height / 2, 4),\r\n          '\" width=\"',\r\n          toFixed(this.__lineWidths[i], 4),\r\n          '\" height=\"',\r\n          toFixed(this._getHeightOfLine(this.ctx, i) / this.lineHeight, 4),\r\n        '\"></rect>\\n');\r\n    },\r\n\r\n    _setSVGBg: function(textBgRects) {\r\n      if (this.backgroundColor) {\r\n        textBgRects.push(\r\n          '\\t\\t<rect ',\r\n            this._getFillAttributes(this.backgroundColor),\r\n            ' x=\"',\r\n            toFixed(-this.width / 2, 4),\r\n            '\" y=\"',\r\n            toFixed(-this.height / 2, 4),\r\n            '\" width=\"',\r\n            toFixed(this.width, 4),\r\n            '\" height=\"',\r\n            toFixed(this.height, 4),\r\n          '\"></rect>\\n');\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Adobe Illustrator (at least CS5) is unable to render rgba()-based fill values\r\n     * we work around it by \"moving\" alpha channel into opacity attribute and setting fill's alpha to 1\r\n     *\r\n     * @private\r\n     * @param {Any} value\r\n     * @return {String}\r\n     */\r\n    _getFillAttributes: function(value) {\r\n      var fillColor = (value && typeof value === 'string') ? new fabric.Color(value) : '';\r\n      if (!fillColor || !fillColor.getSource() || fillColor.getAlpha() === 1) {\r\n        return 'fill=\"' + value + '\"';\r\n      }\r\n      return 'opacity=\"' + fillColor.getAlpha() + '\" fill=\"' + fillColor.setAlpha(1).toRgb() + '\"';\r\n    },\r\n    /* _TO_SVG_END_ */\r\n\r\n    /**\r\n     * Sets specified property to a specified value\r\n     * @param {String} key\r\n     * @param {Any} value\r\n     * @return {fabric.Text} thisArg\r\n     * @chainable\r\n     */\r\n    _set: function(key, value) {\r\n      this.callSuper('_set', key, value);\r\n\r\n      if (key in this._dimensionAffectingProps) {\r\n        this._initDimensions();\r\n        this.setCoords();\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Returns complexity of an instance\r\n     * @return {Number} complexity\r\n     */\r\n    complexity: function() {\r\n      return 1;\r\n    }\r\n  });\r\n\r\n  /* _FROM_SVG_START_ */\r\n  /**\r\n   * List of attribute names to account for when parsing SVG element (used by {@link fabric.Text.fromElement})\r\n   * @static\r\n   * @memberOf fabric.Text\r\n   * @see: http://www.w3.org/TR/SVG/text.html#TextElement\r\n   */\r\n  fabric.Text.ATTRIBUTE_NAMES = fabric.SHARED_ATTRIBUTES.concat(\r\n    'x y dx dy font-family font-style font-weight font-size text-decoration text-anchor'.split(' '));\r\n\r\n  /**\r\n   * Default SVG font size\r\n   * @static\r\n   * @memberOf fabric.Text\r\n   */\r\n  fabric.Text.DEFAULT_SVG_FONT_SIZE = 16;\r\n\r\n  /**\r\n   * Returns fabric.Text instance from an SVG element (<b>not yet implemented</b>)\r\n   * @static\r\n   * @memberOf fabric.Text\r\n   * @param {SVGElement} element Element to parse\r\n   * @param {Object} [options] Options object\r\n   * @return {fabric.Text} Instance of fabric.Text\r\n   */\r\n  fabric.Text.fromElement = function(element, options) {\r\n    if (!element) {\r\n      return null;\r\n    }\r\n\r\n    var parsedAttributes = fabric.parseAttributes(element, fabric.Text.ATTRIBUTE_NAMES);\r\n    options = fabric.util.object.extend((options ? fabric.util.object.clone(options) : { }), parsedAttributes);\r\n\r\n    options.top = options.top || 0;\r\n    options.left = options.left || 0;\r\n    if ('dx' in parsedAttributes) {\r\n      options.left += parsedAttributes.dx;\r\n    }\r\n    if ('dy' in parsedAttributes) {\r\n      options.top += parsedAttributes.dy;\r\n    }\r\n    if (!('fontSize' in options)) {\r\n      options.fontSize = fabric.Text.DEFAULT_SVG_FONT_SIZE;\r\n    }\r\n\r\n    if (!options.originX) {\r\n      options.originX = 'left';\r\n    }\r\n    var textContent = element.textContent.replace(/^\\s+|\\s+$|\\n+/g, '').replace(/\\s+/g, ' '),\r\n        text = new fabric.Text(textContent, options),\r\n        /*\r\n          Adjust positioning:\r\n            x/y attributes in SVG correspond to the bottom-left corner of text bounding box\r\n            top/left properties in Fabric correspond to center point of text bounding box\r\n        */\r\n        offX = 0;\r\n\r\n    if (text.originX === 'left') {\r\n      offX = text.getWidth() / 2;\r\n    }\r\n    if (text.originX === 'right') {\r\n      offX = -text.getWidth() / 2;\r\n    }\r\n    text.set({\r\n      left: text.getLeft() + offX,\r\n      top: text.getTop() - text.getHeight() / 2 + text.fontSize * (0.18 + text._fontSizeFraction) /* 0.3 is the old lineHeight */\r\n    });\r\n\r\n    return text;\r\n  };\r\n  /* _FROM_SVG_END_ */\r\n\r\n  /**\r\n   * Returns fabric.Text instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.Text\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.Text} Instance of fabric.Text\r\n   */\r\n  fabric.Text.fromObject = function(object) {\r\n    return new fabric.Text(object.text, clone(object));\r\n  };\r\n\r\n  fabric.util.createAccessors(fabric.Text);\r\n\r\n})(typeof exports !== 'undefined' ? exports : this);\r\n\r\n\r\n(function() {\r\n\r\n  var clone = fabric.util.object.clone;\r\n\r\n  /**\r\n   * IText class (introduced in <b>v1.4</b>) Events are also fired with \"text:\"\r\n   * prefix when observing canvas.\r\n   * @class fabric.IText\r\n   * @extends fabric.Text\r\n   * @mixes fabric.Observable\r\n   *\r\n   * @fires changed\r\n   * @fires selection:changed\r\n   * @fires editing:entered\r\n   * @fires editing:exited\r\n   *\r\n   * @return {fabric.IText} thisArg\r\n   * @see {@link fabric.IText#initialize} for constructor definition\r\n   *\r\n   * <p>Supported key combinations:</p>\r\n   * <pre>\r\n   *   Move cursor:                    left, right, up, down\r\n   *   Select character:               shift + left, shift + right\r\n   *   Select text vertically:         shift + up, shift + down\r\n   *   Move cursor by word:            alt + left, alt + right\r\n   *   Select words:                   shift + alt + left, shift + alt + right\r\n   *   Move cursor to line start/end:  cmd + left, cmd + right or home, end\r\n   *   Select till start/end of line:  cmd + shift + left, cmd + shift + right or shift + home, shift + end\r\n   *   Jump to start/end of text:      cmd + up, cmd + down\r\n   *   Select till start/end of text:  cmd + shift + up, cmd + shift + down or shift + pgUp, shift + pgDown\r\n   *   Delete character:               backspace\r\n   *   Delete word:                    alt + backspace\r\n   *   Delete line:                    cmd + backspace\r\n   *   Forward delete:                 delete\r\n   *   Copy text:                      ctrl/cmd + c\r\n   *   Paste text:                     ctrl/cmd + v\r\n   *   Cut text:                       ctrl/cmd + x\r\n   *   Select entire text:             ctrl/cmd + a\r\n   *   Quit editing                    tab or esc\r\n   * </pre>\r\n   *\r\n   * <p>Supported mouse/touch combination</p>\r\n   * <pre>\r\n   *   Position cursor:                click/touch\r\n   *   Create selection:               click/touch & drag\r\n   *   Create selection:               click & shift + click\r\n   *   Select word:                    double click\r\n   *   Select line:                    triple click\r\n   * </pre>\r\n   */\r\n  fabric.IText = fabric.util.createClass(fabric.Text, fabric.Observable, /** @lends fabric.IText.prototype */ {\r\n\r\n    /**\r\n     * Type of an object\r\n     * @type String\r\n     * @default\r\n     */\r\n    type: 'i-text',\r\n\r\n    /**\r\n     * Index where text selection starts (or where cursor is when there is no selection)\r\n     * @type Nubmer\r\n     * @default\r\n     */\r\n    selectionStart: 0,\r\n\r\n    /**\r\n     * Index where text selection ends\r\n     * @type Nubmer\r\n     * @default\r\n     */\r\n    selectionEnd: 0,\r\n\r\n    /**\r\n     * Color of text selection\r\n     * @type String\r\n     * @default\r\n     */\r\n    selectionColor: 'rgba(17,119,255,0.3)',\r\n\r\n    /**\r\n     * Indicates whether text is in editing mode\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    isEditing: false,\r\n\r\n    /**\r\n     * Indicates whether a text can be edited\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    editable: true,\r\n\r\n    /**\r\n     * Border color of text object while it's in editing mode\r\n     * @type String\r\n     * @default\r\n     */\r\n    editingBorderColor: 'rgba(102,153,255,0.25)',\r\n\r\n    /**\r\n     * Width of cursor (in px)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    cursorWidth: 2,\r\n\r\n    /**\r\n     * Color of default cursor (when not overwritten by character style)\r\n     * @type String\r\n     * @default\r\n     */\r\n    cursorColor: '#333',\r\n\r\n    /**\r\n     * Delay between cursor blink (in ms)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    cursorDelay: 1000,\r\n\r\n    /**\r\n     * Duration of cursor fadein (in ms)\r\n     * @type Number\r\n     * @default\r\n     */\r\n    cursorDuration: 600,\r\n\r\n    /**\r\n     * Object containing character styles\r\n     * (where top-level properties corresponds to line number and 2nd-level properties -- to char number in a line)\r\n     * @type Object\r\n     * @default\r\n     */\r\n    styles: null,\r\n\r\n    /**\r\n     * Indicates whether internal text char widths can be cached\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    caching: true,\r\n\r\n    /**\r\n     * @private\r\n     * @type Boolean\r\n     * @default\r\n     */\r\n    _skipFillStrokeCheck: false,\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _reSpace: /\\s|\\n/,\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _currentCursorOpacity: 0,\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _selectionDirection: null,\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _abortCursorAnimation: false,\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _charWidthsCache: { },\r\n\r\n    /**\r\n     * Constructor\r\n     * @param {String} text Text string\r\n     * @param {Object} [options] Options object\r\n     * @return {fabric.IText} thisArg\r\n     */\r\n    initialize: function(text, options) {\r\n      this.styles = options ? (options.styles || { }) : { };\r\n      this.callSuper('initialize', text, options);\r\n      this.initBehavior();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _clearCache: function() {\r\n      this.callSuper('_clearCache');\r\n      this.__maxFontHeights = [ ];\r\n      this.__widthOfSpace = [ ];\r\n    },\r\n\r\n    /**\r\n     * Returns true if object has no styling\r\n     */\r\n    isEmptyStyles: function() {\r\n      if (!this.styles) {\r\n        return true;\r\n      }\r\n      var obj = this.styles;\r\n\r\n      for (var p1 in obj) {\r\n        for (var p2 in obj[p1]) {\r\n          /*jshint unused:false */\r\n          for (var p3 in obj[p1][p2]) {\r\n            return false;\r\n          }\r\n        }\r\n      }\r\n      return true;\r\n    },\r\n\r\n    /**\r\n     * Sets selection start (left boundary of a selection)\r\n     * @param {Number} index Index to set selection start to\r\n     */\r\n    setSelectionStart: function(index) {\r\n      index = Math.max(index, 0);\r\n      if (this.selectionStart !== index) {\r\n        this.fire('selection:changed');\r\n        this.canvas && this.canvas.fire('text:selection:changed', { target: this });\r\n        this.selectionStart = index;\r\n      }\r\n      this._updateTextarea();\r\n    },\r\n\r\n    /**\r\n     * Sets selection end (right boundary of a selection)\r\n     * @param {Number} index Index to set selection end to\r\n     */\r\n    setSelectionEnd: function(index) {\r\n      index = Math.min(index, this.text.length);\r\n      if (this.selectionEnd !== index) {\r\n        this.fire('selection:changed');\r\n        this.canvas && this.canvas.fire('text:selection:changed', { target: this });\r\n        this.selectionEnd = index;\r\n      }\r\n      this._updateTextarea();\r\n    },\r\n\r\n    /**\r\n     * Gets style of a current selection/cursor (at the start position)\r\n     * @param {Number} [startIndex] Start index to get styles at\r\n     * @param {Number} [endIndex] End index to get styles at\r\n     * @return {Object} styles Style object at a specified (or current) index\r\n     */\r\n    getSelectionStyles: function(startIndex, endIndex) {\r\n\r\n      if (arguments.length === 2) {\r\n        var styles = [ ];\r\n        for (var i = startIndex; i < endIndex; i++) {\r\n          styles.push(this.getSelectionStyles(i));\r\n        }\r\n        return styles;\r\n      }\r\n\r\n      var loc = this.get2DCursorLocation(startIndex);\r\n      if (this.styles[loc.lineIndex]) {\r\n        return this.styles[loc.lineIndex][loc.charIndex] || { };\r\n      }\r\n\r\n      return { };\r\n    },\r\n\r\n    /**\r\n     * Sets style of a current selection\r\n     * @param {Object} [styles] Styles object\r\n     * @return {fabric.IText} thisArg\r\n     * @chainable\r\n     */\r\n    setSelectionStyles: function(styles) {\r\n      if (this.selectionStart === this.selectionEnd) {\r\n        this._extendStyles(this.selectionStart, styles);\r\n      }\r\n      else {\r\n        for (var i = this.selectionStart; i < this.selectionEnd; i++) {\r\n          this._extendStyles(i, styles);\r\n        }\r\n      }\r\n      /* not included in _extendStyles to avoid clearing cache more than once */\r\n      this._clearCache();\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _extendStyles: function(index, styles) {\r\n      var loc = this.get2DCursorLocation(index);\r\n\r\n      if (!this.styles[loc.lineIndex]) {\r\n        this.styles[loc.lineIndex] = { };\r\n      }\r\n      if (!this.styles[loc.lineIndex][loc.charIndex]) {\r\n        this.styles[loc.lineIndex][loc.charIndex] = { };\r\n      }\r\n      fabric.util.object.extend(this.styles[loc.lineIndex][loc.charIndex], styles);\r\n    },\r\n\r\n    /**\r\n    * @private\r\n    * @param {CanvasRenderingContext2D} ctx Context to render on\r\n    */\r\n    _render: function(ctx) {\r\n      this.callSuper('_render', ctx);\r\n      this.ctx = ctx;\r\n      this.isEditing && this.renderCursorOrSelection();\r\n    },\r\n\r\n    /**\r\n     * Renders cursor or selection (depending on what exists)\r\n     */\r\n    renderCursorOrSelection: function() {\r\n      if (!this.active) {\r\n        return;\r\n      }\r\n\r\n      var chars = this.text.split(''),\r\n          boundaries, ctx;\r\n\r\n      if (this.canvas.contextTop) {\r\n        ctx = this.canvas.contextTop;\r\n        ctx.save();\r\n        ctx.transform.apply(ctx, this.canvas.viewportTransform);\r\n        this.transform(ctx);\r\n      }\r\n      else {\r\n        ctx = this.ctx;\r\n        ctx.save();\r\n      }\r\n\r\n      if (this.selectionStart === this.selectionEnd) {\r\n        boundaries = this._getCursorBoundaries(chars, 'cursor');\r\n        this.renderCursor(boundaries, ctx);\r\n      }\r\n      else {\r\n        boundaries = this._getCursorBoundaries(chars, 'selection');\r\n        this.renderSelection(chars, boundaries, ctx);\r\n      }\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Returns 2d representation (lineIndex and charIndex) of cursor (or selection start)\r\n     * @param {Number} [selectionStart] Optional index. When not given, current selectionStart is used.\r\n     */\r\n    get2DCursorLocation: function(selectionStart) {\r\n      if (typeof selectionStart === 'undefined') {\r\n        selectionStart = this.selectionStart;\r\n      }\r\n      var textBeforeCursor = this.text.slice(0, selectionStart),\r\n          linesBeforeCursor = textBeforeCursor.split(this._reNewline);\r\n\r\n      return {\r\n        lineIndex: linesBeforeCursor.length - 1,\r\n        charIndex: linesBeforeCursor[linesBeforeCursor.length - 1].length\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Returns complete style of char at the current cursor\r\n     * @param {Number} lineIndex Line index\r\n     * @param {Number} charIndex Char index\r\n    * @return {Object} Character style\r\n     */\r\n    getCurrentCharStyle: function(lineIndex, charIndex) {\r\n      var style = this.styles[lineIndex] && this.styles[lineIndex][charIndex === 0 ? 0 : (charIndex - 1)];\r\n\r\n      return {\r\n        fontSize: style && style.fontSize || this.fontSize,\r\n        fill: style && style.fill || this.fill,\r\n        textBackgroundColor: style && style.textBackgroundColor || this.textBackgroundColor,\r\n        textDecoration: style && style.textDecoration || this.textDecoration,\r\n        fontFamily: style && style.fontFamily || this.fontFamily,\r\n        fontWeight: style && style.fontWeight || this.fontWeight,\r\n        fontStyle: style && style.fontStyle || this.fontStyle,\r\n        stroke: style && style.stroke || this.stroke,\r\n        strokeWidth: style && style.strokeWidth || this.strokeWidth\r\n      };\r\n    },\r\n\r\n    /**\r\n     * Returns fontSize of char at the current cursor\r\n     * @param {Number} lineIndex Line index\r\n     * @param {Number} charIndex Char index\r\n     * @return {Number} Character font size\r\n     */\r\n    getCurrentCharFontSize: function(lineIndex, charIndex) {\r\n      return (\r\n        this.styles[lineIndex] &&\r\n        this.styles[lineIndex][charIndex === 0 ? 0 : (charIndex - 1)] &&\r\n        this.styles[lineIndex][charIndex === 0 ? 0 : (charIndex - 1)].fontSize) || this.fontSize;\r\n    },\r\n\r\n    /**\r\n     * Returns color (fill) of char at the current cursor\r\n     * @param {Number} lineIndex Line index\r\n     * @param {Number} charIndex Char index\r\n     * @return {String} Character color (fill)\r\n     */\r\n    getCurrentCharColor: function(lineIndex, charIndex) {\r\n      return (\r\n        this.styles[lineIndex] &&\r\n        this.styles[lineIndex][charIndex === 0 ? 0 : (charIndex - 1)] &&\r\n        this.styles[lineIndex][charIndex === 0 ? 0 : (charIndex - 1)].fill) || this.cursorColor;\r\n    },\r\n\r\n    /**\r\n     * Returns cursor boundaries (left, top, leftOffset, topOffset)\r\n     * @private\r\n     * @param {Array} chars Array of characters\r\n     * @param {String} typeOfBoundaries\r\n     */\r\n    _getCursorBoundaries: function(chars, typeOfBoundaries) {\r\n\r\n      // left/top are left/top of entire text box\r\n      // leftOffset/topOffset are offset from that left/top point of a text box\r\n\r\n      var left = Math.round(this._getLeftOffset()),\r\n          top = this._getTopOffset(),\r\n\r\n          offsets = this._getCursorBoundariesOffsets(\r\n                      chars, typeOfBoundaries);\r\n\r\n      return {\r\n        left: left,\r\n        top: top,\r\n        leftOffset: offsets.left + offsets.lineLeft,\r\n        topOffset: offsets.top\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getCursorBoundariesOffsets: function(chars, typeOfBoundaries) {\r\n\r\n      var lineLeftOffset = 0,\r\n\r\n          lineIndex = 0,\r\n          charIndex = 0,\r\n          topOffset = 0,\r\n          leftOffset = 0;\r\n\r\n      for (var i = 0; i < this.selectionStart; i++) {\r\n        if (chars[i] === '\\n') {\r\n          leftOffset = 0;\r\n          topOffset += this._getHeightOfLine(this.ctx, lineIndex);\r\n\r\n          lineIndex++;\r\n          charIndex = 0;\r\n        }\r\n        else {\r\n          leftOffset += this._getWidthOfChar(this.ctx, chars[i], lineIndex, charIndex);\r\n          charIndex++;\r\n        }\r\n\r\n        lineLeftOffset = this._getCachedLineOffset(lineIndex);\r\n      }\r\n      if (typeOfBoundaries === 'cursor') {\r\n        topOffset += (1 - this._fontSizeFraction) * this._getHeightOfLine(this.ctx, lineIndex) / this.lineHeight\r\n          - this.getCurrentCharFontSize(lineIndex, charIndex) * (1 - this._fontSizeFraction);\r\n      }\r\n\r\n      return {\r\n        top: topOffset,\r\n        left: leftOffset,\r\n        lineLeft: lineLeftOffset\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getCachedLineOffset: function(lineIndex) {\r\n      var widthOfLine = this._getLineWidth(this.ctx, lineIndex);\r\n\r\n      return this.__lineOffsets[lineIndex] ||\r\n        (this.__lineOffsets[lineIndex] = this._getLineLeftOffset(widthOfLine));\r\n    },\r\n\r\n    /**\r\n     * Renders cursor\r\n     * @param {Object} boundaries\r\n     * @param {CanvasRenderingContext2D} ctx transformed context to draw on\r\n     */\r\n    renderCursor: function(boundaries, ctx) {\r\n\r\n      var cursorLocation = this.get2DCursorLocation(),\r\n          lineIndex = cursorLocation.lineIndex,\r\n          charIndex = cursorLocation.charIndex,\r\n          charHeight = this.getCurrentCharFontSize(lineIndex, charIndex),\r\n          leftOffset = (lineIndex === 0 && charIndex === 0)\r\n                    ? this._getCachedLineOffset(lineIndex)\r\n                    : boundaries.leftOffset;\r\n\r\n      ctx.fillStyle = this.getCurrentCharColor(lineIndex, charIndex);\r\n      ctx.globalAlpha = this.__isMousedown ? 1 : this._currentCursorOpacity;\r\n\r\n      ctx.fillRect(\r\n        boundaries.left + leftOffset,\r\n        boundaries.top + boundaries.topOffset,\r\n        this.cursorWidth / this.scaleX,\r\n        charHeight);\r\n\r\n    },\r\n\r\n    /**\r\n     * Renders text selection\r\n     * @param {Array} chars Array of characters\r\n     * @param {Object} boundaries Object with left/top/leftOffset/topOffset\r\n     * @param {CanvasRenderingContext2D} ctx transformed context to draw on\r\n     */\r\n    renderSelection: function(chars, boundaries, ctx) {\r\n\r\n      ctx.fillStyle = this.selectionColor;\r\n\r\n      var start = this.get2DCursorLocation(this.selectionStart),\r\n          end = this.get2DCursorLocation(this.selectionEnd),\r\n          startLine = start.lineIndex,\r\n          endLine = end.lineIndex;\r\n\r\n      for (var i = startLine; i <= endLine; i++) {\r\n        var lineOffset = this._getCachedLineOffset(i) || 0,\r\n            lineHeight = this._getHeightOfLine(this.ctx, i),\r\n            boxWidth = 0, line = this._textLines[i];\r\n\r\n        if (i === startLine) {\r\n          for (var j = 0, len = line.length; j < len; j++) {\r\n            if (j >= start.charIndex && (i !== endLine || j < end.charIndex)) {\r\n              boxWidth += this._getWidthOfChar(ctx, line[j], i, j);\r\n            }\r\n            if (j < start.charIndex) {\r\n              lineOffset += this._getWidthOfChar(ctx, line[j], i, j);\r\n            }\r\n          }\r\n        }\r\n        else if (i > startLine && i < endLine) {\r\n          boxWidth += this._getLineWidth(ctx, i) || 5;\r\n        }\r\n        else if (i === endLine) {\r\n          for (var j2 = 0, j2len = end.charIndex; j2 < j2len; j2++) {\r\n            boxWidth += this._getWidthOfChar(ctx, line[j2], i, j2);\r\n          }\r\n        }\r\n\r\n        ctx.fillRect(\r\n          boundaries.left + lineOffset,\r\n          boundaries.top + boundaries.topOffset,\r\n          boxWidth,\r\n          lineHeight);\r\n\r\n        boundaries.topOffset += lineHeight;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} method\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderChars: function(method, ctx, line, left, top, lineIndex) {\r\n\r\n      if (this.isEmptyStyles()) {\r\n        return this._renderCharsFast(method, ctx, line, left, top);\r\n      }\r\n\r\n      this.skipTextAlign = true;\r\n\r\n      // set proper box offset\r\n      left -= this.textAlign === 'center'\r\n        ? (this.width / 2)\r\n        : (this.textAlign === 'right')\r\n          ? this.width\r\n          : 0;\r\n\r\n      // set proper line offset\r\n      var lineHeight = this._getHeightOfLine(ctx, lineIndex),\r\n          lineLeftOffset = this._getCachedLineOffset(lineIndex),\r\n          chars = line.split(''),\r\n          prevStyle,\r\n          charsToRender = '';\r\n\r\n      left += lineLeftOffset || 0;\r\n\r\n      ctx.save();\r\n      top -= lineHeight / this.lineHeight * this._fontSizeFraction;\r\n      for (var i = 0, len = chars.length; i <= len; i++) {\r\n        prevStyle = prevStyle || this.getCurrentCharStyle(lineIndex, i);\r\n        var thisStyle = this.getCurrentCharStyle(lineIndex, i + 1);\r\n\r\n        if (this._hasStyleChanged(prevStyle, thisStyle) || i === len) {\r\n          this._renderChar(method, ctx, lineIndex, i - 1, charsToRender, left, top, lineHeight);\r\n          charsToRender = '';\r\n          prevStyle = thisStyle;\r\n        }\r\n        charsToRender += chars[i];\r\n      }\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} method\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {String} line Content of the line\r\n     * @param {Number} left Left coordinate\r\n     * @param {Number} top Top coordinate\r\n     */\r\n    _renderCharsFast: function(method, ctx, line, left, top) {\r\n      this.skipTextAlign = false;\r\n\r\n      if (method === 'fillText' && this.fill) {\r\n        this.callSuper('_renderChars', method, ctx, line, left, top);\r\n      }\r\n      if (method === 'strokeText' && ((this.stroke && this.strokeWidth > 0) || this.skipFillStrokeCheck)) {\r\n        this.callSuper('_renderChars', method, ctx, line, left, top);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} method\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {Number} lineIndex\r\n     * @param {Number} i\r\n     * @param {String} _char\r\n     * @param {Number} left Left coordinate\r\n     * @param {Number} top Top coordinate\r\n     * @param {Number} lineHeight Height of the line\r\n     */\r\n    _renderChar: function(method, ctx, lineIndex, i, _char, left, top, lineHeight) {\r\n      var decl, charWidth, charHeight,\r\n          offset = this._fontSizeFraction * lineHeight / this.lineHeight;\r\n\r\n      if (this.styles && this.styles[lineIndex] && (decl = this.styles[lineIndex][i])) {\r\n\r\n        var shouldStroke = decl.stroke || this.stroke,\r\n            shouldFill = decl.fill || this.fill;\r\n\r\n        ctx.save();\r\n        charWidth = this._applyCharStylesGetWidth(ctx, _char, lineIndex, i, decl);\r\n        charHeight = this._getHeightOfChar(ctx, _char, lineIndex, i);\r\n\r\n        if (shouldFill) {\r\n          ctx.fillText(_char, left, top);\r\n        }\r\n        if (shouldStroke) {\r\n          ctx.strokeText(_char, left, top);\r\n        }\r\n\r\n        this._renderCharDecoration(ctx, decl, left, top, offset, charWidth, charHeight);\r\n        ctx.restore();\r\n\r\n        ctx.translate(charWidth, 0);\r\n      }\r\n      else {\r\n        if (method === 'strokeText' && this.stroke) {\r\n          ctx[method](_char, left, top);\r\n        }\r\n        if (method === 'fillText' && this.fill) {\r\n          ctx[method](_char, left, top);\r\n        }\r\n        charWidth = this._applyCharStylesGetWidth(ctx, _char, lineIndex, i);\r\n        this._renderCharDecoration(ctx, null, left, top, offset, charWidth, this.fontSize);\r\n\r\n        ctx.translate(ctx.measureText(_char).width, 0);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} prevStyle\r\n     * @param {Object} thisStyle\r\n     */\r\n    _hasStyleChanged: function(prevStyle, thisStyle) {\r\n      return (prevStyle.fill !== thisStyle.fill ||\r\n              prevStyle.fontSize !== thisStyle.fontSize ||\r\n              prevStyle.textBackgroundColor !== thisStyle.textBackgroundColor ||\r\n              prevStyle.textDecoration !== thisStyle.textDecoration ||\r\n              prevStyle.fontFamily !== thisStyle.fontFamily ||\r\n              prevStyle.fontWeight !== thisStyle.fontWeight ||\r\n              prevStyle.fontStyle !== thisStyle.fontStyle ||\r\n              prevStyle.stroke !== thisStyle.stroke ||\r\n              prevStyle.strokeWidth !== thisStyle.strokeWidth\r\n      );\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderCharDecoration: function(ctx, styleDeclaration, left, top, offset, charWidth, charHeight) {\r\n\r\n      var textDecoration = styleDeclaration\r\n            ? (styleDeclaration.textDecoration || this.textDecoration)\r\n            : this.textDecoration;\r\n\r\n      if (!textDecoration) {\r\n        return;\r\n      }\r\n\r\n      if (textDecoration.indexOf('underline') > -1) {\r\n        ctx.fillRect(\r\n          left,\r\n          top + charHeight / 10,\r\n          charWidth ,\r\n          charHeight / 15\r\n        );\r\n      }\r\n      if (textDecoration.indexOf('line-through') > -1) {\r\n        ctx.fillRect(\r\n          left,\r\n          top - charHeight * (this._fontSizeFraction + this._fontSizeMult - 1) + charHeight / 15,\r\n          charWidth,\r\n          charHeight / 15\r\n        );\r\n      }\r\n      if (textDecoration.indexOf('overline') > -1) {\r\n        ctx.fillRect(\r\n          left,\r\n          top - (this._fontSizeMult - this._fontSizeFraction) * charHeight,\r\n          charWidth,\r\n          charHeight / 15\r\n        );\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {String} method\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {String} line\r\n     */\r\n    _renderTextLine: function(method, ctx, line, left, top, lineIndex) {\r\n      // to \"cancel\" this.fontSize subtraction in fabric.Text#_renderTextLine\r\n      // the adding 0.03 is just to align text with itext by overlap test\r\n      if (!this.isEmptyStyles()) {\r\n        top += this.fontSize * (this._fontSizeFraction + 0.03);\r\n      }\r\n      this.callSuper('_renderTextLine', method, ctx, line, left, top, lineIndex);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderTextDecoration: function(ctx) {\r\n      if (this.isEmptyStyles()) {\r\n        return this.callSuper('_renderTextDecoration', ctx);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _renderTextLinesBackground: function(ctx) {\r\n      if (!this.textBackgroundColor && !this.styles) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n\r\n      if (this.textBackgroundColor) {\r\n        ctx.fillStyle = this.textBackgroundColor;\r\n      }\r\n\r\n      var lineHeights = 0;\r\n\r\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\r\n\r\n        var heightOfLine = this._getHeightOfLine(ctx, i);\r\n        if (this._textLines[i] === '') {\r\n          lineHeights += heightOfLine;\r\n          continue;\r\n        }\r\n\r\n        var lineWidth = this._getLineWidth(ctx, i),\r\n            lineLeftOffset = this._getCachedLineOffset(i);\r\n\r\n        if (this.textBackgroundColor) {\r\n          ctx.fillStyle = this.textBackgroundColor;\r\n\r\n          ctx.fillRect(\r\n            this._getLeftOffset() + lineLeftOffset,\r\n            this._getTopOffset() + lineHeights,\r\n            lineWidth,\r\n            heightOfLine / this.lineHeight\r\n          );\r\n        }\r\n        if (this.styles[i]) {\r\n          for (var j = 0, jlen = this._textLines[i].length; j < jlen; j++) {\r\n            if (this.styles[i] && this.styles[i][j] && this.styles[i][j].textBackgroundColor) {\r\n\r\n              var _char = this._textLines[i][j];\r\n\r\n              ctx.fillStyle = this.styles[i][j].textBackgroundColor;\r\n\r\n              ctx.fillRect(\r\n                this._getLeftOffset() + lineLeftOffset + this._getWidthOfCharsAt(ctx, i, j),\r\n                this._getTopOffset() + lineHeights,\r\n                this._getWidthOfChar(ctx, _char, i, j) + 1,\r\n                heightOfLine / this.lineHeight\r\n              );\r\n            }\r\n          }\r\n        }\r\n        lineHeights += heightOfLine;\r\n      }\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _getCacheProp: function(_char, styleDeclaration) {\r\n      return _char +\r\n             styleDeclaration.fontFamily +\r\n             styleDeclaration.fontSize +\r\n             styleDeclaration.fontWeight +\r\n             styleDeclaration.fontStyle +\r\n             styleDeclaration.shadow;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {String} _char\r\n     * @param {Number} lineIndex\r\n     * @param {Number} charIndex\r\n     * @param {Object} [decl]\r\n     */\r\n    _applyCharStylesGetWidth: function(ctx, _char, lineIndex, charIndex, decl) {\r\n      var styleDeclaration = decl ||\r\n                            (this.styles[lineIndex] &&\r\n                             this.styles[lineIndex][charIndex]);\r\n\r\n      if (styleDeclaration) {\r\n        // cloning so that original style object is not polluted with following font declarations\r\n        styleDeclaration = clone(styleDeclaration);\r\n      }\r\n      else {\r\n        styleDeclaration = { };\r\n      }\r\n\r\n      this._applyFontStyles(styleDeclaration);\r\n\r\n      var cacheProp = this._getCacheProp(_char, styleDeclaration);\r\n\r\n      // short-circuit if no styles\r\n      if (this.isEmptyStyles() && this._charWidthsCache[cacheProp] && this.caching) {\r\n        return this._charWidthsCache[cacheProp];\r\n      }\r\n\r\n      if (typeof styleDeclaration.shadow === 'string') {\r\n        styleDeclaration.shadow = new fabric.Shadow(styleDeclaration.shadow);\r\n      }\r\n\r\n      var fill = styleDeclaration.fill || this.fill;\r\n      ctx.fillStyle = fill.toLive\r\n        ? fill.toLive(ctx, this)\r\n        : fill;\r\n\r\n      if (styleDeclaration.stroke) {\r\n        ctx.strokeStyle = (styleDeclaration.stroke && styleDeclaration.stroke.toLive)\r\n          ? styleDeclaration.stroke.toLive(ctx, this)\r\n          : styleDeclaration.stroke;\r\n      }\r\n\r\n      ctx.lineWidth = styleDeclaration.strokeWidth || this.strokeWidth;\r\n      ctx.font = this._getFontDeclaration.call(styleDeclaration);\r\n      this._setShadow.call(styleDeclaration, ctx);\r\n\r\n      if (!this.caching) {\r\n        return ctx.measureText(_char).width;\r\n      }\r\n\r\n      if (!this._charWidthsCache[cacheProp]) {\r\n        this._charWidthsCache[cacheProp] = ctx.measureText(_char).width;\r\n      }\r\n\r\n      return this._charWidthsCache[cacheProp];\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Object} styleDeclaration\r\n     */\r\n    _applyFontStyles: function(styleDeclaration) {\r\n      if (!styleDeclaration.fontFamily) {\r\n        styleDeclaration.fontFamily = this.fontFamily;\r\n      }\r\n      if (!styleDeclaration.fontSize) {\r\n        styleDeclaration.fontSize = this.fontSize;\r\n      }\r\n      if (!styleDeclaration.fontWeight) {\r\n        styleDeclaration.fontWeight = this.fontWeight;\r\n      }\r\n      if (!styleDeclaration.fontStyle) {\r\n        styleDeclaration.fontStyle = this.fontStyle;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {Number} lineIndex\r\n     * @param {Number} charIndex\r\n     */\r\n    _getStyleDeclaration: function(lineIndex, charIndex) {\r\n      return (this.styles[lineIndex] && this.styles[lineIndex][charIndex])\r\n        ? clone(this.styles[lineIndex][charIndex])\r\n        : { };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _getWidthOfChar: function(ctx, _char, lineIndex, charIndex) {\r\n      if (this.textAlign === 'justify' && /\\s/.test(_char)) {\r\n        return this._getWidthOfSpace(ctx, lineIndex);\r\n      }\r\n\r\n      var styleDeclaration = this._getStyleDeclaration(lineIndex, charIndex);\r\n      this._applyFontStyles(styleDeclaration);\r\n      var cacheProp = this._getCacheProp(_char, styleDeclaration);\r\n\r\n      if (this._charWidthsCache[cacheProp] && this.caching) {\r\n        return this._charWidthsCache[cacheProp];\r\n      }\r\n      else if (ctx) {\r\n        ctx.save();\r\n        var width = this._applyCharStylesGetWidth(ctx, _char, lineIndex, charIndex);\r\n        ctx.restore();\r\n        return width;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _getHeightOfChar: function(ctx, _char, lineIndex, charIndex) {\r\n      if (this.styles[lineIndex] && this.styles[lineIndex][charIndex]) {\r\n        return this.styles[lineIndex][charIndex].fontSize || this.fontSize;\r\n      }\r\n      return this.fontSize;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _getHeightOfCharAt: function(ctx, lineIndex, charIndex) {\r\n      var _char = this._textLines[lineIndex][charIndex];\r\n      return this._getHeightOfChar(ctx, _char, lineIndex, charIndex);\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _getWidthOfCharsAt: function(ctx, lineIndex, charIndex) {\r\n      var width = 0, i, _char;\r\n      for (i = 0; i < charIndex; i++) {\r\n        _char = this._textLines[lineIndex][i];\r\n        width += this._getWidthOfChar(ctx, _char, lineIndex, i);\r\n      }\r\n      return width;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _getLineWidth: function(ctx, lineIndex) {\r\n      if (this.__lineWidths[lineIndex]) {\r\n        return this.__lineWidths[lineIndex];\r\n      }\r\n      this.__lineWidths[lineIndex] = this._getWidthOfCharsAt(ctx, lineIndex, this._textLines[lineIndex].length);\r\n      return this.__lineWidths[lineIndex];\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {Number} lineIndex\r\n     */\r\n    _getWidthOfSpace: function (ctx, lineIndex) {\r\n      if (this.__widthOfSpace[lineIndex]) {\r\n        return this.__widthOfSpace[lineIndex];\r\n      }\r\n      var line = this._textLines[lineIndex],\r\n          wordsWidth = this._getWidthOfWords(ctx, line, lineIndex),\r\n          widthDiff = this.width - wordsWidth,\r\n          numSpaces = line.length - line.replace(/\\s+/g, '').length,\r\n          width = widthDiff / numSpaces;\r\n      this.__widthOfSpace[lineIndex] = width;\r\n      return width;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     * @param {Number} line\r\n     * @param {Number} lineIndex\r\n     */\r\n    _getWidthOfWords: function (ctx, line, lineIndex) {\r\n      var width = 0;\r\n\r\n      for (var charIndex = 0; charIndex < line.length; charIndex++) {\r\n        var _char = line[charIndex];\r\n\r\n        if (!_char.match(/\\s/)) {\r\n          width += this._getWidthOfChar(ctx, _char, lineIndex, charIndex);\r\n        }\r\n      }\r\n\r\n      return width;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _getHeightOfLine: function(ctx, lineIndex) {\r\n      if (this.__lineHeights[lineIndex]) {\r\n        return this.__lineHeights[lineIndex];\r\n      }\r\n\r\n      var line = this._textLines[lineIndex],\r\n          maxHeight = this._getHeightOfChar(ctx, line[0], lineIndex, 0);\r\n\r\n      for (var i = 1, len = line.length; i < len; i++) {\r\n        var currentCharHeight = this._getHeightOfChar(ctx, line[i], lineIndex, i);\r\n        if (currentCharHeight > maxHeight) {\r\n          maxHeight = currentCharHeight;\r\n        }\r\n      }\r\n      this.__maxFontHeights[lineIndex] = maxHeight;\r\n      this.__lineHeights[lineIndex] = maxHeight * this.lineHeight * this._fontSizeMult;\r\n      return this.__lineHeights[lineIndex];\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     * @param {CanvasRenderingContext2D} ctx Context to render on\r\n     */\r\n    _getTextHeight: function(ctx) {\r\n      var height = 0;\r\n      for (var i = 0, len = this._textLines.length; i < len; i++) {\r\n        height += this._getHeightOfLine(ctx, i);\r\n      }\r\n      return height;\r\n    },\r\n\r\n    /**\r\n     * This method is overwritten to account for different top offset\r\n     * @private\r\n     */\r\n    _renderTextBoxBackground: function(ctx) {\r\n      if (!this.backgroundColor) {\r\n        return;\r\n      }\r\n\r\n      ctx.save();\r\n      ctx.fillStyle = this.backgroundColor;\r\n\r\n      ctx.fillRect(\r\n        this._getLeftOffset(),\r\n        this._getTopOffset(),\r\n        this.width,\r\n        this.height\r\n      );\r\n\r\n      ctx.restore();\r\n    },\r\n\r\n    /**\r\n     * Returns object representation of an instance\r\n     * @method toObject\r\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\r\n     * @return {Object} object representation of an instance\r\n     */\r\n    toObject: function(propertiesToInclude) {\r\n      return fabric.util.object.extend(this.callSuper('toObject', propertiesToInclude), {\r\n        styles: clone(this.styles)\r\n      });\r\n    }\r\n  });\r\n\r\n  /**\r\n   * Returns fabric.IText instance from an object representation\r\n   * @static\r\n   * @memberOf fabric.IText\r\n   * @param {Object} object Object to create an instance from\r\n   * @return {fabric.IText} instance of fabric.IText\r\n   */\r\n  fabric.IText.fromObject = function(object) {\r\n    return new fabric.IText(object.text, clone(object));\r\n  };\r\n})();\r\n\r\n\r\n(function() {\r\n\r\n  var clone = fabric.util.object.clone;\r\n\r\n  fabric.util.object.extend(fabric.IText.prototype, /** @lends fabric.IText.prototype */ {\r\n\r\n    /**\r\n     * Initializes all the interactive behavior of IText\r\n     */\r\n    initBehavior: function() {\r\n      this.initAddedHandler();\r\n      this.initRemovedHandler();\r\n      this.initCursorSelectionHandlers();\r\n      this.initDoubleClickSimulation();\r\n    },\r\n\r\n    /**\r\n     * Initializes \"selected\" event handler\r\n     */\r\n    initSelectedHandler: function() {\r\n      this.on('selected', function() {\r\n\r\n        var _this = this;\r\n        setTimeout(function() {\r\n          _this.selected = true;\r\n        }, 100);\r\n      });\r\n    },\r\n\r\n    /**\r\n     * Initializes \"added\" event handler\r\n     */\r\n    initAddedHandler: function() {\r\n      var _this = this;\r\n      this.on('added', function() {\r\n        if (this.canvas && !this.canvas._hasITextHandlers) {\r\n          this.canvas._hasITextHandlers = true;\r\n          this._initCanvasHandlers();\r\n        }\r\n\r\n        // Track IText instances per-canvas. Only register in this array once added\r\n        // to a canvas; we don't want to leak a reference to the instance forever\r\n        // simply because it existed at some point.\r\n        //\r\n        // (Might be added to a collection, but not on a canvas.)\r\n        if (_this.canvas) {\r\n          _this.canvas._iTextInstances = _this.canvas._iTextInstances || [];\r\n          _this.canvas._iTextInstances.push(_this);\r\n        }\r\n      });\r\n    },\r\n\r\n    initRemovedHandler: function() {\r\n      var _this = this;\r\n      this.on('removed', function() {\r\n        // (Might be removed from a collection, but not on a canvas.)\r\n        if (_this.canvas) {\r\n          _this.canvas._iTextInstances = _this.canvas._iTextInstances || [];\r\n          fabric.util.removeFromArray(_this.canvas._iTextInstances, _this);\r\n        }\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _initCanvasHandlers: function() {\r\n      var _this = this;\r\n\r\n      this.canvas.on('selection:cleared', function() {\r\n        fabric.IText.prototype.exitEditingOnOthers(_this.canvas);\r\n      });\r\n\r\n      this.canvas.on('mouse:up', function() {\r\n        if (_this.canvas._iTextInstances) {\r\n          _this.canvas._iTextInstances.forEach(function(obj) {\r\n            obj.__isMousedown = false;\r\n          });\r\n        }\r\n      });\r\n\r\n      this.canvas.on('object:selected', function() {\r\n        fabric.IText.prototype.exitEditingOnOthers(_this.canvas);\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _tick: function() {\r\n      this._currentTickState = this._animateCursor(this, 1, this.cursorDuration, '_onTickComplete');\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _animateCursor: function(obj, targetOpacity, duration, completeMethod) {\r\n\r\n      var tickState;\r\n\r\n      tickState = {\r\n        isAborted: false,\r\n        abort: function() {\r\n          this.isAborted = true;\r\n        },\r\n      };\r\n\r\n      obj.animate('_currentCursorOpacity', targetOpacity, {\r\n        duration: duration,\r\n        onComplete: function() {\r\n          if (!tickState.isAborted) {\r\n            obj[completeMethod]();\r\n          }\r\n        },\r\n        onChange: function() {\r\n          if (obj.canvas) {\r\n            obj.canvas.clearContext(obj.canvas.contextTop || obj.ctx);\r\n            obj.renderCursorOrSelection();\r\n          }\r\n        },\r\n        abort: function() {\r\n          return tickState.isAborted;\r\n        }\r\n      });\r\n      return tickState;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _onTickComplete: function() {\r\n\r\n      var _this = this;\r\n\r\n      if (this._cursorTimeout1) {\r\n        clearTimeout(this._cursorTimeout1);\r\n      }\r\n      this._cursorTimeout1 = setTimeout(function() {\r\n        _this._currentTickCompleteState = _this._animateCursor(_this, 0, this.cursorDuration / 2, '_tick');\r\n      }, 100);\r\n    },\r\n\r\n    /**\r\n     * Initializes delayed cursor\r\n     */\r\n    initDelayedCursor: function(restart) {\r\n      var _this = this,\r\n          delay = restart ? 0 : this.cursorDelay;\r\n\r\n      this._currentTickState && this._currentTickState.abort();\r\n      this._currentTickCompleteState && this._currentTickCompleteState.abort();\r\n      clearTimeout(this._cursorTimeout1);\r\n      this._currentCursorOpacity = 1;\r\n      if (this.canvas) {\r\n        this.canvas.clearContext(this.canvas.contextTop || this.ctx);\r\n        this.renderCursorOrSelection();\r\n      }\r\n      if (this._cursorTimeout2) {\r\n        clearTimeout(this._cursorTimeout2);\r\n      }\r\n      this._cursorTimeout2 = setTimeout(function() {\r\n        _this._tick();\r\n      }, delay);\r\n    },\r\n\r\n    /**\r\n     * Aborts cursor animation and clears all timeouts\r\n     */\r\n    abortCursorAnimation: function() {\r\n      this._currentTickState && this._currentTickState.abort();\r\n      this._currentTickCompleteState && this._currentTickCompleteState.abort();\r\n\r\n      clearTimeout(this._cursorTimeout1);\r\n      clearTimeout(this._cursorTimeout2);\r\n\r\n      this._currentCursorOpacity = 0;\r\n      this.canvas && this.canvas.clearContext(this.canvas.contextTop || this.ctx);\r\n    },\r\n\r\n    /**\r\n     * Selects entire text\r\n     */\r\n    selectAll: function() {\r\n      this.setSelectionStart(0);\r\n      this.setSelectionEnd(this.text.length);\r\n    },\r\n\r\n    /**\r\n     * Returns selected text\r\n     * @return {String}\r\n     */\r\n    getSelectedText: function() {\r\n      return this.text.slice(this.selectionStart, this.selectionEnd);\r\n    },\r\n\r\n    /**\r\n     * Find new selection index representing start of current word according to current selection index\r\n     * @param {Number} startFrom Surrent selection index\r\n     * @return {Number} New selection index\r\n     */\r\n    findWordBoundaryLeft: function(startFrom) {\r\n      var offset = 0, index = startFrom - 1;\r\n\r\n      // remove space before cursor first\r\n      if (this._reSpace.test(this.text.charAt(index))) {\r\n        while (this._reSpace.test(this.text.charAt(index))) {\r\n          offset++;\r\n          index--;\r\n        }\r\n      }\r\n      while (/\\S/.test(this.text.charAt(index)) && index > -1) {\r\n        offset++;\r\n        index--;\r\n      }\r\n\r\n      return startFrom - offset;\r\n    },\r\n\r\n    /**\r\n     * Find new selection index representing end of current word according to current selection index\r\n     * @param {Number} startFrom Current selection index\r\n     * @return {Number} New selection index\r\n     */\r\n    findWordBoundaryRight: function(startFrom) {\r\n      var offset = 0, index = startFrom;\r\n\r\n      // remove space after cursor first\r\n      if (this._reSpace.test(this.text.charAt(index))) {\r\n        while (this._reSpace.test(this.text.charAt(index))) {\r\n          offset++;\r\n          index++;\r\n        }\r\n      }\r\n      while (/\\S/.test(this.text.charAt(index)) && index < this.text.length) {\r\n        offset++;\r\n        index++;\r\n      }\r\n\r\n      return startFrom + offset;\r\n    },\r\n\r\n    /**\r\n     * Find new selection index representing start of current line according to current selection index\r\n     * @param {Number} startFrom Current selection index\r\n     * @return {Number} New selection index\r\n     */\r\n    findLineBoundaryLeft: function(startFrom) {\r\n      var offset = 0, index = startFrom - 1;\r\n\r\n      while (!/\\n/.test(this.text.charAt(index)) && index > -1) {\r\n        offset++;\r\n        index--;\r\n      }\r\n\r\n      return startFrom - offset;\r\n    },\r\n\r\n    /**\r\n     * Find new selection index representing end of current line according to current selection index\r\n     * @param {Number} startFrom Current selection index\r\n     * @return {Number} New selection index\r\n     */\r\n    findLineBoundaryRight: function(startFrom) {\r\n      var offset = 0, index = startFrom;\r\n\r\n      while (!/\\n/.test(this.text.charAt(index)) && index < this.text.length) {\r\n        offset++;\r\n        index++;\r\n      }\r\n\r\n      return startFrom + offset;\r\n    },\r\n\r\n    /**\r\n     * Returns number of newlines in selected text\r\n     * @return {Number} Number of newlines in selected text\r\n     */\r\n    getNumNewLinesInSelectedText: function() {\r\n      var selectedText = this.getSelectedText(),\r\n          numNewLines = 0;\r\n\r\n      for (var i = 0, chars = selectedText.split(''), len = chars.length; i < len; i++) {\r\n        if (chars[i] === '\\n') {\r\n          numNewLines++;\r\n        }\r\n      }\r\n      return numNewLines;\r\n    },\r\n\r\n    /**\r\n     * Finds index corresponding to beginning or end of a word\r\n     * @param {Number} selectionStart Index of a character\r\n     * @param {Number} direction: 1 or -1\r\n     * @return {Number} Index of the beginning or end of a word\r\n     */\r\n    searchWordBoundary: function(selectionStart, direction) {\r\n      var index = this._reSpace.test(this.text.charAt(selectionStart)) ? selectionStart - 1 : selectionStart,\r\n          _char = this.text.charAt(index),\r\n          reNonWord = /[ \\n\\.,;!\\?\\-]/;\r\n\r\n      while (!reNonWord.test(_char) && index > 0 && index < this.text.length) {\r\n        index += direction;\r\n        _char = this.text.charAt(index);\r\n      }\r\n      if (reNonWord.test(_char) && _char !== '\\n') {\r\n        index += direction === 1 ? 0 : 1;\r\n      }\r\n      return index;\r\n    },\r\n\r\n    /**\r\n     * Selects a word based on the index\r\n     * @param {Number} selectionStart Index of a character\r\n     */\r\n    selectWord: function(selectionStart) {\r\n      var newSelectionStart = this.searchWordBoundary(selectionStart, -1), /* search backwards */\r\n          newSelectionEnd = this.searchWordBoundary(selectionStart, 1); /* search forward */\r\n\r\n      this.setSelectionStart(newSelectionStart);\r\n      this.setSelectionEnd(newSelectionEnd);\r\n    },\r\n\r\n    /**\r\n     * Selects a line based on the index\r\n     * @param {Number} selectionStart Index of a character\r\n     */\r\n    selectLine: function(selectionStart) {\r\n      var newSelectionStart = this.findLineBoundaryLeft(selectionStart),\r\n          newSelectionEnd = this.findLineBoundaryRight(selectionStart);\r\n\r\n      this.setSelectionStart(newSelectionStart);\r\n      this.setSelectionEnd(newSelectionEnd);\r\n    },\r\n\r\n    /**\r\n     * Enters editing state\r\n     * @return {fabric.IText} thisArg\r\n     * @chainable\r\n     */\r\n    enterEditing: function() {\r\n      if (this.isEditing || !this.editable) {\r\n        return;\r\n      }\r\n\r\n      if (this.canvas) {\r\n        this.exitEditingOnOthers(this.canvas);\r\n      }\r\n\r\n      this.isEditing = true;\r\n\r\n      this.initHiddenTextarea();\r\n      this.hiddenTextarea.focus();\r\n      this._updateTextarea();\r\n      this._saveEditingProps();\r\n      this._setEditingProps();\r\n\r\n      this._tick();\r\n      this.fire('editing:entered');\r\n\r\n      if (!this.canvas) {\r\n        return this;\r\n      }\r\n\r\n      this.canvas.renderAll();\r\n      this.canvas.fire('text:editing:entered', { target: this });\r\n      this.initMouseMoveHandler();\r\n      return this;\r\n    },\r\n\r\n    exitEditingOnOthers: function(canvas) {\r\n      if (canvas._iTextInstances) {\r\n        canvas._iTextInstances.forEach(function(obj) {\r\n          obj.selected = false;\r\n          if (obj.isEditing) {\r\n            obj.exitEditing();\r\n          }\r\n        });\r\n      }\r\n    },\r\n\r\n    /**\r\n    * Initializes \"mousemove\" event handler\r\n    */\r\n    initMouseMoveHandler: function() {\r\n      var _this = this;\r\n      this.canvas.on('mouse:move',  function(options) {\r\n        if (!_this.__isMousedown || !_this.isEditing) {\r\n          return;\r\n        }\r\n\r\n        var newSelectionStart = _this.getSelectionStartFromPointer(options.e);\r\n        if (newSelectionStart >= _this.__selectionStartOnMouseDown) {\r\n          _this.setSelectionStart(_this.__selectionStartOnMouseDown);\r\n          _this.setSelectionEnd(newSelectionStart);\r\n        }\r\n        else {\r\n          _this.setSelectionStart(newSelectionStart);\r\n          _this.setSelectionEnd(_this.__selectionStartOnMouseDown);\r\n        }\r\n      });\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _setEditingProps: function() {\r\n      this.hoverCursor = 'text';\r\n\r\n      if (this.canvas) {\r\n        this.canvas.defaultCursor = this.canvas.moveCursor = 'text';\r\n      }\r\n\r\n      this.borderColor = this.editingBorderColor;\r\n\r\n      this.hasControls = this.selectable = false;\r\n      this.lockMovementX = this.lockMovementY = true;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _updateTextarea: function() {\r\n      if (!this.hiddenTextarea) {\r\n        return;\r\n      }\r\n\r\n      this.hiddenTextarea.value = this.text;\r\n      this.hiddenTextarea.selectionStart = this.selectionStart;\r\n      this.hiddenTextarea.selectionEnd = this.selectionEnd;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _saveEditingProps: function() {\r\n      this._savedProps = {\r\n        hasControls: this.hasControls,\r\n        borderColor: this.borderColor,\r\n        lockMovementX: this.lockMovementX,\r\n        lockMovementY: this.lockMovementY,\r\n        hoverCursor: this.hoverCursor,\r\n        defaultCursor: this.canvas && this.canvas.defaultCursor,\r\n        moveCursor: this.canvas && this.canvas.moveCursor\r\n      };\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _restoreEditingProps: function() {\r\n      if (!this._savedProps) {\r\n        return;\r\n      }\r\n\r\n      this.hoverCursor = this._savedProps.overCursor;\r\n      this.hasControls = this._savedProps.hasControls;\r\n      this.borderColor = this._savedProps.borderColor;\r\n      this.lockMovementX = this._savedProps.lockMovementX;\r\n      this.lockMovementY = this._savedProps.lockMovementY;\r\n\r\n      if (this.canvas) {\r\n        this.canvas.defaultCursor = this._savedProps.defaultCursor;\r\n        this.canvas.moveCursor = this._savedProps.moveCursor;\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Exits from editing state\r\n     * @return {fabric.IText} thisArg\r\n     * @chainable\r\n     */\r\n    exitEditing: function() {\r\n\r\n      this.selected = false;\r\n      this.isEditing = false;\r\n      this.selectable = true;\r\n\r\n      this.selectionEnd = this.selectionStart;\r\n      this.hiddenTextarea && this.canvas && this.hiddenTextarea.parentNode.removeChild(this.hiddenTextarea);\r\n      this.hiddenTextarea = null;\r\n\r\n      this.abortCursorAnimation();\r\n      this._restoreEditingProps();\r\n      this._currentCursorOpacity = 0;\r\n\r\n      this.fire('editing:exited');\r\n      this.canvas && this.canvas.fire('text:editing:exited', { target: this });\r\n\r\n      return this;\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _removeExtraneousStyles: function() {\r\n      for (var prop in this.styles) {\r\n        if (!this._textLines[prop]) {\r\n          delete this.styles[prop];\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _removeCharsFromTo: function(start, end) {\r\n\r\n      var i = end;\r\n      while (i !== start) {\r\n\r\n        var prevIndex = this.get2DCursorLocation(i).charIndex;\r\n        i--;\r\n\r\n        var index = this.get2DCursorLocation(i).charIndex,\r\n            isNewline = index > prevIndex;\r\n\r\n        if (isNewline) {\r\n          this.removeStyleObject(isNewline, i + 1);\r\n        }\r\n        else {\r\n          this.removeStyleObject(this.get2DCursorLocation(i).charIndex === 0, i);\r\n        }\r\n\r\n      }\r\n\r\n      this.text = this.text.slice(0, start) +\r\n                  this.text.slice(end);\r\n      this._clearCache();\r\n    },\r\n\r\n    /**\r\n     * Inserts a character where cursor is (replacing selection if one exists)\r\n     * @param {String} _chars Characters to insert\r\n     */\r\n    insertChars: function(_chars, useCopiedStyle) {\r\n      var isEndOfLine = this.text.slice(this.selectionStart, this.selectionStart + 1) === '\\n';\r\n\r\n      this.text = this.text.slice(0, this.selectionStart) +\r\n                    _chars +\r\n                  this.text.slice(this.selectionEnd);\r\n\r\n      if (this.selectionStart === this.selectionEnd) {\r\n        this.insertStyleObjects(_chars, isEndOfLine, useCopiedStyle);\r\n      }\r\n      // else if (this.selectionEnd - this.selectionStart > 1) {\r\n      // TODO: replace styles properly\r\n      // console.log('replacing MORE than 1 char');\r\n      // }\r\n      this.setSelectionStart(this.selectionStart + _chars.length);\r\n      this.setSelectionEnd(this.selectionStart);\r\n      this._clearCache();\r\n      this.canvas && this.canvas.renderAll();\r\n\r\n      this.setCoords();\r\n      this.fire('changed');\r\n      this.canvas && this.canvas.fire('text:changed', { target: this });\r\n    },\r\n\r\n    /**\r\n     * Inserts new style object\r\n     * @param {Number} lineIndex Index of a line\r\n     * @param {Number} charIndex Index of a char\r\n     * @param {Boolean} isEndOfLine True if it's end of line\r\n     */\r\n    insertNewlineStyleObject: function(lineIndex, charIndex, isEndOfLine) {\r\n\r\n      this.shiftLineStyles(lineIndex, +1);\r\n\r\n      if (!this.styles[lineIndex + 1]) {\r\n        this.styles[lineIndex + 1] = { };\r\n      }\r\n\r\n      var currentCharStyle = this.styles[lineIndex][charIndex - 1],\r\n          newLineStyles = { };\r\n\r\n      // if there's nothing after cursor,\r\n      // we clone current char style onto the next (otherwise empty) line\r\n      if (isEndOfLine) {\r\n        newLineStyles[0] = clone(currentCharStyle);\r\n        this.styles[lineIndex + 1] = newLineStyles;\r\n      }\r\n      // otherwise we clone styles of all chars\r\n      // after cursor onto the next line, from the beginning\r\n      else {\r\n        for (var index in this.styles[lineIndex]) {\r\n          if (parseInt(index, 10) >= charIndex) {\r\n            newLineStyles[parseInt(index, 10) - charIndex] = this.styles[lineIndex][index];\r\n            // remove lines from the previous line since they're on a new line now\r\n            delete this.styles[lineIndex][index];\r\n          }\r\n        }\r\n        this.styles[lineIndex + 1] = newLineStyles;\r\n      }\r\n      this._clearCache();\r\n    },\r\n\r\n    /**\r\n     * Inserts style object for a given line/char index\r\n     * @param {Number} lineIndex Index of a line\r\n     * @param {Number} charIndex Index of a char\r\n     * @param {Object} [style] Style object to insert, if given\r\n     */\r\n    insertCharStyleObject: function(lineIndex, charIndex, style) {\r\n\r\n      var currentLineStyles = this.styles[lineIndex],\r\n          currentLineStylesCloned = clone(currentLineStyles);\r\n\r\n      if (charIndex === 0 && !style) {\r\n        charIndex = 1;\r\n      }\r\n\r\n      // shift all char styles by 1 forward\r\n      // 0,1,2,3 -> (charIndex=2) -> 0,1,3,4 -> (insert 2) -> 0,1,2,3,4\r\n      for (var index in currentLineStylesCloned) {\r\n        var numericIndex = parseInt(index, 10);\r\n        if (numericIndex >= charIndex) {\r\n          currentLineStyles[numericIndex + 1] = currentLineStylesCloned[numericIndex];\r\n          //delete currentLineStyles[index];\r\n        }\r\n      }\r\n\r\n      this.styles[lineIndex][charIndex] =\r\n        style || clone(currentLineStyles[charIndex - 1]);\r\n      this._clearCache();\r\n    },\r\n\r\n    /**\r\n     * Inserts style object(s)\r\n     * @param {String} _chars Characters at the location where style is inserted\r\n     * @param {Boolean} isEndOfLine True if it's end of line\r\n     * @param {Boolean} [useCopiedStyle] Style to insert\r\n     */\r\n    insertStyleObjects: function(_chars, isEndOfLine, useCopiedStyle) {\r\n      // removed shortcircuit over isEmptyStyles\r\n\r\n      var cursorLocation = this.get2DCursorLocation(),\r\n          lineIndex = cursorLocation.lineIndex,\r\n          charIndex = cursorLocation.charIndex;\r\n\r\n      if (!this.styles[lineIndex]) {\r\n        this.styles[lineIndex] = { };\r\n      }\r\n\r\n      if (_chars === '\\n') {\r\n        this.insertNewlineStyleObject(lineIndex, charIndex, isEndOfLine);\r\n      }\r\n      else {\r\n        if (useCopiedStyle) {\r\n          this._insertStyles(this.copiedStyles);\r\n        }\r\n        else {\r\n          // TODO: support multiple style insertion if _chars.length > 1\r\n          this.insertCharStyleObject(lineIndex, charIndex);\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * @private\r\n     */\r\n    _insertStyles: function(styles) {\r\n      for (var i = 0, len = styles.length; i < len; i++) {\r\n\r\n        var cursorLocation = this.get2DCursorLocation(this.selectionStart + i),\r\n            lineIndex = cursorLocation.lineIndex,\r\n            charIndex = cursorLocation.charIndex;\r\n\r\n        this.insertCharStyleObject(lineIndex, charIndex, styles[i]);\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Shifts line styles up or down\r\n     * @param {Number} lineIndex Index of a line\r\n     * @param {Number} offset Can be -1 or +1\r\n     */\r\n    shiftLineStyles: function(lineIndex, offset) {\r\n      // shift all line styles by 1 upward\r\n      var clonedStyles = clone(this.styles);\r\n      for (var line in this.styles) {\r\n        var numericLine = parseInt(line, 10);\r\n        if (numericLine > lineIndex) {\r\n          this.styles[numericLine + offset] = clonedStyles[numericLine];\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Removes style object\r\n     * @param {Boolean} isBeginningOfLine True if cursor is at the beginning of line\r\n     * @param {Number} [index] Optional index. When not given, current selectionStart is used.\r\n     */\r\n    removeStyleObject: function(isBeginningOfLine, index) {\r\n\r\n      var cursorLocation = this.get2DCursorLocation(index),\r\n          lineIndex = cursorLocation.lineIndex,\r\n          charIndex = cursorLocation.charIndex;\r\n\r\n      if (isBeginningOfLine) {\r\n\r\n        var textOnPreviousLine = this._textLines[lineIndex - 1],\r\n            newCharIndexOnPrevLine = textOnPreviousLine\r\n              ? textOnPreviousLine.length\r\n              : 0;\r\n\r\n        if (!this.styles[lineIndex - 1]) {\r\n          this.styles[lineIndex - 1] = { };\r\n        }\r\n\r\n        for (charIndex in this.styles[lineIndex]) {\r\n          this.styles[lineIndex - 1][parseInt(charIndex, 10) + newCharIndexOnPrevLine]\r\n            = this.styles[lineIndex][charIndex];\r\n        }\r\n\r\n        this.shiftLineStyles(lineIndex, -1);\r\n      }\r\n      else {\r\n        var currentLineStyles = this.styles[lineIndex];\r\n\r\n        if (currentLineStyles) {\r\n          var offset = this.selectionStart === this.selectionEnd ? -1 : 0;\r\n          delete currentLineStyles[charIndex + offset];\r\n          // console.log('deleting', lineIndex, charIndex + offset);\r\n        }\r\n\r\n        var currentLineStylesCloned = clone(currentLineStyles);\r\n\r\n        // shift all styles by 1 backwards\r\n        for (var i in currentLineStylesCloned) {\r\n          var numericIndex = parseInt(i, 10);\r\n          if (numericIndex >= charIndex && numericIndex !== 0) {\r\n            currentLineStyles[numericIndex - 1] = currentLineStylesCloned[numericIndex];\r\n            delete currentLineStyles[numericIndex];\r\n          }\r\n        }\r\n      }\r\n    },\r\n\r\n    /**\r\n     * Inserts new line\r\n     */\r\n    insertNewline: function() {\r\n      this.insertChars('\\n');\r\n    }\r\n  });\r\n})();\r\n\r\n\r\nfabric.util.object.extend(fabric.IText.prototype, /** @lends fabric.IText.prototype */ {\r\n  /**\r\n   * Initializes \"dbclick\" event handler\r\n   */\r\n  initDoubleClickSimulation: function() {\r\n\r\n    // for double click\r\n    this.__lastClickTime = +new Date();\r\n\r\n    // for triple click\r\n    this.__lastLastClickTime = +new Date();\r\n\r\n    this.__lastPointer = { };\r\n\r\n    this.on('mousedown', this.onMouseDown.bind(this));\r\n  },\r\n\r\n  onMouseDown: function(options) {\r\n\r\n    this.__newClickTime = +new Date();\r\n    var newPointer = this.canvas.getPointer(options.e);\r\n\r\n    if (this.isTripleClick(newPointer)) {\r\n      this.fire('tripleclick', options);\r\n      this._stopEvent(options.e);\r\n    }\r\n    else if (this.isDoubleClick(newPointer)) {\r\n      this.fire('dblclick', options);\r\n      this._stopEvent(options.e);\r\n    }\r\n\r\n    this.__lastLastClickTime = this.__lastClickTime;\r\n    this.__lastClickTime = this.__newClickTime;\r\n    this.__lastPointer = newPointer;\r\n    this.__lastIsEditing = this.isEditing;\r\n    this.__lastSelected = this.selected;\r\n  },\r\n\r\n  isDoubleClick: function(newPointer) {\r\n    return this.__newClickTime - this.__lastClickTime < 500 &&\r\n        this.__lastPointer.x === newPointer.x &&\r\n        this.__lastPointer.y === newPointer.y && this.__lastIsEditing;\r\n  },\r\n\r\n  isTripleClick: function(newPointer) {\r\n    return this.__newClickTime - this.__lastClickTime < 500 &&\r\n        this.__lastClickTime - this.__lastLastClickTime < 500 &&\r\n        this.__lastPointer.x === newPointer.x &&\r\n        this.__lastPointer.y === newPointer.y;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _stopEvent: function(e) {\r\n    e.preventDefault && e.preventDefault();\r\n    e.stopPropagation && e.stopPropagation();\r\n  },\r\n\r\n  /**\r\n   * Initializes event handlers related to cursor or selection\r\n   */\r\n  initCursorSelectionHandlers: function() {\r\n    this.initSelectedHandler();\r\n    this.initMousedownHandler();\r\n    this.initMouseupHandler();\r\n    this.initClicks();\r\n  },\r\n\r\n  /**\r\n   * Initializes double and triple click event handlers\r\n   */\r\n  initClicks: function() {\r\n    this.on('dblclick', function(options) {\r\n      this.selectWord(this.getSelectionStartFromPointer(options.e));\r\n    });\r\n    this.on('tripleclick', function(options) {\r\n      this.selectLine(this.getSelectionStartFromPointer(options.e));\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Initializes \"mousedown\" event handler\r\n   */\r\n  initMousedownHandler: function() {\r\n    this.on('mousedown', function(options) {\r\n\r\n      var pointer = this.canvas.getPointer(options.e);\r\n\r\n      this.__mousedownX = pointer.x;\r\n      this.__mousedownY = pointer.y;\r\n      this.__isMousedown = true;\r\n\r\n      if (this.hiddenTextarea && this.canvas) {\r\n        this.canvas.wrapperEl.appendChild(this.hiddenTextarea);\r\n      }\r\n\r\n      if (this.selected) {\r\n        this.setCursorByClick(options.e);\r\n      }\r\n\r\n      if (this.isEditing) {\r\n        this.__selectionStartOnMouseDown = this.selectionStart;\r\n        this.initDelayedCursor(true);\r\n      }\r\n    });\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _isObjectMoved: function(e) {\r\n    var pointer = this.canvas.getPointer(e);\r\n\r\n    return this.__mousedownX !== pointer.x ||\r\n           this.__mousedownY !== pointer.y;\r\n  },\r\n\r\n  /**\r\n   * Initializes \"mouseup\" event handler\r\n   */\r\n  initMouseupHandler: function() {\r\n    this.on('mouseup', function(options) {\r\n      this.__isMousedown = false;\r\n      if (this._isObjectMoved(options.e)) {\r\n        return;\r\n      }\r\n\r\n      if (this.__lastSelected) {\r\n        this.enterEditing();\r\n        this.initDelayedCursor(true);\r\n      }\r\n      this.selected = true;\r\n    });\r\n  },\r\n\r\n  /**\r\n   * Changes cursor location in a text depending on passed pointer (x/y) object\r\n   * @param {Event} e Event object\r\n   */\r\n  setCursorByClick: function(e) {\r\n    var newSelectionStart = this.getSelectionStartFromPointer(e);\r\n\r\n    if (e.shiftKey) {\r\n      if (newSelectionStart < this.selectionStart) {\r\n        this.setSelectionEnd(this.selectionStart);\r\n        this.setSelectionStart(newSelectionStart);\r\n      }\r\n      else {\r\n        this.setSelectionEnd(newSelectionStart);\r\n      }\r\n    }\r\n    else {\r\n      this.setSelectionStart(newSelectionStart);\r\n      this.setSelectionEnd(newSelectionStart);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {Event} e Event object\r\n   * @return {Object} Coordinates of a pointer (x, y)\r\n   */\r\n  _getLocalRotatedPointer: function(e) {\r\n    var pointer = this.canvas.getPointer(e),\r\n\r\n        pClicked = new fabric.Point(pointer.x, pointer.y),\r\n        pLeftTop = new fabric.Point(this.left, this.top),\r\n\r\n        rotated = fabric.util.rotatePoint(\r\n          pClicked, pLeftTop, fabric.util.degreesToRadians(-this.angle));\r\n\r\n    return this.getLocalPointer(e, rotated);\r\n  },\r\n\r\n  /**\r\n   * Returns index of a character corresponding to where an object was clicked\r\n   * @param {Event} e Event object\r\n   * @return {Number} Index of a character\r\n   */\r\n  getSelectionStartFromPointer: function(e) {\r\n    var mouseOffset = this._getLocalRotatedPointer(e),\r\n        prevWidth = 0,\r\n        width = 0,\r\n        height = 0,\r\n        charIndex = 0,\r\n        newSelectionStart,\r\n        line;\r\n\r\n    for (var i = 0, len = this._textLines.length; i < len; i++) {\r\n      line = this._textLines[i].split('');\r\n      height += this._getHeightOfLine(this.ctx, i) * this.scaleY;\r\n\r\n      var widthOfLine = this._getLineWidth(this.ctx, i),\r\n          lineLeftOffset = this._getLineLeftOffset(widthOfLine);\r\n\r\n      width = lineLeftOffset * this.scaleX;\r\n\r\n      if (this.flipX) {\r\n        // when oject is horizontally flipped we reverse chars\r\n        this._textLines[i] = line.reverse().join('');\r\n      }\r\n\r\n      for (var j = 0, jlen = line.length; j < jlen; j++) {\r\n\r\n        var _char = line[j];\r\n        prevWidth = width;\r\n\r\n        width += this._getWidthOfChar(this.ctx, _char, i, this.flipX ? jlen - j : j) *\r\n                 this.scaleX;\r\n\r\n        if (height <= mouseOffset.y || width <= mouseOffset.x) {\r\n          charIndex++;\r\n          continue;\r\n        }\r\n\r\n        return this._getNewSelectionStartFromOffset(\r\n          mouseOffset, prevWidth, width, charIndex + i, jlen);\r\n      }\r\n\r\n      if (mouseOffset.y < height) {\r\n        return this._getNewSelectionStartFromOffset(\r\n          mouseOffset, prevWidth, width, charIndex + i, jlen);\r\n      }\r\n    }\r\n\r\n    // clicked somewhere after all chars, so set at the end\r\n    if (typeof newSelectionStart === 'undefined') {\r\n      return this.text.length;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _getNewSelectionStartFromOffset: function(mouseOffset, prevWidth, width, index, jlen) {\r\n\r\n    var distanceBtwLastCharAndCursor = mouseOffset.x - prevWidth,\r\n        distanceBtwNextCharAndCursor = width - mouseOffset.x,\r\n        offset = distanceBtwNextCharAndCursor > distanceBtwLastCharAndCursor ? 0 : 1,\r\n        newSelectionStart = index + offset;\r\n\r\n    // if object is horizontally flipped, mirror cursor location from the end\r\n    if (this.flipX) {\r\n      newSelectionStart = jlen - newSelectionStart;\r\n    }\r\n\r\n    if (newSelectionStart > this.text.length) {\r\n      newSelectionStart = this.text.length;\r\n    }\r\n\r\n    return newSelectionStart;\r\n  }\r\n});\r\n\r\n\r\nfabric.util.object.extend(fabric.IText.prototype, /** @lends fabric.IText.prototype */ {\r\n\r\n  /**\r\n   * Initializes hidden textarea (needed to bring up keyboard in iOS)\r\n   */\r\n  initHiddenTextarea: function() {\r\n    this.hiddenTextarea = fabric.document.createElement('textarea');\r\n\r\n    this.hiddenTextarea.setAttribute('autocapitalize', 'off');\r\n    this.hiddenTextarea.style.cssText = 'position: fixed; bottom: 20px; left: 0px; opacity: 0;'\r\n                                        + ' width: 0px; height: 0px; z-index: -999;';\r\n    fabric.document.body.appendChild(this.hiddenTextarea);\r\n\r\n    fabric.util.addListener(this.hiddenTextarea, 'keydown', this.onKeyDown.bind(this));\r\n    fabric.util.addListener(this.hiddenTextarea, 'keypress', this.onKeyPress.bind(this));\r\n    fabric.util.addListener(this.hiddenTextarea, 'copy', this.copy.bind(this));\r\n    fabric.util.addListener(this.hiddenTextarea, 'paste', this.paste.bind(this));\r\n\r\n    if (!this._clickHandlerInitialized && this.canvas) {\r\n      fabric.util.addListener(this.canvas.upperCanvasEl, 'click', this.onClick.bind(this));\r\n      this._clickHandlerInitialized = true;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _keysMap: {\r\n    8:  'removeChars',\r\n    9:  'exitEditing',\r\n    27: 'exitEditing',\r\n    13: 'insertNewline',\r\n    33: 'moveCursorUp',\r\n    34: 'moveCursorDown',\r\n    35: 'moveCursorRight',\r\n    36: 'moveCursorLeft',\r\n    37: 'moveCursorLeft',\r\n    38: 'moveCursorUp',\r\n    39: 'moveCursorRight',\r\n    40: 'moveCursorDown',\r\n    46: 'forwardDelete'\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _ctrlKeysMap: {\r\n    65: 'selectAll',\r\n    88: 'cut'\r\n  },\r\n\r\n  onClick: function() {\r\n    // No need to trigger click event here, focus is enough to have the keyboard appear on Android\r\n    this.hiddenTextarea && this.hiddenTextarea.focus();\r\n  },\r\n\r\n  /**\r\n   * Handles keyup event\r\n   * @param {Event} e Event object\r\n   */\r\n  onKeyDown: function(e) {\r\n    if (!this.isEditing) {\r\n      return;\r\n    }\r\n    if (e.keyCode in this._keysMap) {\r\n      this[this._keysMap[e.keyCode]](e);\r\n    }\r\n    else if ((e.keyCode in this._ctrlKeysMap) && (e.ctrlKey || e.metaKey)) {\r\n      this[this._ctrlKeysMap[e.keyCode]](e);\r\n    }\r\n    else {\r\n      return;\r\n    }\r\n    e.stopImmediatePropagation();\r\n    e.preventDefault();\r\n    this.canvas && this.canvas.renderAll();\r\n  },\r\n\r\n  /**\r\n   * Forward delete\r\n   */\r\n  forwardDelete: function(e) {\r\n    if (this.selectionStart === this.selectionEnd) {\r\n      this.moveCursorRight(e);\r\n    }\r\n    this.removeChars(e);\r\n  },\r\n\r\n  /**\r\n   * Copies selected text\r\n   * @param {Event} e Event object\r\n   */\r\n  copy: function(e) {\r\n    var selectedText = this.getSelectedText(),\r\n        clipboardData = this._getClipboardData(e);\r\n\r\n    // Check for backward compatibility with old browsers\r\n    if (clipboardData) {\r\n      clipboardData.setData('text', selectedText);\r\n    }\r\n\r\n    this.copiedText = selectedText;\r\n    this.copiedStyles = this.getSelectionStyles(\r\n                          this.selectionStart,\r\n                          this.selectionEnd);\r\n  },\r\n\r\n  /**\r\n   * Pastes text\r\n   * @param {Event} e Event object\r\n   */\r\n  paste: function(e) {\r\n    var copiedText = null,\r\n        clipboardData = this._getClipboardData(e);\r\n\r\n    // Check for backward compatibility with old browsers\r\n    if (clipboardData) {\r\n      copiedText = clipboardData.getData('text');\r\n    }\r\n    else {\r\n      copiedText = this.copiedText;\r\n    }\r\n\r\n    if (copiedText) {\r\n      this.insertChars(copiedText, true);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Cuts text\r\n   * @param {Event} e Event object\r\n   */\r\n  cut: function(e) {\r\n    if (this.selectionStart === this.selectionEnd) {\r\n      return;\r\n    }\r\n\r\n    this.copy();\r\n    this.removeChars(e);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {Event} e Event object\r\n   * @return {Object} Clipboard data object\r\n   */\r\n  _getClipboardData: function(e) {\r\n    return e && (e.clipboardData || fabric.window.clipboardData);\r\n  },\r\n\r\n  /**\r\n   * Handles keypress event\r\n   * @param {Event} e Event object\r\n   */\r\n  onKeyPress: function(e) {\r\n    if (!this.isEditing || e.metaKey || e.ctrlKey) {\r\n      return;\r\n    }\r\n    if (e.which !== 0) {\r\n      this.insertChars(String.fromCharCode(e.which));\r\n    }\r\n    e.stopPropagation();\r\n  },\r\n\r\n  /**\r\n   * Gets start offset of a selection\r\n   * @param {Event} e Event object\r\n   * @param {Boolean} isRight\r\n   * @return {Number}\r\n   */\r\n  getDownCursorOffset: function(e, isRight) {\r\n    var selectionProp = isRight ? this.selectionEnd : this.selectionStart,\r\n        _char, lineLeftOffset,\r\n        textBeforeCursor = this.text.slice(0, selectionProp),\r\n        textAfterCursor = this.text.slice(selectionProp),\r\n\r\n        textOnSameLineBeforeCursor = textBeforeCursor.slice(textBeforeCursor.lastIndexOf('\\n') + 1),\r\n        textOnSameLineAfterCursor = textAfterCursor.match(/(.*)\\n?/)[1],\r\n        textOnNextLine = (textAfterCursor.match(/.*\\n(.*)\\n?/) || { })[1] || '',\r\n\r\n        cursorLocation = this.get2DCursorLocation(selectionProp);\r\n\r\n    // if on last line, down cursor goes to end of line\r\n    if (cursorLocation.lineIndex === this._textLines.length - 1 || e.metaKey || e.keyCode === 34) {\r\n\r\n      // move to the end of a text\r\n      return this.text.length - selectionProp;\r\n    }\r\n\r\n    var widthOfSameLineBeforeCursor = this._getLineWidth(this.ctx, cursorLocation.lineIndex);\r\n    lineLeftOffset = this._getLineLeftOffset(widthOfSameLineBeforeCursor);\r\n\r\n    var widthOfCharsOnSameLineBeforeCursor = lineLeftOffset,\r\n        lineIndex = cursorLocation.lineIndex;\r\n\r\n    for (var i = 0, len = textOnSameLineBeforeCursor.length; i < len; i++) {\r\n      _char = textOnSameLineBeforeCursor[i];\r\n      widthOfCharsOnSameLineBeforeCursor += this._getWidthOfChar(this.ctx, _char, lineIndex, i);\r\n    }\r\n\r\n    var indexOnNextLine = this._getIndexOnNextLine(\r\n      cursorLocation, textOnNextLine, widthOfCharsOnSameLineBeforeCursor);\r\n\r\n    return textOnSameLineAfterCursor.length + 1 + indexOnNextLine;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _getIndexOnNextLine: function(cursorLocation, textOnNextLine, widthOfCharsOnSameLineBeforeCursor) {\r\n    var lineIndex = cursorLocation.lineIndex + 1,\r\n        widthOfNextLine = this._getLineWidth(this.ctx, lineIndex),\r\n        lineLeftOffset = this._getLineLeftOffset(widthOfNextLine),\r\n        widthOfCharsOnNextLine = lineLeftOffset,\r\n        indexOnNextLine = 0,\r\n        foundMatch;\r\n\r\n    for (var j = 0, jlen = textOnNextLine.length; j < jlen; j++) {\r\n\r\n      var _char = textOnNextLine[j],\r\n          widthOfChar = this._getWidthOfChar(this.ctx, _char, lineIndex, j);\r\n\r\n      widthOfCharsOnNextLine += widthOfChar;\r\n\r\n      if (widthOfCharsOnNextLine > widthOfCharsOnSameLineBeforeCursor) {\r\n\r\n        foundMatch = true;\r\n\r\n        var leftEdge = widthOfCharsOnNextLine - widthOfChar,\r\n            rightEdge = widthOfCharsOnNextLine,\r\n            offsetFromLeftEdge = Math.abs(leftEdge - widthOfCharsOnSameLineBeforeCursor),\r\n            offsetFromRightEdge = Math.abs(rightEdge - widthOfCharsOnSameLineBeforeCursor);\r\n\r\n        indexOnNextLine = offsetFromRightEdge < offsetFromLeftEdge ? j + 1 : j;\r\n\r\n        break;\r\n      }\r\n    }\r\n\r\n    // reached end\r\n    if (!foundMatch) {\r\n      indexOnNextLine = textOnNextLine.length;\r\n    }\r\n\r\n    return indexOnNextLine;\r\n  },\r\n\r\n  /**\r\n   * Moves cursor down\r\n   * @param {Event} e Event object\r\n   */\r\n  moveCursorDown: function(e) {\r\n    this.abortCursorAnimation();\r\n    this._currentCursorOpacity = 1;\r\n\r\n    var offset = this.getDownCursorOffset(e, this._selectionDirection === 'right');\r\n\r\n    if (e.shiftKey) {\r\n      this.moveCursorDownWithShift(offset);\r\n    }\r\n    else {\r\n      this.moveCursorDownWithoutShift(offset);\r\n    }\r\n\r\n    this.initDelayedCursor();\r\n  },\r\n\r\n  /**\r\n   * Moves cursor down without keeping selection\r\n   * @param {Number} offset\r\n   */\r\n  moveCursorDownWithoutShift: function(offset) {\r\n    this._selectionDirection = 'right';\r\n    this.setSelectionStart(this.selectionStart + offset);\r\n    this.setSelectionEnd(this.selectionStart);\r\n  },\r\n\r\n  /**\r\n   * private\r\n   */\r\n  swapSelectionPoints: function() {\r\n    var swapSel = this.selectionEnd;\r\n    this.setSelectionEnd(this.selectionStart);\r\n    this.setSelectionStart(swapSel);\r\n  },\r\n\r\n  /**\r\n   * Moves cursor down while keeping selection\r\n   * @param {Number} offset\r\n   */\r\n  moveCursorDownWithShift: function(offset) {\r\n    if (this.selectionEnd === this.selectionStart) {\r\n      this._selectionDirection = 'right';\r\n    }\r\n    if (this._selectionDirection === 'right') {\r\n      this.setSelectionEnd(this.selectionEnd + offset);\r\n    }\r\n    else {\r\n      this.setSelectionStart(this.selectionStart + offset);\r\n    }\r\n    if (this.selectionEnd < this.selectionStart  && this._selectionDirection === 'left') {\r\n      this.swapSelectionPoints();\r\n      this._selectionDirection = 'right';\r\n    }\r\n    if (this.selectionEnd > this.text.length) {\r\n      this.setSelectionEnd(this.text.length);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @param {Event} e Event object\r\n   * @param {Boolean} isRight\r\n   * @return {Number}\r\n   */\r\n  getUpCursorOffset: function(e, isRight) {\r\n    var selectionProp = isRight ? this.selectionEnd : this.selectionStart,\r\n        cursorLocation = this.get2DCursorLocation(selectionProp);\r\n    // if on first line, up cursor goes to start of line\r\n    if (cursorLocation.lineIndex === 0 || e.metaKey || e.keyCode === 33) {\r\n      return selectionProp;\r\n    }\r\n\r\n    var textBeforeCursor = this.text.slice(0, selectionProp),\r\n        textOnSameLineBeforeCursor = textBeforeCursor.slice(textBeforeCursor.lastIndexOf('\\n') + 1),\r\n        textOnPreviousLine = (textBeforeCursor.match(/\\n?(.*)\\n.*$/) || {})[1] || '',\r\n        _char,\r\n        widthOfSameLineBeforeCursor = this._getLineWidth(this.ctx, cursorLocation.lineIndex),\r\n        lineLeftOffset = this._getLineLeftOffset(widthOfSameLineBeforeCursor),\r\n        widthOfCharsOnSameLineBeforeCursor = lineLeftOffset,\r\n        lineIndex = cursorLocation.lineIndex;\r\n\r\n    for (var i = 0, len = textOnSameLineBeforeCursor.length; i < len; i++) {\r\n      _char = textOnSameLineBeforeCursor[i];\r\n      widthOfCharsOnSameLineBeforeCursor += this._getWidthOfChar(this.ctx, _char, lineIndex, i);\r\n    }\r\n\r\n    var indexOnPrevLine = this._getIndexOnPrevLine(\r\n      cursorLocation, textOnPreviousLine, widthOfCharsOnSameLineBeforeCursor);\r\n\r\n    return textOnPreviousLine.length - indexOnPrevLine + textOnSameLineBeforeCursor.length;\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _getIndexOnPrevLine: function(cursorLocation, textOnPreviousLine, widthOfCharsOnSameLineBeforeCursor) {\r\n\r\n    var lineIndex = cursorLocation.lineIndex - 1,\r\n        widthOfPreviousLine = this._getLineWidth(this.ctx, lineIndex),\r\n        lineLeftOffset = this._getLineLeftOffset(widthOfPreviousLine),\r\n        widthOfCharsOnPreviousLine = lineLeftOffset,\r\n        indexOnPrevLine = 0,\r\n        foundMatch;\r\n\r\n    for (var j = 0, jlen = textOnPreviousLine.length; j < jlen; j++) {\r\n\r\n      var _char = textOnPreviousLine[j],\r\n          widthOfChar = this._getWidthOfChar(this.ctx, _char, lineIndex, j);\r\n\r\n      widthOfCharsOnPreviousLine += widthOfChar;\r\n\r\n      if (widthOfCharsOnPreviousLine > widthOfCharsOnSameLineBeforeCursor) {\r\n\r\n        foundMatch = true;\r\n\r\n        var leftEdge = widthOfCharsOnPreviousLine - widthOfChar,\r\n            rightEdge = widthOfCharsOnPreviousLine,\r\n            offsetFromLeftEdge = Math.abs(leftEdge - widthOfCharsOnSameLineBeforeCursor),\r\n            offsetFromRightEdge = Math.abs(rightEdge - widthOfCharsOnSameLineBeforeCursor);\r\n\r\n        indexOnPrevLine = offsetFromRightEdge < offsetFromLeftEdge ? j : (j - 1);\r\n\r\n        break;\r\n      }\r\n    }\r\n\r\n    // reached end\r\n    if (!foundMatch) {\r\n      indexOnPrevLine = textOnPreviousLine.length - 1;\r\n    }\r\n\r\n    return indexOnPrevLine;\r\n  },\r\n\r\n  /**\r\n   * Moves cursor up\r\n   * @param {Event} e Event object\r\n   */\r\n  moveCursorUp: function(e) {\r\n\r\n    this.abortCursorAnimation();\r\n    this._currentCursorOpacity = 1;\r\n\r\n    var offset = this.getUpCursorOffset(e, this._selectionDirection === 'right');\r\n    if (e.shiftKey) {\r\n      this.moveCursorUpWithShift(offset);\r\n    }\r\n    else {\r\n      this.moveCursorUpWithoutShift(offset);\r\n    }\r\n\r\n    this.initDelayedCursor();\r\n  },\r\n\r\n  /**\r\n   * Moves cursor up with shift\r\n   * @param {Number} offset\r\n   */\r\n  moveCursorUpWithShift: function(offset) {\r\n    if (this.selectionEnd === this.selectionStart) {\r\n      this._selectionDirection = 'left';\r\n    }\r\n    if (this._selectionDirection === 'right') {\r\n      this.setSelectionEnd(this.selectionEnd - offset);\r\n    }\r\n    else {\r\n      this.setSelectionStart(this.selectionStart - offset);\r\n    }\r\n    if (this.selectionEnd < this.selectionStart && this._selectionDirection === 'right') {\r\n      this.swapSelectionPoints();\r\n      this._selectionDirection = 'left';\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Moves cursor up without shift\r\n   * @param {Number} offset\r\n   */\r\n  moveCursorUpWithoutShift: function(offset) {\r\n    if (this.selectionStart === this.selectionEnd) {\r\n      this.setSelectionStart(this.selectionStart - offset);\r\n    }\r\n    this.setSelectionEnd(this.selectionStart);\r\n\r\n    this._selectionDirection = 'left';\r\n  },\r\n\r\n  /**\r\n   * Moves cursor left\r\n   * @param {Event} e Event object\r\n   */\r\n  moveCursorLeft: function(e) {\r\n    if (this.selectionStart === 0 && this.selectionEnd === 0) {\r\n      return;\r\n    }\r\n\r\n    this.abortCursorAnimation();\r\n    this._currentCursorOpacity = 1;\r\n\r\n    if (e.shiftKey) {\r\n      this.moveCursorLeftWithShift(e);\r\n    }\r\n    else {\r\n      this.moveCursorLeftWithoutShift(e);\r\n    }\r\n\r\n    this.initDelayedCursor();\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _move: function(e, prop, direction) {\r\n    var propMethod = (prop === 'selectionStart' ? 'setSelectionStart' : 'setSelectionEnd');\r\n    if (e.altKey) {\r\n      this[propMethod](this['findWordBoundary' + direction](this[prop]));\r\n    }\r\n    else if (e.metaKey || e.keyCode === 35 ||  e.keyCode === 36 ) {\r\n      this[propMethod](this['findLineBoundary' + direction](this[prop]));\r\n    }\r\n    else {\r\n      this[propMethod](this[prop] + (direction === 'Left' ? -1 : 1));\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _moveLeft: function(e, prop) {\r\n    this._move(e, prop, 'Left');\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _moveRight: function(e, prop) {\r\n    this._move(e, prop, 'Right');\r\n  },\r\n\r\n  /**\r\n   * Moves cursor left without keeping selection\r\n   * @param {Event} e\r\n   */\r\n  moveCursorLeftWithoutShift: function(e) {\r\n    this._selectionDirection = 'left';\r\n\r\n    // only move cursor when there is no selection,\r\n    // otherwise we discard it, and leave cursor on same place\r\n    if (this.selectionEnd === this.selectionStart) {\r\n      this._moveLeft(e, 'selectionStart');\r\n    }\r\n    this.setSelectionEnd(this.selectionStart);\r\n  },\r\n\r\n  /**\r\n   * Moves cursor left while keeping selection\r\n   * @param {Event} e\r\n   */\r\n  moveCursorLeftWithShift: function(e) {\r\n    if (this._selectionDirection === 'right' && this.selectionStart !== this.selectionEnd) {\r\n      this._moveLeft(e, 'selectionEnd');\r\n    }\r\n    else {\r\n      this._selectionDirection = 'left';\r\n      this._moveLeft(e, 'selectionStart');\r\n\r\n      // increase selection by one if it's a newline\r\n      if (this.text.charAt(this.selectionStart) === '\\n') {\r\n        this.setSelectionStart(this.selectionStart - 1);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Moves cursor right\r\n   * @param {Event} e Event object\r\n   */\r\n  moveCursorRight: function(e) {\r\n    if (this.selectionStart >= this.text.length && this.selectionEnd >= this.text.length) {\r\n      return;\r\n    }\r\n\r\n    this.abortCursorAnimation();\r\n    this._currentCursorOpacity = 1;\r\n\r\n    if (e.shiftKey) {\r\n      this.moveCursorRightWithShift(e);\r\n    }\r\n    else {\r\n      this.moveCursorRightWithoutShift(e);\r\n    }\r\n\r\n    this.initDelayedCursor();\r\n  },\r\n\r\n  /**\r\n   * Moves cursor right while keeping selection\r\n   * @param {Event} e\r\n   */\r\n  moveCursorRightWithShift: function(e) {\r\n    if (this._selectionDirection === 'left' && this.selectionStart !== this.selectionEnd) {\r\n      this._moveRight(e, 'selectionStart');\r\n    }\r\n    else {\r\n      this._selectionDirection = 'right';\r\n      this._moveRight(e, 'selectionEnd');\r\n\r\n      // increase selection by one if it's a newline\r\n      if (this.text.charAt(this.selectionEnd - 1) === '\\n') {\r\n        this.setSelectionEnd(this.selectionEnd + 1);\r\n      }\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Moves cursor right without keeping selection\r\n   * @param {Event} e Event object\r\n   */\r\n  moveCursorRightWithoutShift: function(e) {\r\n    this._selectionDirection = 'right';\r\n\r\n    if (this.selectionStart === this.selectionEnd) {\r\n      this._moveRight(e, 'selectionStart');\r\n      this.setSelectionEnd(this.selectionStart);\r\n    }\r\n    else {\r\n      this.setSelectionEnd(this.selectionEnd + this.getNumNewLinesInSelectedText());\r\n      this.setSelectionStart(this.selectionEnd);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * Removes characters selected by selection\r\n   * @param {Event} e Event object\r\n   */\r\n  removeChars: function(e) {\r\n    if (this.selectionStart === this.selectionEnd) {\r\n      this._removeCharsNearCursor(e);\r\n    }\r\n    else {\r\n      this._removeCharsFromTo(this.selectionStart, this.selectionEnd);\r\n    }\r\n\r\n    this.setSelectionEnd(this.selectionStart);\r\n\r\n    this._removeExtraneousStyles();\r\n\r\n    this._clearCache();\r\n    this.canvas && this.canvas.renderAll();\r\n\r\n    this.setCoords();\r\n    this.fire('changed');\r\n    this.canvas && this.canvas.fire('text:changed', { target: this });\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   * @param {Event} e Event object\r\n   */\r\n  _removeCharsNearCursor: function(e) {\r\n    if (this.selectionStart !== 0) {\r\n\r\n      if (e.metaKey) {\r\n        // remove all till the start of current line\r\n        var leftLineBoundary = this.findLineBoundaryLeft(this.selectionStart);\r\n\r\n        this._removeCharsFromTo(leftLineBoundary, this.selectionStart);\r\n        this.setSelectionStart(leftLineBoundary);\r\n      }\r\n      else if (e.altKey) {\r\n        // remove all till the start of current word\r\n        var leftWordBoundary = this.findWordBoundaryLeft(this.selectionStart);\r\n\r\n        this._removeCharsFromTo(leftWordBoundary, this.selectionStart);\r\n        this.setSelectionStart(leftWordBoundary);\r\n      }\r\n      else {\r\n        var isBeginningOfLine = this.text.slice(this.selectionStart - 1, this.selectionStart) === '\\n';\r\n        this.removeStyleObject(isBeginningOfLine);\r\n        this.setSelectionStart(this.selectionStart - 1);\r\n        this.text = this.text.slice(0, this.selectionStart) +\r\n                    this.text.slice(this.selectionStart + 1);\r\n      }\r\n    }\r\n  }\r\n});\r\n\r\n\r\n/* _TO_SVG_START_ */\r\nfabric.util.object.extend(fabric.IText.prototype, /** @lends fabric.IText.prototype */ {\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _setSVGTextLineText: function(lineIndex, textSpans, height, textLeftOffset, textTopOffset, textBgRects) {\r\n    if (!this.styles[lineIndex]) {\r\n      this.callSuper('_setSVGTextLineText',\r\n        lineIndex, textSpans, height, textLeftOffset, textTopOffset);\r\n    }\r\n    else {\r\n      this._setSVGTextLineChars(\r\n        lineIndex, textSpans, height, textLeftOffset, textBgRects);\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _setSVGTextLineChars: function(lineIndex, textSpans, height, textLeftOffset, textBgRects) {\r\n\r\n    var chars = this._textLines[lineIndex].split(''),\r\n        charOffset = 0,\r\n        lineLeftOffset = this._getSVGLineLeftOffset(lineIndex) - this.width / 2,\r\n        lineOffset = this._getSVGLineTopOffset(lineIndex),\r\n        heightOfLine = this._getHeightOfLine(this.ctx, lineIndex);\r\n\r\n    for (var i = 0, len = chars.length; i < len; i++) {\r\n      var styleDecl = this.styles[lineIndex][i] || { };\r\n\r\n      textSpans.push(\r\n        this._createTextCharSpan(\r\n          chars[i], styleDecl, lineLeftOffset, lineOffset.lineTop + lineOffset.offset, charOffset));\r\n\r\n      var charWidth = this._getWidthOfChar(this.ctx, chars[i], lineIndex, i);\r\n\r\n      if (styleDecl.textBackgroundColor) {\r\n        textBgRects.push(\r\n          this._createTextCharBg(\r\n            styleDecl, lineLeftOffset, lineOffset.lineTop, heightOfLine, charWidth, charOffset));\r\n      }\r\n\r\n      charOffset += charWidth;\r\n    }\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _getSVGLineLeftOffset: function(lineIndex) {\r\n    return fabric.util.toFixed(this._getLineLeftOffset(this.__lineWidths[lineIndex]), 2);\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _getSVGLineTopOffset: function(lineIndex) {\r\n    var lineTopOffset = 0, lastHeight = 0;\r\n    for (var j = 0; j < lineIndex; j++) {\r\n      lineTopOffset += this._getHeightOfLine(this.ctx, j);\r\n    }\r\n    lastHeight = this._getHeightOfLine(this.ctx, j);\r\n    return {\r\n      lineTop: lineTopOffset,\r\n      offset: (this._fontSizeMult - this._fontSizeFraction) * lastHeight / (this.lineHeight * this._fontSizeMult)\r\n    };\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _createTextCharBg: function(styleDecl, lineLeftOffset, lineTopOffset, heightOfLine, charWidth, charOffset) {\r\n    return [\r\n      //jscs:disable validateIndentation\r\n      '<rect fill=\"', styleDecl.textBackgroundColor,\r\n      '\" x=\"', lineLeftOffset + charOffset,\r\n      '\" y=\"', lineTopOffset - this.height/2,\r\n      '\" width=\"', charWidth,\r\n      '\" height=\"', heightOfLine / this.lineHeight,\r\n      '\"></rect>'\r\n      //jscs:enable validateIndentation\r\n    ].join('');\r\n  },\r\n\r\n  /**\r\n   * @private\r\n   */\r\n  _createTextCharSpan: function(_char, styleDecl, lineLeftOffset, lineTopOffset, charOffset) {\r\n\r\n    var fillStyles = this.getSvgStyles.call(fabric.util.object.extend({\r\n      visible: true,\r\n      fill: this.fill,\r\n      stroke: this.stroke,\r\n      type: 'text'\r\n    }, styleDecl));\r\n\r\n    return [\r\n      //jscs:disable validateIndentation\r\n      '<tspan x=\"', lineLeftOffset + charOffset, '\" y=\"',\r\n        lineTopOffset - this.height/2, '\" ',\r\n        (styleDecl.fontFamily ? 'font-family=\"' + styleDecl.fontFamily.replace(/\"/g, '\\'') + '\" ': ''),\r\n        (styleDecl.fontSize ? 'font-size=\"' + styleDecl.fontSize + '\" ': ''),\r\n        (styleDecl.fontStyle ? 'font-style=\"' + styleDecl.fontStyle + '\" ': ''),\r\n        (styleDecl.fontWeight ? 'font-weight=\"' + styleDecl.fontWeight + '\" ': ''),\r\n        (styleDecl.textDecoration ? 'text-decoration=\"' + styleDecl.textDecoration + '\" ': ''),\r\n        'style=\"', fillStyles, '\">',\r\n        fabric.util.string.escapeXml(_char),\r\n      '</tspan>'\r\n      //jscs:enable validateIndentation\r\n    ].join('');\r\n  }\r\n});\r\n/* _TO_SVG_END_ */\r\n\r\n\r\n(function() {\r\n\r\n  if (typeof document !== 'undefined' && typeof window !== 'undefined') {\r\n    return;\r\n  }\r\n\r\n  var DOMParser = require('xmldom').DOMParser,\r\n      URL = require('url'),\r\n      HTTP = require('http'),\r\n      HTTPS = require('https'),\r\n\r\n      Canvas = require('canvas'),\r\n      Image = require('canvas').Image;\r\n\r\n  /** @private */\r\n  function request(url, encoding, callback) {\r\n    var oURL = URL.parse(url);\r\n\r\n    // detect if http or https is used\r\n    if ( !oURL.port ) {\r\n      oURL.port = ( oURL.protocol.indexOf('https:') === 0 ) ? 443 : 80;\r\n    }\r\n\r\n    // assign request handler based on protocol\r\n    var reqHandler = (oURL.protocol.indexOf('https:') === 0 ) ? HTTPS : HTTP,\r\n        req = reqHandler.request({\r\n          hostname: oURL.hostname,\r\n          port: oURL.port,\r\n          path: oURL.path,\r\n          method: 'GET'\r\n        }, function(response) {\r\n          var body = '';\r\n          if (encoding) {\r\n            response.setEncoding(encoding);\r\n          }\r\n          response.on('end', function () {\r\n            callback(body);\r\n          });\r\n          response.on('data', function (chunk) {\r\n            if (response.statusCode === 200) {\r\n              body += chunk;\r\n            }\r\n          });\r\n        });\r\n\r\n    req.on('error', function(err) {\r\n      if (err.errno === process.ECONNREFUSED) {\r\n        fabric.log('ECONNREFUSED: connection refused to ' + oURL.hostname + ':' + oURL.port);\r\n      }\r\n      else {\r\n        fabric.log(err.message);\r\n      }\r\n    });\r\n\r\n    req.end();\r\n  }\r\n\r\n  /** @private */\r\n  function requestFs(path, callback) {\r\n    var fs = require('fs');\r\n    fs.readFile(path, function (err, data) {\r\n      if (err) {\r\n        fabric.log(err);\r\n        throw err;\r\n      }\r\n      else {\r\n        callback(data);\r\n      }\r\n    });\r\n  }\r\n\r\n  fabric.util.loadImage = function(url, callback, context) {\r\n    function createImageAndCallBack(data) {\r\n      img.src = new Buffer(data, 'binary');\r\n      // preserving original url, which seems to be lost in node-canvas\r\n      img._src = url;\r\n      callback && callback.call(context, img);\r\n    }\r\n    var img = new Image();\r\n    if (url && (url instanceof Buffer || url.indexOf('data') === 0)) {\r\n      img.src = img._src = url;\r\n      callback && callback.call(context, img);\r\n    }\r\n    else if (url && url.indexOf('http') !== 0) {\r\n      requestFs(url, createImageAndCallBack);\r\n    }\r\n    else if (url) {\r\n      request(url, 'binary', createImageAndCallBack);\r\n    }\r\n    else {\r\n      callback && callback.call(context, url);\r\n    }\r\n  };\r\n\r\n  fabric.loadSVGFromURL = function(url, callback, reviver) {\r\n    url = url.replace(/^\\n\\s*/, '').replace(/\\?.*$/, '').trim();\r\n    if (url.indexOf('http') !== 0) {\r\n      requestFs(url, function(body) {\r\n        fabric.loadSVGFromString(body.toString(), callback, reviver);\r\n      });\r\n    }\r\n    else {\r\n      request(url, '', function(body) {\r\n        fabric.loadSVGFromString(body, callback, reviver);\r\n      });\r\n    }\r\n  };\r\n\r\n  fabric.loadSVGFromString = function(string, callback, reviver) {\r\n    var doc = new DOMParser().parseFromString(string);\r\n    fabric.parseSVGDocument(doc.documentElement, function(results, options) {\r\n      callback && callback(results, options);\r\n    }, reviver);\r\n  };\r\n\r\n  fabric.util.getScript = function(url, callback) {\r\n    request(url, '', function(body) {\r\n      eval(body);\r\n      callback && callback();\r\n    });\r\n  };\r\n\r\n  fabric.Image.fromObject = function(object, callback) {\r\n    fabric.util.loadImage(object.src, function(img) {\r\n      var oImg = new fabric.Image(img);\r\n\r\n      oImg._initConfig(object);\r\n      oImg._initFilters(object, function(filters) {\r\n        oImg.filters = filters || [ ];\r\n        callback && callback(oImg);\r\n      });\r\n    });\r\n  };\r\n\r\n  /**\r\n   * Only available when running fabric on node.js\r\n   * @param {Number} width Canvas width\r\n   * @param {Number} height Canvas height\r\n   * @param {Object} [options] Options to pass to FabricCanvas.\r\n   * @param {Object} [nodeCanvasOptions] Options to pass to NodeCanvas.\r\n   * @return {Object} wrapped canvas instance\r\n   */\r\n  fabric.createCanvasForNode = function(width, height, options, nodeCanvasOptions) {\r\n    nodeCanvasOptions = nodeCanvasOptions || options;\r\n\r\n    var canvasEl = fabric.document.createElement('canvas'),\r\n        nodeCanvas = new Canvas(width || 600, height || 600, nodeCanvasOptions);\r\n\r\n    // jsdom doesn't create style on canvas element, so here be temp. workaround\r\n    canvasEl.style = { };\r\n\r\n    canvasEl.width = nodeCanvas.width;\r\n    canvasEl.height = nodeCanvas.height;\r\n\r\n    var FabricCanvas = fabric.Canvas || fabric.StaticCanvas,\r\n        fabricCanvas = new FabricCanvas(canvasEl, options);\r\n\r\n    fabricCanvas.contextContainer = nodeCanvas.getContext('2d');\r\n    fabricCanvas.nodeCanvas = nodeCanvas;\r\n    fabricCanvas.Font = Canvas.Font;\r\n\r\n    return fabricCanvas;\r\n  };\r\n\r\n  /** @ignore */\r\n  fabric.StaticCanvas.prototype.createPNGStream = function() {\r\n    return this.nodeCanvas.createPNGStream();\r\n  };\r\n\r\n  fabric.StaticCanvas.prototype.createJPEGStream = function(opts) {\r\n    return this.nodeCanvas.createJPEGStream(opts);\r\n  };\r\n\r\n  var origSetWidth = fabric.StaticCanvas.prototype.setWidth;\r\n  fabric.StaticCanvas.prototype.setWidth = function(width, options) {\r\n    origSetWidth.call(this, width, options);\r\n    this.nodeCanvas.width = width;\r\n    return this;\r\n  };\r\n  if (fabric.Canvas) {\r\n    fabric.Canvas.prototype.setWidth = fabric.StaticCanvas.prototype.setWidth;\r\n  }\r\n\r\n  var origSetHeight = fabric.StaticCanvas.prototype.setHeight;\r\n  fabric.StaticCanvas.prototype.setHeight = function(height, options) {\r\n    origSetHeight.call(this, height, options);\r\n    this.nodeCanvas.height = height;\r\n    return this;\r\n  };\r\n  if (fabric.Canvas) {\r\n    fabric.Canvas.prototype.setHeight = fabric.StaticCanvas.prototype.setHeight;\r\n  }\r\n\r\n})();\r\n\r\n\nvar DateFormat = {};\r\n\r\n(function($) {\r\n  var daysInWeek          = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\r\n  var shortDaysInWeek     = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];\r\n  var shortMonthsInYear   = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',\r\n                              'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];\r\n  var longMonthsInYear    = ['January', 'February', 'March', 'April', 'May', 'June',\r\n                              'July', 'August', 'September', 'October', 'November', 'December'];\r\n  var shortMonthsToNumber = { 'Jan': '01', 'Feb': '02', 'Mar': '03', 'Apr': '04', 'May': '05', 'Jun': '06',\r\n                              'Jul': '07', 'Aug': '08', 'Sep': '09', 'Oct': '10', 'Nov': '11', 'Dec': '12' };\r\n\r\n  var YYYYMMDD_MATCHER = /\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.?\\d{0,3}[Z\\-+]?(\\d{2}:?\\d{2})?/;\r\n\r\n  $.format = (function() {\r\n    function numberToLongDay(value) {\r\n      // 0 to Sunday\r\n      // 1 to Monday\r\n      return daysInWeek[parseInt(value, 10)] || value;\r\n    }\r\n\r\n    function numberToShortDay(value) {\r\n      // 0 to Sun\r\n      // 1 to Mon\r\n      return shortDaysInWeek[parseInt(value, 10)] || value;\r\n    }\r\n\r\n    function numberToShortMonth(value) {\r\n      // 1 to Jan\r\n      // 2 to Feb\r\n      var monthArrayIndex = parseInt(value, 10) - 1;\r\n      return shortMonthsInYear[monthArrayIndex] || value;\r\n    }\r\n\r\n    function numberToLongMonth(value) {\r\n      // 1 to January\r\n      // 2 to February\r\n      var monthArrayIndex = parseInt(value, 10) - 1;\r\n      return longMonthsInYear[monthArrayIndex] || value;\r\n    }\r\n\r\n    function shortMonthToNumber(value) {\r\n      // Jan to 01\r\n      // Feb to 02\r\n      return shortMonthsToNumber[value] || value;\r\n    }\r\n\r\n    function parseTime(value) {\r\n      // 10:54:50.546\r\n      // => hour: 10, minute: 54, second: 50, millis: 546\r\n      // 10:54:50\r\n      // => hour: 10, minute: 54, second: 50, millis: ''\r\n      var time = value,\r\n          values,\r\n          subValues,\r\n          hour,\r\n          minute,\r\n          second,\r\n          millis = '',\r\n          delimited,\r\n          timeArray;\r\n\r\n      if(time.indexOf('.') !== -1) {\r\n        delimited = time.split('.');\r\n        // split time and milliseconds\r\n        time   = delimited[0];\r\n        millis = delimited[1];\r\n      }\r\n\r\n      timeArray = time.split(':');\r\n\r\n      if(timeArray.length === 3) {\r\n        hour   = timeArray[0];\r\n        minute = timeArray[1];\r\n        // '20 GMT-0200 (BRST)'.replace(/\\s.+/, '').replace(/[a-z]/gi, '');\r\n        // => 20\r\n        // '20Z'.replace(/\\s.+/, '').replace(/[a-z]/gi, '');\r\n        // => 20\r\n        second = timeArray[2].replace(/\\s.+/, '').replace(/[a-z]/gi, '');\r\n        // '01:10:20 GMT-0200 (BRST)'.replace(/\\s.+/, '').replace(/[a-z]/gi, '');\r\n        // => 01:10:20\r\n        // '01:10:20Z'.replace(/\\s.+/, '').replace(/[a-z]/gi, '');\r\n        // => 01:10:20\r\n        time = time.replace(/\\s.+/, '').replace(/[a-z]/gi, '');\r\n        return {\r\n          time:    time,\r\n          hour:    hour,\r\n          minute:  minute,\r\n          second:  second,\r\n          millis:  millis\r\n        };\r\n      }\r\n\r\n      return { time : '', hour : '', minute : '', second : '', millis : '' };\r\n    }\r\n\r\n\r\n    function padding(value, length) {\r\n      var paddingCount = length - String(value).length;\r\n      for(var i = 0; i < paddingCount; i++) {\r\n        value = '0' + value;\r\n      }\r\n      return value;\r\n    }\r\n\r\n    return {\r\n\r\n      parseDate: function(value) {\r\n        var parsedDate = {\r\n          date:       null,\r\n          year:       null,\r\n          month:      null,\r\n          dayOfMonth: null,\r\n          dayOfWeek:  null,\r\n          time:       null\r\n        };\r\n\r\n        if(typeof value == 'number') {\r\n          return this.parseDate(new Date(value));\r\n        } else if(typeof value.getFullYear == 'function') {\r\n          parsedDate.year       = String(value.getFullYear());\r\n          // d = new Date(1900, 1, 1) // 1 for Feb instead of Jan.\r\n          // => Thu Feb 01 1900 00:00:00\r\n          parsedDate.month      = String(value.getMonth() + 1);\r\n          parsedDate.dayOfMonth = String(value.getDate());\r\n          parsedDate.time       = parseTime(value.toTimeString());\r\n        } else if(value.search(YYYYMMDD_MATCHER) != -1) {\r\n          /* 2009-04-19T16:11:05+02:00 || 2009-04-19T16:11:05Z */\r\n          values = value.split(/[T\\+-]/);\r\n          parsedDate.year       = values[0];\r\n          parsedDate.month      = values[1];\r\n          parsedDate.dayOfMonth = values[2];\r\n          parsedDate.time       = parseTime(values[3].split('.')[0]);\r\n        } else {\r\n          values = value.split(' ');\r\n          if(values.length === 6 && isNaN(values[5])) {\r\n            // values[5] == year\r\n            /*\r\n             * This change is necessary to make `Mon Apr 28 2014 05:30:00 GMT-0300` work\r\n             * like `case 7`\r\n             * otherwise it will be considered like `Wed Jan 13 10:43:41 CET 2010\r\n             * Fixes: https://github.com/phstc/jquery-dateFormat/issues/64\r\n             */\r\n            values[values.length] = '()';\r\n          }\r\n          switch (values.length) {\r\n            case 6:\r\n              /* Wed Jan 13 10:43:41 CET 2010 */\r\n              parsedDate.year       = values[5];\r\n              parsedDate.month      = shortMonthToNumber(values[1]);\r\n              parsedDate.dayOfMonth = values[2];\r\n              parsedDate.time       = parseTime(values[3]);\r\n              break;\r\n            case 2:\r\n              /* 2009-12-18 10:54:50.546 */\r\n              subValues = values[0].split('-');\r\n              parsedDate.year       = subValues[0];\r\n              parsedDate.month      = subValues[1];\r\n              parsedDate.dayOfMonth = subValues[2];\r\n              parsedDate.time       = parseTime(values[1]);\r\n              break;\r\n            case 7:\r\n              /* Tue Mar 01 2011 12:01:42 GMT-0800 (PST) */\r\n            case 9:\r\n              /* added by Larry, for Fri Apr 08 2011 00:00:00 GMT+0800 (China Standard Time) */\r\n            case 10:\r\n              /* added by Larry, for Fri Apr 08 2011 00:00:00 GMT+0200 (W. Europe Daylight Time) */\r\n              parsedDate.year       = values[3];\r\n              parsedDate.month      = shortMonthToNumber(values[1]);\r\n              parsedDate.dayOfMonth = values[2];\r\n              parsedDate.time       = parseTime(values[4]);\r\n              break;\r\n            case 1:\r\n              /* added by Jonny, for 2012-02-07CET00:00:00 (Doctrine Entity -> Json Serializer) */\r\n              subValues = values[0].split('');\r\n              parsedDate.year       = subValues[0] + subValues[1] + subValues[2] + subValues[3];\r\n              parsedDate.month      = subValues[5] + subValues[6];\r\n              parsedDate.dayOfMonth = subValues[8] + subValues[9];\r\n              parsedDate.time       = parseTime(subValues[13] + subValues[14] + subValues[15] + subValues[16] + subValues[17] + subValues[18] + subValues[19] + subValues[20]);\r\n              break;\r\n            default:\r\n              return null;\r\n          }\r\n        }\r\n        parsedDate.date       = new Date(parsedDate.year, parsedDate.month - 1, parsedDate.dayOfMonth);\r\n        parsedDate.dayOfWeek  = String(parsedDate.date.getDay());\r\n\r\n        return parsedDate;\r\n      },\r\n\r\n      date : function(value, format) {\r\n        try {\r\n          var parsedDate = this.parseDate(value);\r\n\r\n          if(parsedDate === null) {\r\n            return value;\r\n          }\r\n\r\n          var date       = parsedDate.date,\r\n              year       = parsedDate.year,\r\n              month      = parsedDate.month,\r\n              dayOfMonth = parsedDate.dayOfMonth,\r\n              dayOfWeek  = parsedDate.dayOfWeek,\r\n              time       = parsedDate.time;\r\n\r\n          var pattern      = '',\r\n              retValue     = '',\r\n              unparsedRest = '',\r\n              inQuote      = false;\r\n\r\n          /* Issue 1 - variable scope issue in format.date (Thanks jakemonO) */\r\n          for(var i = 0; i < format.length; i++) {\r\n            var currentPattern = format.charAt(i);\r\n            // Look-Ahead Right (LALR)\r\n            var nextRight      = format.charAt(i + 1);\r\n\r\n            if (inQuote) {\r\n              if (currentPattern == \"'\") {\r\n                retValue += (pattern === '') ? \"'\" : pattern;\r\n                pattern = '';\r\n                inQuote = false;\r\n              } else {\r\n                pattern += currentPattern;\r\n              }\r\n              continue;\r\n            }\r\n            pattern += currentPattern;\r\n            unparsedRest = '';\r\n            switch (pattern) {\r\n              case 'ddd':\r\n                retValue += numberToLongDay(dayOfWeek);\r\n                pattern = '';\r\n                break;\r\n              case 'dd':\r\n                if(nextRight === 'd') {\r\n                  break;\r\n                }\r\n                retValue += padding(dayOfMonth, 2);\r\n                pattern = '';\r\n                break;\r\n              case 'd':\r\n                if(nextRight === 'd') {\r\n                  break;\r\n                }\r\n                retValue += parseInt(dayOfMonth, 10);\r\n                pattern = '';\r\n                break;\r\n              case 'D':\r\n                if(dayOfMonth == 1 || dayOfMonth == 21 || dayOfMonth == 31) {\r\n                  dayOfMonth = parseInt(dayOfMonth, 10) + 'st';\r\n                } else if(dayOfMonth == 2 || dayOfMonth == 22) {\r\n                  dayOfMonth = parseInt(dayOfMonth, 10) + 'nd';\r\n                } else if(dayOfMonth == 3 || dayOfMonth == 23) {\r\n                  dayOfMonth = parseInt(dayOfMonth, 10) + 'rd';\r\n                } else {\r\n                  dayOfMonth = parseInt(dayOfMonth, 10) + 'th';\r\n                }\r\n                retValue += dayOfMonth;\r\n                pattern = '';\r\n                break;\r\n              case 'MMMM':\r\n                retValue += numberToLongMonth(month);\r\n                pattern = '';\r\n                break;\r\n              case 'MMM':\r\n                if(nextRight === 'M') {\r\n                  break;\r\n                }\r\n                retValue += numberToShortMonth(month);\r\n                pattern = '';\r\n                break;\r\n              case 'MM':\r\n                if(nextRight === 'M') {\r\n                  break;\r\n                }\r\n                retValue += padding(month, 2);\r\n                pattern = '';\r\n                break;\r\n              case 'M':\r\n                if(nextRight === 'M') {\r\n                  break;\r\n                }\r\n                retValue += parseInt(month, 10);\r\n                pattern = '';\r\n                break;\r\n              case 'y':\r\n              case 'yyy':\r\n                if(nextRight === 'y') {\r\n                  break;\r\n                }\r\n                retValue += pattern;\r\n                pattern = '';\r\n                break;\r\n              case 'yy':\r\n                if(nextRight === 'y') {\r\n                  break;\r\n                }\r\n                retValue += String(year).slice(-2);\r\n                pattern = '';\r\n                break;\r\n              case 'yyyy':\r\n                retValue += year;\r\n                pattern = '';\r\n                break;\r\n              case 'HH':\r\n                retValue += padding(time.hour, 2);\r\n                pattern = '';\r\n                break;\r\n              case 'H':\r\n                if(nextRight === 'H') {\r\n                  break;\r\n                }\r\n                retValue += parseInt(time.hour, 10);\r\n                pattern = '';\r\n                break;\r\n              case 'hh':\r\n                /* time.hour is '00' as string == is used instead of === */\r\n                hour = (parseInt(time.hour, 10) === 0 ? 12 : time.hour < 13 ? time.hour\r\n                    : time.hour - 12);\r\n                retValue += padding(hour, 2);\r\n                pattern = '';\r\n                break;\r\n              case 'h':\r\n                if(nextRight === 'h') {\r\n                  break;\r\n                }\r\n                hour = (parseInt(time.hour, 10) === 0 ? 12 : time.hour < 13 ? time.hour\r\n                    : time.hour - 12);\r\n                retValue += parseInt(hour, 10);\r\n                // Fixing issue https://github.com/phstc/jquery-dateFormat/issues/21\r\n                // retValue = parseInt(retValue, 10);\r\n                pattern = '';\r\n                break;\r\n              case 'mm':\r\n                retValue += padding(time.minute, 2);\r\n                pattern = '';\r\n                break;\r\n              case 'm':\r\n                if(nextRight === 'm') {\r\n                  break;\r\n                }\r\n                retValue += time.minute;\r\n                pattern = '';\r\n                break;\r\n              case 'ss':\r\n                /* ensure only seconds are added to the return string */\r\n                retValue += padding(time.second.substring(0, 2), 2);\r\n                pattern = '';\r\n                break;\r\n              case 's':\r\n                if(nextRight === 's') {\r\n                  break;\r\n                }\r\n                retValue += time.second;\r\n                pattern = '';\r\n                break;\r\n              case 'S':\r\n              case 'SS':\r\n                if(nextRight === 'S') {\r\n                  break;\r\n                }\r\n                retValue += pattern;\r\n                pattern = '';\r\n                break;\r\n              case 'SSS':\r\n                retValue += time.millis.substring(0, 3);\r\n                pattern = '';\r\n                break;\r\n              case 'a':\r\n                retValue += time.hour >= 12 ? 'PM' : 'AM';\r\n                pattern = '';\r\n                break;\r\n              case 'p':\r\n                retValue += time.hour >= 12 ? 'p.m.' : 'a.m.';\r\n                pattern = '';\r\n                break;\r\n              case 'E':\r\n                retValue += numberToShortDay(dayOfWeek);\r\n                pattern = '';\r\n                break;\r\n              case \"'\":\r\n                pattern = '';\r\n                inQuote = true;\r\n                break;\r\n              default:\r\n                retValue += currentPattern;\r\n                pattern = '';\r\n                break;\r\n            }\r\n          }\r\n          retValue += unparsedRest;\r\n          return retValue;\r\n        } catch (e) {\r\n          if(console && console.log) {\r\n            console.log(e);\r\n          }\r\n          return value;\r\n        }\r\n      },\r\n      /*\r\n       * JavaScript Pretty Date\r\n       * Copyright (c) 2011 John Resig (ejohn.org)\r\n       * Licensed under the MIT and GPL licenses.\r\n       *\r\n       * Takes an ISO time and returns a string representing how long ago the date\r\n       * represents\r\n       *\r\n       * ('2008-01-28T20:24:17Z') // => '2 hours ago'\r\n       * ('2008-01-27T22:24:17Z') // => 'Yesterday'\r\n       * ('2008-01-26T22:24:17Z') // => '2 days ago'\r\n       * ('2008-01-14T22:24:17Z') // => '2 weeks ago'\r\n       * ('2007-12-15T22:24:17Z') // => 'more than 5 weeks ago'\r\n       *\r\n       */\r\n      prettyDate : function(time) {\r\n        var date;\r\n        var diff;\r\n        var day_diff;\r\n\r\n        if(typeof time === 'string' || typeof time === 'number') {\r\n          date = new Date(time);\r\n        }\r\n\r\n        if(typeof time === 'object') {\r\n          date = new Date(time.toString());\r\n        }\r\n\r\n        diff = (((new Date()).getTime() - date.getTime()) / 1000);\r\n\r\n        day_diff = Math.floor(diff / 86400);\r\n\r\n        if(isNaN(day_diff) || day_diff < 0) {\r\n          return;\r\n        }\r\n\r\n        if(diff < 60) {\r\n          return 'just now';\r\n        } else if(diff < 120) {\r\n          return '1 minute ago';\r\n        } else if(diff < 3600) {\r\n          return Math.floor(diff / 60) + ' minutes ago';\r\n        } else if(diff < 7200) {\r\n          return '1 hour ago';\r\n        } else if(diff < 86400) {\r\n          return Math.floor(diff / 3600) + ' hours ago';\r\n        } else if(day_diff === 1) {\r\n          return 'Yesterday';\r\n        } else if(day_diff < 7) {\r\n          return day_diff + ' days ago';\r\n        } else if(day_diff < 31) {\r\n          return Math.ceil(day_diff / 7) + ' weeks ago';\r\n        } else if(day_diff >= 31) {\r\n          return 'more than 5 weeks ago';\r\n        }\r\n      },\r\n      toBrowserTimeZone : function(value, format) {\r\n        return this.date(new Date(value), format || 'MM/dd/yyyy HH:mm:ss');\r\n      }\r\n    };\r\n  }());\r\n}(DateFormat));\r\n;// require dateFormat.js\r\n// please check `dist/jquery.dateFormat.js` for a complete version\r\n(function($) {\r\n  $.format = DateFormat.format;\r\n}(jQuery));\r\n\n\r\n(function (root, factory) {\r\n  'use strict';\r\n\r\n  if (typeof define === 'function' && define.amd) {\r\n    define([], function () { return factory(root); });\r\n  } else {\r\n    root.saveAs = root.saveAs || factory(root);\r\n  }\r\n\r\n})(this, function saveAsFactory(root, undefined) {\r\n  'use strict';\r\n\r\nif (root.navigator !== undefined) {\r\n\r\n  /*\r\n   * IE <10 is explicitly unsupported\r\n   */\r\n  if (/MSIE [1-9]\\./.test(root.navigator.userAgent)) {\r\n    return;\r\n  }\r\n\r\n  /*\r\n   * IE 10+ (native saveAs)\r\n   */\r\n  if (root.navigator.msSaveOrOpenBlob) {\r\n    return nativeIeSaveAs;\r\n  }\r\n\r\n}\r\n\r\nfunction nativeIeSaveAs(blob, name) {\r\n  return root.navigator.msSaveOrOpenBlob(autoBom(blob), name);\r\n}\r\n\r\n\r\n// `self` is undefined in Firefox for Android content script context\r\n// while `this` is nsIContentFrameMessageManager\r\n// with an attribute `content` that corresponds to the window\r\nvar view = root.self || root.window || root.content;\r\nvar saveLinkElement = view.document.createElementNS('http://www.w3.org/1999/xhtml', 'a');\r\nvar canUseSaveLink = 'download' in saveLinkElement;\r\nvar webkitReqFs = view.webkitRequestFileSystem;\r\nvar reqFs = view.requestFileSystem || webkitReqFs || view.mozRequestFileSystem;\r\nvar forceSaveableType = 'application/octet-stream';\r\nvar fsMinSize = 0;\r\n\r\n// See https://code.google.com/p/chromium/issues/detail?id=375297#c7 and\r\n// https://github.com/eligrey/FileSaver.js/commit/485930a#commitcomment-8768047\r\n// for the reasoning behind the timeout and revocation flow\r\nvar arbitraryRevokeTimeout = 500;\r\nvar setImmediate = view.setImmediate || view.setTimeout;\r\n\r\nfunction saveAs(blob, name) {\r\n  return new FileSaver(blob, name);\r\n}\r\n\r\n\r\nvar FSProto = FileSaver.prototype;\r\nFSProto.abort = fileSaverAbort;\r\nFSProto.INIT = 0;\r\nFSProto.WRITING = 1;\r\nFSProto.DONE = 2;\r\nFSProto.readyState = FSProto.INIT;\r\nFSProto.error = null;\r\nFSProto.onwritestart = null;\r\nFSProto.onprogress = null;\r\nFSProto.onwrite = null;\r\nFSProto.onabort = null;\r\nFSProto.onerror = null;\r\nFSProto.onwriteend = null;\r\n\r\n\r\nfunction FileSaver(blob, name) {\r\n  this.blob = blob = autoBom(blob);\r\n  this.saveUsingObjectURLs = saveUsingObjectURLs;\r\n  this.execSave = execSave;\r\n\r\n  // First try a.download, then web filesystem, then object URLs\r\n  var filesaver = this;\r\n  var type = blob.type;\r\n  var blobChanged = false;\r\n  var objectUrl;\r\n  var targetView;\r\n\r\n\r\n  filesaver.readyState = filesaver.INIT;\r\n  name = name || 'download';\r\n\r\n  if ( canUseSaveLink ) {\r\n    return saveUsingLinkElement();\r\n  }\r\n\r\n  fixChromeSaveableType();\r\n  fixWebKitDownload();\r\n\r\n\r\n  if ( ! reqFs ) {\r\n    return saveUsingObjectURLs();\r\n  }\r\n\r\n  return saveUsingFyleSystem(filesaver);\r\n\r\n\r\n  ////////////////\r\n\r\n  function saveUsingLinkElement() {\r\n    objectUrl = getURL().createObjectURL(blob);\r\n    saveLinkElement.href = objectUrl;\r\n    saveLinkElement.download = name;\r\n\r\n    setImmediate(function () {\r\n      triggerClickOnSaveLink();\r\n      dispatchAll(filesaver);\r\n      revoke(objectUrl);\r\n      filesaver.readyState = filesaver.DONE;\r\n    }, 0);\r\n  }\r\n\r\n  function fixChromeSaveableType() {\r\n    /*\r\n     * Object and web filesystem URLs have a problem saving in Google Chrome when\r\n     * viewed in a tab, so I force save with application/octet-stream\r\n     * http://code.google.com/p/chromium/issues/detail?id=91158\r\n     * Update: Google errantly closed 91158, I submitted it again:\r\n     * https://code.google.com/p/chromium/issues/detail?id=389642\r\n     */\r\n    if (view.chrome && type && type !== forceSaveableType) {\r\n      var slice = blob.slice || blob.webkitSlice;\r\n      blob = slice.call(blob, 0, blob.size, forceSaveableType);\r\n      blobChanged = true;\r\n    }\r\n  }\r\n\r\n  function fixWebKitDownload() {\r\n    // Since I can't be sure that the guessed media type will trigger a download\r\n    // in WebKit, I append .download to the filename.\r\n    // https://bugs.webkit.org/show_bug.cgi?id=65440\r\n    if (webkitReqFs && name !== 'download') {\r\n      name += '.download';\r\n    }\r\n\r\n    if (type === forceSaveableType || webkitReqFs) {\r\n      targetView = view;\r\n    }\r\n  }\r\n\r\n\r\n  // on any filesys errors revert to saving with object URLs\r\n  function saveUsingObjectURLs() {\r\n    // don't create more object URLs than needed\r\n    if (blobChanged || ! objectUrl) {\r\n      objectUrl = getURL().createObjectURL(blob);\r\n    }\r\n\r\n    execSave(objectUrl);\r\n  }\r\n\r\n\r\n  function execSave(objectUrl, file, event) {\r\n\r\n    if( targetView ) {\r\n      targetView.location.href = objectUrl;\r\n    } else {\r\n      var newTab = view.open(objectUrl, '_blank');\r\n      if ( newTab === undefined ) {\r\n        /*\r\n         * Apple do not allow window.open\r\n         * see http://bit.ly/1kZffRI\r\n         */\r\n        view.location.href = objectUrl;\r\n      }\r\n    }\r\n\r\n\r\n    filesaver.readyState = filesaver.DONE;\r\n\r\n    if( ! event ) {\r\n      dispatchAll(filesaver);\r\n    } else {\r\n      dispatch(filesaver, 'writeend', event);\r\n    }\r\n\r\n    revoke(file || objectUrl);\r\n  }\r\n\r\n}\r\n\r\nfunction fileSaverAbort() {\r\n  var filesaver = this;\r\n  filesaver.readyState = filesaver.DONE;\r\n  dispatch(filesaver, 'abort');\r\n}\r\n\r\n\r\n// TODO apply dispatch to FileSaver prototype\r\nfunction dispatchAll(filesaver) {\r\n  dispatch(filesaver, 'writestart progress write writeend'.split(' '));\r\n}\r\n\r\n\r\nfunction dispatch(filesaver, eventTypes, event) {\r\n  eventTypes = [].concat(eventTypes);\r\n  var i = eventTypes.length;\r\n  while (i--) {\r\n    var listener = filesaver['on' + eventTypes[i]];\r\n    if (typeof listener === 'function') {\r\n      try {\r\n        listener.call(filesaver, event || filesaver);\r\n      } catch (ex) {\r\n        throwOutside(ex);\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n\r\nfunction saveUsingFyleSystem(filesaver) {\r\n  fsMinSize += filesaver.blob.size;\r\n  var createIfNotFound = {create: true, exclusive: false};\r\n\r\n  reqFs(view.TEMPORARY, fsMinSize, abortable(getFyleSystem), filesaver.saveUsingObjectURLs);\r\n\r\n  ////////////\r\n\r\n  function getFyleSystem(fs) {\r\n    fs.root.getDirectory('temp', createIfNotFound, abortable(getTempDirectory), filesaver.saveUsingObjectURLs);\r\n  }\r\n\r\n  function getTempDirectory(dir) {\r\n    dir.getFile(name, { create: false }, abortable(getExistentFileForRemove), abortable(existentFileNotFound) );\r\n\r\n    /////////////\r\n\r\n    function getExistentFileForRemove(file) {\r\n      // delete file if it already exists\r\n      file.remove(function() {\r\n        save();\r\n      });\r\n    }\r\n\r\n    function existentFileNotFound(ex) {\r\n      if (ex.name === 'NotFoundError') {\r\n        save();\r\n      } else {\r\n        filesaver.saveUsingObjectURLs();\r\n      }\r\n    }\r\n\r\n    //////////\r\n\r\n    function save() {\r\n      dir.getFile(name, createIfNotFound, abortable(getFileForWrite), filesaver.saveUsingObjectURLs);\r\n    }\r\n\r\n    function getFileForWrite(file) {\r\n      file.createWriter(abortable(createWriter), filesaver.saveUsingObjectURLs);\r\n\r\n      ////////\r\n\r\n      function createWriter(writer) {\r\n        writer.onwriteend = onWriterEnd;\r\n        writer.onerror = onError;\r\n\r\n        bindEventsToWriter();\r\n\r\n        writer.write(blob);\r\n        filesaver.abort = onAbort;\r\n        filesaver.readyState = filesaver.WRITING;\r\n\r\n        ////////////\r\n\r\n        function onWriterEnd(event) {\r\n          filesaver.execSave(file.toURL(), file, event);\r\n        }\r\n\r\n        function onError() {\r\n          var error = writer.error;\r\n          if (error.code !== error.ABORT_ERR) {\r\n            filesaver.saveUsingObjectURLs();\r\n          }\r\n        }\r\n\r\n        function bindEventsToWriter() {\r\n          'writestart progress write abort'.split(' ').forEach(function (event) {\r\n            writer['on' + event] = filesaver['on' + event];\r\n          });\r\n        }\r\n\r\n        function onAbort() {\r\n          writer.abort();\r\n          filesaver.readyState = filesaver.DONE;\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  function abortable(func) {\r\n    return function () {\r\n      if (filesaver.readyState !== filesaver.DONE) {\r\n        return func.apply(this, arguments);\r\n      }\r\n    };\r\n  }\r\n}\r\n\r\n\r\nfunction autoBom(blob) {\r\n  // prepend BOM for UTF-8 XML and text/* types (including HTML)\r\n  if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\r\n    return new Blob(['\\ufeff', blob], {type: blob.type});\r\n  }\r\n\r\n  return blob;\r\n}\r\n\r\n// only get URL when necessary in case Blob.js hasn't overridden it yet\r\nfunction getURL() {\r\n  return view.URL || view.webkitURL || view;\r\n}\r\n\r\nfunction revoke(file) {\r\n  setTimeout(revoker, arbitraryRevokeTimeout);\r\n\r\n  ///////////\r\n\r\n  function revoker() {\r\n    if (typeof file === 'string') { // file is an object URL\r\n      getURL().revokeObjectURL(file);\r\n    } else { // file is a File\r\n      file.remove(function(){});\r\n    }\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction throwOutside(ex) {\r\n  setImmediate(function () {\r\n    throw ex;\r\n  }, 0);\r\n}\r\n\r\nfunction triggerClickOnSaveLink() {\r\n  var event = new MouseEvent('click');\r\n  saveLinkElement.dispatchEvent(event);\r\n}\r\n\r\n\r\n  return saveAs;\r\n});\r\n\n/* canvas-toBlob.js\r\n * A canvas.toBlob() implementation.\r\n * 2013-12-27\r\n * \r\n * By Eli Grey, http://eligrey.com and Devin Samarin, https://github.com/eboyjr\r\n * License: X11/MIT\r\n *   See LICENSE.md\r\n */\r\n\r\n/*global self */\r\n/*jslint bitwise: true, regexp: true, confusion: true, es5: true, vars: true, white: true,\r\n  plusplus: true */\r\n\r\n/*! @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */\r\n\r\n(function(view) {\r\n\"use strict\";\r\nvar\r\n\t  Uint8Array = view.Uint8Array\r\n\t, HTMLCanvasElement = view.HTMLCanvasElement\r\n\t, canvas_proto = HTMLCanvasElement && HTMLCanvasElement.prototype\r\n\t, is_base64_regex = /\\s*;\\s*base64\\s*(?:;|$)/i\r\n\t, to_data_url = \"toDataURL\"\r\n\t, base64_ranks\r\n\t, decode_base64 = function(base64) {\r\n\t\tvar\r\n\t\t\t  len = base64.length\r\n\t\t\t, buffer = new Uint8Array(len / 4 * 3 | 0)\r\n\t\t\t, i = 0\r\n\t\t\t, outptr = 0\r\n\t\t\t, last = [0, 0]\r\n\t\t\t, state = 0\r\n\t\t\t, save = 0\r\n\t\t\t, rank\r\n\t\t\t, code\r\n\t\t\t, undef\r\n\t\t;\r\n\t\twhile (len--) {\r\n\t\t\tcode = base64.charCodeAt(i++);\r\n\t\t\trank = base64_ranks[code-43];\r\n\t\t\tif (rank !== 255 && rank !== undef) {\r\n\t\t\t\tlast[1] = last[0];\r\n\t\t\t\tlast[0] = code;\r\n\t\t\t\tsave = (save << 6) | rank;\r\n\t\t\t\tstate++;\r\n\t\t\t\tif (state === 4) {\r\n\t\t\t\t\tbuffer[outptr++] = save >>> 16;\r\n\t\t\t\t\tif (last[1] !== 61 /* padding character */) {\r\n\t\t\t\t\t\tbuffer[outptr++] = save >>> 8;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (last[0] !== 61 /* padding character */) {\r\n\t\t\t\t\t\tbuffer[outptr++] = save;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tstate = 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t// 2/3 chance there's going to be some null bytes at the end, but that\r\n\t\t// doesn't really matter with most image formats.\r\n\t\t// If it somehow matters for you, truncate the buffer up outptr.\r\n\t\treturn buffer;\r\n\t}\r\n;\r\nif (Uint8Array) {\r\n\tbase64_ranks = new Uint8Array([\r\n\t\t  62, -1, -1, -1, 63, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, -1\r\n\t\t, -1, -1,  0, -1, -1, -1,  0,  1,  2,  3,  4,  5,  6,  7,  8,  9\r\n\t\t, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25\r\n\t\t, -1, -1, -1, -1, -1, -1, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35\r\n\t\t, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51\r\n\t]);\r\n}\r\nif (HTMLCanvasElement && !canvas_proto.toBlob) {\r\n\tcanvas_proto.toBlob = function(callback, type /*, ...args*/) {\r\n\t\t  if (!type) {\r\n\t\t\ttype = \"image/png\";\r\n\t\t} if (this.mozGetAsFile) {\r\n\t\t\tcallback(this.mozGetAsFile(\"canvas\", type));\r\n\t\t\treturn;\r\n\t\t} if (this.msToBlob && /^\\s*image\\/png\\s*(?:$|;)/i.test(type)) {\r\n\t\t\tcallback(this.msToBlob());\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tvar\r\n\t\t\t  args = Array.prototype.slice.call(arguments, 1)\r\n\t\t\t, dataURI = this[to_data_url].apply(this, args)\r\n\t\t\t, header_end = dataURI.indexOf(\",\")\r\n\t\t\t, data = dataURI.substring(header_end + 1)\r\n\t\t\t, is_base64 = is_base64_regex.test(dataURI.substring(0, header_end))\r\n\t\t\t, blob\r\n\t\t;\r\n\t\tif (Blob.fake) {\r\n\t\t\t// no reason to decode a data: URI that's just going to become a data URI again\r\n\t\t\tblob = new Blob\r\n\t\t\tif (is_base64) {\r\n\t\t\t\tblob.encoding = \"base64\";\r\n\t\t\t} else {\r\n\t\t\t\tblob.encoding = \"URI\";\r\n\t\t\t}\r\n\t\t\tblob.data = data;\r\n\t\t\tblob.size = data.length;\r\n\t\t} else if (Uint8Array) {\r\n\t\t\tif (is_base64) {\r\n\t\t\t\tblob = new Blob([decode_base64(data)], {type: type});\r\n\t\t\t} else {\r\n\t\t\t\tblob = new Blob([decodeURIComponent(data)], {type: type});\r\n\t\t\t}\r\n\t\t}\r\n\t\tcallback(blob);\r\n\t};\r\n\r\n\tif (canvas_proto.toDataURLHD) {\r\n\t\tcanvas_proto.toBlobHD = function() {\r\n\t\t\tto_data_url = \"toDataURLHD\";\r\n\t\t\tvar blob = this.toBlob();\r\n\t\t\tto_data_url = \"toDataURL\";\r\n\t\t\treturn blob;\r\n\t\t}\r\n\t} else {\r\n\t\tcanvas_proto.toBlobHD = canvas_proto.toBlob;\r\n\t}\r\n}\r\n}(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content || this));\r\n"]}